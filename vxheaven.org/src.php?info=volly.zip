<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Volly - Virus for - by roy g biv (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content=""/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"fecf4a7b6d8e4e6479f30a119ba342686ca0876e-1498755353-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><script type="text/rocketscript">	var s = 0;
	function soundex() {
		if (document.getElementById) {
			var snd = document.getElementById("snd");
			var frm = document.getElementById("sfrm");
			s = 1 - s;
			snd.src = "/img/sound_" + (s ? "on" : "off") + ".gif";
			frm.soundex.value = s;
		}
	}
	function do_img() {
		if (document.getElementById)
			document.write('<' + 'img id="snd" class="va" src="/img/sound_' + (s ? 'on' : 'off') + '.gif" onclick="soundex();" alt="" /' + '>');
	}</script>
<link rel="stylesheet" type="text/css" href="/style.css"/><style type="text/css">.va{vertical-align:middle;}</style>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/src.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Source code of computer viruses</h1><h2>Volly - Virus for - by roy g biv</h2><p><em>Virus for -</em></p><p><strong>roy g biv</strong><br/><small><a href="/src.php?author=roy g biv">Show all viruses by this author</a></small></p><p>2008-09-08</p><a href="#disqus_thread">Comments</a><br/><form class="fr" method="post" action="/file.php"><input type="image" src="/img/dl.gif" alt="Download"/><input type="hidden" name="file" value="c3JjL3ZvbGx5LnppcA@@"/></form> Download volly.zip (6198 bytes) or <a href="/src_view.php?file=volly.zip">browse online</a><p><strong>Author's description</strong></p>
<h2>What is it?</h2>
<p>ODbgScript is a plug-in for OllyDbg. Of course you already know what is OllyDbg. ;) ODbgScript contains a scripting language that can automate OllyDbg. It has lots of useful built-in functions, and it can also execute assembler code directly for extra functions.</p>
<h2>What kind of built-in functions?</h2>
<p>ODbgScript supports local variables, it can push values to the host stack, it can pop values from the host stack, it can access the CPU registers directly, it can get the address of functions in DLLs, it can convert hex values to strings, it can write long strings to memory using the MOV command, it can concatenate strings using the ADD command... and many other things that I did not need. The documentation is very clear. You should go and read that instead. :)</p>
<h2>What kind of extra functions?</h2>
<p>There is a limitation that ODbgScript does not understand selectors, so we cannot look at fs:[30h] and other places using the scripting language. What we can do instead is to use an execution block. That is EXEC and ENDE. Inside that block we put the code to run, but it does not support any local variables and strings. So to access fs:[30h], for example, we could use this code:</p>
<pre class="source">
    exec
    mov eax, fs:[30] //all values are in hex, only dword accesses allowed
    ende
    var a //local variable to receive value
    mov a,eax
</pre>
<p>So easy. We can use functions in DLLs by GPA command. GPA loads the DLL and returns the address of the function. The problem is that DLL is loaded into OllyDbg memory, not the memory of the file being debugged, so if DLL is not there, then we will crash if we try to call the address. Also, there can be a different address for the DLL because of other DLLs loaded already, but that is probably a rare thing.</p>
<h2>Labels and variables</h2>
<p>ODbgScript supports labels and variables. The variables can be short or long
names, and they can be declared more than once without error. This is good
for us, so that the host code will still work even if we have a same name.
Labels can also be declared more than once, but only the first one has the
effect. For that reason, it is good idea to guess about unique names.</p>
<h2>Other things</h2>
<p>ODbgScript supports some arithmetic commands like ADD, SUB, XOR, INC, DEC. They do not alter the flags. There is CMP command which does alter the flags. It is important to remember that because of a likely bug in this code:</p>
<pre class="source">
    dec a
    jne b
</pre>
<p>This code looks like it should branch while a is not zero, but since DEC command does not alter flags, it does not have the right effect. It also means that we can have tricky poly code like this:</p>
<pre class="source">
    mov a,12345678
    cmp a,12345677
    add a,23456789
    sub a,3579be01
    je  b
</pre>
<p>Then a is zero but branch is not taken.</p>
<p>Now we look at some real code...</p>
<p>I know that I could put more into EXEC/ENDE blocks, but I wanted to be as much script as possible, so only APIs are there.</p>
<script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/src.php?info=volly.zip';</script></div><br/><div class="s2">
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"></div>
</body>
</html>
