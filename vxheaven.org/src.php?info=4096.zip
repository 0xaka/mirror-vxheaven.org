<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>4096 - Virus for Linux by badCRC (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content=""/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"a4ee7cbff0e2c9fe0eaac6e17bed4f34bad04d6f-1498759679-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><script type="text/rocketscript">	var s = 0;
	function soundex() {
		if (document.getElementById) {
			var snd = document.getElementById("snd");
			var frm = document.getElementById("sfrm");
			s = 1 - s;
			snd.src = "/img/sound_" + (s ? "on" : "off") + ".gif";
			frm.soundex.value = s;
		}
	}
	function do_img() {
		if (document.getElementById)
			document.write('<' + 'img id="snd" class="va" src="/img/sound_' + (s ? 'on' : 'off') + '.gif" onclick="soundex();" alt="" /' + '>');
	}</script>
<link rel="stylesheet" type="text/css" href="/style.css"/><style type="text/css">.va{vertical-align:middle;}</style>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div><div style="float:right;"><a href="/src.php?tbs=0"><img src="/img/min.gif" alt="Minimize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: left;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="32" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><br clear="both"/></div>
<div class="s2"><h1>Source code of computer viruses</h1><h2>4096 - Virus for Linux by badCRC</h2><p><em>Virus for Linux</em></p><p><strong>badCRC</strong><br/><small><a href="/src.php?author=badCRC">Show all viruses by this author</a></small></p><p>2003-08-00</p><a href="#disqus_thread">Comments</a><br/><form class="fr" method="post" action="/file.php"><input type="image" src="/img/dl.gif" alt="Download"/><input type="hidden" name="file" value="c3JjLzQwOTYuemlw"/></form> Download 4096.zip (3832 bytes) or <a href="/src_view.php?file=4096.zip">browse online</a><p>Released in 29A#7</p>
<p><strong>Author's notes</strong></p>
<h2>Introduction</h2>
<p>First of all, I have to say my english is not very good, so
I'm sorry if you don't understand all I write. I'll try to
explain me in the best way I can ;)</p>
<p>This is my first released virus and I want to dedicate it to
a girl who is very special for me (she knows who she is :) On
the other hand, I also want to thank Wintermute for his virus
course and all the people in the scene who write or wrote
interesting things.</p>
<h2>Disclaimer</h2>
<p>I'm not responsible for what you do with this virus and if
you spread it, it will be your fault and not mine. So, be
careful. In any case, this virus is less dangerous than the
Windows OS as you'll see xD</p>
<h2>Features</h2>
<p>It's about a runtime mid-file virus that infects executable
ELF files. Every time it is executed, it will try to infect 3
files and then, it will return control to host. These files can
be in any directory that belong to the virus path. For example,
if the the virus resides in /tools/bin/, it will look for
files in bin, tools and /, that is, the root dir.</p>
<p>I think the most interesting thing in this virus is the
infection method, so I'm going to explain it a little :)</p>
<p>When the virus finds a file suitable for infection, it will
search in the PHT for the first loadable segment, usually the
text segment. Now, we have to check for free space in the last
memory page that this segment occupies because we want to copy
us there. How? It's easy: subtract from 1000h the last 3 hex
digits in p_memsz (I assume 4 KB pages). Let's see an example.
Suppose p_memsz = 12AF9h. So, how much space is free in the
last page? 1000h - AF9h = 507h = 1287 bytes. Why are we limited
in this way? Because we copy us in the first loadable segment,
and if there is another one, its first page will be next ours
and we don't want to be overwritten when the program is loaded
into memory.</p>
<p>Next step is increase file size and copy the virus into the
file. We'll have to fix the offsets of some entries in the PHT
because of we are going to copy us where the first loadable
segment ends, that is, p_offset + p_filesz. The file size will
be increased in 1000h bytes because file offsets (p_offset) and
virtual addresses (p_vaddr) must be congruent modulo the page
size (1000h), that is, if you divide p_offset or p_vaddr by
1000h, the remainder will be the same. For better
understanding, imagine there is another loadable segment next
ours and we have to fix its offset. Suppose p_offset = 2BF00h,
p_vaddr = 8074F00h and virus length = 100h. If we increase file
size in 100h bytes, we'll have to add 100h to p_offset (2C000h)
and then, p_offset and p_vaddr won't be congruent modulo 1000h.
So, the minimum value in order they continue being congruent
is 1000h.</p>
<p>I hope you have understood it. If not, take a look at the
code, ok? Good luck!</p>
<h2>Payload</h2>
<p>Every 30 November the virus will print a message on the
screen. The way I use to compute the date is not precise, so
the virus will activate a day before or after sometimes.</p>
<h2>To assemble</h2>
<pre class="source">
  nasm 4096.asm -o 4096.tmp -f elf
  ld 4096.tmp -o 4096 -s
  dwarf.exec 4096
</pre><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/src.php?info=4096.zip';</script></div><br/><div class="s2">
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"></div>
</body>
</html>
