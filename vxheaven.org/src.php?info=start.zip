<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Start - Virus for MS-DOS by DJ Sadovnikov (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content=""/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"714c30349174626f3f3dfe79e942f7b6a7992db1-1498755342-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><script type="text/rocketscript">	var s = 0;
	function soundex() {
		if (document.getElementById) {
			var snd = document.getElementById("snd");
			var frm = document.getElementById("sfrm");
			s = 1 - s;
			snd.src = "/img/sound_" + (s ? "on" : "off") + ".gif";
			frm.soundex.value = s;
		}
	}
	function do_img() {
		if (document.getElementById)
			document.write('<' + 'img id="snd" class="va" src="/img/sound_' + (s ? 'on' : 'off') + '.gif" onclick="soundex();" alt="" /' + '>');
	}</script>
<link rel="stylesheet" type="text/css" href="/style.css"/><style type="text/css">.va{vertical-align:middle;}</style>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/src.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Source code of computer viruses</h1><h2>Start - Virus for MS-DOS by DJ Sadovnikov</h2><p><em>Virus for MS-DOS</em></p><p><strong>DJ Sadovnikov</strong><br/><small><a href="/src.php?author=DJ Sadovnikov">Show all viruses by this author</a></small></p><p>1998-11-18</p><a href="#disqus_thread">Comments</a><br/><form class="fr" method="post" action="/file.php"><input type="image" src="/img/dl.gif" alt="Download"/><input type="hidden" name="file" value="c3JjL3N0YXJ0LnppcA@@"/></form> Download start.zip (10927 bytes) or <a href="/src_view.php?file=start.zip">browse online</a><p>Released in Matrix#1</p>
<p><strong>Author's notes</strong></p>
<p>Now I'm presenting for attention of respected DOS users my second and,
I hope, not last virus (the first virus was named "Antipas.1101"). This virus
is 2200 bytes long and is named "$tart". If it will be widespread and, as
result, get into the bases of some antiviruses, I ask for name it "$tart.2200"
or, in the last resort, "Start.2200". I wrote this virus for my personal
purposes (see effects below), but I hope it will be useful for someone else.
I'm not a distributor of this virus, so I don't bear any responsibility for the
injury to the software, caused by virus. The writing of the virus was finished
18.11.1998 at 20:00. Autor - DJ Sadovnikov. And now I tell you about the virus
explicitly (for whose whom laziness to look the source text).</p>
<ul>
<li>The general information: virus requires the 286+ processor. The check of
presence of required processor isn't made in cause of practically complete
absence of machines with CPU 86/186. The usage of 286-instructions allows to
optimize a code considerably. DOS version 3.x-6.x required. The check of
DOS version is made in cause of incorrectly virus's operation under Windows,
because Windows doesn't support SFT (for whose who doesn't know: Windows
returns DOS version 7.x). Other operational system weren't tested.
- Resident, takes up about 4500 bytes of memory. Staying resident via
correction of MCB-segment of program-carrier. There is a little bug here:
as a result of MCB correction cease to work some programs packed by EXEPACK
(but not all). I don't know why does it take place - honourly speaking,
it's lazy to look into.</li>
<li>The virus infects EXE files. Doesn't touch overlays. The type of the file is
determined by the extension first, and then - by the first two bytes (MZ)
in case of this is maybe COM-file renamed into EXE. The increase of lenghth
of the infected file is 2200 bytes. While infecting file, virus corrects
both CS:IP and SS:SP. Virus infects files at the executing and opening.
While infecting, uses STF. I apologize for virus doesn't infect COM-files.
The point is that COM-files are disappearing, besides the procedure of it's
infecting will highly increase the virus's cumbersomely. Although, MZ-EXE
files will disappearing soon too. It's time for me to move on to NE-EXE and
PE-EXE infecting.</li>
<li>The virus is twice encrypted. The first procedure of encryption is ordinary
XOR. The key changes from file to file. The second procedure - XOR and
SUB/ADD. The key changes from byte to byte according to easy law. The
antidebugging technology is used, based on the registration of the
decrypting procedure as an interupt Int1/Int3. The overlapping code is used
too, which complicates a research of virus after disassembling a little.</li>
<li>Stealth. At the catalog reading corrects lengths of the infected files. This
method doesn't work at the performance of DIR command in cause of using FCB
by DIR. At the opening of a file the virus treats it, at the closing -
infects it again. At the executing of some archivers (see source) and
CHKDSK program virus disables it's stealth mechanism until the next file
will be executed. I hope you understand why does it necessary.</li>
<li>The virus determines the real Int21h handler's address via tracing. It will
not work if somebody made the splicing (inserting a jump to itseft at the
beginning of the handler), or the antitrace protection is presented. When
the virus is in memory already, at the attempting of tracing of Int21h
handler it displays the message (see source) and halts the system.</li>
<li>The Int24h (disk write-protect) stub is presented, but it doesn't correctly
work, and the cause is unknown for me.</li>
<li>The 18th of May (my birthday) virus displays the text (see source) at the
top of screen and drops the chars with a sound effect. When virus infects
500th file (not on the concrete computer, and in general), it displays a
message (see source) and waits for key pressed.</li>
<li>When the follow string appears at the screen:
<ul>
<li>"Show virus info" -- displays copyright message (see source)</li>
<li>"Crack HDD" -- erases MBR using ports, so BIOS's "Virus Warning"
will not help even.</li>
<li>"Erase CMOS" -- erases CMOS.</li>
<li>"Reboot system" -- reboots computer.</li>
</ul></li>
<li>At the virus's beginning the string "Packed file is corrupt$" is presented.
It can confuse somebody who takes into his head to look over the infected
program at the healthy computer.</li>
</ul>
<h2>Bugs:</h2>
<ul>
<li>[!] Memory allocation is made very incorrectly.</li>
<li>[!] At the returning to program-carrier SS has a wrong value.</li>
<li>[+] The installation of Int24h handler is made incorrectly.</li>
<li>[+] Attemption of read/write to standart devices is possible.</li>
<li>[*] The procedure of search for strings at the screen has a mistake.</li>
</ul><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/src.php?info=start.zip';</script></div><br/><div class="s2">
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"></div>
</body>
</html>
