<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>twilight corner in the herm1t's cave</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="google-site-verification" content="Sc4wn3AiNWySp1xuXdama5S6XRqXT2KoRdwCqAY0XwI"/>
<meta name="author" content="herm1t"/>
<meta name="keywords" content="vx.netlux.org,herm1t,virus,virii,vx,Linux,LISP,AX.25,Nagios,quine,LJ,Virus.Linux.Grip,LZW,Arithmetic Compression,RLE,Lempel-Ziv,VX Heavens,UNIX,ELF,infection,FreeBSD,Crimea,Lacrimae,PiLoT,Pildug,Piltot,Hashcave,Hasher,Arches,Arian,42,FortyTwo,CRC32C,SSE4.2"/>
<meta name="description" content="home page of herm1t"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"a4dde69ef455baad618ca47fe4fbe5da6b7b0cd7-1498754794-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<style type="text/css">h1,h2{margin-top:0;font-size:16pt;font-family:sans-serif,serif;}h3,h4{margin-top:0;font-size:14pt;font-family:sans-serif,serif;}body{background-color:#336699;}.content{padding-top:.2em;padding-left:.2em;padding-bottom:0;margin-bottom:.5em;background-color:#b2cde0;border:solid thin black;float:left;}img{border:0;vertical-align:middle;}h1 img{vertical-align:middle;}a{text-decoration:none;}.ss{text-decoration:none;}</style>
</head>
<body>
<div class="content">
 
<div style="float: left; border-bottom: solid thin black;"><img src="herm1t.gif" alt=""/></div>
<h1>twilight corner in the  <a href="http://lj.rossia.org/users/herm1t/"><img src="lj/userinfo_ljr.gif" alt="[LJ]"/>herm1t</a>'s <a href="http://herm1t.netlux.org/">cave<img src="link.gif" alt=""/></a></h1>
<br clear="all"/>
 
My blog <a href="http://lj.rossia.org/users/herm1t/">in russian</a> (@ lj.rossia.org) and <a href="http://herm1tvx.blogspot.com/">english</a> (@ blogger)</p>
<strong>Works</strong><br/>
 <img src="art.gif" alt=""/> <a href="http://lj.rossia.org/users/herm1t/78510.html">Runtime GOT poisoning from injected shared object</a><br/>
 <img src="blog.png" alt=""/> <a href="http://herm1tvx.blogspot.com/2015/03/nspr4prwrite.html">The right way to hook PR_Write f-n in FireFox</a><br/>
 <img src="blog.png" alt=""/> <a href="http://herm1tvx.blogspot.com/2013/04/cve-2010-4347-cve-2012-0056-small-fixes.html"> CVE-2010-4347 CVE-2012-0056 small fixes</a><br/>
 <a href="http://ezine.vxnetw0rk.ws/mag5/CODES/herm1t/mysql_virus.sql.txt">Quine-based infector for MySQL</a>, DarK-CodeZ #5<br/>
 <a href="http://pferrie.host22.com/misc/10print.htm">10 PRINT</a>, i came second with 11 bytes<br/>
<small>i also thought about undocumented instructions, but failed to found the right one, my congrats to Peter</small><br/>
 <img src="blog.png" alt=""/> <a href="http://lj.rossia.org/users/herm1t/66091.html">Mixing 16- 32- and 64-bits code</a><br/>
 <img src="art.gif" alt=""/><a href="/lib/vhe11.html">Recompiling the metamorphism</a>, Valhalla #2<br/>
 <img src="blog.png" alt=""/> <a href="http://herm1tvx.blogspot.com/2011/10/recently-bindyb-from-rootkits.html">LDE based on exceptions</a><br/>
 <img src="blog.png" alt=""/> <a href="http://herm1tvx.blogspot.com/2011/09/hardware-breakpoints.html#more">Hardware breakpoints</a><br/>
 <img src="blog.png" alt=""/> <a href="http://herm1tvx.blogspot.com/2011/09/highway-to-libc.html">Getting GLibc address from TLS</a><br/>
 <img src="art.gif" alt=""/><a href="/lib/vhe10.html">Advanced EPO: Deeper, longer and harder (Part 1)</a>, EOF#3<br/>
 <img src="blog.png" alt=""/> <a href="http://herm1tvx.blogspot.com/2011/08/entropy-with-integers.html">Entropy in integers</a><br/>
 <img src="blog.png" alt=""/> <a href="http://herm1tvx.blogspot.com/2011/07/writing-to-executable-and-currently.html"> Writing to executable (and currently running) file</a><br/>
 <img src="art.gif" alt=""/><a href="/lib/vhe09.html">Inversing a random numbers</a>, in Virus Writing Bulletin #1, <a href="http://vxer.org/forum/viewtopic.php?pid=4165#p4165">update from cl0ne</a><br/>
 <a href="http://vxer.org/forum/viewtopic.php?pid=3428#p3428">Using rpmlib in RELx.G2</a>, handling relocations in .data<br/>
 <a href="http://vxer.org/forum/viewtopic.php?pid=3394#p3394">RiPM</a> - update MD5 checksum and length of the file in the RPM database<br/>
 My topics on forum: <a href="http://vxer.org/forum/viewtopic.php?id=383">Reversing PRNGs</a>, <a href="http://vxer.org/forum/viewtopic.php?id=405">Not so random random()</a><br/>
 <img src="art.gif" alt=""/><em>From position-independent to self-relocatable viral code</em> [<a href="http://www.vxheavens.com/lib/vhe07.html">RU</a>] [<a href="http://www.vxheavens.com/lib/vhe08.html">EN</a>], sources and examples of <a href="http://www.vxheavens.com/src.php?info=relx.zip">Linux.RELx.A/G2</a><br/>
<small>
&nbsp;&nbsp;.. P. Ferrie &laquo;<a href="/lib/apf58.html">Frankie say relax</a>&raquo;, VB, Aug 2011, pp. 4-6
</small><br/>
 <a href="examples.tar.gz">Examples</a> of different infection methods for Linux<br/>
<small>&nbsp;&nbsp;..hash remove/reduce (sysv style only), cavity (data, functions, headers, sections, relocks),<br/>simple (compression, overlay, prepender), plt, segments (add, end of bss, end of data, padding, replace, shift text)</small><br/>
 <strong>Linux.FortyTwo</strong> (crc32b SSE4.2), download <a href="Linux.FortyTwo.zip">source and binary</a>, or read the <a href="http://vx.eof-project.net/viewtopic.php?pid=1049">description</a><img src="link.gif" alt="" title=""/><br/>
 
<small>
&nbsp;&nbsp;.. P. Ferrie &laquo;<a href="http://blogs.technet.com/mmpc/archive/2008/09/10/life-the-universe-and-everything.aspx">Life, the Universe, and Everything</a>&raquo;<img src="link.gif" alt="" title=""/> (<a href="ferrie_42.html">local copy</a>)
</small><br/>
 YAD (&#1071;&#1076;&#1098;) Yet Another Disassembler [<a href="http://vx.org.ua/vx.php?id=ey01">Download</a>] (also in EOF-DR-RRLF)<br/>
 <span style="color: #000060;"><strong>Linux.Lacrimae</strong>, README <a href="Lacrimae_EN.txt">EN</a>,<a href="Lacrimae_RU.txt">RU</a>, download <a href="lacrimae.zip">v. 0.30</a>, released in EOF-DR-RRLF</span><br/>
<small>
&nbsp;&nbsp;.. P. Ferrie <a href="http://pferrie.tripod.com/papers/crimea.pdf">"Crimea River"</a><img src="link.gif" alt="" title=""/>,
<a href="http://www.virusbtn.com/virusbulletin/archive/2008/02/vb200802-crimea.dkb">VB, Feb 2008</a><img src="link.gif" alt="" title=""/>, or the <a href="/lib/apf12.html">local copy</a> here at vx heavens<br/>
&nbsp;&nbsp;up to 0.25.2 detected as <img src="sym.gif" alt="Symantec name"/>Linux/Crimea, and a <em>few samples</em> as <img src="kav_small.gif" alt="KAV name"/>Virus.Linux.Impok
 
</small><br/>
 <img src="art.gif" alt=""/><em>INT 0x80? No, thank you!</em> [<a href="pilot_en.html">EN</a>], <strong>Linux.PiLoT</strong>, download <a href="pilot.zip">source and binary</a>, released in EOF-DR-RRLF<br/>
<small>
&nbsp;&nbsp;there was a typo in the source, the last line in the pilot.asm should be <code>pcnt equ data_start + <em>24</em></code><br/>
&nbsp;&nbsp;detected as <img src="fortinet.gif" alt="Fortinet"/>ELF/Pildug, <img src="kav_small.gif" alt="KAV"/>Virus.Linux.Piltot<br/>
&nbsp;&nbsp;.. P. Ferrie <a href="http://pferrie2.tripod.com/papers/pilot.pdf">"Flying solo"</a><img src="link.gif" alt="" title=""/>, VB, Sep, 2009, or the <a href="/lib/apf37.html">local copy</a> here at vx heavens<br/>
</small>
 <img src="art.gif" alt=""/><em>Reverse of a coin: A short note on segment alignment</em> [<a href="coin_en.html">EN</a>], <strong>Linux.Coin</strong> download <a href="coin.zip">source and binary</a><br/>
<small>
 &nbsp;&nbsp;.. P. Ferrie <a href="http://pferrie.tripod.com/papers/coin.pdf">"Heads or tails?"</a><img src="link.gif" alt="" title=""/>, <a href="http://www.virusbtn.com/virusbulletin/archive/2009/09/vb200909-heads-or-tails">VB, Sep 2009</a><img src="link.gif" alt="" title=""/>, or the <a href="/lib/apf31.html">local copy</a> here<br/>
</small>
 <img src="art.gif" alt=""/><em>Caveat virus</em> [<a href="caveat_en.html">EN</a>], <strong>Linux.Caveat</strong> download <a href="caveat.zip">source and binary</a><br/>
<small>
 &nbsp;&nbsp;.. P. Ferrie <a href="http://pferrie.tripod.com/papers/caveat.pdf">"Can you spare a seg?"</a><img src="link.gif" alt="" title=""/>, <a href="http://www.virusbtn.com/virusbulletin/archive/2009/07/vb200907-seg">VB, Jul 2009</a><img src="link.gif" alt="" title=""/>, or the <a href="/lib/apf29.html">local copy</a> here<br/>
 &nbsp;&nbsp;.. <a href="caveat.patch">patch</a> for the virus which introduces more rigid checks of ELF header fields..<br/>
</small>
 <img src="art.gif" alt=""/><em>Hashin' the elves</em> [<a href="/lib/vhe02.html">EN</a>/<a href="/lib/vhe03.html">RU</a>], demo viruses <a href="Linux.Hasher.zip"><strong>Linux.Hasher</strong>.a,b,c,d</a> (aka <img src="vb.gif" alt="VirusBuster"/>Linux.HashCave, <img src="fortinet.gif" alt="Fortinet"/>ELF/Small)<br/>
<small>
 &nbsp;&nbsp;.. P. Ferrie <a href="http://pferrie.tripod.com/papers/hash.pdf">"Making a hash of things"</a><img src="link.gif" alt="" title=""/>, <a href="http://www.virusbtn.com/virusbulletin/archive/2009/08/vb200908-hash">VB, Aug 2009</a><img src="link.gif" alt="" title=""/>, or the <a href="/lib/apf30.html">local copy</a> here<br/>
</small>
Snippets:
 Using <a href="import.zip">ELF imports</a>,
 using <a href="syscall.asm">sysenter</a>,
 <a href="elfi.zip">infecting ELF files</a> (before text, after data/bss, last seg, padding, replace)<br/>
 <img src="art.gif" alt=""/><em>Tribute to PDP-11/UNIX, <a href="dawn/index.html">UNIX.Dawn</a> virus</em> (aka <img src="vb.gif" alt="VirusBuster"/>UNIX.Small.a)<br/>
 <img src="art.gif" alt=""/><em>Infecting ELF-files using function padding for Linux</em> [<a href="/lib/vhe00.html">EN</a>/<a href="/lib/vhe01.html">RU</a>], <strong>Linux.Arches</strong> inside<br/>
<small>
 &nbsp;&nbsp;.. cited in Matthieu Kaczmarek "<a href="http://www.vxheavens.com/lib/vmk00.html">ELF et virologie informatique</a>"<br/>
</small>
 <a href="rc4.zip">RC4</a>,
 <a href="rc5.zip">RC5</a>,
 <a href="tea.zip">TEA</a> implementation<br/>
 Arithmetic, LZW and RLE <a href="compr.zip">compression modules</a> and demonstration virus <a href="arian.zip">Linux.Arian</a>, also released in RRLF#7<br/>
 <img src="beads/blackglider.gif" alt="" height="15" width="15"/>The virus that is always with me... <a href="beads/beads.html">Linux.Beads.89</a><br/>
 Yet Another Six Bytes: <a href="yasb.asm">AC CD 29 E2 FB C3</a><br/>
 <strong>FreeBSD.Egalite</strong> (<img src="sym.gif" alt="Symantec name"/>Linux.Hermalite) [<a href="FreeBSD.Egalite.bin.zip">binary</a>] and [<a href="FreeBSD.Egalite.src.zip">source</a>], also released in RRLF#7<br/>
 <strong>Linux.Grip</strong> (rel.2) (<a href="grip_variants.txt">some variants</a> detected as <img src="kav_small.gif" alt="KAV name"/> Virus.Linux.Grip.b, Virus.Linux.Little [<a href="Linux.Grip.zip">source</a>, released in <a href="http://rrlf.de.vu/">RRLF<img src="link.gif" alt="" title=""/></a>#6] [<a href="Linux.Grip.bin.tar.gz">binary</a>]<br/>
 <strong>Linux.Grip</strong> (rel.1) (<img src="kav_small.gif" alt="KAV name"/> Virus.Linux.Grip.a) [<a href="Linux.Grip.a.bin.gz">binary</a>, released in <a href="http://groups.google.com/group/fido7.su.virus/browse_thread/thread/d6871903ee767d08/837029151a96d2ac">su.virus</a><img src="link.gif" alt="" title=""/>] [<a href="Linux.Grip.a.src.tar.gz">source</a>]<br/>
<small>
&nbsp;&nbsp;..i found a typo in rel. 2 sources, so there is <a href="Linux.Grip-typo.patch">the patch</a> to fix it, unpack sources and run: <tt>patch -p0 &lt; Linux.Grip-typo.patch</tt><br/>
&nbsp;&nbsp;..<a href="cmpsrc/post.txt">it is no wonder</a> that single virus produced two families, though even a <a href="cmpsrc/cmpsrc.zip">simple tool</a> will find <a href="cmpsrc/results.ps">similarities</a> (ps, 67K), <a href="cmpsrc/results.bz2">raw data</a> (bz2, 280k) (Feb 2005)..<br/>
&nbsp;&nbsp;..having a lots of options, the tempting and natural idea is to turn the virus into <a href="ghog.zip">generator</a> (ezXML,GTK2; zip, 44k) <a href="ghog.png">sceenshot</a> (Sep 2005)..<br/>
&nbsp;&nbsp;..this virus attracted some attention from the avers:
K. Sapronov <a href="http://www.viruslist.com/en/analysis?pubid=184625030">2005: *nix Malware Evolution</a><img src="link.gif" alt="" title=""/>,
J. Kaminsky <a href="http://www3.ca.com/securityadvisor/newsinfo/collateral.aspx?cid=100975">Loathing Lupper in Linux</a><img src="link.gif" alt="" title=""/>
</small><br/>
 BrainFuck <a href="brainfuck.tar.gz">interpreter</a>, <a href="bfcc.sed">Brainfuck to C converter</a> (sed)<br/>
 <img src="key.gif" alt="Password required"/><a href="lj/herm1t/index.html">Archive</a> of herm1t's LJ<br/>
 <img src="taoico.gif" alt=""/> Geoffrey James "<a href="http://www.canonical.org/~kragen/tao-of-programming.html">The Tao of Programming<img src="link.gif" alt="" title=""/></a>" (<a href="tao.html">russian translation</a>)<br/>
 The <a href="igorusb.crk">crack</a> for the <a href="http://www.cesko.host.sk/">IgorPlug USB<img src="link.gif" alt="" title=""/></a><br/>
 Simple client for the <a href="http://www.nagios.org/">Nagios</a>: <a href="nagv-0.91.tar.bz2">nagv-0.91</a> and <a href="nagv-0.91-1.i386.rpm">RPM package</a>.<br/>
 
Kernel module called <a href="kmm.tar.gz">kMeep-Meeper</a> will "pronounce Linux as Le-ee-n-oo-oks"<br/>
&nbsp;&nbsp;every time any process dies, based on <a href="http://timelesson.blogspot.com/">UR3IJC</a>'s<img src="link.gif" alt="" title=""/> idea and splicing code by Silvio Cesare<br/>
<a href="http://www.tapr.org/pub_ax25.html">AX.25<img src="link.gif" alt="" title=""/></a> over IP encapsulation <a href="ax25_ip-0.03.tar.gz">driver</a> for Linux, see <a href="http://www.rfc-editor.org/rfc/rfc1226.txt">RFC 1226<img src="link.gif" alt="" title=""/></a> for details<br/>
<a href="wce.tar.gz">This</a> will help to extract files from the Web Compiler presentations (like <a href="/lib/vcc00.html">VDAT</a>)<br/>
K&amp;R malloc/free <a href="malloc.tar.gz">implementation</a><br/>
Small LISP-like <a href="LISP.tar.gz">interpreter</a> based on <a href="http://www.sigala.it/sandro/software.php#slisp">slisp-1.2<img src="link.gif" alt="" title=""/></a> by Sandro Sigala<br/>
Two <a href="http://www.nyx.net/~gthompso/quine.htm">quines<img src="link.gif" alt="" title=""/></a> written in <a href="quine.lisp">LISP</a> and <a href="quine.sh">SH</a> and <a href="without$0.sh">BASH.-$0</a><br/>
<a href="tmrtg.tar.gz">Quick approach</a> to <a href="tmrtg-screenshot.gif">display</a> MRTG graph in text console.<br/>
<a href="pic.tar.gz">Some code</a> for <a href="http://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&amp;nodeId=1335&amp;dDocName=en010275">18F252<img src="link.gif" alt="" title=""/></a>, without comments and schematics it's mostly of no use.<br/>
&nbsp;&nbsp;..forgot, there's <tt>picup</tt> (a Linux uploader) for <a href="http://www.etc.ugal.ro/cchiculita/software/picbootloader.htm">Tiny PIC bootloader<img src="link.gif" alt="" title=""/></a>, tested and used with the tinybld163..<br/>
Slightly optimized <a href="catchy-1.6-2.zip">version</a> of <a href="/vx.php?id=ec11">Catchy32</a> engine by sars<br/>
Brain damaged <a href="Linux.CSmall.tar.gz">games</a> with gcc and ELF. Linux.CSmall.395/410<br/>
Linux.Futhork <a href="Futhorc.a.lisp">.a</a>, <a href="Futhorc.b.lisp">.b</a>, thread on <a href="http://groups.google.com.ua/group/comp.lang.lisp/browse_thread/thread/2525beea923015b5/26761ce395ec40bf">comp.lang.lisp</a><img src="link.gif" alt="" title=""/><br/>
<a href="Linux.ThinIce.tar.gz">Linux.ThinIce</a>, <a href="Linux.Adhoc.b.tar.gz">Linux.Adhoc.b</a>, <a href="Linux.Tahorg.tar.gz">Linux.Tahorg</a><br/>
<p style="margin: 1em 0 0 0;"><strong>Interviews</strong><br/>
 <img src="dcm.png" alt="DCM" width="16"/>Perforin <a href="/lib/iv056.html">"Interview with herm1t"</a>, Dark Codez #3, Dec 2010<br/>
 <img src="esquire.gif" alt="Esquire"/>Alexey Vorobyev &laquo;<a href="esq/index.html">The nature of the pathogen</a>&raquo;, <a href="http://esquire.ru/">Esquire Russia</a><img src="link.gif" alt="" title=""/>, #33, May 2008 (interview with me inside)<br/>
 <img src="eof.gif" width="16" alt=""/>izee <a href="ieof.html">"Interview with herm1t"</a> for <a href="/vx.php?id=ze02">EOF-DR-RRLF magazine</a><img src="link.gif" alt="" title=""/>, Nov 2007<br/>
 Dan Grabham <a href="/lib/iv045.html">Warning: Virus!</a>, .net Issue 118, Dec 2003 (I answered a few questions there)<br/>
</p>
<p style="margin: 1em 0 0 0;"><strong>Misc</strong><br/>
<a href="cress.html">A talk with Nancy Kress about copyvio and shit like that</a><br/>
<a href="ferrie_eof.html">Ferrie's post</a> on EOF magzine, and <a href="ferrie_rrlf.html">another one</a> on RRLF/DR<br/>
</p>
<div style="float:right;"><img src="raven.gif" alt="" title=""/></div>
<p style="margin: 1em 0 0 0;"><strong>Links</strong><br/>
Forums of <a href="http://forum.vxheavens.com/">VX Heavens</a> and <a href="http://vx.eof-project.net/">EOF project</a>,
<a href="http://pferrie.tripod.com/">Homepage</a> of Peter Ferrie<br/>
Some of my sites:
<a href="http://virusbooks.org.ua/">о книгах</a>,
<a href="http://viruszines.org.ua/">о журналах</a>,
<a href="http://virusgen.org.ua/">генераторах</a>,
<a href="http://viruslib.org.ua/">статьях</a>,
<a href="http://uidzero.org.ua/">о всяком полезном софте</a>.<br/>
<a href="http://virusnews.org.ua/">Архивы</a> FIDO конференций
<a href="http://virusnews.org.ua/fido/su.virus/">su.virus</a>,
<a href="http://virusnews.org.ua/fido/adinf.support/">adinf.support</a>,
<a href="http://virusnews.org.ua/fido/ru.virus/">ru.virus</a>,
<a href="http://virusnews.org.ua/fido/su.cm/">su.cm</a>,
<a href="http://virusnews.org.ua/fido/unix-virus/">unix-virus</a>,
<a href="http://virusnews.org.ua/fido/pvt.virii/">pvt.virii</a>.
</p>
<div style="float: left;">
<img src="/cgi-bin/mimetex.cgi?formdata=%5Ctext%7Bmail+to+herm1t+dot+vx+at+gmail%7D" alt=""/><a href="herm1t.asc"><img src="/img/key.gif" alt="GPG key"/></a>
<br/>
<script type="text/rocketscript">document.write('Last modified:'+document.lastModified);</script>
</div>
</div>
<br clear="left"/>
<a href="http://validator.w3.org/check?uri=referer"><img src="http://validator.w3.org/images/valid_icons/valid-xhtml10-blue" alt="Valid XHTML 1.0!" height="31" width="88" border="0"/></a>
<a href="http://jigsaw.w3.org/css-validator/"><img style="border:0;width:88px;height:31px" src="http://jigsaw.w3.org/css-validator/images/vcss-blue" alt="Valid CSS!"/></a>
<a href="/"><img src="vx.gif" alt="VX Heavens" title="VX Heavens" border="0"/></a>
<a href="friends.html"></a>
</body>
</html>
