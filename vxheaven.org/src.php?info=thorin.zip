<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Thorin - Virus for Windows by Billy Belcebu (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content=""/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"b8c93c23f18dad7ba32fc96590e02e5e48a54938-1498755345-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><script type="text/rocketscript">	var s = 0;
	function soundex() {
		if (document.getElementById) {
			var snd = document.getElementById("snd");
			var frm = document.getElementById("sfrm");
			s = 1 - s;
			snd.src = "/img/sound_" + (s ? "on" : "off") + ".gif";
			frm.soundex.value = s;
		}
	}
	function do_img() {
		if (document.getElementById)
			document.write('<' + 'img id="snd" class="va" src="/img/sound_' + (s ? 'on' : 'off') + '.gif" onclick="soundex();" alt="" /' + '>');
	}</script>
<link rel="stylesheet" type="text/css" href="/style.css"/><style type="text/css">.va{vertical-align:middle;}</style>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/src.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Source code of computer viruses</h1><h2>Thorin - Virus for Windows by Billy Belcebu</h2><p><em>Virus for Windows</em></p><p><strong>Billy Belcebu</strong><br/><small><a href="/src.php?author=Billy Belcebu">Show all viruses by this author</a></small></p><p>1999-00-00</p><a href="#disqus_thread">Comments</a><br/><form class="fr" method="post" action="/file.php"><input type="image" src="/img/dl.gif" alt="Download"/><input type="hidden" name="file" value="c3JjL3Rob3Jpbi56aXA@"/></form> Download thorin.zip (58325 bytes) or <a href="/src_view.php?file=thorin.zip">browse online</a><p><strong>Author's notes</strong></p>
<h2>Why 'Thorin'?</h2>
<p>Heh, are you an incult guy? Heh, have you ever read the
wonderful book of the wonderful author J. R. R. Tolkien,
called "The Hobbit"? Ok, if you did it, you can realize
that the most important dwarf is called in this way :) He
died with honour, and he couldn't taste the victory and be
the king, anyway thanks to him, the Middle-Earth was a much
better world for years. Ain't it charming? ;)</p>
<h2>Features</h2>
<p>Ok, here i will list all that this babe is able to do...</p>
<ul>
<li>Infect PE files in current, Windows, and System dirs.</li>
<li>Runtime module, infects 4 files each time.</li>
<li>Per-Process residency (Import Table &amp; GetProcAddress).</li>
<li>Infects EXE, SCR &amp; CPL files.</li>
<li>Anti-Debugging features (SEH &amp; 'IsDebuggerPresent').</li>
<li>Anti-Emulation features.</li>
<li>Anti-Monitors, kills AVP Monitor and AMON.</li>
<li>Polymorphic layer of decryption.</li>
<li>RDA layer of decryption.</li>
<li>Size Stealth (FindFirstFileA/FindNextFileA).</li>
<li>Fast infection (depending of the host).</li>
<li>Internet aware virus: mIRC, ViRC97 and PIRCH scripts.</li>
<li>Traversal routine for search for the scripts (hi LJ!).</li>
<li>Packed dropper, used LSCE 1.0.</li>
<li>Really tiny unpacker.</li>
<li>Multiple payloads (see below).</li>
<li>Doesn't hardcode KERNEL32 base address.</li>
<li>Doesn't hardcode API addresses (of course).</li>
<li>Gets Image Base at running time.</li>
<li>Removes many AV CRC files.</li>
<li>Avoids infection of certain (dangerous for us) files.</li>
</ul>
<h2>Payloads</h2>
<p>Yes, this virus has multiple payloads (hi DuST!). Let's see
a little overview of them (executed every 26 of October).</p>
<ol>
<li>The biggest one, based in a trick that i learnt from
mandragore's viruses, dropping a file as C:\WIN.COM, that
gets executed by the system before of the file that should
be, that is C:\WINDOWS\WIN.COM, thus bringing us the possibility of own the computer before windows :) Well, it consists in a very little, simple and easy quiz that all ppl who had read "The Hobbit" once in his life would be able to pass without problems, and consists of 3 questions.</li>
<li>Sets the HD's name as 'THORIN'.</li>
<li>Due an idea that my friend Qozah gave me, it swaps the
mouse buttons, thus making the user be stoned... All you
clicked with the left button, now you'll have to click with
the right one, and vice-versa.</li>
<li>The typical MessageBox with a silly message.</li>
<li>Launches user to Microsoft page, thus annoying him and
make his little and ignorant mind to think that the awaited
Micro$oft offensive over the earth has began. Well, ain't
this one charming? ;)</li>
</ol>
<h2>Internet</h2>
<p>This virus is able to spread itself using the most used
IRC programs over the world: mIRC, PIRCH and ViRC. Every
infected system will have a little infected file in
C:\PR0N.EXE. This file is sent to everyone that joins the
channel where the user is chatting by DCC. Very simple and
effective.</p>
<h2>Thoughts</h2>
<p>This is, nowadays, my best virus so far, over Iced Earth,
Garaipena, and Nitro, all of them for Windoze. I needed to
do at least a good virus, for feed my own ego (why lie?),
and i think this is what really happened. But i won't stop
there, there are many things yet to explore (and exploit)
in 32 bit enviroments, there are many problems unsolved,
and i will try to contribute with my humble code for all
those purposes. Btw, i used, in my other viruses, to try to
optimize , but in this virus i didn't. I mean, you won't
see here OBVIOUS lacks of optimization, like CMP reg,-1 but
i will use many times the same code in different procedures
many strings, two droppers (one for IRC distribution, and
other for one payload). This virus is big in its size, well
not as Win32.Harrier, Win32.Libertine, WinNT.Remex, etc.,
but it's a 'big' one, and i hope this will mean a 'good'
one. Fuck, i've coded also a lot of payloads, none of them
is destructive, but all are VERY annoying... The description
is above, if you don't believe me.</p>
<p>Well, now i'm gonna excuse myself, because while making
this virus (based initially on my Win95.Iced Earth) i have
noticed the great quantity of bugs that my Iced Earth virus
had (believe me, more than 10 incredible bugs!), and i'm
still wondering why all those escaped from my beta testing.
Moreover, all those bugs only reflect my incompetence. With
this virus i have made very serious tests, mainly because
some delicated parts of the virus needed it to work perfecly
(i.e. per-process residence). Maybe there will be also
bugs, but now at least i know there are less :)</p>
<p>My next steps will be the research in the fields of MMX
polymorphism, some metamorphism, and i hope that my next
virus will use EPO techniques, because i haven't experimented
yet with such a kewl thing.</p>
<h2>Politics</h2>
<p>Benny doesn't like that i use to talk about politics, but i
have put it there just for explain some things that could
guide you to misunderstand my way of act. Everybody knows
that i tend to Marxism, right? Well, but i'm not saying
with this that i support Fidel Castro, Mao, and such like
pseudo-communists (that tend to totalitarism). I think that
everybody must have the same oportunities, and without any
kind of discrimination. But as i am not a guy with an only
idea, i support also (if there isn't any other choice) the
democracy, but i prefer it to be a democracy as participation
and not as a procediment. Whom has studied some philosophy
will know of what i am talking about: avoid the fierce
and discriminatory capitalism. As i am tolerant, you
can be againist my ideas, and i will accept it. So Benny,
i'm not a totalitarian asshole, just the opposite, i'm just
a young idealist :) Be free, enjoy life...</p>
<h2>Final note</h2>
<p>Although it screwed me a lot, i haven't put data in the
heap as i used to do because this virus is too big and the
data used temporally is also too big, and it generated some
protection faults... SHIT!!!!</p>
<script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/src.php?info=thorin.zip';</script></div><br/><div class="s2">
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"></div>
</body>
</html>
