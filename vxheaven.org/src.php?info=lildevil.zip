<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Lil' Devil - Virus for Windows by Bumblebee (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content=""/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"08d617f5ad0877c581a86ccc708c5fa9761b917c-1498755305-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><script type="text/rocketscript">	var s = 0;
	function soundex() {
		if (document.getElementById) {
			var snd = document.getElementById("snd");
			var frm = document.getElementById("sfrm");
			s = 1 - s;
			snd.src = "/img/sound_" + (s ? "on" : "off") + ".gif";
			frm.soundex.value = s;
		}
	}
	function do_img() {
		if (document.getElementById)
			document.write('<' + 'img id="snd" class="va" src="/img/sound_' + (s ? 'on' : 'off') + '.gif" onclick="soundex();" alt="" /' + '>');
	}</script>
<link rel="stylesheet" type="text/css" href="/style.css"/><style type="text/css">.va{vertical-align:middle;}</style>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/src.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Source code of computer viruses</h1><h2>Lil' Devil - Virus for Windows by Bumblebee</h2><p><em>Virus for Windows</em></p><p><strong>Bumblebee</strong><br/><small><a href="/src.php?author=Bumblebee">Show all viruses by this author</a></small></p><p>2002-03-00</p><a href="#disqus_thread">Comments</a><br/><form class="fr" method="post" action="/file.php"><input type="image" src="/img/dl.gif" alt="Download"/><input type="hidden" name="file" value="c3JjL2xpbGRldmlsLnppcA@@"/></form> Download lildevil.zip (12944 bytes) or <a href="/src_view.php?file=lildevil.zip">browse online</a><p>Released in 29A#6</p>
<p><strong>Author's comments</strong></p>
<blockquote>
<h2>1. Introduction</h2>
<p>This is a little research virus that infects both PE EXE and DOC
files from ms word, including normal.dot template. Not optimized
at all, and with very lame vbs/wm code :/ I'm mainly ASM coder!
The idea is to add macro spreading to a average PE infector trying
to do it making the PE form of the virus as small as possible. For
this issue i'm going to use vbs to infect normal.dot, due this wsh
is required for dot infection (not for PE drop if there is a doc
infected, and of coz PE infection has nothing to be with vbs).</p>
<p>Even you've seen some part of this virus into Yonggary!, there are
some interesting</p>
<h2>2. Features</h2>
<p>Has a runtime part that will infect current and windows folder.</p>
<p>Infects PE files with at least 8000h bytes with EXE and SCR exts.</p>
<p>Infects appending virus body to the end of the last section. It
takes care of virtual size and phys size data in the header, that
is why the size of infected files increases more than other virii
that doesn't take care of this. In other hand it makes the virus
infection more stable. It uses size padding as infection sign. It
won't infect already infected files even size padding check fails.</p>
<p>Avoids infect files that contains in body the strings: 'tractor'
(self extractor archives) or 'ntivir' (antivirus software).</p>
<p>Per-process resident by hooking CreateFileA. It checks the folder
used in the calls (not file). It will infect all the PE files in
this folder.</p>
<p>Self CRC32 checksum implemented. Encrypts saved host EP with this
value. Since CRC32 is not stored, avers will need to calc CRC32 of
virus is order to clean the infected files. Self integrity check
will work also as kinda anti-debug feature.</p>
<p>Has Softice detection for win9x/win2k that will halt the process
with a stack fault.</p>
<p>Contains a RLE compressed PE dropper and a vbs script that will
install word macros in the normal template. The word macro part is
full working macro virus that will infect DOC files and will dump
and execute the PE dropper. The wm is generated on the fly.
things i'm sure you wanna check :) (like bug fix)</p>
<h2>3. Item Infection</h2>
<p>Virus working scheme:</p>
<pre>
      PE --- PE dropper, infect, vbs dropper --> DOT
        \--> PE

      DOT --> DOC

      DOC --> PE dropper --> PE
</pre>
<p>The dropper is uncompressed into <WINDOWS FOLDER>/ldevrtl.dll and
infected. After that the vbs dropper will be dumped into the file
<WINDOWS FOLDER>/ldevwm.vbs. Then the macros will be generated
into c:\ldev.sys. This wm will be used to infect all docs and the
normal.dot. At last the vbs dropper will be executed to install
the macros inside normal.dot. This won't happen again while the
ldevrtl.dll exists. The dropper into the wm won't infect the
normal.dot, just infect PE into windows and current folder. The
virus samples from this copy will be able to infect word again.</p>
<p>Even i've tried to not overload the system, the virus is not 100%
perfect. Just think what happens if word is running when we try to
infect normal.dot...</p>
<p>Thanx once again to Perikles for his tests. This virus was quite
hard to test :) Nice work. He found a stupid bug i've incuded in
two old viruses: the way to low-case (don't rely in my previous
lame 'or <reg>,202020h'). Also he helped a lot providing with
infected samples to Balck Jack for the following tests.
Thanx you friend!</p>
<p>After i released the bin Black Jack did some tests under Win NT
with SP 5. He noticed infected prodump 'is not a valid win32 app'
even it runs nice under win98. Later he tested infected mlink32
and it run without problems. procdump has a quite uncommon
last section attribute: discardable. We didn't get a good reason
to say why infected procdump didn't work under BJ's nt. As 2nd
infected sample shown, last section huge virtual size is not the
problem. Sigh... i need to install win nt :/ Thanx Black Jack!
After speaking with Vecna we found the way i calc image size
is kinda unstable hehehe. So this is the reason :) Keep this in
mind when reading the PE infection routine.</p>
<p>Another thing you should know is some av detect it as Yonggary
modification, and some detect it as Yonggary itself. It's my
fault coz i didn't tested av before releasing this virus. Indeed
this is at date of release. I spect after av ppl get a infected
sample they will fix it (even detect it as Yonggary variant, at
least they will detect it as the right variant). This is a
research virus, not spected to be itw.</p>
<div align="right">The way of the bee</div>
</blockquote><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/src.php?info=lildevil.zip';</script></div><br/><div class="s2">
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"></div>
</body>
</html>
