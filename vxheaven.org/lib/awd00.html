<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>William Dowling 'There Are No Safe Virus Tests' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="William Dowling"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Dowling, William,There Are No Safe Virus Tests, text, input, programs, program, virus, executed, behavior, definition, assumption, running, alters, operating, system, hand, begin"/>
<meta name="Description" content="This note gives a proof that no program can both test its input for the presence of a virus and simultaneously be guaranteed not to spread a virus itself."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"212cc273f19bc077fbc6b90f652352391d26d9ea-1498757282-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/awd00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>There Are No Safe Virus Tests</h1><p><a href="/lib/?lang=en&amp;author=Dowling%2C%20William">William Dowling</a><br/> <em>American Mathematical Monthly, v.96 n.9, p.835-836, Nov. 1989.</em><br/> <em>ISSN 0002-9890</em><br/> <em>November 1989</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/awd00.html';</script><div class="ci"><a href="/lib/?ci=awd00">1</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/There%20Are%20No%20Safe%20Virus%20Tests.pdf">Download</a> PDF (208.72Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=TH#awd00">Back to index</a>] [<a href="/lib/awd00.html#disqus_thread">Comments</a>]<br/> <form method="post" action="">
<img src="/img/cache/0b9fd596a90421f9f1f68a9760275737.gif" alt="\text{T_EX size}" valign="middle"/>
<select name="TeX_size"><option value="-2">-2</option><option value="-1">-1</option><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select>
<input type="submit" value="Scale"/>
</form><form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>Department of Mathematics and Computer Science, Drexel University, Philadelphia, PA 19104</address>
<p>This note gives a proof that no program can both test its input for the presence of a virus and simultaneously be guaranteed not to spread a virus itself. (You may define " virus" any way you please, as long as the definition is extensional.) This immediate corollary of Rice's Theorem [1] is proved by a direct diagonalization and offered as an antidote (not a vaccine) to boredom in the elementary computability course during the presentation of the halting problem.</p>
<p>Programs running on modern computers, unlike the executions of Turing machine programs, as usually conceived, run "in an environment." This is to say that when a program is executed, it is run as a subprogram of the logically independent program, the operating system, which is responsible for such bookkeeping chores as primary and secondary memory management, process management, recording statistics, and so on. A program that, when run, alters the code of the operating system, is called a <em>virus</em>. (When a new version of the operating system is written legitimately, it replaces, not alters, the former operating system.) This is a somewhat less restrictive definition of virus than others have proposed [2], in that no particular behavior is required of the modified operating system. For instance, it is frequently required that a virus have the effect of inserting its own code into other executable programs. Such restrictions are unnecessary for the result we seek.</p>
<p>It would be nice if we could detect automatically which programs are viruses and which are not by submitting them to a filter program, thus avoiding the expense and inconvenience of unwittingly and possibly harmfully altering our operating system. We now show there can be no program that does this correctly for every possible input, while guaranteed not to spread a virus itself.</p>
<p>We begin by fixing an operating system OS, and making a definition.</p>
 
<p><strong>DEFINITION 1.</strong>
<em>Program <img src="/img/cache/44c29edb103a2872f519ad0c9a0fdaaa.gif" alt="P" valign="middle"/> spreads a virus on input <img src="/img/cache/9dd4e461268c8034f5c8564e155c67a6.gif" alt="x" valign="middle"/> if running <img src="/img/cache/44c29edb103a2872f519ad0c9a0fdaaa.gif" alt="P" valign="middle"/> under operating system OS on input <img src="/img/cache/9dd4e461268c8034f5c8564e155c67a6.gif" alt="x" valign="middle"/> alters OS. Otherwise it is safe on input <img src="/img/cache/9dd4e461268c8034f5c8564e155c67a6.gif" alt="x" valign="middle"/>. A program is safe if it is safe for all inputs.</em></p>
<p>We also make the assumption that there exist viruses for OS, otherwise there would be no necessity for our test. Now for the sake of contradiction, let us assume there is some safe program <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/> that decides the safety of running an arbitrary program <img src="/img/cache/44c29edb103a2872f519ad0c9a0fdaaa.gif" alt="P" valign="middle"/> on arbitrary input <img src="/img/cache/9dd4e461268c8034f5c8564e155c67a6.gif" alt="x" valign="middle"/>. Thus</p>
<div class="N5"><img src="/img/cache/c133c4da971aab14b85e8a4e7ffad7cf.gif" alt="
	IS-SAFE(P, x) = \{
	\begin{align}
		&amp; \text{yes} &amp; \text{if }P\text{is safe on input }x &amp; \\
		&amp; \text{np } &amp; \text{otherwise.} &amp; \\
	\end{align}
" valign="middle"/></div>
<p>Given such a program and our assumption that there exist viruses, it is easy to write a program <img src="/img/cache/913e751d717c2ff7c5e16f8c1d6758bb.gif" alt="D()" valign="middle"/> of one argument that has the following behavior:</p>
<div class="N5"><img src="/img/cache/3cae601cc1601fa5f998493935ba9dd8.gif" alt="
	D(P) = \{
	\begin{align}
		&amp; \text{Write 'Have a nice day'} 	&amp; \text{if }IS-SAFE(P,P) = \text{no} &amp; \\
		&amp; \text{alter OS}			&amp; \text{otherwise.} &amp; \\
	\end{align}
" valign="middle"/></div>
<p>We can now show that <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/> cannot be both safe and correct by examining the behavior of <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> on input <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/>. If <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> is safe on input <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> this can only be because it has not executed the otherwise clause, that is, because <img src="/img/cache/d29798b9743048075a2cbeca6749a0be.gif" alt="IS-SAFE(D, D) = \&quot;\text{no},\&quot;" valign="middle"/> thus showing that <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/> is not correct. On the other hand, if <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> alters OS on input <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/>, there are two possibilities. On one hand, the call to <img src="/img/cache/dddbbcdb2cc94c65198f938a2b286668.gif" alt="IS-SAFE(D, D)" valign="middle"/> may be returning "yes" so the otherwise clause in <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> is being executed, in which case <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/> is not correct. On the other hand, if <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/> returns "no" (so <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> simply prints "Have a nice day") the assumption that <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> is unsafe on input <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> means that the call to <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/> must be the culprit, that is, <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/> is not safe. We conclude that the assumption of the existence of a safe, correct program that runs on OS and checks the safety of its input must be incorrect; there can be no such program <img src="/img/cache/4b55f30bba798e540dfbd83d4ddffcfc.gif" alt="IS-SAFE" valign="middle"/>.</p>
<h2>References</h2>
<ol>
<li>H. Rogers, Theory of Recursive Functions and Effective Computability, McGraw-Hill, New York, 1967.</li>
<li>I. Witten, <a href="/lib/aiw00.html">Computer (in)security: infiltrating open systems</a>, Abacus, 4 (Summer 1987) 7-25.</li>
</ol>
 
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=awd00">de</a><a href="/lib/index.php?lang=en&amp;id=awd00">en</a><a href="/lib/index.php?lang=es&amp;id=awd00">es</a><a href="/lib/index.php?lang=it&amp;id=awd00">it</a><a href="/lib/index.php?lang=fr&amp;id=awd00">fr</a><a href="/lib/index.php?lang=pl&amp;id=awd00">pl</a><a href="/lib/index.php?lang=ru&amp;id=awd00">ru</a><a href="/lib/index.php?lang=ua&amp;id=awd00">ua</a></div>
</body>
</html>
