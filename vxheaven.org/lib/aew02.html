<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Edward Wilding 'The Violator Virus - Burger’s Continuing Legacy' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Edward Wilding"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Wilding, Edward,Violator Virus - Burger’s Continuing Legacy, violator, found, code, august, version, trigger, burger, seconds, washburn, copyright, author, viruses, date, vienna, book"/>
<meta name="Description" content="The technical competence of virus writers varies considerably, from abysmally poor to reasonably proficient but this is not usually a consideration which affects the actual functioning of virus code (apart, of course, from programming bugs).Over a period of time, a researcher will develop a “feel” for the style and structure of particular viruses and may even be able to link apparently dissimilar programs and reasonably ascribe them to the same original author. Such stylistic analyses have little value to computer users but they may become extremely useful as computer misuse legislation is adopted worldwide and law enforcement agencies begin to home in on the criminals responsible for the problem.One of the most obvious links discovered to date concerns the origins of the Violator virus and it highlights the undoubted advantages of detailed disassembly of virus code over the faster (but less effective) sparse analysis technique. Before examining the conclusions of a stylistic analysis, I will first describe Violator."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"90b1ef585f55de75eda4871e21fcf7da7dcfacc9-1498757402-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/aew02.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>The Violator Virus - Burger’s Continuing Legacy</h1><p><a href="/lib/?lang=en&amp;author=Wilding%2C%20Edward">Edward Wilding</a><br/> <em><a href="/vx.php?fid=1680#f1680">Virus Bulletin, April 1991</a>, pp. 22-23</em><br/> <em>ISSN 0956-9979</em><br/> <em>April 1991</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/aew02.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=AN#aew02">Back to index</a>] [<a href="/lib/aew02.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<ul>
<li><a href="#c1">Brief Description</a></li>
<li><a href="#c2">Operation</a></li>
<li><a href="#c3">Trigger</a></li>
<li><a href="#c4">Infection</a></li>
<li><a href="#c5">The Washburn-Burger Connection</a></li>
</ul>
<p>The technical competence of virus writers varies considerably, from abysmally poor to reasonably proficient but this is not usually a consideration which affects the actual functioning of virus code (apart, of course, from programming bugs).</p>
<p>Over a period of time, a researcher will develop a “feel” for the style and structure of particular viruses and may even be able to link apparently dissimilar programs and reasonably ascribe them to the same original author. Such stylistic analyses have little value to computer users but they may become extremely useful as computer misuse legislation is adopted worldwide and law enforcement agencies begin to home in on the criminals responsible for the problem.</p>
<p>One of the most obvious links discovered to date concerns the origins of the Violator virus and it highlights the undoubted advantages of detailed disassembly of virus code over the faster (but less effective) sparse analysis technique. Before examining the conclusions of a stylistic analysis, I will first describe Violator.</p>
<h2><a name="c1"></a>Brief Description</h2>
<p>This is a non-resident virus which infects only COM files of between 10 and 64000 bytes. Infection takes place on a ‘oneshot’ basis (i.e. one file is infected each time the virus is executed). Files in the current directory are attacked first and when they are all infected, the search continues by accessing files within directories listed in the system PATH setting. A date controlled destructive trigger routine is incorporated and described below. The code is not encrypted and responds readily to automatic disassembly.</p>
<h2><a name="c2"></a>Operation</h2>
<p>From the initial jump instruction at the head of the host COM file, the virus first collects an offset value which is subsequently used throughout the code to address various data items. This value is modified during the infection routine to reflect the length of the new host file. Once this offset has been collected, it is used to access the original three bytes of the host header and these are replaced at the top of the file.</p>
<p>A check is then made on the current DOS version and processing returns to the host program if this is earlier than version 2.00. If the DOS version is acceptable, the virus sets up its own Disk Transfer Area and then checks the current setting of the system date to see whether the trigger routine should be executed.</p>
<p>The code to check the date is extremely clumsy but the criteria are as follows:</p>
<p>If the date is before 15th August 1990 then the trigger is not executed. If the month is January to July (inclusive - any year) the trigger is not executed. If the date is the 1st to the 14th (inclusive - any month) the trigger is not executed. This selection of dates for the trigger routine does not affect the infection routines which are processed every time the code is executed. Once the trigger routine has run, processing continues with the normal infection routines.</p>
<h2><a name="c3"></a>Trigger</h2>
<p>The trigger routine consists of a small loop which uses the BIOS INT 13H call to attempt to format the first track of all floppy drives from A to Z. This will obviously destroy the boot sector of any unprotected floppy disks in those drives. The virus does not install a special critical error handler and no check is made for error conditions. This means that unless there is a write-enabled disk in every floppy drive, the DOS error handler will report either “Sector not found” or “Drive not ready” errors to the screen. No attempt is made to initialise the format instruction correctly.</p>
<h2><a name="c4"></a>Infection</h2>
<p>The infection routine begins by accessing the Environment Segment belonging to the host program and searching for the “PATH=” command. Once this is found, its position is stored for later use.</p>
<p>A search mask of “*.COM” is then used with a call to Function 4EH of INT 21H to find the first matching file. Attributes are set to include System and Read Only files. Once a file is found, the time field is checked for a value of 1FH (31 = 62 seconds) in the seconds field. If this is found, the file is assumed to be infected and the search continues with a Function 4FH (Find Next) call. If no matching (uninfected) file is found in the current directory, processing collects the first parameter in the “PATH=” statement and continues the search there. This process continues until all of the directories (delimited with a semi-colon) noted in the path statement have been searched.</p>
<p>Once a suitable file is found, the usual processes of collecting and storing the attributes and the date/time field are executed and the file is then opened for write access. <strong>Files which were set to Read Only access are still at risk since the virus resets these temporarily during infection to allow write privileges.</strong></p>
<p>The next phase collects the first three bytes of the new host and stores them within the virus code. The 1055 bytes of the virus code are then written to the end of the host file and a new offset is calculated for the initial jump. The new jump instruction is written to the beginning of the file and the file date and time field is restored to its original value but with the seconds field set to 1FH (62 seconds). The file is then closed and the
 
attributes restored to their original value before the virus passes control back to the original host program. A recognition pattern for Violator has already been published (<em>VB</em>, January 1991) and this analysis has confirmed this string as accurate and effective.</p>
<h2><a name="c5"></a>The Washburn-Burger Connection</h2>
<p>The operations described above are unremarkable and are similar to those found in most parasitic viruses. What <em>is</em> interesting is when a stylistic analysis is conducted and considerable similarity is revealed between large sections of the code in the Violator, Casper and V1 viruses.</p>
<p>Casper is a ‘hacked’ development of the 1260 virus (V2P1) written by Mark Washburn in the U.S. and V1 is listed in Ralf Burger’s book <em><a href="/lib/arb01.html">Computer Viruses - A High Tech Disease</a></em> (<em>VB</em>, <a href="/vx.php?fid=1662#f1662">October 1989</a>, p.19) as a version of the Vienna virus.</p>
<p>There is no equivocation in this comparison; the similarities are numerous (even to the duplication of NOP instructions and bugs). The temptation to <em>speculate</em> upon the original derivation of Violator is irresistible:</p>
<p>Given three viruses from (apparently) three different sources, the first question is which came first. In this case there is no doubt that the original Vienna virus was first since it is a disassembly of this which appears as the V1 listing in Burger’s book. The book was originally published in Germany in 1987 (the English translation appeared around a year later), so we can place Vienna at pre-1987.</p>
<p>Dating the other two is less easy. File dates are not reliable since they can be changed so easily, but in this case there are other indications concerning the original dates of Casper and Violator. The earliest report that I can find concerning Violator appears in the Patricia Hoffman listing from the United States, dated November 1990. The Hoffman listing is a first class initiative and it deserves success. Unfortunately it seems to be plagued with many inaccuracies in the virus reports which add to the confusion concerning exactly how particular viruses operate. In this case for example, Violator is reported as follows:</p>
<blockquote><em>When a program infected by the Violator virus is executed, what happens depends on what the system date is set to. If the date is prior to August 15, 1990, the virus will infect 1 .COM file located in the current directory, adding 1,055 bytes to the program. If the date is August 15, 1990 or after, the virus will not affect any files.</em></blockquote>
<p>This is plainly at variance with my observation of the current sample which is infective regardless of the date and triggers as described above. However, the reported text strings and other details match exactly and do seem to indicate that we are referring to the same virus. The same entry reports that: <em>“The Violator virus was submitted in August, 1990 by an anonymous user of the HomeBase BBS”</em>. This places Violator no later than August 1990 so we only need to date Casper to complete the timescale. The source listing of Casper (which includes Washburn’s name and address) contains the message <em>“Copyright (C) Mark Washburn, 1990. All Rights Reserved”.</em> Assuming that this ‘copyright’ message is correct, this enables us to date Casper to 1990, but the exact month of its development is unknown.</p>
<p>Unfortunately, it is impossible to draw absolutely firm conclusions from the above speculation but the alternatives are interesting in themselves. Violator and Casper could <em>both</em> have been written by the same hand or both could have been <em>copied</em> from the Burger book, but independently.</p>
<p>It is also possible that sections of Violator could have been copied from Casper (and, less likely, vice versa). It should be remembered that source code for the Casper virus has been widely distributed.The presence of certain incorrect checks and the position of some of the NOP instructions leads me to suspect that Violator was probably copied from the Burger book, as was Casper. The impression gained during disassembly of Violator is that it was written by someone with virtually no knowledge of PCs who had access to some virus source code and a rather poor reference book to DOS. It is impossible to determine whether the same author was involved in both cases, even though Violator contains text claiming <em>“Copyright (c) 1990 RABID!”</em> and Washburn has certainly demonstrated his desire to corner the ‘market’ through claiming copyright.</p>
<p><strong>More importantly, this examination highlights once again the fact that virus source code is immensely more dangerous than its assembled equivalent because source code will continue to spawn modified strains.</strong> Burger’s publication of source code to the Vienna virus has spawned more viruses and variants than any other single action. Washburn’s V2P1, V2P2 and V2P6 are <em>all</em> based on the Burger listing. (Even disregarding his public dissemination of virus code, the existence of the destructive Casper virus which is derived from 1260, has served to discredit Washburn as a responsible researcher.) Ultimately Violator, which is <em>clearly</em> related to the V1 source code, is another damning indictment of Burger.</p>
<p>Technical Editor’s comment: Analysis of the Casper virus assembly listing indicates that is <strong>not</strong> developed from a disassembly of the V2P1 executable, as Washburn claims (<a href="/lib/aew01.html">see page 20</a>). Rather it is created by modifying the virus’ <em>source code</em> which indicates that V2P1 (1260) source code is in circulation.</p>
<p>It is my opiniont hat Casper and Violator were developed <em>independently</em> but that they share a common ancestor; namely the original Vienna virus. It is unlikely that the author of Violator had access to Casper (or V2P1) as Violator contains none of the special code which makes V2P1 different to Burger’s published Vienna variant, V1. It is equally unlikely that the author of Casper had access to Violator as its code contains none of the mistakes found in the latter virus.</p>
<p>There is one seemingly indisputable connection - Washburn used Burger’s published source code to create his V2P1 (1260) virus and the source code to 1260 is now in circulation. The publication and/or distribution of source code represent a greater threat than the distribution of binary virus code and are acts of gross irresponsibility.</p>
 
[<a style="" href="/lib/?lang=EN&amp;index=AN#aew02">Back to index</a>] [<a href="/lib/aew02.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=aew02">de</a><a href="/lib/index.php?lang=en&amp;id=aew02">en</a><a href="/lib/index.php?lang=es&amp;id=aew02">es</a><a href="/lib/index.php?lang=it&amp;id=aew02">it</a><a href="/lib/index.php?lang=fr&amp;id=aew02">fr</a><a href="/lib/index.php?lang=pl&amp;id=aew02">pl</a><a href="/lib/index.php?lang=ru&amp;id=aew02">ru</a><a href="/lib/index.php?lang=ua&amp;id=aew02">ua</a></div>
</body>
</html>
