<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Brian Reid 'Reflections on Some Recent Widespread Computer Break-Ins' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Brian Reid"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Reid, Brian,Reflections on Some Recent Widespread Computer Break-Ins, computers, account, directory, user, guest, convenience, machines, security, stanford, police, routine, file, permissions, computer, search"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"caf3c6aab971eb5a74edc20472819f1ba8e35e78-1498757047-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/abr00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Reflections on Some Recent Widespread Computer Break-Ins</h1><p><a href="/lib/?lang=en&amp;author=Reid%2C%20Brian">Brian Reid</a><br/> <em>Computers under attack: intruders, worms, and viruses, pp. 145-149</em><br/> <em>ISBN 0-201-53067-8</em><br/> <em>January 1990</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/abr00.html';</script><div class="ci"><a href="/lib/?ci=abr00">5</a></div>[<a style="" href="/lib/?lang=EN&amp;index=HI#abr00">Back to index</a>] [<a href="/lib/abr00.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<p><em>doi>10.1145/102616.102626</em></p>
<p><strong>Article 6</strong></p>
<p>from <em><a href="/lib/apd01.html">Computers under attack: intruders, worms, and viruses</a></em></p>
<p><em>Reprinted from Communications of the ACM, Vol 30, No. 2, February 1987, pp. 103-105. Copyright© 1989, Association for Computing Machinery, Inc.</em></p>
<p>In the first weeks of September 1986, some number of UNIX® systems in the San Francisco area, and elsewhere on the ARPANET, were systematically penetrated by talented intruder(s). We believe that it began at Stanford; it seems to have spread to many other computers around the ARPA Internet. The intruder often left behind recompiled login programs to simplify his return. His goal seems to have been purely numeric, to see how many computers he could crack. We are aware of no major destruction or theft of files — although the inconvenience to users and managers of these computers was significant. Most of these computers are operated without professional management by small groups of researchers; because no records were kept, it is difficult to tell exactly how many machines were penetrated. The number could be as high as 30 to 60 on the Stanford campus alone. Similar break-ins at other ARPA Internet sites have been reported to us. Virtually all of the other site managers have asked me not to reveal their identity, but I have firsthand knowledge of break-ins at 9 universities, 15 Silicon Valley companies, and 9 ARPANET sites, including 3 government labs.</p>
 
<p>An analysis of the break-ins shows that they were made possible by a combination of technology and human nature, creating an environment in which penetrations were easy and the consequences more dire than necessary. In reporting this event, I will review the technical nature of the break-ins, draw some conclusions, and make some recommendations based on what we have learned.</p>
<p>The user-level networking features in Berkeley UNIX are formulated around the concepts of remote execution and trusted host. For example, the command typed on computer A for remote copying from computer B to computer C is:</p>
<pre>rcp B:file C:file</pre>
<p>The decision of whether or not to permit these copy commands is based on permission files on computers B and C. If my account on computer B has a permission file that contains the entry "(A, reid)," the operating system on computer B will give access to someone who is logged on to A with identity "reid." The command will succeed if I have an account on all computers involved, and the permission file stored in my directory on those computers authorizes the attempted kind of access.</p>
<p>The break-ins started with an obscure Stanford computer that was used primarily as a mail gateway between UNIX and IBM computers on campus. This computer had a guest account with the user id "guest" and the password "guest." Although this is a silly mistake, it is a common one, and those managing this computer did not have much experience in setting up UNIX systems. Because this computer is used only as a mail gateway, there was no incentive to keep it constantly up-to-date or carefully patrolled. The intruder easily broke in to the guest account.</p>
<p>On most Berkeley UNIX systems, it is routine for an experienced programmer to be able to trick a privileged system program into executing nonstandard versions of system commands. If a user has write permission in a system directory, he or she can store a bogus version of a system command in that directory and then wait for some regularly scheduled system maintenance command to execute that version. The substitute command will thus be run as a certain privileged user, called a superuser. Because of the search path mechanism, by which several directories will be searched until the requested program is found, it is difficult to spot such security holes by casual inspection.</p>
<p>On the distribution tape of 4.2BSD (a version of Berkeley UNIX), it happens that the directory named "/user/spool/at" is universally writeable by all users; it also happens that it is fairly easy to trick the operating system into executing privileged commands by storing them in that
 
directory. When beginners install that distribution tape, they rarely realize that the directory protection is a security problem, and so do not change the protection from the default value. The intruder knew this and had no difficulty in becoming the superuser on that machine. We suspect that the intruder simply looked around the network until he found a machine with both a guest account and the writeable-directory bug.</p>
<p>Having become superuser, the intruder was able to assume the login identity of anybody who had an account on that computer. In particular, he was able to pretend to be user "x" or user "y," and in that guise ask for a remote login on other computers. This enabled him to get access to x's or y's privileges on various remote machines. One user, a systems programmer, had accounts on several machines, each of which had a permission file authorizing access from the mail gateway computer. Having logged in to the other computers, the intruder repeated the process of becoming the superuser, and worked his way through the entire network. The machine on which the initial break-in occurred was one I did not even know existed, and no one in my department had any control over it. Yet a leak on this seemingly inconsequential machine on a remote part of campus was able to spread to our machines because of the networking code.</p>
<p>The above description of how the intruder picked his way through the network illustrates the technological side of the break-ins. What made this whole affair so interesting is how the UNIX technology interacted with human nature to create a large number of permission files for users who had write permission to a system directory. Here is how that happened.</p>
<p>The networking mechanism in Berkeley UNIX is very, very convenient. To move the file from one place to another, the user just types "rcp" and it is there. Fast, efficient, and quite transparent. The alternative is the file transfer program (ftp), which is slower, less accurate, and harder to use. In my work I am often asked to help install software on remote machines. Like so many other systems people, I prefer rcp. To use rcp, I must create, however briefly, a permission file authorizing the transfer. If for some reason I am interrupted, and I forget to delete the permission file, it will remain behind, a silent aid to an intruder. After a few years of operation, a large network of Berkeley UNIX systems seems to grow extra permission files the way old oak trees grow mistletoe. A surprising number of these files are created by people like me, installing system software, and therefore having write permission to system directories.</p>
<p>People often let convenience dominate caution. Search paths are almost universally misused. Many sites modify the root search path so that
 
it will be convenient for systems programmers to use interactively as the superuser, forgetting that the same search path will be used by system maintenance scripts run automatically during the night. Essentially every UNIX computer I have ever explored has grievous security leaks caused by very general or overly long search paths for privileged users.</p>
<p>Systems programmers are in short supply, and they are almost always overworked. They often make heavy use of sophisticated software tools and shortcuts to make their jobs more tractable. In this instance, the convenience of the remote file access mechanism was so compelling that it may have lured some systems programmers into using it to lighten their workloads, sacrificing security for convenience.</p>
<p>UNIX was created as a laboratory research vehicle, not as a commercial operating system. As it has become more widely used commercially, many of the properties that made it attractive in the laboratory have created problems. For example, the permission file mechanism described above lets me easily give my colleagues full access to the files on my computer. When UNIX systems are installed in nonlaboratory applications by people who are not trained to think about operating system security, however, the same mechanism that is convenient in the laboratory becomes dangerous in the field. There is no way to assign fault or blame for these security problems, because if the UNIX system is used as its designers intended, security is not a problem.</p>
<p>A frustrating irony was that after we saw and understood the <em>modus operandi</em> of the intruder, we had great difficulty convincing the night shift authorities that this was a serious problem. We could not get the telephone calls traced that night. At one point an intruder spend two hours talking on the telephone with a Stanford system manager, bragging about his accomplishment, but we could not get the call traced. He must have known this, or he would not have called.</p>
<p>It is possible to err in the opposite direction by applying too much police power. A few years ago, Stanford and other universities suffered a series of break-ins by a high school student. He was ultimately convicted of felony charges. The conviction and the sentence were excessive relative to the true damage that he caused, but were probably typical in terms of the amount of police and FBI effort that was required to catch him.</p>
<p>In summary, the two technological entry points that made these intrusions possible were:</p>
<ul>
<li>The large number of permanent permission files, with too many permissions stored in them, found all over the campus computers (and, for that matter, all over the ARPANET).</li>
 
<li>The presence of system directories in which users have write permission. This was caused in part because the people who prepared the 4.2BSD release tape did not anticipate the diversity of potential customers for their software. They were probably thinking that the customers were university computer science departments.</li>
</ul>
<p>My conclusions from all of this are:</p>
<ul>
<li>Nobody, no matter how important, should have write permission into any directory on the system search path. Ever. One should not be able to install a new program without typing a password.</li>
<li>It would be a worthwhile research venture to carefully rethink the user interface of the Berkeley networking mechanisms, to find ways to permit people to type passwords as they are needed, rather than requiring them to edit new permissions into their permissions files.</li>
<li>The permission-file security access mechanism is fundamentally vulnerable. It would be quite reasonable for a system manager to forbid the use of them, or to drastically limit the use of them. Mechanized checking is easy.</li>
<li>Programmer convenience is the antithesis of security, because it is going to become intruder convenience if the programmer's account is ever compromised. This is especially true in setting up the search path for the superuser.</li>
<li>To catch intruders efficiently advance plans must be made. Making them will also help keep down the level of frenzy during the chase. If computer installations make some advance arrangements with the local police, and come to agreements about how the police can help solve electronic intrusions, it will increase the effectiveness of the deterrent while decreasing the likelihood of an overreaction. Computer break-ins are becoming routine, and we need to make the response to them equally routine.</li>
</ul>
 
[<a style="" href="/lib/?lang=EN&amp;index=HI#abr00">Back to index</a>] [<a href="/lib/abr00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=abr00">de</a><a href="/lib/index.php?lang=en&amp;id=abr00">en</a><a href="/lib/index.php?lang=es&amp;id=abr00">es</a><a href="/lib/index.php?lang=it&amp;id=abr00">it</a><a href="/lib/index.php?lang=fr&amp;id=abr00">fr</a><a href="/lib/index.php?lang=pl&amp;id=abr00">pl</a><a href="/lib/index.php?lang=ru&amp;id=abr00">ru</a><a href="/lib/index.php?lang=ua&amp;id=abr00">ua</a></div>
</body>
</html>
