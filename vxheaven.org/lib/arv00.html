<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Robert Vibert 'A Day in the Life of an Anti-Virus Lab' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Robert Vibert"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Vibert, Robert,Day in the Life of an Anti-Virus Lab, viruses, customers, links, macro, news, analysis, software, code, pattern, time, automated, anti, samples, customer, computer"/>
<meta name="Description" content="If you're an average computer user, the first time you may hear of a new computer virus is when it appears in your morning paper or makes the evening TV news. However, by the time the general press gets wind of a new virus, virus researchers are already considering it old news and have moved on to the next bit of malicious code that needs tending to. Every month, hundreds of viruses are discovered and fewer than one percent of them ever make the headlines."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"1a640f7618dabe41106c488a10f52b37a815f66b-1498756035-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/arv00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>A Day in the Life of an Anti-Virus Lab</h1><p><a href="/lib/?lang=en&amp;author=Vibert%2C%20Robert">Robert Vibert</a><br/> <em>SecurityFocus</em><br/> <em> 2000</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/arv00.html';</script><div class="ci"><a href="/lib/?ci=arv00">1</a></div>[<a style="" href="/lib/?lang=EN&amp;index=AR#arv00">Back to index</a>] [<a href="/lib/arv00.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c1">The wheat from the chaff</a></li>
<li><a href="#c2">How many thousand copies did you need?</a></li>
<li><a href="#c3">Catching the critters</a></li>
<li><a href="#c4">Autopilot engaged</a></li>
<li><a href="#c5">Relevant Links</a></li>
<li><a href="#c6">Anti-Virus Labs'Submission Links</a></li>
</ul>
 
<p>If you're an average computer user, the first time you may hear of a new computer virus is when it appears in your morning paper or makes the evening TV news. However, by the time the general press gets wind of a new virus, virus researchers are already considering it old news and have moved on to the next bit of malicious code that needs tending to. Every month, hundreds of viruses are discovered and fewer than one percent of them ever make the headlines.</p>
<p>A look at the analysis processes used by researchers to handle the hundreds of new viruses each month reveals that they range from a mix of manual investigation and semi-automated software tools to some nearly fully-automatic systems with little, if any, human intervention.</p>
<p>Most new viruses arrive at a virus lab by way of customers who discover something amiss on their systems and send any suspicious files to their Anti-Virus vendor. These suspicious files are not always viruses - they may be damaged, or simply some innocent file that someone has sent along for analysis in the hope that it contains the answer to a mysterious problem from which their PC is suffering. For many users, a virus is the first suspect when something goes wrong, and Anti-Virus labs are constantly receiving innocuous submissions. Needless to say, if a file arrives from a customer, it receives top-priority handling. Other files received from researchers and collections which are exchanged between virus labs are dealt with after the customer files have been processed.</p>
<h2><a name="c1"></a>The wheat from the chaff</h2>
<p>The first stage of the process at any lab is to sift out the definitely-innocent non-virus files from the potentially infected ones. Many labs use one or more processes to accomplish this, usually by identifying the known "normal" files by matching them against an ever-growing database of files which have been thoroughly analysed and verified as virus-free. Using checksums and other pattern matching technology, each new file is compared to the known clean files to determine if it should be subject to further investigation or simply culled from the analysis process. If a file matches a known-clean file, it is removed from the process and the customer informed that it is not a virus. On any given day, the ratio of safe to suspect files received in a lab can vary tremendously.</p>
<p>The next stage is to inspect the now reduced group of suspect files to see if any are known viruses. For this test, staff in an AV vendor's virus lab will use their own virus scanner set to its maximum detection levels. Some will also use a number of virus scanners from competing vendors to increase their chances of pruning out the known viruses. Those files which are identified as known viruses by the lab's internal scanner are once again put aside from those which are still an unknown quantity and require further analysis. If they are viruses and were picked up by a competitor's scanner and not by the in-house scanner, they must be considered to be in the wild and detection needs to be added to the product represented by the lab.</p>
<p>The resulting files are then analysed for viral content, using an array of tools. Given that there are two main families of viruses seen these days, program file viruses and macro viruses, they are often sent for specialized analysis. Each file is dissected, probed, and prodded to determine just what it contains. Mike Pavluschick, a virus researcher at Kaspersky Lab in Russia, says "Within 5 seconds of looking at the source code of a macro, I can tell if it is a virus or not." Of course, one has to get a look at that source code first, before making such lightning-fast assessments.</p>
<p>To peer inside files and decipher their contents, virus labs use a range of software tools. One popular one is the IDA Pro disassembler from DataRescue in Belgium, which decomposes program files into their basic instructions, permitting virus analysts to examine the flow of code. Although to the layman the reports produced by a program such as IDA might look like so much gibberish, to the highly trained anti-virus researcher, it is easy to find the characteristics of a virus amidst the programming instructions.</p>
<p>Most anti-virus labs have also developed their own tools, some of which remain for their internal use and others which they share with other virus researchers. For example, Dmitry Gryaznov of Network Associates has developed a number of tools, including one called SCRID, which aids in the analysis of text-based viruses and worms, such as those using VBS (LoveLetter et al.). Fridrik Skulason of FRISK Software in Iceland, another long time virus researcher, has made available his program F-VBACRC, which facilitates the creation of checksums for new macro viruses.</p>
<p>Internal software tools are abundant at virus labs, performing such tasks as extracting macro source code from the wide range of macro viruses, creating detection patterns to be used in the scanning products, verifying if internal OLE structures in files are correct, comparing the macro code in one sample with a database of known macro viruses, etc. In many cases, these tools are used by the professionals to simplify their work and have grown out of the repetitive nature of virus analysis. The vast majority of viruses seen each month in the labs are derivative works of existing viruses. Only occasionally does a truly new virus come along, and these require a special treatment.</p>
<h2><a name="c2"></a>How many thousand copies did you need?</h2>
<p>Once a suspect file has been determined to contain what looks like an actual virus, it must pass a simple test - it must be able to self-replicate. There are a number of defintions of a virus, but they all come back to the same basic feature - the program must have self-replication capability. In the case of non-polymorphic viruses, it is sufficient to replicate a few copies of the virus, as each should look identical to the other. Prepared so-called "goat" files, which are "sacrificed" on the altar of research, are used to prod the virus into infecting. Each goat file has a well understood structure, which makes it easy to detect exactly how the virus infects a file and what changes it makes.</p>
<p>Goat environments are also used, with complete systems comprising of common configurations of the different versions of Windows operating systems and Microsoft Office applications, for example. Modern viruses often interact with the applications on computers, exploiting security holes in programs such as Outlook, Access, Excel, and Word. To understand the actions of these viruses, a simulated environment is needed to let the virus do its dirty work, while under constant observation. Once again, once the goat environment has been infected, careful inspection is made to determine all the actions undertaken by the virus are understood. This can be especially important in deciding what level of alert needs to be issued to customers. If the virus is fast-spreading or carries a potentially destructive payload, users need to know about it as soon as possible.</p>
<p>In the case of polymorphic viruses, thousands of samples must be replicated to ensure a proper detection pattern is created, as each infection of the virus is designed to look different from the others. Most virus labs have automatic replication routines and facilities established to provide an environment for virus files to replicate. These test beds must be returned to a pristine state after each replication exercise, to ensure that there is no cross-contamination of one virus with another. The more polymorphic the virus, the more samples must be created to ensure that all permutations are understood.</p>
<h2><a name="c3"></a>Catching the critters</h2>
<p>Having determined that a file is in fact a new virus, the next stage is to create a means of consistently detecting the virus, without triggering any false alarms on otherwise innocent files. Virus researchers such as Joe Hartmann of Trend Micro, are constantly working to improve the detection capabilities of their products. "At this point, we often use patterns rather than exact identification (such as CRC checksums). However, one of my goals is to make the Trend engine more accurate in its virus detection."</p>
<p>Once a researcher has created a virus detection pattern, it must be thoroughly tested. The replicated samples from the replication stage can be re-used for this purpose. The virus definition must be able to catch all infected samples - if one or two are missed, they will have the potential to spread undetected. The pattern is also tested against massive libraries of know clean files, in an effort to ensure that no innocent file is incorrectly identified as infected - what the virus researchers call a false positive.</p>
<p>With the virus properly analysed and understood, and a detection routine or pattern ready for customers, a description is prepared of the virus and its effects. Some labs have tools which simplify this task, providing templates for the researcher to complete, in order to ensure that the details of the virus and its effects are properly documented. At this point, the customer who submitted the virus sample is contacted with the information and the update to the detection database which can be used to remove the virus from their systems.</p>
<p>If the virus has been identified as "hot", a news release is prepared for sending to customers and to the general press. "Hot"
is the term used to describe a virus which has the potential to spread very quickly, as was the case with Melissa and LoveLetter, or to cause serious damage, as was the case with CIH. The news release will usually indicate the characteristics of the virus, how widespread it has been up to that point in time, what damage it may cause, and where to get updated protection from it. Most Anti-Virus companies have mailing lists for their customers and send the information to them at the same time as it is sent to the press. A hot virus will also warrant that the update be posted to the vendor's website immediately and that their online virus encyclopaedias will also be updated. Viruses which are not considered as likely to be of immediate concern to most users are handled in the regularly scheduled updates to both the detection and information sources.</p>
<h2><a name="c4"></a>Autopilot engaged</h2>
<p>Some vendors, such as Trend and Symantec, are hard at work on automating their processes to ensure that suspect files are collected from customers in an orderly and controlled fashion, analysed systematically and any responses (explanations and virus detection updates) returned to them within a suitable time frame. This time frame is typically described as between two and forty eight hours, depending upon such variables as the workload in the lab, the complexity of the virus, and the need to incorporate any new technology into the virus detection engine.</p>
<p>Trend has a system called TICK (Trend Internet Customer Key), which provides an automated Internet-based facility for submitting suspect files and receiving updates and answers. The TICK system relieves both customers and virus researchers from the time wasted talking on the phone. Customers can upload a suspect file to TICK, have one or more of the fifty virus researchers in Trend's Philippines labs analyse it and report back to them with a fix and description. Customers can also track the progress of their file using TICK, much as UPS customers can track their parcels being shipped. The target response times range from a few hours for a simple request for information to twenty four hours for a complex new virus or malware.</p>
<p>Symantec has been working together with IBM for several years on what they call the Immune System. IBM first presented the theory behind the Immune system in an article published in 1993. At Anti-Virus industry conferences throughout the 90s, IBM researchers presented their developing concepts, and a working prototype was eventually demonstrated in 1997. In 1998, IBM stopped work on their own Anti-Virus product and signed an agreement with Symantec, under which development of the Immune System would continue. Currently, the system is in trials with users and is expected to go live before the end of 2000.</p>
<p>The Immune System is an ambitious project, involving the most automated virus analysis system to date. Samples received from customers undergo all the processes explained above (from collecting a suspect sample on a client's machine to providing the cure), but without human intervention - the entire effort is conducted in an automated system. Only if a sample cannot be automatically handled will a human virus researcher intervene, with two goals in mind - to discover what has caused the problem and provide a manual fix, and then to improve the design of the Immune System so that it can handle the anomaly itself next time round. The stated objective of the Immune System is to respond to viruses within a few hours of their appearance, thereby reducing the chances of any major outbreaks.</p>
<p>As the number of new viruses increases, the Anti-Virus vendors will be continually investing in personnel, tools and automation to improve the speed and accuracy of their virus labs. And, chances are, by the time users are hearing about a new threat, protection is just a few mouse-clicks away.</p>
<h2><a name="c5"></a>Relevant Links</h2>
<ul>
<li><a href="http://www.av.ibm.com/ScientificPapers/White/Anatomy/anatomy.html">Anatomy of an Immune System</a>, <em>IBM AntiVirus Online</em></li>
<li><a href="http://www.av.ibm.com/ScientificPapers/Kephart/VB94/vb94.html">Automatic Extraction of Virus Signatures</a>, <em>Jeffrey O. Kephart and William C. Arnold</em></li>
<li><a href="http://www.segurasolutions.com/">More Anti-Virus Advice</a>, <em>Segura Solutions</em></li>
</ul>
<h2><a name="c6"></a>Anti-Virus Labs'Submission Links</h2>
<ul>
<li><a href="/cdn-cgi/l/email-protection#fc8a958e898fbc9f9391919d92989f9391d29f9391">Command Software</a></li>
<li><a href="/cdn-cgi/l/email-protection#0d7b647f787e4d6e6c64236e6260">Computer Associates</a></li>
<li><a href="/cdn-cgi/l/email-protection#c6b5a7abb6aaa3b586a0ebb5a3a5b3b4a3e8a5a9ab">F-Secure Corp</a></li>
<li><a href="/cdn-cgi/l/email-protection#55233c27202639343715363a382539302d7b3c26">Frisk Software</a></li>
<li><a href="/cdn-cgi/l/email-protection#5831283d2e312a2d2b182e3d2c763b373576392d">InoculateIT</a></li>
<li><a href="/cdn-cgi/l/email-protection#325c5745445b404741725344421c4047">Kaspersky Labs</a></li>
<li><a href="/cdn-cgi/l/email-protection#e89e819a9d9bb79a8d9b8d899a8b80a8868981c68b8785">Network Associates (US)</a></li>
<li><a href="/cdn-cgi/l/email-protection#dcafa9acacb3aea89cafb3acb4b3aff2bfb3b1">Sophos Plc.</a></li>
<li><a href="/cdn-cgi/l/email-protection#d4b5a2a7a1b6b9bda094a7adb9b5baa0b1b7fab7bbb9">Symantec</a></li>
<li><a href="/cdn-cgi/l/email-protection#186e716a6d6b477c777b6c776a586c6a7d767c75717b6a77367b7775">Trend Micro</a></li>
</ul>[<a style="" href="/lib/?lang=EN&amp;index=AR#arv00">Back to index</a>] [<a href="/lib/arv00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=arv00">de</a><a href="/lib/index.php?lang=en&amp;id=arv00">en</a><a href="/lib/index.php?lang=es&amp;id=arv00">es</a><a href="/lib/index.php?lang=it&amp;id=arv00">it</a><a href="/lib/index.php?lang=fr&amp;id=arv00">fr</a><a href="/lib/index.php?lang=pl&amp;id=arv00">pl</a><a href="/lib/index.php?lang=ru&amp;id=arv00">ru</a><a href="/lib/index.php?lang=ua&amp;id=arv00">ua</a></div>
<script>/* <![CDATA[ */(function(d,s,a,i,j,r,l,m,t){try{l=d.getElementsByTagName('a');t=d.createElement('textarea');for(i=0;l.length-i;i++){try{a=l[i].href;s=a.indexOf('/cdn-cgi/l/email-protection');m=a.length;if(a&&s>-1&&m>28){j=28+s;s='';if(j<m){r='0x'+a.substr(j,2)|0;for(j+=2;j<m&&a.charAt(j)!='X';j+=2)s+='%'+('0'+('0x'+a.substr(j,2)^r).toString(16)).slice(-2);j++;s=decodeURIComponent(s)+a.substr(j,m-j)}t.innerHTML=s.replace(/</g,'&lt;').replace(/\>/g,'&gt;');l[i].href='mailto:'+t.value}}catch(e){}}}catch(e){}})(document);/* ]]> */</script></body>
</html>
