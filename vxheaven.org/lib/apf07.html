<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Peter Ferrie, Péter Ször 'Cabirn fever' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Peter Ferrie, Péter Ször"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Ferrie, Peter; Ször, Péter,Cabirn fever, bluetooth, installation, device, files, phone, manager, caribe, running, mobile, message, wireless, long, mime, range, named"/>
<meta name="Description" content="It has been a long time coming, but in June 2004 the first worm arrived that spreads from mobile phone to mobile phone: SymbOS/Cabir. Fortunately, due to the fact that the worm uses a specific user-interface component, it is restricted to Series 60-based mobile phones."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"8242c5d00c565b9ffb6ef888562ca475d99170d6-1498755706-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/apf07.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Cabirn fever</h1><p><a href="/lib/?lang=en&amp;author=Ferrie%2C%20Peter">Peter Ferrie</a>, <a href="/lib/?lang=en&amp;author=Sz%C3%B6r%2C%20P%C3%A9ter">Péter Ször</a><br/> <em>Virus Bulletin, August 2004, pp.4-5</em><br/> <em>ISSN 0956-9979</em><br/> <em>August 2004</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/apf07.html';</script><div class="ci"><a href="/lib/?ci=apf07">1</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Cabirn%20fever.pdf">Download</a> PDF (36.57Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=AN#apf07">Back to index</a>] [<a href="/lib/apf07.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
Peter Ferrie and P&eacute;ter Sz&iuml;r<br/>
Symantec Security Response, USA
</address>
<p>It has been a long time coming, but in June 2004 the first worm arrived that spreads from mobile phone to mobile phone: SymbOS/Cabir. Fortunately, due to the fact that the worm uses a specific user-interface component, it is restricted to <em>Series 60</em>-based mobile phones.</p>
<h2>Bluetooth</h2>
<p>Cabir spreads using the Bluetooth wireless networking technology. The name of the technology comes from a translation of the name of the tenth century Danish king Harald Bl&aring;tand, or Bluetooth. Some say that it was Bl&aring;tand who united Denmark and Norway, and Bluetooth which unites the rest of the world. That would be for large values of `unite' or small values of `world', though, given the very limited range of Bluetooth.</p>
<h2>All SIS-tems go!</h2>
<p>Cabir arrives as a .SIS file. A .SIS file is an installation package that contains files and/or scripts, and is processed by the Installation Manager that is part of the <em>Symbian</em> operating system.</p>
<p>When the Cabir .SIS file is executed, the Installation Manager will extract and place the worm files (CARIBE.APP, FLO.MDL and CARIBE.RSC) into the `\SYSTEM\APPS\CARIBE' directory.</p>
<p>The Installation Manager also creates a file named `\SYSTEM\INSTALL\CARIBE.SIS', which contains only information about how to remove the installed application. The .SIS file is configured so that the Installation Manager will then run the extracted `CARIBE.APP' file. This application runs on the ARM series of processors.</p>
<h2>Hello world</h2>
<img src="img/apf07_fig1.jpg" align="left" alt="Infected Nokia phone"/>
<p>When the `CARIBE.APP' file is executed, it displays a message announcing its presence. The message is `Caribe-VZ/29a' in the .A variant, and `Caribe' in the .B variant. Once the user clicks `OK', the worm waits 10 seconds before proceeding.</p>
<p>Cabir begins by checking the filename of the currently running file. If the filename is not `CARIBE.APP', running from the directory C:\SYSTEM\SYMBIANSECUREDATA\CARIBESECURITYMANAGER' (note the hard-coded `C:', which is the default drive but is not always used), the worm will create that directory, and copy itself there as a file named `CARIBE.APP'.</p>
<p>The worm also copies the .rsc file to the same directory, as a file named `CARIBE.RSC'. If there is a failure during the copying of the .rsc file, the worm deletes the `CARIBE.APP' file that has just been created. Such a failure will prevent the worm from running by default, if the device is restarted.</p>
<p>Finally, the worm creates a directory named `C:\SYSTEM\RECOGS', and copies to this directory the file named `FLO.MDL'.</p>
<h2>Mimetic behaviour</h2>
<p>The `FLO.MDL' file is a MIME recogniser. MIME recognisers that are present in the `RECOGS' directory are called whenever applications are launched, and are used to prepare the environment for an application to run.</p>
<p>The `FLO.MDL' file simply runs the `CARIBE.APP' file from the `CARIBESECURITYMANAGER' directory, rather than from the `APPS' directory. This means that even if a user uninstalls the CARIBE application, the worm will continue to run. Additionally, files under the `SYMBIANSECUREDATA' directory are not visible by default to users unless File Manager is installed, which is able to show these files.</p>
<p>The more recent models of <em>Series 60</em> devices do not allow MIME recognisers to run files in directories other than the `APPS' directory.</p>
<p>After copying the necessary files, the worm creates a new .SIS file, using the .SIS file header that it carries, and the files that it has copied. This step is necessary because a .SIS file is usually deleted by the Installation Manager after an installation has completed.</p>
<h2>First contact</h2>
<p>Cabir attempts to spread using a three-stage approach. The first stage searches for Bluetooth-enabled devices, and attempts to connect to the first one that is found, regardless of the type of device (i.e. even a printer or a mouse will be attacked if they are in range).</p>
<p>The second stage sends the `CARIBE.SIS' file, and the third stage disconnects from the target device. Immediately after disconnecting from the target device, the worm runs the first stage again. The worm will connect to the same device
 
again and again, for as long as it is in range. The cycle continues for as long as the worm application is allowed to run.</p>
<p>The first-stage search for Bluetooth-enabled devices causes a significant drain on the battery of the mobile phone - however, Bluetooth support can be switched off by the user, since the worm does not switch it on (though, by default, Bluetooth support is not enabled).</p>
<h2>Click on everything</h2>
<p>Cabir requires several interactive steps on the part of the recipient in order to execute. The first step is to accept the incoming connection request from another user (this would soon become a great many requests while the two devices remain in range of each other).</p>
<p>Having accepted the request, the recipient is presented with a warning that the supplier cannot be verified. However, this warning message is displayed by any application that originates from anywhere other than <em>Symbian</em>, even if that application is signed.</p>
<p>If the recipient elects to continue anyway, a final prompt is displayed that asks whether the recipient wants to install the application. Only if this prompt is accepted will the worm be installed and executed.</p>
<h2>Flying circus</h2>
<p>Cabir introduces new problems to natural infection testing. Normally, it is sufficient to walk into a secure zone and work on an isolated network. In an attempt to test Cabir, one analyst tried to find the closest emergency evacuation bunker; another suggested running out into the middle of a deserted park with no one nearby. Although sending files through well built walls does not seem to work reliably, the wireless security of the virus labs needs to be prepared for wireless devices that use stronger signals.</p>
<p>What will be next? A mass mailer using MMS? A downloader using SMS? Ring, ring your virus is calling!</p>
<table summary="SymbOS/Cabir">
<tr><th colspan="2">SymbOS/Cabir</th></tr>
<tr><th>Size:</th><td>11,944 bytes (.A), 11,932 bytes (.B).</td></tr>
<tr><th>Type:</th><td>Mobile phone worm.</td></tr>
<tr><th>Payload:</th><td>Phone battery drained by search method.</td></tr>
<tr><th>Removal:</th><td>Delete the referenced files.</td></tr>
</table>
 
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=apf07">de</a><a href="/lib/index.php?lang=en&amp;id=apf07">en</a><a href="/lib/index.php?lang=es&amp;id=apf07">es</a><a href="/lib/index.php?lang=it&amp;id=apf07">it</a><a href="/lib/index.php?lang=fr&amp;id=apf07">fr</a><a href="/lib/index.php?lang=pl&amp;id=apf07">pl</a><a href="/lib/index.php?lang=ru&amp;id=apf07">ru</a><a href="/lib/index.php?lang=ua&amp;id=apf07">ua</a></div>
</body>
</html>
