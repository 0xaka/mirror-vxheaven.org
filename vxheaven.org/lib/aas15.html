<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Alan Solomon 'Epidemiology and computer viruses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Alan Solomon"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Solomon, Alan,Epidemiology and computer viruses, pmax, viruses, detector, virus, figures, number, system, running, software, computer, precautions, computers, infection, infected, effect"/>
<meta name="Description" content="It has been suggested in the press that computer viruses spread at an exponential rate; figures suggesting a doubling every two or three months have been suggested. These figures tend to be arrived at by fitting such a simple curve to two points, one of which is a rather arbitrary point a few years ago, when it is supposed that only one copy of one virus existed, and the other datum is an estimate of the current position.Statisticians are well aware of the danger of curve-fitting and extrapolation from two (rather shaky) numbers; furthermore the experience for biological viruses does not suggest a simple exponential curve. There is a well-researched model for epidemiological studies, and it has a strong justification."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"55ceaa3aca679d41709fd95aaecc4dc977f545cc-1498756185-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/aas15.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Epidemiology and computer viruses</h1><p><a href="/lib/?lang=en&amp;author=Solomon%2C%20Alan">Alan Solomon</a><br/> <em>S & S International</em><br/> <em> 1990</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/aas15.html';</script><div class="ci"><a href="/lib/?ci=aas15">2</a></div>[<a style="" href="/lib/?lang=EN&amp;index=EP#aas15">Back to index</a>] [<a href="/lib/aas15.html#disqus_thread">Comments</a>]<br/> 
<p>It has been suggested in the press that computer viruses spread at an exponential rate; figures suggesting a doubling every two or three months have been suggested. These figures tend to be arrived at by fitting such a simple curve to two points, one of which is a rather arbitrary point a few years ago, when it is supposed that only one copy of one virus existed, and the other datum is an estimate of the current position.</p>
<p>Statisticians are well aware of the danger of curve-fitting and extrapolation from two (rather shaky) numbers; furthermore the experience for biological viruses does not suggest a simple exponential curve. There is a well-researched model for epidemiological studies, and it has a strong justification.</p>
<p>First, let us consider the factors affecting the probability that any given computer will be infected by a given virus. There are three main influences on this probability.</p>
<ol>
<li>The percentage of currently-infected individuals.</li>
<li>The readiness with which the virus under consideration can replicate (called infectivity).</li>
<li>The degree to which the machine in question has contact with the population of computers.</li>
</ol>
<p>The percentage of currently-infected individuals depends on two factors:</p>
<ol start="4">
<li>The rate at which computers are becoming infected.</li>
<li>The length of time that they stay infected.</li>
</ol>
<p>These factors vary. Let us define them precisely. The first analysis will assume that there is only one virus - later this will be generalised.</p>
<p>The first variable, p, is the fraction of PCs that are infected with the virus. Let us also define I as the probability that a PC will become infected by "exposure" to another infected PC. Finally, D is the probability that the virus is detected. We shall assume that ince the virus is detected, it is eradicated from that system.</p>
<p>The rate of new infections is proportional to the number of infected PCs, to the number of uninfected PCs and to the probability of infection. The rate of infections being eradicated is proportional to the number of infected PCs, and to the probability of detection.</p>
<pre class="source">(1)	dp/dt = p.(1-p).I - p.D</pre>
<p>Some interesting consequences of this model are as follows. First, consider the situation of equilibrium, so that dp/dt = 0. If we plug this into equation 2, we get p = 0 (no infections, so no spreading) or p = 1 - D/I. This means that if D is greater than I, p tends to zero. A virus will die out if it is more likely to be detected, than to cause a new infection. We will call this equilibrium condition pmax = 1 - D/I.</p>
<p>This is, we think, what has happened to Brain virus. The probability of detection is very large, as it announces itself on every infected diskette by the volume label (c) Brain. Before people knew that this meant a virus, it could spread unhindered, but now that so many PC users are aware of the meaning of such a volume label, it means rapid eradication of the outbreak. We now get very few reports of Brain from most countries (India is an exception, but this is perhaps because virus awareness is a relatively recent thing there.</p>
<p>If the probability of detection is 0.1 times the probability of infection, then p tends to 1-D/I = 0.9. So a virus that is well hidden will be most successful.</p>
<pre class="source">(2)	dp = p.I - p.p.I - p.D
(3)	dt = dp/(p.(I-D-I.p))</pre>
<p>We integrate by partial fractions:</p>
<pre class="source">(4)	1 /(p.(I-D-I.p)) = A/p + B/(I-D-I.p)
(5)	= (A.(I-D-I.p) + B.p) / (p.(I-D-I.p))</pre>
<p>So A = 1/(I-D)</p>
<pre class="source">B = A.I = I/(I-D)</pre>
<p>Plugging these back into the differential equation, we get:</p>
<pre class="source">(6)	dt = (1/(I-D)).dp/p + (1/(I-D)).dp/(1-D/I-p)</pre>
<p>Using our definition of Pmax = 1 - D/I,</p>
<pre class="source">(7)	I.dt = (1/pmax).(dp/p) + (1/pmax).(dp/(pmax-p))</pre>
<p>Now we integrate:</p>
<pre class="source">(8)	Pmax.I.(t - t0) = ln p - ln (pmax - p) = ln(p/(pmax-p))
(9)	p/(pmax-p) = exp(pmax.I.(t-t0))</pre>
<p>This gives us a way to look at the situation at t = t0; then p/(pmax-p) = 1, so p = 0.5 pmax.</p>
<p>From (9), we can get</p>
<pre class="source">(10)	p = pmax.exp(pmax.I.(t-t0)) - p.exp(pmax.I.(t-t0))
(11)	p . (1 + exp(pmax.I.(t-t0)) ) = pmax . exp(pmax.I.(t-t0))
(12)	p = pmax . exp(pmax.I.(t-t0)) / (1 + exp(pmax.I.(t-t0)) )</pre>
<p>Below, figures 1 to 3 show the proportion of computers infected for I = 0.04, with D between 0.01 and 0.03. Figures 4 to 9 show the curves with I = 0.1, giving D values between 0.01 and 0.09.</p>
<p>In the more complex case of multiple viruses, it is necessary to use matrix algebra to track the infections of each virus, but the main interaction between the viruses is that when any one virus is discovered on a system, you must assume that all viruses on that system will be removed. This means that there is a weak interaction between the spread of the different viruses, but since multiple infections are still not common, this is an effect that can be ignored for the present.</p>
<p>A more important effect of multiple viruses, is on the probability of detection. It is our experience that most people take no, or else ineffective, precautions against viruses until they experience one directly. At that point, they begin to take the problem more seriously, and install one or more anti-virus systems. This has a significant impact on the probability of detection, especially if the anti-virus system is effective. Even if the anti virus system is only partially effective, there must be some viruses that it can detect, so value for D increases.</p>
<p>Thus, if one virus, has spread and been detected fairly widely, the chances of another virus spreading so widely are severly diminished.</p>
<p>We can add this to the model above, as follows. Assume that the probability of detecting a virus was D1 before, but as each computer is infected, some virus detection software is installed. Assume that the software is not perfect, and that the probability of detecting the virus is changed from D1 to D2. Then, the average probability of detecting a virus, averaged over the whole population of computers, is increased as more of the computers have had contact with a virus.</p>
<p>But, in our experience, although some precautions are taken shortly after a virus outbreak, it is often the case that these precautions fail to identify another virus for some time (outbreaks being relatively rare) and so the precautions fall into disuse. So, we can model D as being related to the number of recent outbreaks; the probability of detection is partway between the low probability (a computer not running a virus detector), and the higher probability (a computer that is running a detector), and the average probability is the average of these two, weighted by the current number of infected and uninfected computers.</p>
<p>D = p . D2 + (1-p) D1</p>
<p>So the differential equation describing the virus spread becomes:</p>
<pre class="source">(13)	dp/dt = p.(1-p).I - p.p.D2 - p.(1-p).D1 = p.(I-D1) - p.p.(I-D2-D1)</pre>
<p>Again it is useful to look at the equilibrium condition. When dp/dt = 0, either p = 0 or p = (I-D1)/(I+D2-D1). Call this situation Pmax, as before. If D1 = D2, this reduces to the same situation as before.</p>
<pre class="source">(14)	dt = dp/(p.(I-D1-p(I-D1+D2)) )</pre>
<p>Using partial fractions again, we get</p>
<pre class="source">(15)	dt = 1/(I-D1) (dp/p) + 1/(I-D1) (dp/(pmax - p))
(16)	t - t0 = 1/(I-D1).ln(p) - 1/(I-D1).ln (pmax - p)
(17)	(I-D1).(t-t0) = ln(p/(pmax-p))
(18)	p/(pmax-p) = exp(I-D1).(t-t0)
(19)	p = pmax . exp(I-D1).(t-t0) - p . exp(I-D1).(t-t0)
(20)	p = pmax . exp(I-D1).(t-t0) / (1 + exp(I-D1).(t-t0))</pre>
<p>We have repeated the runs of the previous model, using I = 0.04 and D1 = 0.01, with values for D2 set to 0.01 (the previous case), 0.1 and 0.5. It is clear how the improved early detection reduces the number of infections. This can be seen more dramatically with the other set of runs, where I = 0.1, D1 = 0.01 and values of D2 from 0.01 to 0.9 are run.</p>
<h2>Conclusions</h2>
<p>Early detection is a very effective way to reduce the incidence of viruses in a population of computers. Reducing the probability of infection would also be useful, but this requires controls over the flow of diskettes and files between the computers, and one of the major advantages of computers is their ability to communicate information. Obviously, the value of I can be reduced, but it is clear from this model that the probability of detection plays a much more crucial role in the spread of a virus. It is also noteworthy that in a situation where early detection software is installed and run for only a short time (as in these models) the number of computers infected is dramatically reduced. If the virus detector is run for a longer period of time after the virus infection, the effect would be even greater.</p>
<p>One surprising outcome of this model, is that the virus detection software does not have to be particularly effective. For example, we found that if you raise the probability of detection from 0.01 to 0.5, you get most of the benefits of running a detector. In practice, what this is saying is that it takes you a bit longer to detect the virus than an efficient detector would take, but nowhere near as long as it would if you were not running any kind of detector.</p>
<p>The Lotus spreadsheets that were used to do the calculations for the various runs of the model are available if you want to try plugging in some other assumptions into the model, or to make the model more elaborate.</p>
[<a style="" href="/lib/?lang=EN&amp;index=EP#aas15">Back to index</a>] [<a href="/lib/aas15.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=aas15">de</a><a href="/lib/index.php?lang=en&amp;id=aas15">en</a><a href="/lib/index.php?lang=es&amp;id=aas15">es</a><a href="/lib/index.php?lang=it&amp;id=aas15">it</a><a href="/lib/index.php?lang=fr&amp;id=aas15">fr</a><a href="/lib/index.php?lang=pl&amp;id=aas15">pl</a><a href="/lib/index.php?lang=ru&amp;id=aas15">ru</a><a href="/lib/index.php?lang=ua&amp;id=aas15">ua</a></div>
</body>
</html>
