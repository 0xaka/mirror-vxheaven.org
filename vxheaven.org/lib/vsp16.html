<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> SPTH 'Past, Present and Future of Batch' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="SPTH"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, SPTH,Past, Present and Future of Batch, trash, ideas, parts, situation, wrote, future, command, batxp, words, things, techniques, goals, idea, polymorphism, multi"/>
<meta name="Description" content="What is this article about and why do I write it? This may me your first questions when you see the title. Well, I'll answere you: In this article you can read my (theoretically) ideas of the future of Batch and a small view of the rached goals in the past. Why do I write it? I just want to tell everybody, who is interested in it, my ideas of the future goal and some neverdone things, because it's doubtful that I'll code much batch in future. Well, I hope that you will like my ideas and thoughts. And now go on reading more important things than this little intro. :)"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"98b749a79c8d0007381ebd17eb917667ae2b5dc1-1498756927-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vsp16.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Past, Present and Future of Batch</h1><p><a href="/lib/?lang=en&amp;author=SPTH"> SPTH</a><br/> <em>BATch Zone #5</em><br/> <em>March 2004</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vsp16.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vsp16">Back to index</a>] [<a href="/lib/vsp16.html#disqus_thread">Comments</a>]<br/> 
<h2>Index</h2>
<ol start="0">
<li>Intro Words</li>
<li>Past - Short view of the reached goals
<ol type="a">
<li>Encryption and other Anti Detections</li>
<li>Polymorphism</li>
<li>Entry Point Obscuring</li>
</ol></li>
<li>Present situation</li>
<li>Future goals
<ol type="a">
<li>Discover more of CMD.exe</li>
<li>Polymorphism
<ol type="i">
<li>Adding Trash</li>
<li>Multi-Polymorphism</li>
</ol></li>
<li>Permutation with Multi-EPO</li>
<li>Improve old techniques</li>
</ol></li>
<li>Last words</li>
</ol>
<h2>0) Intro words</h2>
<p>What is this article about and why do I write it? This may me your first questions when you see the title. Well, I'll answere you: In this article you can read my (theoretically) ideas of the future of Batch and a small view of the rached goals in the past. Why do I write it? I just want to tell everybody, who is interested in it, my ideas of the future goal and some neverdone things, because it's doubtful that I'll code much batch in future. Well, I hope that you will like my ideas and thoughts. And now go on reading more important things than this little intro. :)</p>
<h2>1) Short view of the reached goals</h2>
<p>As every virus language, also batch has it's one history. I want to give you some interesting things I found out about this topic. It could be that I forgot some things, please forgive me. :D Well, let's go.</p>
<h3>a) Encryption and other Anti Detections</h3>
<p>This technique first appeared in 2000, when Duke released his 'Advanced Batch Mutator'. Meanwhile there are other and maybe stronger ways to make the batch code unreadable. Guys like PhileT0ast3r and Alcopaul made a virus called Bat.Calvin&amp;Hobbes, which was encrypted via a vbs-file. I discovered the set-encrypten and the pseudo-trash, SAD1c made great things like including trash and hard-encryption via vbs in his BOM (2003). Also Tim Strazzere wrote a tool called BatchEncrypter, which changed the view of a batch file. Another very important technique was seen in 'Trojan.NoDelDir' by an unknown author. The technique was included to various VCKs (BOM, BWG, DM,...). Another idea found in 2003 was the EICAR-file-including, idead by Doctor Rave.</p>
<h3>b) Polymorphism</h3>
<p>Even polymorphism is much harder to create, it was done before the encryption developed. The first polymorph batch virus was written by GliTCH in 1999 (?) and was released in his article called '<a href="/lib/vgl01.html">GliTCH's Polymorphic Batch Tutorial</a>'. Even it was the first try, the thing wasn't very successful, because every generation the virus' size increases alot. Next try was my BatXP.Saturn, which used CMD.exe (Win00+) instead of command.com (Win9x). One other polymorphic virus was BatXP.Palindrom, which used permutation and variable-name changing. Another polymorphic Bath virus was SAD1c's BAT.PureFilth, Bat.Micromorph and the output of his BOM. One other guy who wrote a polymorphic batch virus was Kefi with his BatXP.on. Alcopaul also wrote an article about 'BatXP polymorphism via vbs'. PhileT0aster made a great batch morphing engine, and discovered a cool type of random number generator, which was also used in his and my Bat/BatXP.Iaafe. In 2003 rRlf anounced a contest about writing the best poly-virus which runs from Win95-WinXP. Toro won with his Bat.Tee. In 2003 even CWarrior wrote an interesting batch mutator. The last guy who joined the club of batch mutants writer was DvL with his Bat.Limitrophe.a.</p>
<h3>c) Entry Point Obscuring</h3>
<p>That technique was the last totally new major technique I know. In 2003 I wrote some ideas to DvL and forgot about them. The things came back into my mind when I read BZ#4 in 2004, where DvL wrote a something about EPO in batch. Than I sat down and tried out things and made BatXP.Nihilist, the first EPO batch virus. As this article is written short after the virus I can't say anything about the future of it.</p>
<h2>2) Present situation</h2>
<p>The present situation in batch virus writing is hard to explain. There are a couple of batch virus writers or people who write batch sometimes. I think there are 10-15 who create malware via batch. Maybe the most important thing in the current damn good situation of batch writing is DvL's BATch Zone. The situation developed, I think, in 2002/2003, because DvL started his BATch Zone Magazine, SAD1c made the best Virus Creator for Batch (Batch-O-Matic) and other guys discovered great techniques. Nowadays Batch authors want to create new, inovative stuff, and discovering new techniques. And it changes even more to BatXP, which uses WinNT/00/XP's CMD.exe. That file contains much more commands than command.com, and you can do virus-related stuff much easier. But so far there are many undiscovered commands, so we don't know what future could bring to us...</p>
<h2>3) Future goals</h2>
<h3>a) Discover more of CMD.exe</h3>
<p>In my opinion, CMD.exe could be the only future of batch, because old command.com is just used by old OSes like Win95/98/Me(?). Command.com was the battle-field of batch-viruses for years (since Ralf Burger's first batch virus in 1987). Moreover it's intelligent to use the new field, because it allows great virus-related stuff, which weren't possible or which were not as easy to make in command.com. I'm talking about techniques like infection all files at the HD, easy polymorphism, EPO, net spreading (not done yet?). I know that there will be more great techniques which hasn't been done with command.com.</p>
<h3>b) Polymorphism</h3>
<h4>i) Adding Trash</h4>
<p>This is another polymorphism technique, which is possible to do. I got the idea when I saw PhileT0ast3r's Mutanting Engine. It should be easy to write any silly commands to the code:</p>
<pre>
	trash
	command1
	command2
	trash
	trash
	command3
	trash
	command4
	trash
	...
</pre>
<h4>ii) Multi-Polymorphism</h4>
<p>So far there are 2 different types of already discovere pure-batch polymorphism: Permutation and Variable-Name Changing (which are already combined). After discovering also the 3rd type (Adding Trash), it would be of much value to combine these three. This is a sample of the file, how does it look like:</p>
<div class="dos" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">AAAA</span><span style="color: #33cc33;">%</span>... \ &nbsp; &nbsp; &nbsp; &nbsp; trash<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">AAAA</span><span style="color: #33cc33;">%</span>... &nbsp;\ &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">Bhsk</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">BBBB</span><span style="color: #33cc33;">%</span>... &nbsp; \ &nbsp; &nbsp; &nbsp; <span style="color: #33cc33;">%</span><span style="color: #448888;">Bhsk</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">BBBB</span><span style="color: #33cc33;">%</span>... &nbsp; &nbsp;\__\ &nbsp; trash<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">CCCC</span><span style="color: #33cc33;">%</span>... &nbsp; &nbsp;/ &nbsp;/ &nbsp; <span style="color: #33cc33;">%</span><span style="color: #448888;">Cooq</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">CCCC</span><span style="color: #33cc33;">%</span>... &nbsp; / &nbsp; &nbsp; &nbsp; <span style="color: #33cc33;">%</span><span style="color: #448888;">Cooq</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">DDDD</span><span style="color: #33cc33;">%</span>... &nbsp;/ &nbsp; &nbsp; &nbsp; &nbsp;trash<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">DDDD</span><span style="color: #33cc33;">%</span>... / &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #33cc33;">%</span><span style="color: #448888;">Doej</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">Doej</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;trash<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">Arrs</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #33cc33;">%</span><span style="color: #448888;">Arrs</span><span style="color: #33cc33;">%</span>...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;trash<br/>
&nbsp;</div>
<h3>c) Permutation with Multi-EPO</h3>
<p>This strange combination could be the best technique in batch ever ideat. I got the idea by jackie, who told me that this could be a great technique for JavaScript. As I think, it's also possible in Batch, I wanted to write this idea here. I'll show you the idea via pseudo-code:</p>
<pre class="source">
        Uninfected File   +       Virus          =          Infected File
         ____________             __________            _________
        |    com A   |           |  %VIR A% |          | com A   |
        |    com B   |           |  %VIR B% |          | %VIR C% |
        |    com C   |    |      |  %VIR C% |  _______ | com B   |
        |    com D   | ___|___   |  %VIR D% |          | %VIR D% |
        |    com E   |    |      |__________|  _______ | com C   |
        |    com F   |    |                            | com D   |
        |____________|                                 | %VIR A% |
                                                       | com E   |
                                                       | %VIR B% |
                                                       | com F   |
                                                       |_________|
</pre>
<p>The virus splits into n parts, and then put the n parts in any order between the victim file. The different parts are joined by goto &amp; lables. To run the virus first in file you include a goto infront of the real code to the first virus part. I'm sure it will be much work, but remember: 2-hours viruses are nonsence. :D</p>
<h3>d) Improve old techniques</h3>
<p>There are many techniques, which aren't perfect so far. Examples are the EPO, Polymorphism - Variable Name changing, Encryption (however which type). As you can see, there are still many things, which could be improved. Maybe also techniques like Multi-OSing (Win95-WinXP runable virus) are not perfect so far. I don't think of viruses, that uses the same commands for every OS, but a virus, which uses different codes for CMD.exe and command.com (like PhileT0ast3r's and my Bat/BatXP.Iaafe).</p>
<h2>4) Last words</h2>
<p>Comming to an end I want to say that I'm happy that I wrote these ideas and thoughts down, because I don't if I can finish it (I've many other projects: CTG, MenuetOS, PEs, ...). It's also a new challange for everybody who is interested in batch, and who thinks that (s)he is able to show new great stuff. I'm sure that guys like PhileT0ast3r, Kefi, DvL or Alcopaul are able to do it. As there are damn much information around about batch and BatchXP, it shouldn't be as hard as you may think. I would be happy if I can see some of my ideas brought to reality new few month, otherwise I know that I did everything batch related for nothing. For me it's most important to see that I could help any other virus writer with my codes and ideas. And the only way you can show me that is to bring these ideas to batch code. :)</p>
<p>I hope that you don't hate me now because it's a 100% theoretically article, but in my opinion getting new ideas is at least as important as code this ideas. It would also be damn happy if I could read some other articles about new ideas very soon. As you can see I just collected a few ideas about 'Fake AV' ways. Maybe anybody else could make the same about new spreading ways of batch. Well that's more than enough (and even more than I wanted to write :D), see you out there soon...</p>
<pre>
                                                        - - - - - - - - - - - - - - -
                                                          Second Part To Hell/[rRlf]  
                                                          www.spth.de.vu
                                                          <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="9ae9eaeef2daeae8f3ffe9eeb4fbee">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
                                                          written in march 2004
                                                          Austria
                                                        - - - - - - - - - - - - - - - </pre>
<p>PS: Some parts of this article were written at 3am, some parts at school and the last part in a church nearby my school :) shit ... I think the priest is comming ... I've to run away...</p>
[<a style="" href="/lib/?lang=EN&amp;index=MA#vsp16">Back to index</a>] [<a href="/lib/vsp16.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vsp16">de</a><a href="/lib/index.php?lang=en&amp;id=vsp16">en</a><a href="/lib/index.php?lang=es&amp;id=vsp16">es</a><a href="/lib/index.php?lang=it&amp;id=vsp16">it</a><a href="/lib/index.php?lang=fr&amp;id=vsp16">fr</a><a href="/lib/index.php?lang=pl&amp;id=vsp16">pl</a><a href="/lib/index.php?lang=ru&amp;id=vsp16">ru</a><a href="/lib/index.php?lang=ua&amp;id=vsp16">ua</a></div>
</body>
</html>
