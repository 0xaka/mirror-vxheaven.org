<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Robert Slade 'Viral code "association"' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Robert Slade"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Slade, Robert,Viral code &quot;association&quot;, files, file, original, program, detection, names, viral, change, precedence, programs, "/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"f8cbf41be24021655bb66527764e80f4468a4707-1498757409-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/ars05.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Viral code "association"</h1><p><a href="/lib/?lang=en&amp;author=Slade%2C%20Robert">Robert Slade</a><br/> <em>http://www.textfiles.com/virus/funpiv4.cvp</em><br/> <em>October 1991</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/ars05.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=AV#ars05">Back to index</a>] [<a href="/lib/ars05.html#disqus_thread">Comments</a>]<br/> 
<p>The simplest way for a viral program to avoid the detection that results from modifying the code of an existing program is not to modify the original program. This is an elementary solution, but would seem to have the drawback that, unless you do change the file in some way, the virus will never be called.</p>
<p>There is a "solution" to this problem, and (if I may be allowed some enthusiasm for the concept, if not the reprehensible act) a rather elegant one at that.</p>
<p>In a given situation, computers may be presented with a number of possible courses of action. The action taken first is decided by pre-programmed precedence. A number of programs may have very similar names, leading to potential confusion about which one is to be run in a given invocation. In the case of MS-DOS, for example, SET.COM, SET.EXE and SET.BAT are all "executable" files. In the normal course of events, any one could be invoked by giving the command "SET". If all three files exist, which one is to be run?</p>
<p>The precedence of program invocation under MS-DOS is that .COM files are first, .EXE second and .BAT last. If three files of the same name do exist, this does not imply that all three will be run in that sequence, but rather that giving the command "SET" will always invoke only the SET.COM file.</p>
<p>A certain class of viral programs; known variously as "companion", "spawning" or "precedence" viri; use this feature of the operating system. They "infect" a file with an .EXE extension simply by creating another file with the same name, but a .COM extension. Thus the .COM file is always executed in place of the original .EXE file. The original file remains unchanged, and no manner of "change detection" will tell you any different. (In order to further avoid detection the viral file will generally end with a very specific "call" to the original program, and the viral program has the "hidden" attribute set. In the Macintosh and other GUI operating systems, it is possible for a virus to take precendence by "overlaying" an existing icon with another which is either transparent or identical to the first.)</p>
<p>Fortunately, companion viri are by no means perfect. For one thing, they are limited to those programs which are "lower" in the order of precedence. For another, the "hidden" attribute is relatively easy to overcome (particularly in MS-DOS), and an alphabetical listing of files will quickly turn up the anomaly of identical names. Of the antiviral packages tested so far, no change detector alerts to duplicate names, although many may alert the user by asking the user to "validate" a file that has been in use for some time. It will probably not be long, however, before this is a common feature.</p>
<p><em>copyright Robert M. Slade, 1991 FUNPIV4.CVP 911020</em></p>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=ars05">de</a><a href="/lib/index.php?lang=en&amp;id=ars05">en</a><a href="/lib/index.php?lang=es&amp;id=ars05">es</a><a href="/lib/index.php?lang=it&amp;id=ars05">it</a><a href="/lib/index.php?lang=fr&amp;id=ars05">fr</a><a href="/lib/index.php?lang=pl&amp;id=ars05">pl</a><a href="/lib/index.php?lang=ru&amp;id=ars05">ru</a><a href="/lib/index.php?lang=ua&amp;id=ars05">ua</a></div>
</body>
</html>
