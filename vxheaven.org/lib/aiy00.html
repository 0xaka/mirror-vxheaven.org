<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>InSeon Yoo 'Visualizing Windows Executable Viruses Using Self-Organizing Maps' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="InSeon Yoo"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Yoo, InSeon,Visualizing Windows Executable Viruses Using Self-Organizing Maps, virus, vector, code, mapping, quantization, colour, table, viruses, boza, files, weight, mask, polymorphic, variables, semisoft"/>
<meta name="Description" content="This paper concentrates on visualizing computer viruses without using virus specific signature information as a prior stage of the very important problem of detecting computer viruses. In this paper, we address the fact that each viruses have its own character to be distinguished although it is inserted in the executable file. They cannot hide their own feature through the SOM visualization; this feature is like a DNA to determine an individual's unique genetic code. We present how virus codes affect the whole program projection. Without each virus signature, we present how the virus pattern in Windows executable files tells us their family. We show that the variant of each virus also can be covered with each virus mask, which is produced by SOM. We also present the file structure based SOMs of Windows executable files."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"619d5eaf5f59bdb650ddbb088a924ccbdbcf6409-1498757539-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/aiy00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Visualizing Windows Executable Viruses Using Self-Organizing Maps</h1><p><a href="/lib/?lang=en&amp;author=Yoo%2C%20InSeon">InSeon Yoo</a><br/> <em>Proceedings of the 2004 ACM workshop on Visualization and data mining for computer security, pp.82-89</em><br/> <em>ISBN 1-58113-974-8</em><br/> <em>October 2004</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/aiy00.html';</script><div class="ci"><a href="/lib/?ci=aiy00">1</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Visualizing%20Windows%20Executable%20Viruses%20Using%20Self-Organizing%20Maps.pdf">Download</a> PDF (531.02Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=AT#aiy00">Back to index</a>] [<a href="/lib/aiy00.html#disqus_thread">Comments</a>]<br/> 
<p><small>Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. To copy otherwise, to republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee.</small></p>
<p><em>VizSEC/DMSEC'04</em>, October 29, 2004, Washington, DC, USA. Copyright 2004 ACM 1-58113-974-8/04/0010 ...$5.00.</p>
<address>
Telecommunications, Networks and Security Research Group,<br/>
Department of Informatics, University of Fribourg,<br/>
CH-1700 Fribourg, Switzerland.<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="5f3631722c3a3031712630301f2a3136392d713c37">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</address>
<h2>Abstract</h2>
<p>This paper concentrates on visualizing computer viruses without using virus specific signature information as a prior stage of the very important problem of detecting computer viruses. In this paper, we address the fact that each viruses have its own character to be distinguished although it is inserted in the executable file. They cannot hide their own feature through the SOM visualization; this feature is like a DNA to determine an individual's unique genetic code. We present how virus codes affect the whole program projection. Without each virus signature, we present how the virus pattern in Windows executable files tells us their family. We show that the variant of each virus also can be covered with each virus mask, which is produced by SOM. We also present the file structure based SOMs of Windows executable files.</p>
<h3>Categories and Subject Descriptors</h3>
<p>K.6.5 [<strong>Management of Computing and Information Systems</strong>]: Security and Protection - <em>Invasive software</em>; I.2.6 [<strong>Artificial Intelligence</strong>]: Learning - <em>Connectionism and neural nets</em>; I.5.2 [<strong>Pattern Recognition</strong>]: Design Methodology - <em>Pattern analysis</em></p>
<h3>General Terms</h3>
<p>Security</p>
<h3>Keywords</h3>
<p>Visualization, Windows Executable Viruses, Self-Organizing Maps</p>
<h2>1. Introduction</h2>
<p>The classic virus-detection techniques look for the presence of a virus-specific sequence of instructions, called a virus signature, inside the program: if the signature is found, it is highly probable that the program is infected. For example, the Win95.CIH (Chernobyl) virus is detected by checking for the hexadecimal sequence like following [7]:</p>
<pre class="source">
	E800 0000 005B 8D4B 4251 5050
	0F01 4C24 FE5B 83C3 1CFA 8B2B
</pre>
<p>We aim to design the SOM in a way that neurons will flag the presence of peculiar patterns in Windows executable files and that the position of the active neurons will reflect the position of potentially malicious content in the file. We expect that we can find a similar pattern in files infected by viruses of the same family. Although anti-virus software needs to detect variants of each virus with different virus signature, our approach shows us that each virus family has a virus mask<sup><a href="#f1" name="b1">1</a></sup> like a DNA. We will present how virus codes affect the SOM projection of the whole Windows executable program and show the results of considering several Windows viruses in this paper.</p>
<h2>2. Background of self-organizing map</h2>
<p>Self-Organizing Map (SOM) [2] is an unsupervised neural network method which has properties of both vector quantization and vector projection algorithms. A SOM consists of neurons organized on a regular low-dimensional grid (Figure 1). Each neuron is a <em>d</em>-dimensional weight vector (prototype vector, codebook vector) where <em>d</em> is equal to the dimension of the input vectors. The neurons are connected to adjacent neurons by a neighbourhood relation, which dictates the topology, or structure, of the map.</p>
<p>The SOM training algorithm includes the best-matching weight vector, and its topological neighbours on the map, which are updated: the region around the best-matching vector is stretched towards the presented training sample. The end result is that the neurons on the grid become ordered: neighbouring neurons have similar weight vectors. In the traditional sequential training, samples are presented to the map one at a time, and the algorithm gradually moves the weight vectors towards them. In the batch training, the data set is presented to the SOM as a whole, and the new weight vectors are weighted averages of the data vectors.</p>
<div align="center">
<img src="img/aiy/img1.gif" alt="Figure 1: Discrete neighbourhood (size 0, 1, and 2) of the centermost unit"/>
<p><strong>Figure 1: Discrete neighbourhood (size 0, 1, and 2) of the centermost unit:(a) hexagonal lattice, (b) rectangular lattice. The innermost polygon corresponds to 0-neighbourhood, the second to the 1-neighbourhood and the biggest to the 2-neighbourhood.</strong></p>
</div>
<h3>2.1 Data Analysis Using SOM</h3>
<p>SOM combines vector quantization and vector projection. The goal of SOM is to create a topologically ordered mapping of the data in the sense of a discredited principal surface or curve.</p>
<h4>2.1.1 Quantization</h4>
<p>The SOM has properties of both vector quantization and vector projection algorithms. The quantization from the <em>N</em> training samples to <em>M</em> prototypes reduces the original data set to a smaller, but still representative, set to work with. Further analysis is performed primarily, or at least initially using the prototype vectors instead of all of the data. Using the reduced data set is only valid if it really is representative of the original data. When the number of prototypes approaches infinity and neighbourhood width is very large, numerical experiments have shown that the results are relatively accurate even for a small number of prototypes [3]. While the connection between the density of prototypes of SOM and the input data has not been derived in the general case, it can be assumed that the SOM roughly follows the density of the training data.</p>
<h4>2.1.2 Projection</h4>
<p>To be able to visualize the prototypes efficiently, vector projection is needed. Together the set of prototype vectors and their projections form a low-dimensional map of the data manifold. Since the prototype vectors of the SOM have well-defined positions on the low-dimensional map grid, the SOM is a kind of vector projection algorithm. The projection of a data sample can be defined to be the index <em>b</em> or location <em>r<sub>b</sub></em> of its BMU (the best matching unit) on the map grid. As a projection algorithm, SOM has an important advantage over many other methods. The topological ordering of map units depends primarily on the local neighbourhood, which is defined on the map grid. Since there are more map units where data density is high, the neighbourhood in these areas becomes smaller as measured in the input space. Thus, the projection tunes to local data density.</p>
<h2>3. Windows executable file structure &amp; virus location</h2>
<div align="center">
<img src="img/aiy/img2.gif" alt="Figure 2: Virus positions in New EXE file"/>
<p><strong>Figure 2: Virus positions in New EXE file.</strong></p>
</div>
<p>The most common method of virus infection is by appending the virus to the end of file. In this process the virus changes the top of the file in such a way that the virus code is executed first. This kind of appending is simple and usually effective. The virus writer does not need to know anything about the program to which the virus will append and the appended program simply serves as a carrier for the virus [6].</p>
<div align="center">
<img src="img/aiy/img3.gif" alt="Figure 3: Windows Executable file: DOS Stub and PE header part"/>
<p><strong>Figure 3: Windows Executable file: DOS Stub and PE header part</strong></p>
</div>
<p>In the Windows executables (NewEXE - NE, PE, LE, LX), the fields in the NewEXE header are changed and the virus code is appending to the end of the program code. The structure of this header is much more complicated and there are more fields to be changed; the starting address, the number of sections in the file, properties of the sections etc. In addition to that, before infection, the size of the file may increase to a multiple of one paragraph (16 bytes) in DOS or to a section in Windows. The size of the section depends on the properties of the EXE file header. Figure 2 shows this case.</p>
<p>According to these 4 different areas in virus-infected files, we worked out to train SOMs. The real data of the virus-infected file is like in Figure 3 and Figure 4. In these figures, the location part is counted by octal numbering. When we examined several virus-infected files, most files have the same size of DOS stub (say, 128 bytes), and the other parts are flexible. In addition, apart from virus code, only PE header part is filled with quite similar pattern, which contains text, data, source and relocation.</p>
<div align="center">
<img src="img/aiy/img4.gif" alt="Figure 4: Windows Executable file: Program Code &amp; Data and Virus position."/>
<p><strong>Figure 4: Windows Executable file: Program Code &amp; Data and Virus position.</strong></p>
</div>
<p>Furthermore, the program code &amp; data part is filled with encrypted characters which are made by certain compilers. However, from virus code part, the characters look quite different from original program codes. As we examine like in Figure 3 and Figure 4, virus part character feature is different from the other program codes, which means that once program codes were compiled, the virus code were inserted by force. Since we have found these differences, we attempted to label each part, such as DS for the DOS stub, PE for the NewEXE header, PR for the program code &amp; data, and VS for the virus code, to see which part is displayed differently by SOMs. After training and testing several virus-infected files, we have strong confidence that this virus part is inserted by force, and this virus code should have different code scheme compared with original program code, since the original code is compiled by a certain compiler. [Table 1] is our test data file information. As you see [Table 1], most of files have the same DOS stub size.</p>
<table summary="Table 1: location starting point information of Test files (Unit: bytes)">
<tr><th>Virus file</th><th>PE</th><th>PR</th><th>VS</th></tr>
<tr><td>Win95.CIH Ver 1.2</td><td>128</td><td>576</td><td>11632</td></tr>
<tr><td>Win95.CIH Ver 1.3</td><td>128</td><td>624</td><td>14256</td></tr>
<tr><td>Win95.CIH Ver 1.4</td><td>128</td><td>576</td><td>1968</td></tr>
<tr><td>Win95.Boza.A</td><td>128</td><td>1024</td><td>2016</td></tr>
<tr><td>Win95.Boza.C</td><td>256</td><td>1536</td><td>3072</td></tr>
<tr><td>Win32.Apparition</td><td>128</td><td>1024</td><td>38912</td></tr>
<tr><td>Win32.HLLP.Semisoft</td><td>128</td><td>1024</td><td>41360</td></tr>
</table>
<p><strong>Table 1: location starting point information of Test files (Unit: bytes)</strong><br/>Note. DOS stub always starts from 0000. PE : PE header, PR: Program Code &amp; Data, VS: Virus Code</p>
<p>Viruses are called polymorphic if they cannot, or can but with great difficulty be detected using the virus signature. This is achieved by two main ways. The first is by encrypting the main code of the virus with non-constant key with random sets of decryption commands, the second is by changing the executable virus code. Polymorphic viruses exist of all kinds from boot and file, even macro viruses. In this paper, we are not dealing with these polymorphic viruses separately, because these polymorphic viruses can be included in parasitic viruses or macro viruses. Especially, changing executable codes is mostly by macro viruses, which randomly change the names of their variables, insert empty lines or change their codes in some other ways while making copies of themselves. Therefore the operating algorithm of a virus remains unchanged, but the virus code changes virtually completely from one infection to another.</p>
<p>We assume polymorphic and metamorphic viruses are somehow inserted in the executable files. Thus their figures, whether they are encrypted or not, are also distinguished compared with the other program codes.</p>
<h2>4. Visualizing Windows executable viruses</h2>
<p>To train and visualize SOMs from virus-infected files, we use SOM Toolbox 2.0 [1], a software library for MATLAB 5.3 [4]. The projection is that the originally high-dimensional reference vector space is compressed into two dimensions, making the visualization of the data possible. Unified distance matrix (u-matrix), is a method of displaying SOMs. It represents the map as a regular grid of neurons. The size and topology of the map can readily be observed from the picture where each element represents a neuron. First, when generating a u-matrix, a distance matrix between the reference vectors of adjacent neurons of two-dimensional map is formed. Then, some representation for the matrix is selected, e.g., a grey-level image. The colours in the figure have been selected so that in the black/white printout, the darker the colour between two neurons is, the closer is the relative distance between them. (In colour printout, blue colour part means closeness of distance between two neurons.) In addition, labelling is used to categorize the units or some units by giving them names. We use several Windows executable files to test. [Table 2] is the file information.</p>
<table summary="Table 2: Test file information (Unit: Bytes)">
<tr><th>variants of the virus</th><th>file size</th></tr>
<tr><td>Before infection by CIH1.2</td><td>11,632</td></tr>
<tr><td>Before infection by CIH1.3</td><td>14,256</td></tr>
<tr><td>Before infection by CIH1.4</td><td>1,968</td></tr>
<tr><td>Win95.CIH Ver 1.2</td><td>19,536</td></tr>
<tr><td>Win95.CIH Ver 1.3</td><td>36,864</td></tr>
<tr><td>Win95.CIH Ver 1.4</td><td>4,608</td></tr>
<tr><td>Before infection by Win95.Boza.A</td><td>2,016</td></tr>
<tr><td>Before infection by Win95.Boza.C</td><td>3,072</td></tr>
<tr><td>Win95.Boza.A</td><td>12,408</td></tr>
<tr><td>Win95.Boza.C</td><td>16,384</td></tr>
<tr><td>Before infection by Win32.Apparition</td><td>38,912</td></tr>
<tr><td>Win32.Apparition</td><td>96,239</td></tr>
<tr><td>Before infection by Win32.HLLP.Semisoft</td><td>41,360</td></tr>
<tr><td>Win32.HLLP.Semisoft</td><td>59,904</td></tr>
</table>
<p><strong>Table 2: Test file information (Unit: Bytes)</strong></p>
<h3>4.1 Data Format For Training SOM</h3>
<p>To train SOMs, we make our data like a table. Each row of the table is one data sample. The columns of the table are the variables of the data set. The items on the row are the variables, or components, of the data set (Figure 5). The variables might be the properties of an object, or a set of measurements measured at a specific time. Every sample has the same set of variables. Thus each column of the table holds all values for one variable.</p>
<div align="center">
<img src="img/aiy/img5.gif" alt="Figure 5: Table-format data: there can be any number of samples, but all samples have fixed length, and consist of the sample variables."/>
<p><strong>Figure 5: Table-format data: there can be any number of samples, but all samples have fixed length, and consist of the sample variables.</strong></p>
</div>
<p>To match this table structure, we transformed binary format of virus-infected files with each 4 bytes for each column variables, e.g. each sample contains 32 bytes of virus-infected files. In addition, to deal with binary data efficiently, we converted all data into unsigned integer format. So through SOM normalization, this integer data can be normalized between 0 and 1.</p>
<h3>4.2 Case Example : Win95 CIH Virus</h3>
<p>The Win95.CIH (Chernobyl) [5] is a Windows95/98/NT specific parasitic virus infecting Windows PE (Portable Executable) files, about 1Kbyte of length. There are three original virus versions (1.2, 1.3 and 1.4) known, which are very closely related and only differ in few parts of their code. They have different lengths, texts inside the virus code and trigger date.</p>
<div align="center">
<img src="img/aiy/img6.gif" alt="Figure 6: SOMs of Windows EXE files before Win95.CIH virus infection."/>
<p><strong>Figure 6: SOMs of Windows EXE files before Win95.CIH virus infection.</strong></p>
</div>
<div align="center">
<img src="img/aiy/img7.gif" alt="Figure 7: SOMs of NEW EXE files infected by Win95.CIH viruses."/>
<p><strong>Figure 7: SOMs of NEW EXE files infected by Win95.CIH viruses.</strong></p>
</div>
<p>Figure 6 shows the test Windows executable files before Win95.CIH virus infected. As you can see all the SOM of the test Windows executable files are different from each other. Figure 7 shows the trained SOMs of Win95.CIH 1.2, 1.3 and 1.4 infected test Windows executable files. Each Win95.CIH (Chernobyl) virus has obvious location (the upper of centre) of lower degree of weight data<sup><a href="#f2" name="b2">2</a></sup>. Although each Windows executable file is different, the SOM projection of CIH virus-infected files look similar and have same sort of projection map. We could call this similar sort of figure in each virus as a virus mask. Hence, this can be called CIH virus mask. Anti-virus software needs to detect this Win95.CIH virus with different virus signature in each version. However, our approach tells us that these are same family like having a same DNA.</p>
<div align="center">
<img src="img/aiy/img8.gif" alt="Figure 8: Virus Distribution of CIH 1.2, 1.3, and 1.4 virus."/>
<p><strong>Figure 8: Virus Distribution of CIH 1.2, 1.3, and 1.4 virus.</strong></p>
</div>
<p>To check that the upper centre part is filled with the CIH virus code, we trained the SOM with label which categorized by given name which we gave according to the [Table 1]. We made [Table 1] based on the file structure and when we made the data set, we put the label on each column. The result of the projection with labels is like in Figure 8. This projection is based on the labels, therefore, the whole figure (Figure 8) is different from previous figures (Figure 7).</p>
<p>We add round signs in each area e.g. DS (DOS stub), PE (New EXE Header), VS (Virus Code) area except PR (Program Code &amp; Data) area. Since PR (Program Code &amp; Data) area is been big enough, we do not need to make a distinguished round for this. As Figure 8 is shown, there are two part has smaller distances than the other parts, e.g., PE and VS. This tells us that PE and VS includes smaller likelihood in their code. Even if PE also has smaller distance between two neurons, VS has major of dark colour in black/white printout, (or blue colour in colour printout).</p>
<h3>4.3 Case Example : Win95 Boza Virus</h3>
<p>Win95 Boza virus is the first known virus infecting Windows Portable Executable (PE) files, such files are used by Windows 95 and Windows NT. However, Boza does not infect machines running the Microsoft Windows NT operating system. Boza's spreading technique resembles some of the early DOS viruses. When the first DOS viruses were found in 1980's, they were very simple compared to some of the currently known polymorphic multipartite fast infecting stealth viruses. However, it is not a dangerous parasitic NewEXE (PE) virus. It searches for EXE files, checks the files for PE signature, then creates new section named ".vlad", and writes its code into that section.</p>
<p>We trained two different Boza virus files. Figure 9 shows us the Boza virus mask. In addition, the lighter the colour between two neurons is, the smaller is the relative distance between them. We assume that the major of lighter colour in the upper centre has virus codes. To check and prove this, we made another projection with labels like in Figure 10. As we expected, the major of smaller likelihood part is the Boza virus code. Although NewEXE header code also has smaller likelihood, it does not change the majority.</p>
<div align="center">
<img src="img/aiy/img9.gif" alt="Figure 9: SOMs of Win95 Boza.A and Boza.C viruses."/>
<p><strong>Figure 9: SOMs of Win95 Boza.A and Boza.C viruses.</strong></p>
</div>
<h3>4.4 Case Example : Other Viruses</h3>
<h4>4.4.1 Win32.Apparition</h4>
<p>This is a memory resident Windows32 (Windows95/NT) parasitic infector. The virus has a very unusual structure. The main part (about 60K) is the virus code (virus routines and C runtime library), text strings, icon and other data used by the virus while installing and spreading. The next block (3.5K) contains a packed (with LZ method) MS Word template - Word macro virus. The third block (21K) contains packed (by LZ) virus source code. And the last block (3K) contains resources file that is used when the virus runs Borland C compiler.</p>
<div align="center">
<img src="img/aiy/img10.gif" alt="Figure 10: Virus Distribution of Boza.A and Boza.C viruses."/>
<p><strong>Figure 10: Virus Distribution of Boza.A and Boza.C viruses.</strong></p>
</div>
<div align="center">
<img src="img/aiy/img11.gif" alt="Figure 11: SOMs of Win NT apparition virus and its distribution."/>
<p><strong>Figure 11: SOMs of Win NT apparition virus and its distribution.</strong></p>
</div>
<p>As we looked the previous virus SOMs, this SOM also has the Win32.apparition virus mask. Figure 11 shows the projection of Win32.apparition virus and the other projection with label for the distribution. In addition, since this virus code part has unusual structure, the distribution itself causes VS part is quite similar with the PR parts. Nevertheless, the major of the smaller likelihood part is virus code.</p>
<h4>4.4.2 Win32.HLLP.Semisoft</h4>
<p>Win32.HLLP.Semisoft virus is an unusual file infector which infects files under Windows 95 and Windows NT. The virus creates these 59,904 byte files in the WINDOWS directory: WINIPX.EXE, WINIPXA.EXE, WINSRVC.EXE, and EXPLORE.EXE. The virus infects other EXE files as they are executed once the virus is loaded into memory. The virus depends on a network card being installed to work fully. The virus may have been intended as a prototype of a "spy" program that would intercept information and send this out via a TCP/IP connection. A task "6.666" interferes with normal shutdown. The infected files all have a Notepad Icon when they are visible in Explorer.</p>
<div align="center">
<img src="img/aiy/img12.gif" alt="Figure 12: SOMs of Win32 HLLP.Semisoft virus and its distribution."/>
<p><strong>Figure 12: SOMs of Win32 HLLP.Semisoft virus and its distribution.</strong></p>
</div>
<table summary="Table 3: SOM Result of test files">
<tr><th>&nbsp;</th><th>CIH1.2</th><th>CIH1.3</th><th>CIH1.4</th><th>Boza.A</th><th>Boza.C</th><th>apparition</th><th>HLLP.Semisoft</th></tr>
<tr><th>Quantization error</th><td>0.393</td><td>0.393</td><td>0.393</td><td>0.206</td><td>0.377</td><td>0.445</td><td>0.461</td></tr>
<tr><th>Topographic error</th><td>0.055</td><td>0.050</td><td>0.050</td><td>0.041</td><td>0.015</td><td>0.108</td><td>0.127</td></tr>
<tr><th>Error Percentage</th><td>14.6764</td><td>20.6107</td><td>20.6107</td><td>13.5314</td><td>29.3233</td><td>10.2605</td><td>28.9616</td></tr>
</table>
<p>Figure 12 shows the projection of Win32.HLLP.Semisoft virus and the other projection with label for the distribution. As we looked the previous virus SOMs, this SOM also has the Win32.HLLP.Semisoft virus mask and the major of the smaller likelihood part is virus code.</p>
<h3>4.5 Summary of Experiments: Map Quality Measures</h3>
<p>After the SOM has been trained, it is important to know whether it has properly adapted itself to the training data. Because it is obvious that one optimal map for the given input data must exist, several map quality measures have been proposed. Usually, the quality of the SOM is evaluated based on the mapping precision and the topology preservation.</p>
<h4>4.5.1 Mapping Precision</h4>
<p>The mapping precision measure describes how accurately the neurons respond to the given data set. For example, if the reference vector of the BMU calculated for a given testing vector <em>x<sub>i</sub></em> is exactly the same <em>x<sub>i</sub></em>, the error in precision is then 0. Normally, the number of data vectors exceeds the number of neurons and the precision error is thus always different from 0.</p>
<p>A common measure that calculates the precision of the mapping is the average quantization error over the entire data set:</p>
<pre>
              1  <em>n</em>
	<em>E<sub>q</sub></em> = --- &sum; ||<em>x<sub>i</sub></em> + <em>m<sub>c</sub></em>||
              <em>N</em>  <em>i=1</em>
</pre>
<p>Where, <em>x</em> is a sample vector and <em>m</em> is a reference vector.</p>
<h4>4.5.2 Topology Preservation</h4>
<p>The topology preservation measure describes how well the SOM preserves the topology of the studied data set. Unlike the mapping precision measure, it considers the structure of the map. For a strangely twisted map, the topographic error is big even if the mapping precision error is small. A simple method for calculating the topographic error:</p>
<pre>
              1  <em>n</em>
	<em>E<sub>t</sub></em> = --- &sum; <em>u(x<sub>k</sub>)</em>
	      <em>N</em>  <em>k=1</em>
</pre>
<p>Where, <em>u(x<sub>k</sub>)</em> is 1 if the first and second BMUs of <em>x<sub>k</sub></em> are not next to each other. Otherwise <em>u(x<sub>k</sub>)</em> is 0.</p>
<p>[Table 3] summarizes error ratios of our test virus files. There are three items in the Table, a quantization error is for mapping precision, a topographic error is for topology preservation, and error percentage is for the label error per distance (similarity). The lower quantization error is, the more exact the neuron responds. In addition, the lower topographic error is, the better the SOM preserves the topology.</p>
<p>Although there are variants of the virus-infected files, SOM projections tell us that they are a same family because of their own virus mask. It is like having a same DNA in the same family. We believe, using this virus mask, we can apply to find out variant viruses, which are changed some part from original virus codes.</p>
<h2>5. Conclusion and future work</h2>
<p>We investigated the Windows virus-infected files, in fact, the NewEXE file format, using SOMs. As we expected, we have found a virus pattern in a same virus-infected files. Although anti-virus software needs to detect variants of each virus with different virus signatures, our approach shows us that each virus family has a virus mask like a DNA. Initial experiments show that this approach appears to be successful. In addition, we shall attempt to find out virus pattern similarity, not only a same virus family, but also a virus mask based on the virus-infected file structure in the future. How to detect computer virus using this virus mask? This is the next step of this ongoing project, and this could be a future work.</p>
<h2>6. References</h2>
<ol>
<li>Esa Alhoniemi, Johan Himberg, Jukka Parviainen and Juha Vesanto: SOM Toolbox 2.0, a software library for Matlab, SOM Toolbox team, Laboratory of Computer and Information Science, Finland, 2002.</li>
<li>Teuvo Kohonen: Self-Organizing Maps, Springer, Berlin, Heidelberg, 1995.</li>
<li>Teuvo Kohonen: Comparison of SOM Point Densities Based on Different Criteria, Neural Computation, 11(8), pp.2081-2095, 1999.</li>
<li>MATHWORKS: The Mathworks, Inc., MATLAB, 2003.</li>
<li>M.Samamura: W95.CIH, Volume Expanded Threat List and Virus Encyclopaedia, Symantec Antivirus Researcdh Center, 1998.</li>
<li>Charles P.Pfleeger: Security in Computing, International Edition, Second Edition, Prentice-Hall International, Inc., 1997.</li>
<li>R.Wang: Flash in the pan?, Virus Bulletin, Virus Analysis Library, 1998.</li>
</ol>
<hr/>
<p><a name="f1" href="#b1">1</a> We have found sort of distinguished virus sign or special feature in the SOM reflection. We call this a virus mask.</p>
<p><a name="f2" href="#b2">2</a> The darker the colour between two neurons is, the closer is the relative distance between them. The upper is of the bar, the bigger is the relative distance between data. In black/white printout, the bar displays similar colour of black in the SOM. However, most of black colour in the SOMs represents the blue colour part or close distance between two neurons, which means the black colour part represents that the relative distance is smaller.</p>
[<a style="" href="/lib/?lang=EN&amp;index=AT#aiy00">Back to index</a>] [<a href="/lib/aiy00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=aiy00">de</a><a href="/lib/index.php?lang=en&amp;id=aiy00">en</a><a href="/lib/index.php?lang=es&amp;id=aiy00">es</a><a href="/lib/index.php?lang=it&amp;id=aiy00">it</a><a href="/lib/index.php?lang=fr&amp;id=aiy00">fr</a><a href="/lib/index.php?lang=pl&amp;id=aiy00">pl</a><a href="/lib/index.php?lang=ru&amp;id=aiy00">ru</a><a href="/lib/index.php?lang=ua&amp;id=aiy00">ua</a></div>
</body>
</html>
