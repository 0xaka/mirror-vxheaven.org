<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Richard Ford 'The future of virus detection' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Richard Ford"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Ford, Richard,future of virus detection, systems, symantec, detection, generic, analysis, malicious, computer, system, institute, florida, checksummers, outbreak, behavior, solutions, scanning"/>
<meta name="Description" content="When the average computer user can tell you the name of the latest major Internet worm, it becomes clear that we are not winning the war against Malicious Mobile Code. With the billions of dollars spent annually by the antivirus community and operating system manufactures on new and innovative countermeasures to stop viruses and worms, one is tempted to ask is the war even winnable? Is the issue simply one of careless users taking unnecessary risks, or is there something fundamentally broken in the way in which we attempt to defend against the onslaught of new viruses?In this article, these issues will be examined by looking not at the current threat profile, but at the different ways in which we defend our systems and their weaknesses. By examining the problem from this direction, it is possible to build up a list of requirements for solutions of the future - essentially, what functionality tomorrow's anti-virus software will need to have to keep us one step ahead of the next generation of viruses and worms."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"30f1a9a0d07f93fc158a96079e55c61541f2cfcb-1498756309-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/arf01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>The future of virus detection</h1><p><a href="/lib/?lang=en&amp;author=Ford%2C%20Richard">Richard Ford</a><br/> <em>Information Security Technical Report. Vol. 9, No. 2, pp.19-26</em><br/> <em>ISSN 1363-4127</em><br/> <em>June 2004</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/arf01.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/The%20future%20of%20virus%20detection.pdf">Download</a> PDF (112.85Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=PR#arf01">Back to index</a>] [<a href="/lib/arf01.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
Richard Ford, PhD.<br/>
Research Professor, Florida Institute of Technology Dept. of Computer Science,<br/>
Florida Institute of Technology, 150 W. University Blvd, Melbourne, FL 32901, USA.<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="6a180c05180e2a190f440c031e440f0e1f">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</address>
<ul>
<li><a href="#c1">1. Introduction</a></li>
<li><a href="#c2">2. Overview of the solution space</a></li>
<li><a href="#c3">3. Challenges in the solution space</a>
<ul>
<li><a href="#c31">3.1. Speed of spread</a></li>
<li><a href="#c32">3.2. Entry point obfuscation</a></li>
</ul></li>
<li><a href="#c4">4. New solutions and the future</a>
<ul>
<li><a href="#c41">4.1. Speed of response, revisited</a></li>
<li><a href="#c42">4.2. Try, try, try again attacks</a></li>
</ul></li>
<li><a href="#c5">5. Generic virus detection?</a>
<ul>
<li><a href="#c51">5.1. Checksummers</a></li>
<li><a href="#c52">5.2. Static heuristic analysis</a></li>
<li><a href="#c53">5.3. Fuzzy detection</a></li>
<li><a href="#c54">5.4. The Norman Sandbox</a></li>
<li><a href="#c55">5.5. The Digital Immune System</a></li>
<li><a href="#c56">5.6. Behavior blockers and analyzers</a></li>
</ul></li>
<li><a href="#c6">6. Gatekeeper</a></li>
<li><a href="#c7">7. The future of virus detection</a></li>
<li><a href="#c8">8. Conclusion</a></li>
<li><a href="#c9">Bibliography</a></li>
</ul>
<p><em>Dr. Richard Ford graduated from the University of Oxford in 1992 with a D.Phil in Quantum Physics. Since that time, he has worked extensively in computer security and malicious mobile code. Previous projects include work on the Computer Virus Immune System at IBM Research and development of the largest web hosting system in the world, whilst Director of Engineering for Verio. He is currently Research Professor at Florida Institute of Technology's Center for Information Assurance, where he carries out research on a wide variety of security-related areas. He is currently Executive Editor of Reed - Elsevier's Computers &amp; Security, and Virus Bulletin. He is also Scientific Advisor to the European Institute of Computer Antivirus Research.</em></p>
<p><em>Richard lives with his wife and two dogs in beautiful Florida and, when not trying to solve the world's malcode problems, plays both classical and jazz flute.</em></p>
<h2><a name="c1"></a>1. Introduction</h2>
<p>When the average computer user can tell you the name of the latest major Internet worm, it becomes clear that we are not winning the war against Malicious Mobile Code. With the billions of dollars spent annually by the antivirus community and operating system manufactures on new and innovative countermeasures to stop viruses and worms, one is tempted to ask is the war even winnable? Is the issue simply one of careless users taking unnecessary risks, or is there something fundamentally broken in the way in which we attempt to defend against the onslaught of new viruses?</p>
<p>In this article, these issues will be examined by looking not at the current threat profile, but at the different ways in which we defend our systems and their weaknesses. By examining the problem from this direction, it is possible to build up a list of requirements for solutions of the future - essentially, what functionality tomorrow's anti-virus software will need to have to keep us one step ahead of the next generation of viruses and worms.</p>
<h2><a name="c2"></a>2. Overview of the solution space</h2>
<p>While the antivirus industry has been steadily improving over the years, it may come as a surprise for some to realize that the fundamental technology used for detecting and removing viruses has changed very little over time. In this section, a brief discussion of current common virus solutions is outlined, so that a better understanding can be gained of what one can realistically expect from such countermeasures.</p>
<p>When viruses first became common, most samples were simple boot viruses - that is, small blocks of code, usually less than a couple of kilobytes in length that spread via the boot sectors of removable media. Due to the size limitations, and the naivety of the virus writers of the time, each copy of a virus "looked" the same, and the machine code was not obfuscated in any serious way. Furthermore, outbreaks generally took several weeks or even months to build, as the time between infection events was large.</p>
<p>It was in this environment that the scanner made its debut. At the time, most viruses were relatively static and slow moving. It seemed as though a signature-based virus scanning approach would thus be capable of arresting their spread, and thus this technology formed the basis of most virus scanners. Here, the scanner would look for a particular sequence of bytes in boot sectors and files. This approach was fairly accurate, as the virus code was simplistic. Furthermore, due to the slow spread, updates could be issued monthly, often via regular mail.</p>
<p>As the threat changed, so did the solution. While the idea of "signature" based scanning remained popular, scanner vendors improved performance by moving away from scanning every byte of an object to just scanning those around the entry point of the object. This optimization provided for significant speed improvements, which were critical given the memory and processor limitations of the day. Furthermore, by restricting the area of search the problem of false positives - where a clean file is inadvertently reported as infected - was reduced.</p>
<p>The next large change in detection strategy arrived with the advent of so-called polymorphic viruses. These viruses remain operationally unchanged with each replication, but employ variable decryption routines so that there is no constant string of
 
bytes that can be used for detection. This technique became more popular and forced most vendors to trace the path of execution into the virus code in order to detect an infected file. Perhaps the largest milestone - certainly the most well known - was the release of the Mutation Engine. This was a simple but effective polymorphic engine that was designed to be linked in to simple static file viruses; suddenly polymorphism was within the reach of any virus writer who knew how to leverage a link library.</p>
<p>The current situation is not fundamentally changed from this distant past. While anti-virus vendors no longer use strings of static bytes to detect viruses, the vast majority of viruses are detected using techniques that identify viruses by particular attributes that must be known before detection and removal can take place. Because of this, signature distribution has moved from a monthly event to an ongoing race, with vendors issuing updates via the Internet in real time.</p>
<h2><a name="c3"></a>3. Challenges in the solution space</h2>
<p>From a description of the problem and solution space, it is fairly easy to see that there are a number of open issues for those interested in virus prevention. Note here the change in focus: anti-virus solutions are about return on investment and risk mitigation, not the complete removal of the virus problem. Thus, from a purely pragmatic worldview, the primary goal of anti-virus software is not ultimately virus detection, but reduction of the cost associated with viruses. While this almost always means detection, it does not have to be detection. This clarification is an important point, as we shall see later.</p>
<p>This clarification aside, there are a number of very unpleasant attacks one can carry out against current anti-virus products. In this section, we will examine two of the attacks we have already observed as opposed to future threats, respecting the long-standing tension within the anti-virus world between informing users of risks and actually arming virus writers with new ideas.</p>
<h3><a name="c31"></a>3.1. Speed of spread</h3>
<p>Modern malware is fast. In almost the blink of an eye, an infected machine can send infected documents worldwide; worms like SQL.Slammer can become pandemic in just minutes [Moore2003]. Compare this to the virus problem before ubiquitous connectivity. Organizations like The WildList tracked outbreaks around the world, as infection spread from host to host via sneakernet. Those days are gone forever.</p>
<p>Of course, anti-virus software has taken advantage of connectivity too. Suspicious samples can be gathered from host machines quickly and solutions distributed worldwide in real time. There have even been some attempts - most notably the IBM Digital Immune System [White1999] - to automate parts of the solution generation process. However, with outbreak times now being measured in minutes not weeks, it is increasingly improbable that solutions that are reactive can hope to keep up with the virus problem. This was nicely illustrated in [Williamson2003], which showed that the lag between virus outbreak and solution dissemination is an important factor in determining outbreak size.</p>
<p>In addition to this work, we have created a network-aware simulator to study the challenges of solution dissemination in a degraded network environment. Detailed results of our work in this area are to be the subject of a later paper. Funded by a grant from the Cisco Critical Infrastructure
 
Assurance group, early results indicate that network degradation during an outbreak further weakens the abilities of reactive solutions. While speed of spread is the result of a number of different factors, the result of increased spread speed is very simple: signature-based solutions are becoming increasingly untenable.</p>
<h3><a name="c32"></a>3.2. Entry point obfuscation</h3>
<p>The next big concern for scanner manufacturers is entry point obfuscation, or EPO. In order to understand why EPO is such a problem for the scanner developers, we must first gain a better understanding of how virus scanners work.</p>
<p>Once, when viruses were very simple, and each replication of a virus "looked" very much like every other, viruses could be detected by scanning files for simple hexadecimal strings. Such scanning, however, was slow and unwieldy - as any file that contained the magic hex signature was detected as infected. Given that most viruses modified the file in such a way that the virus code was located at a predictable position within the file, vendors moved from simplistic bulk scanners to scanners that only searched particular locations in files.</p>
<p>This improvement was rendered useless by the creation of "polymorphic" viruses. Such viruses contain a static code block that is trivially encrypted, and a "new" decryptor is built for each replication. Thus, as the static code is encrypted, the virus scanner is forced to search for the presence of the decryptor... which, as it is dynamically generated, is different for each replication of the virus. The result of this is that while each generation of a polymorphic virus is functionally identical, there may be no single code sequence found in every infected file.</p>
<p>In order to detect such files, anti-virus developers have shifted detection strategies and now heavily rely on tracing of the execution path within scanned objects. During this process, the scanner can determine if the code being executed is viral. This technique has proven very effective, and is significantly faster than bulk-scanning large files. However, its usefulness is predicated on the fact that binary file viruses are executed at the start of the execution process.</p>
<p>EPO viruses attack this assumption directly, embedding the jump to the virus code deep within a target executable. Thus, simply tracing the execution path of an EPO-infected file provides no guarantee that the virus code itself will ever be called. Even if the actual virus code is located at the end of the executable, the scanner is unable to detect its exact location in order to emulate it. Essentially, EPO raises the bar in terms of what is required for static detection, as it removes the ability for a scanner to trace into the virus code with surety.</p>
<h2><a name="c4"></a>4. New solutions and the future</h2>
<p>Given that we have already demonstrated that reliable virus detection via static analysis is impossible and that current attacks are pushing the envelope in terms of manageability, new solutions to malcode are paramount if we are to create a robust Internet infrastructure. In the remainder of this paper, we will discuss the attributes of these new technologies, and from a requirements analysis position, attempt to work out what effective solutions might look like.</p>
<h3><a name="c41"></a>4.1. Speed of response, revisited</h3>
<p>Given the speed of spread of current malware, one of the obvious requirements is
 
that we need a solution that prevents pandemics from erupting. This implies either a solution that is capable of preventing fast attacks outright, or that slows attacks sufficiently that they become amenable to slower, but trusted, reactive techniques.</p>
<p>The "killer" solution to the virus problem has always been a method of stopping viruses that were unknown to the solution provider - that is, to provide generic detection of viruses rather than solutions that rely on prior knowledge of the virus.</p>
<p>Numerous attempts to provide such protection have been investigated by the anti-virus industry. Static heuristic analysis of files has been proposed, either by direct binary analysis, or by runtime simulation. In [Natvig2002] Norman Data Defense describes a system that emulates samples in a virtual environment, allowing viruses to "replicate" safely in a virtual machine. Such a technology is potentially extremely powerful, except for three significant weaknesses.</p>
<p>First, such an approach is incapable of detecting worms that rely on code injection - that is, where the worm code is contained in a data stream.</p>
<p>Second, this approach presupposes that the virus code actually gets to execute. With an EPO virus, this is not trivially the case, and the emulator is not practically able to execute all code paths within the target executable. Thus, EPO can potentially render such approaches useless.</p>
<p>Third, the approach is susceptible to viruses that are able to detect that they are under emulation, and thereby change their execution order to hide their intentions. Once free of the emulator and certified as clean, the virus code can do its job and infect the system. This last point is extremely important in virus prevention; so much so that the general case is explored below.</p>
<h3><a name="c42"></a>4.2. Try, try, try again attacks</h3>
<p>One of the challenges with developing virus solutions is that it is somewhat like playing "Paper, Rock, Scissors" when your opponent has to move before you choose to. In such a scenario, the player who moves first always loses against best play. Similarly, with current generic solutions a virus writer is free to study the detection mechanism at his or her leisure and then play to win.</p>
<p>This drawback in detection leaves the door wide open to attacks. At the simplest level, an attacker may develop a virus that evades the proactive detection of a particular scanner. At a higher level, a nation state or similar entity could obtain copies of all proactive solutions and develop a single attack that avoids them all. In such a circumstance, proactive solutions become worthless and the network once again becomes susceptible to a crippling attack.</p>
<h2><a name="c5"></a>5. Generic virus detection?</h2>
<p>Given the challenges faced by solutions that are based upon static analysis techniques, anti-virus researchers have been placing renewed efforts in provided for solutions that allow new viruses to be reliably detected. Indeed, a brief examination of most anti-virus vendors' web sites provides a raft of information that might lead one to think that the problem was well under control.</p>
<p>Unfortunately, a more in-depth analysis of current generic techniques shows that
 
this is far from the truth: the state of generic virus detection is very weak. In this section, we will show some of the techniques currently used for generic detection of viruses and illustrate their susceptibility to one or both of the attacks mentioned in the preceding section. In no particular order, we will therefore examine Checksummers, the Digital Immune System, Static Heuristic Analysis, Fuzzy Detection, the Norman Sandbox and Behavior Blockers.</p>
<h3><a name="c51"></a>5.1. Checksummers</h3>
<p>Checksummers had been a vastly underused part of virus countermeasures, although they are somewhat tricky to deploy on a widespread basis. Essentially, a checksummer relies on the fact that a virus must change an object it infects. By creating a cryptographically strong hash of objects before infection, subsequent changes can be easily detected. Unfortunately, this strength of checksummers is also their biggest weakness: they are change detectors, not virus detectors. Furthermore, they rely on the system environment in which they running, making them vulnerable to viruses that implement a high degree of stealth. Finally, they are highly reactive, letting users know that something occurred, but doing little to prevent further infection.</p>
<h3><a name="c52"></a>5.2. Static heuristic analysis</h3>
<p>Static heuristic analysis is the process whereby a file is searched for certain tell-tale indicators of viral infection. This technique can be useful as infected files are often fairly easily identifiable. Unfortunately, such heuristics fail to both "multiple attempt" attacks and EPO. In the former case, the virus writer can experimentally determine which factors trigger a heuristic response; in the latter, one simply needs to recognize that the entry point of the virus code must be located for meaningful static analysis to occur.</p>
<h3><a name="c53"></a>5.3. Fuzzy detection</h3>
<p>Most computer viruses are not entirely new; rather, a virus writer often takes an existing virus and modifies it in some way. Given the similarity between many different virus variants there are some advantages to imprecisely detecting particular viruses - that is, detecting large groups of viruses and potential variants with one signature provides some level of proactive detection of new viruses based upon the original sample.</p>
<p>However while imprecise detection sounds attractive, it can pose some difficulties with respect to disinfection. Furthermore, such an approach is pragmatic, but not effective against a targeted attack: as the detection algorithm can be obtained by the virus writer by simple trial and error, creating a variant that goes undetected is not difficult. Thus, while fuzzy detection is a useful aid in prevention, we should not consider it to be in any way a cure all.</p>
<h3><a name="c54"></a>5.4. The Norman Sandbox</h3>
<p>One highly effective solution to proactive virus detection is to run a file in a virtual environment, and see what changes it makes on the system. Such approaches are becoming increasingly attractive as processors become faster, as it is now feasible to carry out such simulation in real time.</p>
<p>Furthermore, if one takes the changes and simulates the result of those changes, false positives can be dramatically reduced, as only files that have some properties of self-replication can be tagged. One excellent - and highly effective - example of such a
 
system is found in [Natvig2002], where a fully functional virtual environment is demonstrated.</p>
<p>As we have previously discussed above, however, this approach is susceptible to attacks based upon EPO and against targeted attacks. By detecting that one is inside the sandbox, it is possible to avoid malicious behavior until the file has been determined to be clean. Similarly, if the malicious behavior occurs deep within the program of study, the Sandbox may never create the conditions that cause it to be executed. Thus while the Sandbox is an excellent technique, it is relatively easy to target.</p>
<h3><a name="c55"></a>5.5. The Digital Immune System</h3>
<p>One approach that hopes to combine the best of generic detection with the robustness of virus-specific techniques is the Digital Immune System. This technology, first developed by IBM [White1999] and later acquired by Symantec [Symantec2001] seeks to provide innate immunity from new viruses by automatically generating signatures from infected objects. These signatures are then distributed to uninfected machines. The concept is that by combining generic detection with innate immunity, outbreaks can be handled automatically in real time.</p>
<p>While this approach sounds highly attractive, there are several issues that limit its effectiveness. Consider a typical detection by the immune system. Initially, generic techniques are used to identify objects that are suspicious. These objects are sent to a central analysis center automatically. Here, they are analyzed and replicated; a signature is generated and distributed first to the infected machine and then to all machines, providing innate immunity.</p>
<p>Unfortunately, this cycle limits the immune system in a number of ways. First, the speed of signature distribution required is probably untenable - especially in the face of a network-based virus attack that causes significant network congestion. Second, the immune system is limited by its front-end generic techniques; thus, it is not a method of generic virus detection per se, but a method for turning generic detection into virus-specific detection.</p>
<h3><a name="c56"></a>5.6. Behavior blockers and analyzers</h3>
<p>One approach which is receiving more attention is the concept of runtime behavioral analysis. In this approach, each process or process tree on the machine is monitored for evidence that it is malicious in nature. Should a process be detected as malicious, it can be stopped.</p>
<p>Historically, such approaches have fallen prey to a number of different weaknesses. Most importantly, the challenge of false-positives has proven difficult to overcome. It is difficult, without hardcoding of rules, to determine that a "deltree" command is allowable but that hierarchical file deletion by a program may not be. Additionally, by the time a process is determined to be malicious, it is likely that some changes have already been made to the system, leaving the machine in an unknown and untrusted state. Thus, behavior based systems have historically been more virus detection than virus prevention, as manual work may be required for system recovery.</p>
<p>Fortunately, advances in processing power have made this approach more tenable, as improvements are available for the detection and removal algorithm. Such a system has been developed at Florida Institute of Technology and we use it below to introduce some important concepts in the future of virus detection.</p>
 
<h2><a name="c6"></a>6. Gatekeeper</h2>
<p>Consider a behavior-driven virus prevention system. For such a system, the "faster" a virus is - that is, the more focused its propagation mechanism - the easier it is to detect it behaviorally. Thus, in the age of rapid malware, behaviorally systems are, at face value, attractive. However, historically such systems have not been very successful. Part of the challenge is that there is a tension between detection and prevention. In order to score well in detection, the longer the program of study runs the more reliable detection is, and the more behaviors can be monitored. Thus, the later detection occurs, the more reliable it is likely to be. Conversely, there is a need to prevent damage, so early detection is highly preferable.</p>
<p>One way to resolve this tension is to use a behavior monitor that tracks and is capable of undoing actions on the host machine. We have implemented such a solution - known as Gatekeeper [Ford2003] - at Florida Institute of Technology. Results so far have been highly encouraging - detection rates of >90% of new In the Wild viruses have been achieved with very low false positives. Behavioral systems are not fooled by EPO and most methods of avoiding behavioral systems rely on slowing the rate of spread dramatically. This is desirable, as if spread rate can be reduced, effective reactive countermeasures can be put in place.</p>
<p>Furthermore, there is a fairly convincing argument that such a system does not need to be perfect in order to be effective. For example, consider a system that adds increasing amounts of latency to processes that are deemed suspicious - such a system is described in [Somayaji2002]. Despite the fact that a virus within such a system may successfully infect another machine, if suppression is above a certain key threshold, pandemic spread can be avoided, providing time for reactive solutions to be put in place. Essentially, a behavioral system need not be perfect in order to be effective.</p>
<h2><a name="c7"></a>7. The future of virus detection</h2>
<p>While behavioral systems may well be the future, so far they only address one part of the problem space. Even if reliable detection of rapid malware can be accomplished, how can such a system defend itself from highly-motivated attackers? The critical weakness seems to be that an attacker can try as many times as he likes with zero risk.</p>
<p>One way of defending this attack is to distribute the solution more widely - that is, that the behavior of the entire system of protection cannot be easily inferred from a study of just one endpoint. Such a requirement is key if we are to defend our systems from a potentially catastrophic worm outbreak. Furthermore, focus needs to move from simply protecting systems to protecting the infrastructure that those systems run on. As we read in [Griffin2003], the SQL.Slammer worm had a profound impact on BGP - this at some level measures the stability of the Internet. If such a benign worm can cause such widespread instability, one can only speculate as to the impact of a worm that was designed to cause as much network disruption as possible.</p>
<p>Based upon the rapidly changing threat profile, it is difficult to be specific about the future of virus detection, but the high-level requirements are clear. Generic suppression of viruses - be that via detection or simply reduction of spread rate - must be applied at a network level in order to protect the routes by which innate immunity can be disseminated.</p>
 
<p>Furthermore, solutions will become increasingly distributed, providing protection from well-motivated attackers who, through reverse engineering of detection algorithms, desire to cause catastrophic loss of connectivity and communications on a global scale.</p>
<h2><a name="c8"></a>8. Conclusion</h2>
<p>In this article, the state of the art in virus detection has been examined and shortcomings of our current defense scheme highlighted. Based upon the requirements for a robust solution, some possibilities for the future of generic virus detection have been discussed, and a challenge issued to researchers: provide for reliable generic virus detection without allowing an attacker who knows the algorithm and deployment details to evade detection.</p>
<p>Based upon these requirements, it seems likely that the next generation of anti-virus products will be distributed in nature. Furthermore, it is possible that focus will move away from perfect endpoint protection - something that is demonstrable impossible - to a more holistic view. By taking such an approach, it should be possible to prevent catastrophic network failures, and provide a robust and reliable foundation for the electronic interactions of tomorrow. One thing is for sure: current solutions are not up to the task. We are well advised to reach out for new countermeasures before the current inadequacies become not a matter of discussion but history.</p>
<h2><a name="c9"></a>Bibliography</h2>
<ul>
<li>Ford 2004, Ford R.A, Thompson H, The Future of Proactive virus Prevention. From the proceedings of the 2004 EICAR Conference 2004.</li>
<li>Griffin 2002, Griffin T, and Zhuoqing M, Internet Routing Streams, Workshop on the Management and Processing of Data Streams 2003.</li>
<li>Moore 2003, Moore D, Paxson V, Savage S, Shannon C, Staniford S, and Weaver N, The Spread of the Sapphire/Slammer Worm. CAIDA. Available online at http://www.caida.org/outreach/papers/2003/sapphire/sapphire.html (2003).</li>
<li>Natvig 2002, Natvig K, Sandbox II: Internet, From the Proceedings of the Virus Bulletin Conference, 2002.</li>
<li>Somayaji 2002, Somayaji, A. Operating System Stability and Security Through Process Homeostasis, Ph.D. Dissertation, University of New Mexico, July 2002.</li>
<li>Symantec 2001, Symantec, The Digital Immune System, Symantec Technical Brief. Available online at http://securityresponse.symantec.com/avcenter/reference/dis.tech.brief.pdf. July 2001.</li>
<li>White 1999, White S.R, Swimmer M, Pring E, Arnold W, Chess D, and Morar J, Anatomy of a Commercial-Grade Immune System. International Virus Bulletin Conference, Vancouver, Canada (Sept. 28-30, 1999).</li>
<li>Williamson 2003, Williamson M, Leveille J, An Epidemiological Model of Virus Spread and Cleanup. From the Proceedings of the Virus Bulletin Conference, 2003.</li>
</ul>
 
[<a style="" href="/lib/?lang=EN&amp;index=PR#arf01">Back to index</a>] [<a href="/lib/arf01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=arf01">de</a><a href="/lib/index.php?lang=en&amp;id=arf01">en</a><a href="/lib/index.php?lang=es&amp;id=arf01">es</a><a href="/lib/index.php?lang=it&amp;id=arf01">it</a><a href="/lib/index.php?lang=fr&amp;id=arf01">fr</a><a href="/lib/index.php?lang=pl&amp;id=arf01">pl</a><a href="/lib/index.php?lang=ru&amp;id=arf01">ru</a><a href="/lib/index.php?lang=ua&amp;id=arf01">ua</a></div>
</body>
</html>
