<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Peter Ferrie 'Not worthy' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Peter Ferrie"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Ferrie, Peter,Not worthy, windows, viruses, code, group, microsoft, msil, files, memory, idonus, reads, author, message, program, running, vista"/>
<meta name="Description" content="The members of the RRLF virus-writing group were very proud when they released the first viruses for Microsoft Shell (see VB, November 2005, p.4), believing that these were the first viruses on the Vista platform. Of course, they were wrong: those are Microsoft Shell viruses, not Vista viruses. Then Microsoft announced that it would no longer be shipping Microsoft Shell with the first release of Vista in any case.So what did the group do? They tried again. The second attempt at the `first' Vista virus is called Idonus. However, this is not a Vista virus either - it's an MSIL virus. Give it up, guys."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"b1d06433ac377a0caac77b2ec65d45a8e3b8fc8c-1498756864-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/apf21.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Not worthy</h1><p><a href="/lib/?lang=en&amp;author=Ferrie%2C%20Peter">Peter Ferrie</a><br/> <em>Virus Bulletin, February 2006, p.4</em><br/> <em>ISSN 0956-9979</em><br/> <em>February 2006</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/apf21.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Not%20worthy.pdf">Download</a> PDF (38.3Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=AN#apf21">Back to index</a>] [<a href="/lib/apf21.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
Peter Ferrie<br/>
Symantec Security Response, USA
</address>
<p>The members of the RRLF virus-writing group were very proud when they released the first viruses for <em>Microsoft Shell</em> (see <em>VB</em>, November 2005, p.4), believing that these were the first viruses on the <em>Vista</em> platform. Of course, they were wrong: those are <em>Microsoft Shell</em> viruses, not <em>Vista</em> viruses. Then <em>Microsoft</em> announced that it would no longer be shipping <em>Microsoft Shell</em> with the first release of <em>Vista</em> in any case.</p>
<p>So what did the group do? They tried again. The second attempt at the `first' <em>Vista</em> virus is called Idonus. However, this is not a <em>Vista</em> virus either - it's an <em>MSIL</em> virus. Give it up, guys.</p>
<h2>It gets beta and beta</h2>
<p>MSIL/Idonus runs only on the <em>.NET</em> framework version 2.0, which has just been released. It is freely available from <em>Microsoft</em>, and can be installed on <em>Windows 98</em> (yes, indeed!), <em>Windows ME, Windows 2000, Windows XP</em> (if SP2 is installed), <em>Windows 2003</em> (if SP1 is installed) and, of course, <em>Vista</em> (which is currently at the Beta 1 stage).</p>
<p>The virus also requires the <em>WinFX Runtime Components Core</em> 3.0 to be installed (this includes the <em>Windows Presentation Foundation</em>, which is used to display the payload of the virus). <em>WinFX</em> is currently at the Beta 2 stage, is also freely available from <em>Microsoft</em>, and can be installed on <em>Windows XP</em> and <em>Windows 2003</em>.</p>
<p>The virus author wanted to call the virus `Idoneus', from the Latin meaning `suitable' or `worthy'. If any virus were worthy of anything at all, this isn't it. The code looks awful, it was built in debug mode, which makes it look even worse, and it appears to be unfinished. Perhaps it is in the beta stage, too.</p>
<h2>Register here</h2>
<p>Whenever the virus is executed, it creates a list in memory of all subdirectories under C:\. Then it attempts to open the registry key `HKCU\Software\Retro'. If the registry key does not exist, the virus will create that key, then create the registry value `Idoneus' within it. The virus sets the registry value data to `c:\', followed by a directory name chosen randomly from the list it created. This is followed by the filename of the currently running program. The virus will also copy itself to the same randomly chosen directory, maintaining the name of the currently running program.</p>
<p>If the registry value `Idoneus' exists, the virus reads it and deletes the file to which the registry value points, then copies itself to another randomly chosen directory, and rewrites the registry value with the newly chosen directory name. Thus, the virus moves around the drive each time it is executed.</p>
<p>The virus also creates the registry value `Idoneus' under the registry key `HKCU\Software\Microsoft\Windows\CurrentVersion\Run', and sets the registry value data to `c:\', followed by the randomly chosen directory name and the filename of the currently running program. This ensures that the virus is executed each time the machine starts.</p>
<h2>Start here</h2>
<p>The virus searches only in the current directory for files to infect, and only for those files whose suffix is `.exe'. For each file that the virus finds to infect, the virus reads its own code entirely into memory, then reads the victim's code entirely into memory, but then writes out only the virus code. Thus, the virus overwrites the host file.</p>
<p>It appears that the virus was intended to be a prepender (by writing out the host code afterwards, and including code to extract the host and run it), but perhaps the virus author was under pressure to release sooner.</p>
<h2>Get the message</h2>
<p>After the infection process has completed, the virus displays a message containing the virus name, the group's website and the text `GeNeTiX is EVIL!'. It is not clear if the virus author is targeting a particular molecular biology industry company of that name, or the group that is campaigning against genetically-modified foods, or another group entirely.</p>
<h2>Conclusion</h2>
<p>The expression of controversial opinions in viruses is nothing new. We have seen, for example, anti-Israel comments in W32/Simile (see <em>VB</em>, May 2002, p.4), and other political messages in viruses such as W32/Maldal. However, using a virus to get the message across is not a good way to do it, especially when that virus destroys user data. Now that's evil.</p>
<table summary="MSIL/Idonus">
<tr><th colspan="2">MSIL/Idonus</th></tr>
<tr><th>Size:</th><td>16,384 bytes.</td></tr>
<tr><th>Type:</th><td>Direct-action overwriter.</td></tr>
<tr><th>Payload:</th><td>Displays message box.</td></tr>
<tr><th>Removal:</th><td>Delete infected files and restore them from backup.</td></tr>
</table>
 
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=apf21">de</a><a href="/lib/index.php?lang=en&amp;id=apf21">en</a><a href="/lib/index.php?lang=es&amp;id=apf21">es</a><a href="/lib/index.php?lang=it&amp;id=apf21">it</a><a href="/lib/index.php?lang=fr&amp;id=apf21">fr</a><a href="/lib/index.php?lang=pl&amp;id=apf21">pl</a><a href="/lib/index.php?lang=ru&amp;id=apf21">ru</a><a href="/lib/index.php?lang=ua&amp;id=apf21">ua</a></div>
</body>
</html>
