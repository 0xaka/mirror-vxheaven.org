<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> SPTH 'Hiding your virus in the matrix' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="SPTH"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, SPTH,Hiding your virus in the matrix, externstr, matrix, mystr, virus, vircode, times, mdiag, begin, code, mymtxcode, read, complex, engine, functions, uniform"/>
<meta name="Description" content="In this article you will read about a new kind of polymorphism provided by the eigenvalue problem. We will use some easy results from linear algebra to understand the concept, look at the encryption, decryption and chipher code, see some example and a running virus using this technique, and read about how to use that technique and how to improve it."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"5bb5744e627dc2ffb90c86501d15bf9d9cdda8d6-1498756391-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vsp25.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Hiding your virus in the matrix</h1><p><a href="/lib/?lang=en&amp;author=SPTH"> SPTH</a><br/> <em>July 2009</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vsp25.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=PO#vsp25">Back to index</a>] [<a href="/lib/vsp25.html#disqus_thread">Comments</a>]<br/> <form method="post" action="">
<img src="/img/cache/0b9fd596a90421f9f1f68a9760275737.gif" alt="\text{T_EX size}" valign="middle"/>
<select name="TeX_size"><option value="-2">-2</option><option value="-1">-1</option><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select>
<input type="submit" value="Scale"/>
</form>
<h2>Index</h2>
<ul>
<li><a href="#c0">0) Introduction</a></li>
<li><a href="#c1">1) The Idea</a></li>
<li><a href="#c2">2) Basics of Linear Algebra and Numeric</a>
<ul>
<li><a href="#c21">2.1) Similarity Transformation</a></li>
<li><a href="#c22">2.2) Eigenvalues, eigenvectors</a></li>
<li><a href="#c23">2.3) Cardano/Ferro's method</a></li>
</ul></li>
<li><a href="#c3">3) Coding Example</a>
<ul>
<li><a href="#c31">3.1) Encryption Engine</a></li>
<li><a href="#c32">3.2) Decryption Engine &amp; Encrypted Message</a></li>
</ul></li>
<li><a href="#c4">4) Virus Example</a></li>
<li><a href="#c5">5) Conclusion</a></li>
<li><a href="#c6">6) References</a></li>
<li><a href="#ca">APPENDIX</a>
<ul>
<li>A.1) Three representation of 'Hello VXers!'</li>
<li>A.2) Secret Message</li>
<li>A.3) Ready-To-Run Virus Code</li>
</ul></li>
</ul>
<h2><a name="c0"></a>0) Introduction</h2>
<p>In this article you will read about a new kind of polymorphism provided by the eigenvalue problem. We will use some easy results from linear algebra to understand the concept, look at the encryption, decryption and chipher code, see some example and a running virus using this technique, and read about how to use that technique and how to improve it.</p>
<h2><a name="c1"></a>1) The Idea</h2>
<p>The idea uses the fact, that the eigenvalues of a given matrix A do not change under a similarity transformation B = U^(-1) * A * U, for an invertable matrix U. The eigenvalues will be identified with the virus code, by using the ascii representation of the viruscode. The virus will look like this:</p>
<p>Encrypted Code:</p>
<pre>
	FUNCTIONS FOR CALCULATING THE EIGENVALUES OF THE MATRIX
	FUNCTIONS FOR TRANSFORM EVs -> STRING

	M=several matrices with EV: viruscode
	mycode=getcode(M)
	exec(mycode)
</pre>
<p>The internal viruscode (encrypted in the matrices) looks like this:</p>
<pre>
	FUNCTION FOR MATRIX MULTIPLICATION
	READ CODE + SPLIT IN 3Byte-PARTS
	MAKE 3x3 MATRIX with EV=ORD(Byte1),ORD(Byte2),ORD(Byte3)
	MAKE TRANSFORMED MATRIX B = U^(-1)* A * U
	SEACHFILES AND INFECT WITH MATRICES
</pre>
<h2><a name="c2"></a>2) Basics of Linear Algebra and Numeric</h2>
<h3><a name="c21"></a>2.1) Similarity Transformation</h3>
<p>A similarity transformation is a represenation of the matrix in an other basis; that can be interpretated as a (passive) rotation of the matrix:</p>
<p><img src="/img/cache/0763ad49c811a36d0a690ebf909d806c.gif" alt="B = U^{-1} A U" valign="middle"/></p>
<p>For example, A=diag(3,2,7); U = rotation arround z-axe with angular x in R3:</p>
<p><img src="/img/cache/b89907b6649401df423c889c4cdcd4ca.gif" alt="
B = \left|
 \begin{matrix}
 	\cos(x) &amp; \sin(x) &amp; 0 \\
 	-\sin(x) &amp; \cos(x) &amp; 0 \\
 	0 &amp; 0 &amp; 1
 \end{matrix}
\right| \times
\left|
 \begin{matrix}
 	3 &amp; 0 &amp; 0 \\
 	0 &amp; 2 &amp; 0 \\
 	0 &amp; 0 &amp; 7
 \end{matrix}
\right| \times
\left|
 \begin{matrix}
	\cos(x) &amp; -\sin(x) &amp; 0 \\
	\sin(x) &amp; \cos(x) &amp; 0 \\
	0 &amp; 0 &amp; 1
 \end{matrix}
\right| = \\
= \left|
 \begin{matrix}
	3\cos(x)^2+2\sin(x)^2 &amp; -\cos(x)\sin(x) &amp; 0 \\
	-\cos(x)\sin(x) &amp; 3\sin(x)^2+2\cos(x)^2 &amp; 0 \\
	0 &amp; 0 &amp; 7 
 \end{matrix}
\right|
" valign="middle"/></p>
<p>B looks different as A, but still has some equivalent properties:</p>
<ul>
<li>same determinant</li>
<li>same trace</li>
<li>same characteristic polynomial</li>
<li>...</li>
<li>same eigenvalue!</li>
</ul>
<h3><a name="c22"></a>2.2) Eigenvalues, eigenvectors</h3>
<p>For a matrix A, the eigenvectors give the basis of the matrix representation, the eigenvalues give the stretch or compression for a transformation. A given NxN Matrix has N eigenvalues L (skalar) and N eigenvectors v (N-vectors).</p>
<p>These values hold the following equation:</p>
<p><img src="/img/cache/89164b5efc86ea793a0b9bd8288853db.gif" alt="A \times v = L \times v\\(A - 1 \times L) \times v = 0" valign="middle"/></p>
<p>This is true, if the determinant of <img src="/img/cache/53fda1428c3e7a698c50f30c418fc9cd.gif" alt="(A - 1\times L)" valign="middle"/> is 0:</p>
<p><img src="/img/cache/80bec03c416adeb072bc8539c221a980.gif" alt="\det(A - 1 \times L) = 0" valign="middle"/></p>
<p>For a 2x2 Matrix A</p>
<p><img src="/img/cache/7c47508a44bd90d792ab9121fef21c8a.gif" alt="
	A = \left| \begin{matrix} a &amp; b \\ c &amp; d \end{matrix} \right| \\
	(A - 1 \times L) = \left| \begin{matrix} (a - L) &amp; b \\ c &amp; (d - L) \end{matrix}\right|
" valign="middle"/></p>
<p>the determinate leads to a polynom 2nd grade:</p>
<p><img src="/img/cache/ed76bd5ac8cd72de887000fed3f5d8c4.gif" alt="(a - L)(d - L) - b \times c = 0\\ L^2 + ( -a -d ) \times L + (a \times d - d \times c) = 0" valign="middle"/></p>
<p>which can be easiely solved by quadratic formula.</p>
<p>We will use complex 3x3 matrices, therefor the determinate polynom is 3rd grade. The Cardano method provides an easy algorithm for solving that equation.</p>
<h3><a name="c23"></a>2.3) Cardano/Ferro's method</h3>
<p>This method provides a solution to cubic polynoms. Good explanations can be found all over the internet (for instance here [1]), so I will just provide the results.</p>
<p>A cubic polynom:</p>
<p><img src="/img/cache/94d289944f8f0e8f4c0b5816df7edbe9.gif" alt="x^3 + ax^2 + bx + c = 0" valign="middle"/></p>
<p>With the solution:</p>
<p><img src="/img/cache/76f51c1d20d25dfc48d2f8056d763010.gif" alt="
	x_{1,2,3} = u_{1,2,3} - \frac{p}{3u_{1,2,3}} - \frac{a}{3}\\
	p = b - \frac{a^2}{3}\\
	q = c + \frac{2a^3 - 9ab}{27}\\
	u_{1,2,3} = \left(\frac{-q}{2} \pm \sqrt{\frac{q^2}{4} + \frac{p^3}{27}}\right)^{\frac{1}{3}}
" valign="middle"/></p>
<p>x has three solutions, as the polynom is of grade 3. The different solutions come from different values of u. u is defined by the 3rd root of a complex number, therefor there are 3 solutions.</p>
<h2><a name="c3"></a>3) Coding Example</h2>
<p>I have got the idea of that polymorphism while coding a class for SU(3) matrices; the project has been written in Python, so my code was written in Python too, and so these code examples are. For this example I have only used standard librarys by Python, no external librarys like NumPy - which would already provide an eigenvalue/eigenvector calculator.</p>
<h3><a name="c31"></a>3.1) Encryption Engine</h3>
<p>The encryption engine creates an random complex 3x3 matrix mUr, and its inverse mUl, as well as an diagonal matrix mdiag. mdiag has 3 complex (= 6 real) values in the diagonal: The real part of the diagonal-entrys (=eigenvalues) are the ASCII numbers of the chipher. The imaginary part of the eigenvalues is a couter. For instance:</p>
<p>VX! &larr;&rarr; 86, 88, 33.</p>
<p>But my eigenvalue-function returns the values in a wired order, which I did not understand (NumPy does the same). As the values need a special order, I need the imaginary part for giving that order.</p>
<p>My diagonal matrix looks like this:</p>
<p><img src="/img/cache/87396b9e48acafd203ec17a988bd5bea.gif" alt="
mdiag =
	\left| \begin{matrix} 86+1j &amp; 0 &amp; 0\\0 &amp; 88+2j &amp; 0\\0 &amp; 0 &amp; 33+3j \end{matrix} \right|
	\text{ or }
	\left| \begin{matrix} 33+3j &amp; 0 &amp; 0\\0 &amp; 86+1j &amp; 0\\0 &amp; 0 &amp; 88+2j \end{matrix} \right|
	\text{ or }\cdots
" valign="middle"/></p>
<p>Then the encryption engine creates a new matrix B with</p>
<p><img src="/img/cache/c6b5fdf95db0dd5a30ebfed7645ced52.gif" alt="B = mUl \times mdiag \times mUr" valign="middle"/></p>
<p>which has the same eigenvalues as mdiag, but a very different representation, as it is rotated.</p>
<div class="python" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">random</span> <span style="color: #ff7700;font-weight:bold;">as</span> rnd<br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> makerandom<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">9</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; mtx.<span style="color: black;">append</span><span style="color: black;">&#40;</span>rnd.<span style="color: black;">uniform</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">5</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>+rnd.<span style="color: black;">uniform</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">5</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>*1j<span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> multiply<span style="color: black;">&#40;</span>M<span style="color: #66cc66;">,</span> A<span style="color: #66cc66;">,</span> B<span style="color: black;">&#41;</span>:<br/>
&nbsp; A0<span style="color: #66cc66;">,</span>A1<span style="color: #66cc66;">,</span>A2<span style="color: #66cc66;">,</span>A3<span style="color: #66cc66;">,</span>A4<span style="color: #66cc66;">,</span>A5<span style="color: #66cc66;">,</span>A6<span style="color: #66cc66;">,</span>A7<span style="color: #66cc66;">,</span>A8<span style="color: #66cc66;">=</span>A<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; B0<span style="color: #66cc66;">,</span>B1<span style="color: #66cc66;">,</span>B2<span style="color: #66cc66;">,</span>B3<span style="color: #66cc66;">,</span>B4<span style="color: #66cc66;">,</span>B5<span style="color: #66cc66;">,</span>B6<span style="color: #66cc66;">,</span>B7<span style="color: #66cc66;">,</span>B8<span style="color: #66cc66;">=</span>B<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A0*B0 + A1*B3 + A2*B6<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A0*B1 + A1*B4 + A2*B7<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A0*B2 + A1*B5 + A2*B8<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A3*B0 + A4*B3 + A5*B6<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A3*B1 + A4*B4 + A5*B7<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A3*B2 + A4*B5 + A5*B8<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A6*B0 + A7*B3 + A8*B6<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A6*B1 + A7*B4 + A8*B7<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A6*B2 + A7*B5 + A8*B8<br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> determinate<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; d<span style="color: #66cc66;">=</span>mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span> - \<br/>
&nbsp; &nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span>-mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>-mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span>d<span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> inverse<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; det<span style="color: #66cc66;">=</span>determinate<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span><br/>
&nbsp; s0<span style="color: #66cc66;">,</span>s1<span style="color: #66cc66;">,</span>s2<span style="color: #66cc66;">,</span>s3<span style="color: #66cc66;">,</span>s4<span style="color: #66cc66;">,</span>s5<span style="color: #66cc66;">,</span>s6<span style="color: #66cc66;">,</span>s7<span style="color: #66cc66;">,</span>s8<span style="color: #66cc66;">=</span>mtx<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s4*s8-s5*s7<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s2*s7-s1*s8<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s1*s5-s2*s4<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s5*s6-s3*s8<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s0*s8-s2*s6<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s2*s3-s0*s5<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s3*s7-s4*s6<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s1*s6-s0*s7<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s0*s4-s1*s3<br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">9</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; mtx<span style="color: black;">&#91;</span>n<span style="color: black;">&#93;</span>/<span style="color: #66cc66;">=</span>det<br/>
<br/>
<br/>
externstr<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def getstring(M):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr<span style="color: #66cc66;">=</span> <br/>
<br/>
... <span style="color: black; font-style: italic;"># WHOLE DECRYPTION ENGINE</span><br/>
<br/>
mystr<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;Hello VXers!&quot;</span><br/>
enc<span style="color: #66cc66;">=</span>externstr<br/>
enc+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;M=[]<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
counter<span style="color: #66cc66;">=</span><span style="color: #008000;">int</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #008000;">len</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#41;</span>+<span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>/<span style="color: #ff4500;">3</span>.<span style="color: black;">&#41;</span><br/>
mystr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp;&quot;</span><br/>
<span style="color: #ff7700;font-weight:bold;">for</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span>counter<span style="color: black;">&#41;</span>:<br/>
&nbsp; mUr<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; makerandom<span style="color: black;">&#40;</span>mUr<span style="color: black;">&#41;</span><br/>
&nbsp; L0<span style="color: #66cc66;">=</span><span style="color: #008000;">ord</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span>*n+<span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; L1<span style="color: #66cc66;">=</span><span style="color: #008000;">ord</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span>*n+<span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; L2<span style="color: #66cc66;">=</span><span style="color: #008000;">ord</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span>*n+<span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; mdiag<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span>L0+1j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> L1+2j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> L2+3j<span style="color: black;">&#93;</span><br/>
&nbsp; mUl<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; mUl<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>mUr<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; inverse<span style="color: black;">&#40;</span>mUl<span style="color: black;">&#41;</span><br/>
&nbsp; mY<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; mY<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>mUl<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; mB<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; mB<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>mUl<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; multiply<span style="color: black;">&#40;</span>mY<span style="color: #66cc66;">,</span>mUl<span style="color: #66cc66;">,</span>mdiag<span style="color: black;">&#41;</span><br/>
&nbsp; multiply<span style="color: black;">&#40;</span>mB<span style="color: #66cc66;">,</span>mY<span style="color: #66cc66;">,</span>mUr<span style="color: black;">&#41;</span><br/>
&nbsp; vircode+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;M.append([&quot;</span><br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> m <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">9</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; enc+<span style="color: #66cc66;">=</span><span style="color: #008000;">str</span><span style="color: black;">&#40;</span>mB<span style="color: black;">&#91;</span>m<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; enc+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;,&quot;</span><br/>
&nbsp; enc+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;])<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
enc+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;myMTXcode=getstring(M)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
enc+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;exec(myMTXcode)&quot;</span><br/>
<br/>
f<span style="color: #66cc66;">=</span><span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'encrypted.py'</span><span style="color: black;">&#41;</span><br/>
f.<span style="color: black;">write</span><span style="color: black;">&#40;</span>enc<span style="color: black;">&#41;</span><br/>
f.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp;</div>
<h3><a name="c32"></a>3.2) Decryption Engine &amp; Encrypted Message</h3>
<p>The decryption engine calculates the eigenvalues of all given matrices in M[], sorts them by the imaginary part of the eigenvalues, compains them to a string, and EXECutes the string. It uses the algorithm explained in (2.2) and (2.3).</p>
<p>As example we will look at the following matrix:</p>
<pre>
	(63.1925704486+37.492436785j),(-28.6708074068-35.2366181875j),
		(-46.6902296225-51.6577151605j)
M =	(29.8398186401+5.66596212895j),(69.6512376023+28.7600907908j),
		(-22.0336492677+44.2201928279j)
	(-34.971148787+17.088887324j),(-6.129786337-42.3441159614j),
		(74.1561919491-60.2525275758j),])
</pre>
<p>We need the eigenvalues, therefor we calculate a,b,c as provided by Cardano's method:</p>
<p><img src="/img/cache/fc6f1ff2814d75c5784ee0627b4f5783.gif" alt="\begin{align}
a &amp;=&amp; -207 &amp;-&amp; 6j\\
b &amp;=&amp; 13299 &amp;+&amp; 881j\\
c &amp;=&amp; -248898 &amp;-&amp; 31278j
\end{align}" valign="middle"/></p>
<p>We can get p and q now:</p>
<p><img src="/img/cache/89c08a8b4322f5dd63f19da3c7f404da.gif" alt="\begin{align}
p &amp;=&amp; -972 &amp;+&amp; 53j\\
q &amp;=&amp; 11609 &amp;-&amp; 1007j
\end{align}
" valign="middle"/></p>
<p>And the three values for u:</p>
<p><img src="/img/cache/0724634c5fa21cec1bfe32624199ef86.gif" alt="\begin{align}
u_1 &amp;=&amp; 8.923 &amp;-&amp; 15.3j\\
u_2 &amp;=&amp; 8.788 &amp;+&amp; 15.4j\\
u_3 &amp;=&amp;-17.711 &amp;-&amp; 0.1j
\end{align}" valign="middle"/></p>
<p>Insert all values in the formular for x, we get:</p>
<p><img src="/img/cache/1f0af1a20b900fa99f553569e63aa72f.gif" alt="\begin{align}
x_1 &amp;=&amp; 88 &amp;+&amp; 2j\\
x_2 &amp;=&amp; 86 &amp;+&amp; 1j\\
x_3 &amp;=&amp; 33 &amp;+&amp; 3j
\end{align}" valign="middle"/></p>
<p>We sort them by the imaginary part and compain them:</p>
<pre>msg = chr(86,88,33) = 'VX!'</pre>
<p>The same way the decryption works, just using more matrices for more characters to chipher.</p>
<div class="python" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #ff7700;font-weight:bold;">def</span> root3<span style="color: black;">&#40;</span>num<span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fak1<span style="color: #66cc66;">=</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">1</span>/<span style="color: #ff4500;">2.0</span><span style="color: black;">&#41;</span>+<span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">3</span>**<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>/<span style="color: #ff4500;">2</span>.<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>/<span style="color: #ff4500;">2.0</span><span style="color: black;">&#41;</span>*1j<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fak2<span style="color: #66cc66;">=</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">1</span>/<span style="color: #ff4500;">2.0</span><span style="color: black;">&#41;</span>-<span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">3</span>**<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>/<span style="color: #ff4500;">2</span>.<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>/<span style="color: #ff4500;">2.0</span><span style="color: black;">&#41;</span>*1j<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a<span style="color: #66cc66;">=</span>num**<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>/<span style="color: #ff4500;">3.0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b<span style="color: #66cc66;">=</span>a*fak1<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c<span style="color: #66cc66;">=</span>a*fak2<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span>a<span style="color: #66cc66;">,</span>b<span style="color: #66cc66;">,</span>c<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> getPQ<span style="color: black;">&#40;</span>a<span style="color: #66cc66;">,</span>b<span style="color: #66cc66;">,</span>c<span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p <span style="color: #66cc66;">=</span> b-<span style="color: black;">&#40;</span><span style="color: black;">&#40;</span>a**<span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>/<span style="color: #ff4500;">3.0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q <span style="color: #66cc66;">=</span> c + <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2</span>*<span style="color: black;">&#40;</span>a**<span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span>-<span style="color: #ff4500;">9</span>*a*b<span style="color: black;">&#41;</span>/<span style="color: #ff4500;">27.0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span>p<span style="color: #66cc66;">,</span>q<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> getU<span style="color: black;">&#40;</span>p<span style="color: #66cc66;">,</span>q<span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u3<span style="color: #66cc66;">=</span>-<span style="color: black;">&#40;</span>q/<span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>+<span style="color: black;">&#40;</span><span style="color: black;">&#40;</span>q**<span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>/<span style="color: #ff4500;">4.0</span> + <span style="color: black;">&#40;</span>p**<span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span>/<span style="color: #ff4500;">27</span><span style="color: black;">&#41;</span>**<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>/<span style="color: #ff4500;">2.0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span>root3<span style="color: black;">&#40;</span>u3<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> getLambda<span style="color: black;">&#40;</span>a<span style="color: #66cc66;">,</span>p<span style="color: #66cc66;">,</span>u<span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> u<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">==</span> <span style="color: #ff4500;">0</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L0<span style="color: #66cc66;">=</span>u<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> - a/<span style="color: #ff4500;">3.0</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">else</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L0<span style="color: #66cc66;">=</span>u<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> - p/<span style="color: black;">&#40;</span><span style="color: #ff4500;">3.0</span>*u<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> - a/<span style="color: #ff4500;">3.0</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> u<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">==</span> <span style="color: #ff4500;">0</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L1<span style="color: #66cc66;">=</span>-a/<span style="color: #ff4500;">3.0</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">else</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L1<span style="color: #66cc66;">=</span>u<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span> - p/<span style="color: black;">&#40;</span><span style="color: #ff4500;">3.0</span>*u<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> - a/<span style="color: #ff4500;">3.0</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> u<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">==</span> <span style="color: #ff4500;">0</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L2<span style="color: #66cc66;">=</span>-a/<span style="color: #ff4500;">3.0</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">else</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L2<span style="color: #66cc66;">=</span>u<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span> - p/<span style="color: black;">&#40;</span><span style="color: #ff4500;">3.0</span>*u<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> - a/<span style="color: #ff4500;">3.0</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span>L0<span style="color: #66cc66;">,</span>L1<span style="color: #66cc66;">,</span>L2<span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> getABC<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a<span style="color: #66cc66;">=</span>-<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b<span style="color: #66cc66;">=</span>mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>- \<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span>-mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>-mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c<span style="color: #66cc66;">=</span>-mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span>- \<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>- \<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span>a<span style="color: #66cc66;">,</span>b<span style="color: #66cc66;">,</span>c<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> eigenvalues<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ABC<span style="color: #66cc66;">=</span>getABC<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PQ<span style="color: #66cc66;">=</span>getPQ<span style="color: black;">&#40;</span>ABC<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span>ABC<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span>ABC<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; U<span style="color: #66cc66;">=</span>getU<span style="color: black;">&#40;</span>PQ<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span>PQ<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; L<span style="color: #66cc66;">=</span>getLambda<span style="color: black;">&#40;</span>ABC<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span>PQ<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span>U<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span>L<span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> getstring<span style="color: black;">&#40;</span>M<span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; <span style="color: #008000;">str</span><span style="color: #66cc66;">=</span><span style="color: #483d8b;">''</span><br/>
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> c <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #008000;">len</span><span style="color: black;">&#40;</span>M<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; mLD<span style="color: #66cc66;">=</span>eigenvalues<span style="color: black;">&#40;</span>M<span style="color: black;">&#91;</span>c<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #008000;">len</span><span style="color: black;">&#40;</span>mLD<span style="color: black;">&#41;</span>+<span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #008000;">len</span><span style="color: black;">&#40;</span>mLD<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">round</span><span style="color: black;">&#40;</span>mLD<span style="color: black;">&#91;</span>n<span style="color: black;">&#93;</span>.<span style="color: black;">imag</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">==</span>i:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #008000;">str</span>+<span style="color: #66cc66;">=</span><span style="color: #008000;">chr</span><span style="color: black;">&#40;</span><span style="color: #008000;">int</span><span style="color: black;">&#40;</span><span style="color: #008000;">round</span><span style="color: black;">&#40;</span>mLD<span style="color: black;">&#91;</span>n<span style="color: black;">&#93;</span>.<span style="color: black;">real</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span><span style="color: #008000;">str</span><span style="color: black;">&#41;</span><br/>
<br/>
M<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
M.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">111.683428149</span>+2.06459252284j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">1.10490217211</span>+0.0344072539331j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">0.0430530540908</span>+1.75479909755j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">4.06723092869</span>+2.73413363971j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">107.599271866</span>+2.87763698926j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">2.2482495609</span>+6.9132040589j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">0.59557811208</span>+0.115466142422j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">0.69127471186</span>-1.55945594885j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">111.717299985</span>+1.0577704879j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
M.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">118.541367154</span>+3.93823513788j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1.16266259421</span>+3.00081592836j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">3.76961850274</span>+1.86798711661j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">25.9597030301</span>+51.2947566872j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">95.0015605504</span>-13.3604180029j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">12.2548443046</span>+56.766013692j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span>-<span style="color: #ff4500;">64.5665226786</span>-4.65349502375j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">5.77015944821</span>-24.2108814397j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">51.4570722956</span>+15.422182865j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
M.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">95.0916893207</span>+1.24561178511j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">7.31384679005</span>-7.22713849386j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span>-<span style="color: #ff4500;">19.9802422285</span>+15.1625393048j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">4.55938178994</span>-3.86904477337j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">104.558036099</span>-1.690658605j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">13.2550872642</span>-9.51269056571j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span>-<span style="color: #ff4500;">8.28550792302</span>-4.74874242958j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">3.68768705785</span>-5.01225605387j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">81.3502745803</span>+6.44504681989j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
M.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">69.0666846907</span>+7.74153113972j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">19.2643084637</span>+46.9603166139j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">21.139970505</span>-8.67953298508j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">23.7952908742</span>+11.148451161j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">107.335560615</span>+35.3261292099j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">12.1260566742</span>-11.6069281017j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">38.8301719439</span>+80.4069344033j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">110.722682123</span>+9.83929122878j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">74.5977546942</span>-37.0676603496j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
M.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">87.9859537783</span>+1.76173248065j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0.618291470925</span>-3.51208547752j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span>-<span style="color: #ff4500;">1.49018075771</span>+3.16093597101j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0.140255772765</span>+1.27268956483j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">90.9732250588</span>+6.74443516021j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">4.73290532124</span>-4.89204043436j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span>-<span style="color: #ff4500;">2.71371298788</span>+0.9490601855j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">11.5413989295</span>+2.0366942355j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">96.0408211628</span>-2.50616764086j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
M.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">116.637007456</span>-4.98424447257j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">0.956809935625</span>+7.36275422828j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">5.28173148418</span>+11.143291707j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">82.8913103158</span>+71.7301867459j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">184.402432348</span>-87.6232821155j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">20.8733032706</span>-184.865372846j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">105.555478945</span>+18.2709915185j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">110.437515978</span>+1.054278729j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span>-<span style="color: #ff4500;">39.0394398039</span>+98.6075265881j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
M.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">48.5425894124</span>+8.84920621968j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">0.245656619782</span>+17.7588566545j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">12.5809433528</span>+15.805731952j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0.986479005342</span>-1.27846095227j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">33.7337006106</span>+3.39218276823j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1.75371755321</span>-0.552115644868j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span>-<span style="color: #ff4500;">12.3470680016</span>-1.53249573275j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">2.78756539197</span>-11.7388901482j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #ff4500;">20.723709977</span>-6.24138898791j<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
myMTXcode<span style="color: #66cc66;">=</span>getstring<span style="color: black;">&#40;</span>M<span style="color: black;">&#41;</span><br/>
<span style="color: #ff7700;font-weight:bold;">exec</span><span style="color: black;">&#40;</span>myMTXcode<span style="color: black;">&#41;</span><br/>
&nbsp;</div>
<h2><a name="c4"></a>4) Virus example</h2>
<p>This encryption technique could be used for encrypting a computer virus, too. The virus will be encrypted and executed as string myMTXcode. A good thing is, that the executed string myMTXcode can access its own data. For that reason, the virus will never need to open a file to get its own code, but just use the decrypted myMTXcode-string.</p>
<p>The example-virus infects by prepending all uninfected *.py files in the current directory. It decrypts itself, generates a new encrypted version of itself, and infects the files. Simple concept.</p>
<p>The decryption is the same as in (3.2) - the decrypted virus is here:</p>
<div class="python" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">random</span> <span style="color: #ff7700;font-weight:bold;">as</span> rnd<br/>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> makerandom<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">9</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; mtx.<span style="color: black;">append</span><span style="color: black;">&#40;</span>rnd.<span style="color: black;">uniform</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">5</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>+rnd.<span style="color: black;">uniform</span><span style="color: black;">&#40;</span>-<span style="color: #ff4500;">5</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>*1j<span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> multiply<span style="color: black;">&#40;</span>M<span style="color: #66cc66;">,</span> A<span style="color: #66cc66;">,</span> B<span style="color: black;">&#41;</span>:<br/>
&nbsp; A0<span style="color: #66cc66;">,</span>A1<span style="color: #66cc66;">,</span>A2<span style="color: #66cc66;">,</span>A3<span style="color: #66cc66;">,</span>A4<span style="color: #66cc66;">,</span>A5<span style="color: #66cc66;">,</span>A6<span style="color: #66cc66;">,</span>A7<span style="color: #66cc66;">,</span>A8<span style="color: #66cc66;">=</span>A<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; B0<span style="color: #66cc66;">,</span>B1<span style="color: #66cc66;">,</span>B2<span style="color: #66cc66;">,</span>B3<span style="color: #66cc66;">,</span>B4<span style="color: #66cc66;">,</span>B5<span style="color: #66cc66;">,</span>B6<span style="color: #66cc66;">,</span>B7<span style="color: #66cc66;">,</span>B8<span style="color: #66cc66;">=</span>B<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A0*B0 + A1*B3 + A2*B6<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A0*B1 + A1*B4 + A2*B7<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A0*B2 + A1*B5 + A2*B8<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A3*B0 + A4*B3 + A5*B6<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A3*B1 + A4*B4 + A5*B7<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A3*B2 + A4*B5 + A5*B8<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A6*B0 + A7*B3 + A8*B6<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A6*B1 + A7*B4 + A8*B7<br/>
&nbsp; M<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>A6*B2 + A7*B5 + A8*B8<br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> determinate<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; d<span style="color: #66cc66;">=</span>mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span>+mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span> - \<br/>
&nbsp; &nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span>-mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span>-mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span>*mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">return</span><span style="color: black;">&#40;</span>d<span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">def</span> inverse<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span>:<br/>
&nbsp; det<span style="color: #66cc66;">=</span>determinate<span style="color: black;">&#40;</span>mtx<span style="color: black;">&#41;</span><br/>
&nbsp; s0<span style="color: #66cc66;">,</span>s1<span style="color: #66cc66;">,</span>s2<span style="color: #66cc66;">,</span>s3<span style="color: #66cc66;">,</span>s4<span style="color: #66cc66;">,</span>s5<span style="color: #66cc66;">,</span>s6<span style="color: #66cc66;">,</span>s7<span style="color: #66cc66;">,</span>s8<span style="color: #66cc66;">=</span>mtx<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s4*s8-s5*s7<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s2*s7-s1*s8<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s1*s5-s2*s4<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s5*s6-s3*s8<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s0*s8-s2*s6<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">5</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s2*s3-s0*s5<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s3*s7-s4*s6<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">7</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s1*s6-s0*s7<br/>
&nbsp; mtx<span style="color: black;">&#91;</span><span style="color: #ff4500;">8</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>s0*s4-s1*s3<br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">9</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; mtx<span style="color: black;">&#91;</span>n<span style="color: black;">&#93;</span>/<span style="color: #66cc66;">=</span>det<br/>
<br/>
externstr<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def root3(num):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fak1=(-1/2.0)+((3**(1/2.))/2.0)*1j<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fak2=(-1/2.0)-((3**(1/2.))/2.0)*1j<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a=num**(1/3.0)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b=a*fak1<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c=a*fak2<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return([a,b,c])<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def getPQ(a,b,c):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p = b-((a**2)/3.0)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q = c + ((2*(a**3)-9*a*b)/27.0)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return([p,q])<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def getU(p,q):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u3=-(q/2)+((q**2)/4.0 + (p**3)/27)**(1/2.0)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(root3(u3))<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def getLambda(a,p,u):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if u[0] == 0:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L0=u[0] - a/3.0<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L0=u[0] - p/(3.0*u[0]) - a/3.0<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if u[1] == 0:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L1=-a/3.0<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L1=u[1] - p/(3.0*u[1]) - a/3.0<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if u[2] == 0:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L2=-a/3.0<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L2=u[2] - p/(3.0*u[2]) - a/3.0<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(L0,L1,L2)<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def getABC(mtx):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a=-(mtx[0]+mtx[4]+mtx[8])<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b=mtx[0]*mtx[4]+mtx[0]*mtx[8]+mtx[4]*<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mtx[8]-mtx[5]*mtx[7]-mtx[1]*mtx[3]-mtx[2]*mtx[6]<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c=-mtx[0]*mtx[4]*mtx[8]+mtx[0]*mtx[5]*<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mtx[7]-mtx[1]*mtx[5]*mtx[6]+mtx[1]*mtx[3]*mtx[8]-<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mtx[2]*mtx[3]*mtx[7]+mtx[2]*mtx[4]*mtx[6]<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return([a,b,c])<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def eigenvalues(mtx):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ABC=getABC(mtx)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PQ=getPQ(ABC[0],ABC[1],ABC[2])<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; U=getU(PQ[0],PQ[1])<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; L=getLambda(ABC[0],PQ[0],U)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(L)<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;def getstring(M):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp;str=''<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp;for c in range(len(M)):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp; &nbsp;mLD=eigenvalues(M[c])<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp; &nbsp;for i in range(len(mLD)+1):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp; &nbsp; &nbsp;for n in range(len(mLD)):<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if round(mLD[n].imag)==i:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str+=chr(int(round(mLD[n].real)))<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
externstr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp; &nbsp;return(str)<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
<br/>
mystr<span style="color: #66cc66;">=</span>myMTXcode<br/>
vircode<span style="color: #66cc66;">=</span>externstr<br/>
vircode+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;M=[]<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
counter<span style="color: #66cc66;">=</span><span style="color: #008000;">int</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #008000;">len</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#41;</span>+<span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>/<span style="color: #ff4500;">3</span>.<span style="color: black;">&#41;</span><br/>
mystr+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot; &nbsp;&quot;</span><br/>
<span style="color: #ff7700;font-weight:bold;">for</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span>counter<span style="color: black;">&#41;</span>:<br/>
&nbsp; mUr<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; makerandom<span style="color: black;">&#40;</span>mUr<span style="color: black;">&#41;</span><br/>
&nbsp; L0<span style="color: #66cc66;">=</span><span style="color: #008000;">ord</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span>*n+<span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; L1<span style="color: #66cc66;">=</span><span style="color: #008000;">ord</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span>*n+<span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; L2<span style="color: #66cc66;">=</span><span style="color: #008000;">ord</span><span style="color: black;">&#40;</span>mystr<span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span>*n+<span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; mdiag<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span>L0+1j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> L1+2j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span>+0j<span style="color: #66cc66;">,</span> L2+3j<span style="color: black;">&#93;</span><br/>
&nbsp; mUl<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; mUl<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>mUr<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; inverse<span style="color: black;">&#40;</span>mUl<span style="color: black;">&#41;</span><br/>
&nbsp; mY<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; mY<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>mUl<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; mB<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><br/>
&nbsp; mB<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><span style="color: #66cc66;">=</span>mUl<span style="color: black;">&#91;</span>:<span style="color: black;">&#93;</span><br/>
&nbsp; multiply<span style="color: black;">&#40;</span>mY<span style="color: #66cc66;">,</span>mUl<span style="color: #66cc66;">,</span>mdiag<span style="color: black;">&#41;</span><br/>
&nbsp; multiply<span style="color: black;">&#40;</span>mB<span style="color: #66cc66;">,</span>mY<span style="color: #66cc66;">,</span>mUr<span style="color: black;">&#41;</span><br/>
&nbsp; vircode+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;M.append([&quot;</span><br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">for</span> m <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">9</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; vircode+<span style="color: #66cc66;">=</span><span style="color: #008000;">str</span><span style="color: black;">&#40;</span>mB<span style="color: black;">&#91;</span>m<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; vircode+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;,&quot;</span><br/>
&nbsp; vircode+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;])<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
vircode+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;myMTXcode=getstring(M)<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><br/>
vircode+<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;exec(myMTXcode)&quot;</span><br/>
a<span style="color: #66cc66;">=</span><span style="color: #dc143c;">os</span>.<span style="color: black;">listdir</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span>.<span style="color: black;">curdir</span><span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #008000;">len</span><span style="color: black;">&#40;</span>a<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; b<span style="color: #66cc66;">=</span>a<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span>.<span style="color: black;">rfind</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;.&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">len</span><span style="color: black;">&#40;</span>a<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">&gt;</span>b+<span style="color: #ff4500;">2</span>:<br/>
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> a<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>b+<span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>+a<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>b+<span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">==</span><span style="color: #483d8b;">&quot;py&quot;</span>:<br/>
&nbsp; &nbsp; &nbsp; vic<span style="color: #66cc66;">=</span><span style="color: #008000;">open</span><span style="color: black;">&#40;</span>a<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">&quot;r&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; vc<span style="color: #66cc66;">=</span>vic.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: black;">&#40;</span>vc.<span style="color: black;">find</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;getABC&quot;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">==</span>-<span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; vic.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; vic<span style="color: #66cc66;">=</span><span style="color: #008000;">open</span><span style="color: black;">&#40;</span>a<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">&quot;w&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; vic.<span style="color: black;">write</span><span style="color: black;">&#40;</span>vircode+<span style="color: #483d8b;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; vic.<span style="color: black;">write</span><span style="color: black;">&#40;</span>vc<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; vic.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
<br/>
&nbsp;</div>
<p>For making a 1st generation of the virus, you will need an external program, which encryptes the decrypted_virus.py. There, instead of</p>
<pre>'mystr=myMTXcode'</pre>
<p>you have to write something like:</p>
<div class="python" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #dc143c;">code</span><span style="color: #66cc66;">=</span><span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;decrypted_virus.py&quot;</span><span style="color: #66cc66;">,</span><span style="color: #483d8b;">&quot;r&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; mystr<span style="color: #66cc66;">=</span><span style="color: #dc143c;">code</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #dc143c;">code</span>.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp;</div>
<p>The encrypted version is very big (~300KB), so you will find the full virus code in the APPENDIX.</p>
<h2><a name="c5"></a>5) Conclusion</h2>
<p>In this article we have seen a new kind of polymorphism provided by some easy linear algebra. The example engines use complex 3x3 matrices, and have not used any external library.</p>
<p>One could expand the engine by NxN matrices, with a random number N. As this would lead to more complicated algebraic calculations, one would be forced to use an external numeric library. Numpy[2] provides an great amount of numerical functions, also functions for eigenvalues and eigenvectors. They could be used easiely.</p>
<p>Another expansion could be Adding Trash[3], which has already been coded by VortX; or other interal-code changing. This makes the matrices more dynamic.</p>
<p>Of course, this technique could be used for any programming language; in the same way as provided here for any script language and in some 'more advanced' way in binary viruses.</p>
<hr size="1"/>
<p><em>My dream is over for this time; I'm going back to the other side of the moon again...</em></p>
<h2><a name="c6"></a>6) References</h2>
<ol>
<li><a href="http://en.wikipedia.org/wiki/Cubic_function#Cardano.27s_method">Cubic function / Cardano's method</a></li>
<li><a href="http://numpy.scipy.org/">NumPy Website</a></li>
<li>VortX; <a href="/lib/vvx00.html">"Python Virus Writing Tutorial"</a>; 2005</li>
</ol>
<h2><a name="ca"></a>APPENDIX</h2>
<p>Here I will provide some source codes, which are too big for the article itself. There will be one encrypted messages, in three different matrix representation; one secret message and the full ready-to-run version of the example virus. Enjoy it!</p>
<ul>
<li>A.1) <a href="files/vsp/HelloVXers.py">Three representation of 'Hello VXers!'</a></li>
<li>A.2) <a href="files/vsp/SecretMsg.py">Secret Message</a></li>
<li>A.3) <a href="files/vsp/ready-to-run-virus.py">Ready-To-Run Virus Code</a></li>
<li><a href="files/vsp/encryption_engine.py">encryption_engine.py</a></li>
<li><a href="files/vsp/decryption_engine.py">decryption_engine.py</a></li>
<li><a href="files/vsp/decrypted_virus.py">decrypted_virus.py</a></li>
</ul>
[<a style="" href="/lib/?lang=EN&amp;index=PO#vsp25">Back to index</a>] [<a href="/lib/vsp25.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vsp25">de</a><a href="/lib/index.php?lang=en&amp;id=vsp25">en</a><a href="/lib/index.php?lang=es&amp;id=vsp25">es</a><a href="/lib/index.php?lang=it&amp;id=vsp25">it</a><a href="/lib/index.php?lang=fr&amp;id=vsp25">fr</a><a href="/lib/index.php?lang=pl&amp;id=vsp25">pl</a><a href="/lib/index.php?lang=ru&amp;id=vsp25">ru</a><a href="/lib/index.php?lang=ua&amp;id=vsp25">ua</a></div>
</body>
</html>
