<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Дмитрий Зегжда 'Векторно-операторная модель компьютерных вирусов' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Дмитрий Зегжда"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Зегжда, Дмитрий,Векторно-операторная модель компьютерных вирусов, вируса, pinf, программы, модели, заражения, вирусы, файловых, сигнатурных, используются, метод, внедрения, сигнатуру, вирусов, sign, программа"/>
<meta name="Description" content="[...] Организация эффективной системы борьбы с компьютерными вирусами невозможна без разработки конструктивной математической модели, описывающей их структуру и принципы функционирования. Наличие таких моделей позволит создать универсальные средства противодействия, доказать их эффективность и определить область применения. [...]"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"b5c5a13ae359b547a89110dcad4cbb8950436cb4-1498757996-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/adz01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Векторно-операторная модель компьютерных вирусов</h1><p><a href="/lib/?lang=ru&amp;author=%D0%97%D0%B5%D0%B3%D0%B6%D0%B4%D0%B0%2C%20%D0%94%D0%BC%D0%B8%D1%82%D1%80%D0%B8%D0%B9">Дмитрий Зегжда</a><br/> <em>КомпьютерПресс N 10/1993 (стр. 47-48)</em><br/> <em>ISSN 0868-6157</em><br/> <em>Октябрь 1993</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/adz01.html';</script>[<a style="" href="/lib/?lang=RU&amp;index=TH#adz01">Вернуться к списку</a>] [<a href="/lib/adz01.html#disqus_thread">Комментарии</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
 
<img src="img/adz01_ru.gif" alt="" align="left"/>
<p>Организация эффективной системы борьбы с компьютерными вирусами невозможна без разработки конструктивной математической модели, описывающей их структуру и принципы функционирования <a href="#L1">[1]</a>. Наличие таких моделей позволит создать универсальные средства противодействия, доказать их эффективность и определить область применения. С другой стороны, могут быть определены условия, требующиеся для распространения вирусов, и сформулированы требования к системе, делающие существование вирусов невозможным.</p>
<p>Предлагается рассматривать процесс заражения программы вирусом как синтез новой программы, состоящей из взаимно адаптированных копий исходной программы и вируса.</p>
<p>Необходимо отметить, что в данной статье рассматривается только один класс вирусов - файловые вирусы, имеющие сигнатуру. Хотя метод универсален, в качестве примеров используются вирусы, функционирующие в системе MS-DOS.</p>
<p>Определим базовые элементы предлагаемой модели.</p>
<p><em>Сигнатурой</em> называется фрагмент тела вируса, встречающийся во всех без исключения его копиях <a href="#L2">[2]</a>. Обычно в качестве сигнатуры берется фрагмент кода, характерный для этого вируса.</p>
<p>Программа, вирус, сигнатура в данной модели представляются вектором, компонентами которого являются байты. Элементы вектора нумеруются начиная с 0 (это удобно при программировании). Размер вектора будем писать после его имени в круглых скобках, а индекс в квадратных.</p>
<p>Определим набор операций над этими векторами:</p>
<ol>
<li>Операция равенства ( = ). Будем считать, что вектор X длиной n равен вектору Y длиной n, при условии, что компоненты X и Y попарно равны, то есть:
<pre>
		Х = Y &lt;=> { X[i] = Y[i] | i: О..п-1 }
	</pre></li>
<li>Операция внедрения (обозначим се через +). Если даны два вектора - A длиной n и B длиной m, то результатом внедрения В в А является вектор С длиной n+m, удовлетворяющий следующему условию:
<pre>
                                         (      | A[i]   для 0&lt;=i&lt;k     )
		A(n) + В(m) = С(n+m) &lt;=> ( C[i] | B[i-k] для k&lt;=i&lt;k+m   )
                                         (      | A[i-m] для k+m&lt;=i&lt;m+n )
		k: 0..n-1
	</pre></li>
</ol>
<p>В терминах теории операторов в общем случае факт заражения вирусом программы можно описать так:</p>
<pre>
	Pinf = V(P),
</pre>
<p>где V - оператор заражения программы вирусом; Р - чистая программа; Pinf - инфицированная программа.</p>
<p>Рассмотрим подробнее оператор заражения для сигнатурных файловых вирусов. Процесс заражения программы вирусом состоит из следующих этапов.</p>
<ol>
<li>Внесение возмущений в заражаемую программу. Имеются в виду действия вируса, направленные на преобразование программы в носитель вируса. Для этогo, во-первых, обеспечивается передача управления на код вируса (замена первых команд и адресов переходов у COM-файлов, точки входа у ЕХЕ-файлов) и, во-вторых, создается пространство для размещения кода вируса (стирание частей программы, увеличение размера файла, переписывание фрагментов программы из начала в конец и т.д. вплоть до архивации программы).
<p>Назовем оператор, осуществляющий эти действия, оператором возмущения и обозначим его D(p). Оператор преобразует программу р в искаженную программу, готовую к присоединению вируса.</p></li>
<li>Настройка вируса на заражаемую программу. Под настройкой вируса понимается процесс создания копии вируса, способной функционировать в данной программе. Сюда относятся настройка адресов, инициализация рабочих переменных, сохранение искаженных элементов программы в коде вируса, возможно, перекодировка кода вируса в зависимости от параметров программы и т.д. Заметим, что та часть кода вируса, которая не изменяется в процессе настройки, является сигнатурой.
<p>Назовем этот оператор оператором настройки и обозначим его А(р). Оператор осуществляет настройку вируса для работы в программе р.</p></li>
<li>Внесение кода вируса в заражаемую программу. Имеется в виду процесс внедрения копии вируса, настроенной на данную программу, в тело программы. Этот процесс в простейшем случае может состоять из конкатенации программы и вируса, кроме того, может применяться сложный алгоритм разбиения вируса на несколько фрагментов и вставка их в различные точки программы.
<p>Назовем его оператором инфицирования и обозначим I(р,v) Оператор вносит в программу р, подготовленную к заражению вирусом,
 
настроенную на эту программу копию вируса v.</p></li>
</ol>
<p>Тогда можно представить себе стуктуру зараженной программы следующим образом:</p>
<pre class="source">+-----------------------------------------+
|######PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP|
|PPPPPPPPP <b>ПРОГРАММА</b> PPPPPPPPPPPPPPPPPPPPP|
|PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP|
|PPPPPPPPPPPPP+---------------------------+
|PPPPPPPPPPPPP|PPPPPPvvvvvvvvvvvvvvvvvvvvv|
|-------------+vvvvv <b>ВИРУС</b> vvvvvvvvvvvvvvv|
|vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv|
|#########################################|
+-----------------------------------------+
P - программа
# - настраиваемая часть вируса
v - сигнатура вируса
</pre>
<p>В терминах этих операторов процесс заражения программы P некоторым вирусом, имеющим сигнатуру Sign, с получением зараженной программы Pinf описывается следующим уравнением:</p>
<pre>
	I( D(P), A(P) + Sign ) = Pinf,
</pre>
<p>где D(P) - программа после воздействия оператора возмущения; A(P) - вирус, адаптированый к программе; Sign - сигнатура вируса.</p>
<p>При такой постановке задача анализа вирусов сводится к нахождению сигнатуры Sign, с помощью которой можно однозначно определить наличие вируса в программе и (если они существуют) операторы, обратные к I и D, позволяющие восстановить зараженную программу.</p>
<p>Покажем, как в рамках данной модели можно найти сигнатуру файлового вируса, если его оператор возмущения удовлетворяет определенному ниже условию.</p>
<p>Для нахождения сигнатуры используются специальные файлы-мишени <a href="#L3">[3]</a>. Это типичные COM- и EXE-программы, состоящие из тривиальных команд и обладающие характерными особенностями, которые используются вирусами при заражении программ (например, COM-программы начинаются с инструкции перехода). Необходимо иметь набор таких мишеней различных размеров, так как некоторые вирусы заражают только файлы с длинной, лежащей в определенном диапазоне.</p>
<p>Пусть мы имеем некую мишень t, зараженную вирусом, имеющим сигнатуру:</p>
<pre>I( D(t), A(t) + Sign ) = tinf</pre>
<p>Допустим, что оператор возмущения D(t) осуществляет только перестановку фрагментов мишени и не изменяет составляющие ее байты. Таким образом, мы ввели ограничение на класс сигнатурных файловых вирусов, для которого справедлив предложеный метод. Этому условию удовлетворяет абсолютное большинство сигнатурных файловых вирусов. Однако, если вирус все же искажает фрагменты программы, метод даст правильный результат при условии, что изменения не очень значительны.</p>
<p>Итак, в этом случае мы имеем файл, в котором перемешаны фрагменты кода мишени и вируса. Поскольку коды команд мишени нам известны, мы можем удалить их из файла, и таким образом выделить экземпляр вируса. Обозначим его Vt:</p>
<pre>A(t) + Sign Vt</pre>
<p>Вирус состоит из настраиваемой части, в которую внедрена сигнатура. Для того чтобы ее найти, нам необходимо иметь две мишени, зараженные одним и тем же вирусом:</p>
<pre>A(tt) + Sign - Vtl
A(t2) + Sign - Vt2
</pre>
<p>Получение сигнатуры из этой системы уравнений сводится к нахождению наибольшей общей подпоследовательности у двух байтовых векторов (Vt1 и Vt2). Существует алгоритм, эффективно решающий эту задачу.</p>
<p>Задача нахождения операторов, обратных к I и D, также может быть решена (поскольку мы можем легко отделить мишень от вируса), однако в данной модели абсолютно не учитывается семантика вируса, и результаты будут очень ненадежны, так как алгоритм работы этих операторов чаще всего зависит от характеристик заражаемой программы.</p>
<p>По описанному методу реализована программа, которая была успешно опробована на довольно большом наборе вирусов <a href="#L4">[4]</a>.</p>
<p>Предложенный метод имеет следующие отличительные особенности:</p>
<ul>
<li>он базируется на формальной модели;</li>
<li>реализация позволяет автоматически выделять сигнатуры неизвестных вирусов;</li>
<li>на основе предложенной модели можно сформулировать признаки для классификации вирусов, основанной на механизме размножения.</li>
</ul>
<p>Предложенная модель может быть использована для построения перспективных универсальных самообучающихся антивирусных средств, основанных не на различных системах поиска заданного набора вирусов, а на их комплексном исследовании, позволяющем выработать эффективные способы борьбы против любого неизвестного вируса.</p>
<h2>Литература:</h2>
<ol>
<li><a name="L1"></a>Cohen F. <a href="/lib/afc01.html">Computer viruses - theory and experiments</a> // Proceedings of the 7th National Computer Security Conference, 1984.</li>
<li><a name="L2"></a>Pozzo М., Gray Т. Managing Exposure tо Potetially Malicious Programs // Рrосеedings of the 9th National Computer Security Conference, Sept., 1986.</li>
<li><a name="L3"></a>Котляров В.П., Зегжда Д.П. Средство сертификации и контроля несанкционированного доступа программ и данных компьютерных сетей. Третий всесоюзный семинар "Качество программного обеспечения", тезисы докладов. - М.: СНПО Алгоритм, 1991, с. 109-111.</li>
<li><a name="L4"></a>Защита информации в компьютерных системах. Теоретические аспекты защиты от вирусов / Зегжда Д.П., Матвеев В.A., Молотков С.В., Тихомиров Ю.В.; Под ред. Э.М. Шмакова - СПб: СПбГТУ, 1993.</li>
</ol>
[<a style="" href="/lib/?lang=RU&amp;index=TH#adz01">Вернуться к списку</a>] [<a href="/lib/adz01.html#disqus_thread">Комментарии</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=adz01">de</a><a href="/lib/index.php?lang=en&amp;id=adz01">en</a><a href="/lib/index.php?lang=es&amp;id=adz01">es</a><a href="/lib/index.php?lang=it&amp;id=adz01">it</a><a href="/lib/index.php?lang=fr&amp;id=adz01">fr</a><a href="/lib/index.php?lang=pl&amp;id=adz01">pl</a><a href="/lib/index.php?lang=ru&amp;id=adz01">ru</a><a href="/lib/index.php?lang=ua&amp;id=adz01">ua</a></div>
</body>
</html>
