<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Александр Фролов, Григорий Фролов 'Осторожно: компьютерные вирусы' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Александр Фролов, Григорий Фролов"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Фролов, Александр; Фролов, Григорий,Осторожно: компьютерные вирусы, adinf, таблицы, сети, netware, компьютера, вирус, antivirus, doctor, aidstest, area, сектора, разделов, диска, сервера, компьютер"/>
<meta name="Description" content="В этой книге вы найдете практически всю информацию, необходимую для квалифицированной борьбы с компьютерными вирусами в среде операционных систем MS-DOS, Microsoft Windows, IBM OS/2, Novell NetWare. Мы постарались обобщить громадный опыт, накопленный сотрудниками АО &amp;quot;ДиалогНаука&amp;quot; в этой области, делая упор на практические рекомендации. Книга предназначена как для начинающих пользователей персональных компьютеров, так и для тех, кто уже обладает достаточным опытом работы. В ней вы найдете методики борьбы с вирусами, описание приемов проведения антивирусной профилактики с помощью специально предназначенных для этого средств, описание наиболее распространенных вирусов и многое другое."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"c4b3844357797faeea8ef89a46a3f7bb287d7bc4-1498757856-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/aaf00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Осторожно: компьютерные вирусы</h1><p><a href="/lib/?lang=ru&amp;author=%D0%A4%D1%80%D0%BE%D0%BB%D0%BE%D0%B2%2C%20%D0%90%D0%BB%D0%B5%D0%BA%D1%81%D0%B0%D0%BD%D0%B4%D1%80">Александр Фролов</a>, <a href="/lib/?lang=ru&amp;author=%D0%A4%D1%80%D0%BE%D0%BB%D0%BE%D0%B2%2C%20%D0%93%D1%80%D0%B8%D0%B3%D0%BE%D1%80%D0%B8%D0%B9">Григорий Фролов</a><br/> <em>Персональный компьютер. Шаг за шагом. Том 5, М.: Диалог-МИФИ, 1996, 256 стр.</em><br/> <em> 1996</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/aaf00.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/%D0%9E%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%B6%D0%BD%D0%BE%3A%20%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D1%8B%D0%B5%20%D0%B2%D0%B8%D1%80%D1%83%D1%81%D1%8B.pdf">Скачать</a> PDF (7.61Mb) (Вы должны быть зарегистрированы на <a href="/forum">форуме</a>)<br/>[<a style="" href="/lib/?lang=RU&amp;index=AV#aaf00">Вернуться к списку</a>] [<a href="/lib/aaf00.html#disqus_thread">Комментарии</a>]<br/> 
<img src="img/aaf00/cover.gif" alt="Осторожно: компьютерные вирусы (обложка)" align="left"/>
<p>Персональный компьютер. Шаг за шагом<br/>
Пятый том<br/>
&copy; А.В. Фролов, Г.В. Фролов, 1996<br/>
Осторожно: компьютерные вирусы<br/>
Все, что вы должны знать о компьютерных вирусах</p>
<br clear="all"/>
<h2>Оглавление</h2>
<ul>
<li>ВВЕДЕНИЕ</li>
<li>Глава 1. ЧТО ТАКОЕ КОМПЬЮТЕРНЫЕ ВИРУСЫ И КАК ОНИ РАБОТАЮТ
<ul>
<li>Резидентные и нерезидентные вирусы</li>
<li>Вирусы в загрузочных секторах дисков</li>
<li>Вирусы, внедряющиеся в файлы</li>
<li>Вирус DIR</li>
<li>Маскировка вирусов</li>
<li>Внешние проявления болезни</li>
<li>Вирусы в файлах документов</li>
<li>Вирусы и Windows</li>
<li>Операционная система OS/2 и вирусы/2</li>
<li>Автоматизированные средства разработки вирусов</li>
<li>Плохие программы</li>
<li>Как происходит заражение</li>
</ul></li>
<li>Глава 2. КАК С НИМИ БОРОТЬСЯ
<ul>
<li>Методы обнаружения вирусов</li>
<li>Методы удаления вирусов</li>
<li>Подготовка к вирусной атаке</li>
<li>Можно ли предотвратить проникновение вирусов</li>
<li>Если вы обнаружили вирус</li>
<li>Как лечить компьютер</li>
</ul></li>
<li>Глава 3. ЛУЧШЕЕ СРЕДСТВО ПРОТИВ ВИРУСОВ
<ul>
<li>Антивирусный комплект АО &quot;ДиалогНаука&quot;</li>
<li>Антивирусный пакет AVP</li>
<li>Антивирусный пакет Microsoft Anti-Virus</li>
<li>Антивирус Norton AntiVirus for Windows 95</li>
<li>Антивирус для OS/2 - IBM AntiVirus/2</li>
</ul></li>
<li>Глава 4. ВИРУСЫ И ЛОКАЛЬНЫЕ СЕТИ
<ul>
<li>Разновидности локальных сетей</li>
<li>Способы распространения вирусов в сетях</li>
<li>Защита от вирусов одноранговых сетей</li>
<li>Защита централизованных сетей</li>
</ul></li>
<li>Глава 5. РАБОТА С BBS АО &quot;ДИАЛОГНАУКА&quot;
<ul>
<li>Сеанс связи с BBS АО &quot;ДиалогНаука&quot;</li>
<li>Файловые области BBS АО &quot;ДиалогНаука&quot;</li>
<li>Как получить новые версии антивирусных программ</li>
<li>Просмотр сообщений</li>
</ul></li>
<li>Глава 6. ВОССТАНОВЛЕНИЕ ФАЙЛОВОЙ СИСТЕМЫ
<ul>
<li>Проверка файловой системы</li>
<li>Поиск и восстановление файлов</li>
<li>Особенности файловой системы Microsoft Windows 95</li>
</ul></li>
<li>Глава 7. АХИЛЛЕСОВА ПЯТА ОПЕРАЦИОННОЙ СИСТЕМЫ
<ul>
<li>Операционная система MS-DOS</li>
<li>Операционная система Microsoft Windows версии 3.1</li>
<li>Операционная система Microsoft Windows 95</li>
<li>Операционная система IBM OS/2</li>
<li>Операционная система Microsoft Windows NT</li>
<li>Операционная система Novell NetWare</li>
</ul></li>
<li>ПРЕДМЕТНЫЙ УКАЗАТЕЛЬ</li>
<li>ЛИТЕРАТУРА</li>
</ul>
 
<h2>Аннотация</h2>
<p>В этой книге вы найдете практически всю информацию, необходимую для квалифицированной борьбы с компьютерными вирусами в среде операционных систем MS-DOS, Microsoft Windows, IBM OS/2, Novell NetWare. Мы постарались обобщить громадный опыт, накопленный сотрудниками АО &ldquo;ДиалогНаука&rdquo; в этой области, делая упор на практические рекомендации.</p>
<p>Книга предназначена как для начинающих пользователей персональных компьютеров, так и для тех, кто уже обладает достаточным опытом работы. В ней вы найдете методики борьбы с вирусами, описание приемов проведения антивирусной профилактики с помощью специально предназначенных для этого средств, описание наиболее распространенных вирусов и многое другое.</p>
<h2>Введение</h2>
<p>Персональные компьютеры получают все большее и большее распространение, внедряясь во все новые сферы человеческой деятельности. Этому способствует постоянное и устойчивое снижение стоимости компьютеров, появление удобных в работе программ с дружественным интерфейсом, всемерное развитие глобальных компьютерных сетей, которые предоставляют доступ к неограниченным запасам информации.</p>
<p>Надежность аппаратного обеспечения компьютерных систем стала достаточно высока, поэтому теперь человек передоверяет компьютерам решение многих жизненно важных задач. Пользователям современных компьютеров незнакомы проблемы, связанные со сбоями дисковых систем, занимающих целые комнаты в вычислительных центрах или другого столь же &ldquo;компактного&rdquo; оборудования ЭВМ серии ЕС.</p>
<p>Однако существует и другая опасность, подстерегающая даже высоконадежные резервированные компьютерные системы. Это так называемые компьютерные вирусы, которые есть ни что иное, как программы, специально предназначенные для того, чтобы нарушать нормальную работу компьютерных систем.</p>
<p>Коварность вирусов не знает границ, а вред, который они могут принести в крупной компьютерной системе, поражает воображение. Не зря во многих странах создание и распространение вирусов преследуется по закону как уголовное преступление. Представьте себе, какие могут быть последствия потери информации в крупном банке, медицинском учреждении или нарушения работы военной компьютерной системы. А между тем подобные случаи уже возникали в ряде стран.</p>
<p>Важное свойство компьютерных вирусов - способность &ldquo;размножаться&rdquo;, бесконтрольно распространяясь в компьютерной среде. Переносчики компьютерных вирусов - это дискеты, локальные и глобальные сети, а в последнее время и компакт-диски, особенно с нелицензионным программным обеспечением. Вирусная эпидемия может в считанные дни или часы охватить крупный вычислительный центр (а то и несколько центров), полностью парализовав его работу. При этом издержки могут исчисляться миллионами и десятками миллионов долларов.</p>
<p>Что же можно противопоставить этой более чем реальной угрозе?</p>
<p>Как и в борьбе с обычными вирусами, в борьбе с компьютерными вирусами применяется профилактика, диагностика и лечение.</p>
<p>Каждый из нас с детства знает, что перед едой нужно мыть руки. Эта нехитрая профилактическая мера может спасти вас от такого, например, заболевания, как холера. Когда вы работаете с персональным компьютером, также необходимо принимать ряд несложных профилактических мер, направленных на предупреждение вирусного вторжения. Тщательно соблюдая элементарные меры безопасности, можно сберечь немало времени и денег.</p>
<p>К сожалению, беспечность пользователей и системных администраторов часто приводит к плачевному исходу, когда для восстановления информации на диске компьютера приходится прибегать к услугам высококвалифицированных (и, соответственно, высокооплачиваемых) специалистов. Но и они не всесильны - если вирус расписал весь диск нулевыми байтами, то что тут можно сделать?</p>
<p>Для диагностики (обнаружения вирусов) обычно используют специальные программы, которые пользователи часто называют антивирусами (хотя есть более тонкая классификация).</p>
<p>Регулярная диагностика имеет большое значение, так как чем раньше обнаружен вирус, тем больше вероятность успеха лечения (все, как и с обычными вирусами). Дело в том, что компьютерные вирусы делают свое черное дело не сразу, а с некоторой задержкой, необходимой на распространение. Чем раньше будет обнаружен вирус, тем легче его обезвредить.</p>
<p>Что касается лечения компьютера, зараженного вирусами, то оно не всегда возможно. Лечение также выполняется при помощи специальных антивирусных программ, однако успех этой операции зависит от многих факторов. В частности, он зависит от того, насколько далеко зашли вредоносные действия вирусов.</p>
<p>Применение антивирусных программ не всегда эффективно. Вы должны уметь ими пользоваться, как и обычными лекарствами. Переписав у знакомого или из электронной доски объявлений пару антивирусных программ, многие ограничиваются их ежедневным запуском. Успокаивая себя отсутствием предупреждающих сообщений о появлении вирусов, такие пользователи бывают неприятно поражены, когда взявшийся &ldquo;из неоткуда&rdquo; вирус уничтожает на диске что-нибудь очень нужное.</p>
<p>Причина этого заключается в том, что в мире ежедневно создаются новые вирусы. Некоторые из этих вирусов используют изощренные приемы маскировки, затрудняющие их обнаружение. Поэтому старые версии антивирусных программ оказываются бессильными.</p>
<p>Одна из основных причин распространения вирусов - программы, полученные случайным образом или загруженные из электронных досок объявлений. Риск получения вируса вместе с лицензионным дистрибутивом программного обеспечения намного меньше, хотя он все-таки есть. Поэтому новое программное обеспечение имеет смысл проверять самыми последними версиями антивирусных средств.</p>
<p>Нам хотелось бы также избавить вас от излишней &ldquo;вирусофобии&rdquo;. Иногда вирусам приписывают фантастические возможности. Услышав о гипнотизирующих и зомбирующих вирусах, бедный пользователь в страхе шарахается от компьютера или надевает резиновые перчатки, вставляя дискету. Не надо этого делать! Во-первых, перчатки все равно не помогут, а во-вторых... впрочем, может быть завтра такой вирус появится и на самом деле.</p>
<p>В этой книге мы рассмотрим различные аспекты, связанные с компьютерными вирусами. Мы уделим большое внимание механизму распространения вирусов различных типов, так как знание этого механизма - половина успеха в борьбе с вирусами.</p>
<p>Вы узнаете о том, как правильно выполнять антивирусную профилактику отдельных компьютеров и локальный сетей компьютеров, научитесь пользоваться самыми современными антивирусными средствами, причем не только программными, но и аппаратными.</p>
<p>Так как раннее обнаружение вирусов увеличивают шансы на успех, мы приведем соответствующие методики и рекомендации, в частности, мы расскажем о том, как обнаружить вирусы-невидимки, маскирующие свое присутствие в системе.</p>
<p>Для тех, кто пользуется антивирусными средствами АО &ldquo;ДиалогНаука&rdquo;, есть возможность получения самых последних версий антивирусных программ через модем. Поэтому мы расскажем о том, как пользоваться электронной доской BBS, которая создана специально для подписчиков антивирусного комплекта &ldquo;ДиалогНаука&rdquo;.</p>
<p>Отдельная глава книги посвящена борьбе с вирусами в локальных сетях персональных компьютеров, получивших повсеместное распространение. Плохо защищенная локальная сеть представляет собой как раз ту &ldquo;питательную среду&rdquo;, в которой компьютерные вирусы размножаются особенно быстро и где они могут нанести наибольший вред. Мы приведем конкретные рекомендации для различных сетевых операционных систем, которые предназначены для пользователей сети и системных администраторов.</p>
<p>Для тех из вас, кто интересуется проблемой вирусов глубже, мы расскажем о наиболее слабых местах операционных систем, которые служат объектом нападения вирусов. Мы также расскажем о некоторых приемах восстановления информации после вирусных атак, которые могут быть рекомендованы только для квалифицированных пользователей или системных программистов.</p>
<h2>Благодарности</h2>
<p>Мы приносим свою искреннюю благодарность всем, кто помогал нам писать эту книгу и надеемся, что она станет серьезной поддержкой пользователям компьютеров в борьбе с вирусами.</p>
<p>В первую очередь мы признательны сотрудникам АО &ldquo;ДиалогНаука&rdquo;, в тесном контакте с которыми создавалась книга:</p>
<ul>
<li><em>генеральному директору AO &ldquo;ДиалогНаука&rdquo; Антимонову Сергею Григорьевичу - за идею создания книги о том, как бороться с вирусами;</em></li>
<li><em>руководителю антивирусного отдела AO &ldquo;ДиалогНаука&rdquo; Лященко Юрию Павловичу - за редактирование книги и многочисленные советы по ее содержанию;</em></li>
<li><em>Лозинскому Дмитрию Николаевичу - за популярное изложение жизненного цикла вируса и за предоставленные описания вирусов;</em></li>
<li><em>Данилову Игорю Анатольевичу - за многочисленные консультации по вопросам функционирования современных вирусов, а также за предоставленные описания вирусов;</em></li>
<li><em>Ладыгину Виталию Сергеевичу - за подробное описание вируса Win.CyberTech и рассказ о вирусах, маскирующихся на уровне контроллера жесткого диска;</em></li>
<li><em>Фомину Юрию Николаевичу - за рассказ о принципах аппаратной защиты от вирусов;</em></li>
<li><em>Мостовому Дмитрию Юрьевичу и Зуеву Денису Григорьевичу - за консультации по использованию программы ADinf и лечащего модуля</em></li>
</ul>
<p>Кроме того, мы благодарим Абрамкина Алексея Михайловича за прекрасные рисунки, которые он сделал для нашей книги, Фролову Ольгу Викторовну, ставшую одной из первых читателей, корректора Кустова В. С. и сотрудников издательского отдела АО &ldquo;Диалог-МИФИ&rdquo; Голубева О. А., Дмитриеву Н. В., Виноградову Е. К. и Кузьминову О. А.</p>
<h2>Как связаться с авторами</h2>
<p>Вы можете передать нам свои замечания и предложения по содержанию этой и других наших книг через электронную почту:</p>
<table summary="">
<tr><th>Сеть</th><th>Наш адрес</th></tr>
<tr><td>Relcom</td><td><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="e482968b888b92a483888597ca859487ca8b9683">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></td></tr>
<tr><td>CompuServe</td><td>>internet: <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="1573677a797a6355727974663b7465763b7a6772">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></td></tr>
<tr><td>GlasNet</td><td><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="e086928f8c8f96a0878c8193ce819083ce8f9287">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></td></tr>
<tr><td>UUCP</td><td>cdp!glas!frolov</td></tr>
<tr><td>Internet</td><td><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="b5d3c7dad9dac3f5d2d9d4c69bd4c5d69bdac7d2">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></td></tr>
</table>
<p>Если электронная почта вам недоступна, присылайте ваши отзывы в АО "Диалог-МИФИ" по адресу:</p>
<address>
Адрес: инд. 115409, Москва, ул. Москворечье, 31, корп. 2,<br/>
Тел. (095) 324-43-77
</address>
<p>По вопросом антивирусной защиты обращайтесь непосредственно в АО "ДиалогНаука" по адресу:</p>
<address>
Адрес: инд. 117967, Москва ГСП-1, ул. Вавилова 40, ВЦ РАН, офис 103а.<br/>
Тел. (095) 135-6253, 137-0150, 938-2970<br/>
FidoNet: 2:5020/69<br/>
E-mail:<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="eb8a859f829d8299ab8f828a8798c5869880c5989e">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> - поставки и обслуживание<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="ee8c818cae8a878f829dc0839d85c09d9b">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> - по вопросам связи со станцией BBS<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="58343722183c3139342b76352b33762b2d">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> - передача новых вирусов<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="dbb2bf9bbfb2bab7a8f5b6a8b0f5a8ae">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> - передача новых вирусов<br/>
Сервер WWW: http://www.dials.ccas.ru<br/>
Сервер FTP: ftp.dials.ccas.ru<br/>
</address>
<p>Приносим свои извинения за то, что не можем ответить на каждое письмо. Мы также не занимаемся рассылкой дискет и исходных текстов к нашим книгам. По этому вопросу обращайтесь непосредственно в издательство &ldquo;Диалог-МИФИ&rdquo;.</p>
<h2>1 Что такое компьютерные вирусы и как они работают</h2>
<p>Что же такое компьютерный вирус? Представьте себе работу мелкого клерка и его рабочее место. На столе стоит телефон, копировальный аппарат и другие канцелярские принадлежности. Рядом стоит шкаф с папками и документами.</p>
<p>В папках содержатся инструкции, которые клерк должен выполнять. Каждый день он берет очередную папку и начинает с ней работать. Инструкции в папках могут содержать алгоритмы расчета зарплаты, указания по обработке поступающей документации и т. д.</p>
<p>Клерк монотонно выполняет свою работу день за днем и вдруг недоброжелатель вкладывает ему в папку еще один лист с дополнительными инструкциями. В них клерку предлагается скопировать этот лист на копировальной машине и вложить его в следующую папку. Со временем такой лист распространится по папкам и в конце концов, его копия будет находиться в каждой папке.</p>
<p>Кроме инструкций, отвечающих за распространение, дополнительный лист может содержать другие инструкции. Например, в них может указываться, что клерк должен уничтожить папку, взятую наугад из шкафа с документами или перевести некоторую сумму на определенный счет в банке.</p>
<p>Теперь представьте, что работу клерка выполняет центральный процессор. Шкаф с папками документов - это жесткий диск компьютера. Сами папки - это файлы программ, записанные на диске. В этом случае дополнительный лист, подброшенный кем-то в одну из папок, достаточно точно соответствует компьютерному вирусу.</p>
<p>Наиболее общее определение компьютерного вируса можно дать как самораспространяющийся в информационной среде компьютеров программный код. Он может внедряться в выполнимые файлы программ, распространяться через загрузочные секторы дискет и жестких дисков.</p>
<p>Существуют достаточно оригинальные вирусы, распространяющиеся через файлы документов, подготовленных в текстовом процессоре Microsoft Word for Windows и электронной таблице Microsoft Excel for Windows. Кроме перечисленных вирусов существуют и другие, например, вирусы, заражающие командные файлы - файлы с расширением BAT. Прогресс в мире вирусов не стоит на месте, десятки, если не сотни скучающих программистов делают свое черное дело и на свет появляются все более страшные монстры.</p>
<p>К сожалению, действие большинства вирусов не ограничивается размножением и распространением. Они могут выполнять относительно безопасные или напротив, разрушительные действия.</p>
<p>Внешне действия вирусов могут выражаться в том, что периодически, например, по достижении определенного времени, вирус активизируется и выполняет какие-либо операции. Вирусы могут выводить на экран посторонние надписи, "осыпать" символы, уже отображенные на экране, перезагружать компьютер, замедлять работу компьютера, исполнять на встроенном динамике компьютера всевозможные мелодии, удалять файлы и каталоги, стирать выбранные случайным образом секторы жестких и гибких дисков.</p>
<p>Существуют вирусы, делающие &ldquo;полезную&rdquo; работу. Например, один из вирусов, поражающих файлы программ, одновременно сжимает их, уменьшая размер. Благодаря этому на диске компьютера становится больше свободного места. Такой вирус выполняет функции широко распространенной программы DIET, но делает это автоматически, не спрашивая на то разрешения у пользователя.</p>
<p>Можно придумать много другой полезной работы, которая под силу вирусам. Однако мы не станем отнимать хлеб у писателей вирусов, скажем только, что даже &ldquo;полезные&rdquo; вирусы могут быть очень опасны.</p>
<p>Некоторые эффекты, вызываемые вирусами, например, внезапная перезагрузка компьютера или зависание, часто воспринимаются как аппаратная неисправность компьютера. На это и рассчитывают писатели вирусов. Действительно, причиной этому может послужить аппаратная неисправность компьютера.</p>
<p>Однако не торопитесь вызывать технических специалистов или самостоятельно открывать компьютер. Сначала выполните полную диагностику компьютера, воспользовавшись всеми антивирусными средствами, которыми вы располагаете.</p>
<p>В настоящее время насчитываются тысячи различных вирусов и их модификаций. Мы будем классифицировать их по способу распространения. Подавляющее большинство вирусов можно разделить на две большие группы:</p>
<ul>
<li><em>вирусы, внедряющиеся в файлы,</em></li>
<li><em>вирусы, заражающие загрузочные секторы жестких и гибких дисков.</em></li>
</ul>
<p>Существует много вирусов, которые одновременно можно включить в обе эти группы. Такие вирусы являются комбинированными. Они могут распространяться, заражая файлы и загрузочные секторы дисков.</p>
<h3>Резидентные и нерезидентные вирусы</h3>
<p>Операционная система MS-DOS является однозадачной. В любой момент времени может работать только одна программа. Когда пользователь закончит с ней работать, программа выгружается из оперативной памяти и пользователь может запустить новую программу. Естественно, это не всегда удобно. Например, если вы пишете в текстовом редакторе финансовый отчет, вам может потребоваться калькулятор. Очень неудобно для запуска калькулятора каждый раз завершать текстовый редактор, а потом запускать его снова.</p>
<p>Чтобы как-то смягчить неудобства, вызванные однозадачностью MS-DOS, был создан механизм резидентных программ. При запуске резидентной программы она сразу возвращает управление операционной системе, но оставляет в оперативной памяти резидентный модуль.</p>
<p>Даже если потом запускаются другие программы этот модуль остается в памяти. Затем, когда пользователь нажимает определенную комбинацию клавиш или при другом условии резидентная программа может активизироваться и выполнить некоторую работу.</p>
<p>В качестве примера можно привести программы резидентных калькуляторов. Они могут быть загружены из командной строки операционной системы или из файла AUTOEXEC.BAT и остаются резидентными в памяти. Если пользователь нажимает определенную комбинацию клавиш, на экране появляется панель калькулятора. Пользователь может выполнить любые вычисления и вернуться в свою программу. Резидентные программы могут выполнять и другие действия. Например, они могут выполнять функции будильника.</p>
<p>Механизм резидентных программ, предусмотренный для сугубо мирных целей, был использован авторами вирусов. Обычные, нерезидентные вирусы получают управление и становятся активными только во время запуска зараженной программы. После запуска вирусом настоящей программы, он окончательно теряет управление, до тех пор, пока зараженная программа опять не будет запущена. За это небольшое время вирус должен заразить другие программы и выполнить заложенные в него автором дополнительные функции.</p>
<p>Резидентный вирус, получив управление, оставляет в оперативной памяти компьютера небольшой модуль, который остается активным вплоть до перезагрузки компьютера. Резидентный модуль вируса может использоваться для решения самых различных задач.</p>
<p>Обычно он применяется для заражения новых программ. Резидентный модуль отслеживает запуск или открытие файлов программ, проверяет, не были ли они уже заражены, и если нет, то заражает их.</p>
<p>Интересно, что если на компьютере, зараженном резидентным вирусом, поражающим выполнимые файлы при их открытии, запустить антивирусную программу, которая не может определить этот вирус, то по окончании проверки окажутся зараженными все проверяемые выполнимые файлы.</p>
<p>Некоторые разновидности вирусов, называемые стелс-вирусами, используют резидентный модуль, чтобы замаскировать свое присутствие. Они могут перехватывать обращения к файловой системе и скрывать изменение длины зараженных файлов. Более подробно о стелс-вирусах вы можете прочитать в разделе &ldquo;Маскировка вирусов&rdquo;.</p>
<p>И, конечно, резидентный модуль используется для создания всевозможных спецэффектов. Здесь все зависит от фантазии и знаний, которыми обладает автор вируса. Те, кто попроще, могут испортить данные, записываемые на диск, замедлить работу компьютера. Более изысканные в программировании и менее злобные авторы создают всевозможные видеоэффекты и звуковые композиции.</p>
<p>Любая резидентная программа, и в том числе резидентные модули вирусов, уменьшают объем доступной оперативной памяти. Это изменение можно заметить с помощью команды MEM, входящей в состав операционной системы MS-DOS.</p>
<p>Команда MEM отображает информацию об использовании оперативной памяти компьютера. С помощью нее можно узнать, сколько оперативной памяти установлено на компьютере, сколько памяти занято и сколько свободно для использования:</p>
<pre>
Memory Type         Total      Used       Free
----------------  --------   --------   --------
Conventional          640K       204K      436K
Upper                   0K         0K        0K
Reserved              384K       384K        0K
Extended (XMS)     15 360K    14 336K    1 024K
----------------  --------   --------  --------
Total memory       16 384K    14 924K    1 460K

Total under 1 MB      640K       204K      436K

Total Expanded (EMS)                1 024K (1 048 576 bytes)
Free Expanded (EMS)                 1 024K (1 048 576 bytes)
Largest executable program size       436K   (446 256 bytes)
Largest free upper memory block         0K         (0 bytes)
MS-DOS is resident in the high memory area.
</pre>
<p>Команда MEM позволяет подробно исследовать резидентные модули, загруженные в память. Для этого при вызове команды ей надо указать дополнительные параметры. Подробное описание команды MEM изложено в десятом томе &ldquo;Библиотеки системного программиста&rdquo; - &ldquo;Компьютер IBM PC/AT, MS-DOS и Windows. Вопросы и ответы&rdquo;. Здесь мы приведем только основные сведения.</p>
<pre>MEM [/CLASSIFY | /DEBUG] [/PAGE]</pre>
<p>Если указать дополнительный параметр /CLASSIFY (или /C), то будет представлена информация по каждому резидентному модулю, размещенному в оперативной памяти.</p>
<p>Вместо параметра /CLASSIFY можно указать параметр /DEBUG (или /D). В этом случае будет собрана дополнительная информация о загруженных драйверах.</p>
<p>Команда MEM выводит на экран очень много информации. Так как экран компьютера может одновременно отображать ограниченное количество строк, то выполняется свертка изображения. Дополнительный параметр /PAGE (или /P) позволяет после заполнения очередного экрана выдерживать паузу.</p>
<p>Вирусы могут оставлять в оперативной памяти резидентные модули. Фактически все загрузочные вирусы и большинство файловых вирусов являются резидентными.</p>
<p>Резидентные модули вируса могут затруднить его обнаружение и удаление. Чтобы не дать вирусу шанс получить управление и оставить резидентный модуль в памяти, рекомендуется для проверки компьютера выполнять загрузку с чистой системной дискеты.</p>
<h3>Вирусы в загрузочных секторах дисков</h3>
<p>Сразу после включения питания компьютера начинает работать процедура проверки POST (Power On Self Test). В ходе проверки определяется конфигурация компьютера, проверяется работоспособность основных его подсистем. Процедура POST записана в микросхеме постоянного запоминающего устройства, расположенного на системной плате компьютера.</p>
<p>Если компьютер имеет энергонезависимую память (CMOS-память), из нее считываются значения текущих даты и времени, конфигурация дисковой подсистемы. Заметим, что CMOS-память установлена практически на всех компьютерах. Она отсутствовала только на первых моделях компьютеров IBM PC и IBM PC/XT.</p>
<p>Затем процедура POST проверяет, вставлена ли дискета в дисковод A:. Если дискета вставлена, тогда дальнейшая загрузка операционной системы происходит с дискеты. Если дискета не вставлена, загрузка выполняется с жесткого диска.</p>
<p>Практически все современные системные платы и версии программы Setup позволяют изменить порядок загрузки компьютера. Например, вы можете указать, что компьютер сразу должен загружаться с жесткого диска и только в случае отсутствия жесткого диска загрузка будет выполняться с дискеты.</p>
<p>Последовательность загрузки операционной системы MS-DOS с дискеты и с жесткого диска немного различаются. Мы опишем оба случая, так как это важно для понимания механизма распространения загрузочных вирусов.</p>
<h4>Загрузка компьютера с системной дискеты</h4>
<p>Если загрузка компьютера происходит с дискеты, то процедура POST считывает с нее загрузочную запись (Boot Record) в оперативную память. Эта запись всегда расположена в самом первом секторе дискеты и представляет собой маленькую программу. Кроме программы загрузочную запись содержит структуру данных, определяющую формат дискеты и т. д. Затем процедура POST передает управление загрузочной записи.</p>
<p>Получив управление, загрузочная запись приступает непосредственно к загрузке операционной системы. Она считывает с дискеты и загружает в оперативную память файлы IO.SYS и MSDOS.SYS. Для операцилнных систем, совместимых с MS-DOS эти имена могут отличаться. Например в операционной системе IBM PC-DOS загружаются файлы IBMIO.COM IBMSYS.COM.</p>
<p>Затем, если на дискете записан файл конфигурации CONFIG.SYS, анализируется его содержимое и загружаются указанные в нем драйверы.</p>
<p>После этого с дискеты считывается командный процессор COMMAND.COM и управление передается ему. Командный процессор завершает загрузку операционной системы и выполняет команды, записанные в файле AUTOEXEC.BAT.</p>
<p>После выполнения команд, записанных в файле AUTOEXEC.BAT, командный процессор отображает на экране системное приглашение и ожидает ввода команд:</p>
<pre>A:\&gt;</pre>
<p>Файлы CONFIG.SYS и AUTOEXEC.BAT могут отсутствовать. Если отсутствует файл AUTOEXEC.BAT, тогда после окончания загрузки операционной системы командный процессор предлагает ввести текущую дату и время:</p>
<pre>
	Current date is Fri 15-04-1996
	Enter new date (mm-dd-yy):

	Current time is  2:28:33.47p
	Enter new time:
</pre>
<p>Если вы не желаете изменять дату и время, нажмите два раза клавишу &lt;Enter&gt;. В этом случае дата и время останутся без изменения, и на экране появится системное приглашение MS-DOS. Вы можете создать на системной дискете пустой файл AUTOEXEC.BAT, тогда дата и время запрашиваться не будут и после загрузки операционной системы на экране сразу появится системное приглашение.</p>
<h4>Загрузка компьютера с несистемной дискеты</h4>
<p>Мы рассмотрели вариант загрузки компьютера с системной дискеты. Возможен вариант, при котором пользователь случайно или по ошибке попытается загрузить компьютер с несистемной дискеты. На такой дискете отсутствуют файлы операционной системы IO.SYS, MSDOS.SYS и COMMAND.COM. Тем не менее, загрузочная запись присутствует даже на несистемной дискете.</p>
<p>Когда процедура POST считывает и передает управление загрузочной записи, она определяет, что дискета несистемная (так как на ней отсутствуют файлы операционной системы) и отображает на экране соответствующее сообщение:</p>
<pre>
	Non-System disk or disk error
	Replace and press any key when ready
</pre>
<p>В некоторых случаях сообщение может иметь другой внешний вид:</p>
<pre>
	This disk is not bootable
	
	If you wish to make it bootable,
	run the DOS program SYS after the
	system has been loaded
	
	Please insert a DOS diskette into
	the drive and strike any key...
</pre>
<p>Эти сообщения означают, что дискета не содержит необходимых файлов и загрузить операционную систему с нее невозможно. Вам предлагается вставить в компьютер системную дискету и перезагрузить компьютер.</p>
<p>В разделе &ldquo;Создание системной дискеты&rdquo; мы расскажем, как из несистемной дискеты сделать системную.</p>
<div class="notel">
<em>Загрузочный вирус может распространяться как через системные, так и через несистемные дискеты</em>
</div>
<h4>Загрузка компьютера с жесткого диска</h4>
<p>Загрузка компьютера с жесткого диска происходит несколько сложнее. Процедура POST считывает с жесткого диска главную загрузочную запись (MBR - Master Boot Record) и записывает ее в оперативную память компьютера. Главная загрузочная запись содержит программу первоначальной загрузки и таблицу разделов, в которой описаны все разделы жесткого диска.</p>
<p>Формирование главной загрузочной записи и таблицы разделов происходит во время первоначальной установки компьютера и разделения его жестких дисков на разделы и логические диски. Обычно эту операцию делают один раз, используя для этого команду FDISK операционной системы MS-DOS.</p>
<p>Главная загрузочная запись хранится в самом первом секторе жесткого диска. Поэтому процедура POST всегда знает, где она расположена.</p>
<p>Затем управление передается только что прочитанной с диска программе первоначальной загрузки. Она анализирует содержимое таблицы разделов, выбирает активный раздел и считывает загрузочную запись активного раздела (Boot Record). Загрузочная запись активного раздела аналогична загрузочной записи системной дискеты и выполняет те же самые функции. Она считывает в оперативную память файлы IO.SYS и MSDOS.SYS, анализирует файл конфигурации CONFIG.SYS, записанный на диске активного раздела, и загружает указанные в нем драйверы. После этого управление передается командному процессору COMMAND.COM. Командный процессор завершает загрузку операционной системы, а затем выполняет команды, записанные в файле AUTOEXEC.BAT.</p>
<h4>Как работает загрузочный вирус</h4>
<p>При заражении дискеты или жесткого диска компьютера загрузочным вирусом, последний заменяет загрузочную запись или главную загрузочную запись. Настоящая загрузочная запись или главная загрузочная запись обычно не пропадает (некоторые вирусы не сохраняют исходной загрузочной записи). Вирус копирует их в один из свободных секторов (рис. 1.1).</p>
<p>Таким образом, вирус получает управление сразу после завершения процедуры POST. Затем он, как правило, действует по стандартному алгоритму. Вирус копирует себя в конец оперативной памяти, уменьшая при этом объем свободной оперативной памяти. После этого он перехватывает несколько функций BIOS, так что обращение к ним передает управление вирусу. В конце вирус загружает в оперативную память компьютера настоящий загрузочный сектор и передает ему управление. Далее компьютер загружается как обычно, но вирус уже находится в памяти и может контролировать работу всех программ и драйверов.</p>
<div align="center">
<img src="img/aaf00/fig11.gif" alt="Рис. 1.1. Загрузочный вирус"/>
<p><strong>Рис. 1.1. Загрузочный вирус</strong></p>
</div>
<p>Обычно загрузочный вирус заражает компьютер, когда пользователь загружает компьютер с дискеты, на которой уже есть вирус (вне зависимости от того системная эта дискета или нет). Чаще всего это происходит случайно. Вы работаете с дискетой и оставляете ее в дисководе A: компьютера. Если теперь вы перезагрузите компьютер или произойдет сбой работы компьютера из-за скачка питания, то загрузка компьютера начинается с зараженной дискеты и управление получает вирус. Он сразу заражает жесткий диск компьютера, устанавливает себя резидентным в памяти. Затем вирус загружает компьютер обычным образом. Если дискета загрузочная, то произойдет загрузка операционной системы, в противном случае на экране появляется предложение вставить в дисковод A: системную дискету и перезагрузить компьютер.</p>
<p>Теперь даже после перезагрузки компьютера с жесткого диска путем выключения питания удалить вирус нельзя, так как он уже записан на жестком диске. Сразу после включения питания компьютера вирус опять получит управление и разместит себя резидентно в памяти.</p>
<p>Дальнейшее распространение зависит от особенностей вируса. Обычно применяется простая схема. Если вы вставите в дисковод дискету, не зараженную вирусом, и обратитесь к ней, например, чтобы считать названия записанных на ней файлов, вирус получает сигнал, что дискета вставлена в дисковод. Вирус считывает загрузочную запись с дискеты и записывает ее в какой-либо другой сектор дискеты. Вместо оригинальной загрузочной записи записывается код вируса.</p>
<div class="notel">
<em>Некоторые вирусы, например Joshi, форматируют на дискете дополнительную дорожку. Информация с этой дорожки не может быть считана и записана обычными средствами операционной системы. Вирус может использовать эту дорожку для хранения настоящего загрузочного сектора и некоторых своих модулей. Надо заметить, что использование дополнительных дорожек не является изобретением писателей вирусов. Эта методика применяется многими системами защиты от копирования</em>
</div>
<p>Интересный эффект получается, если дискета или диск последовательно заражены несколькими загрузочными вирусами. В зависимости от того, какие секторы эти вирусы используют для хранения настоящего загрузочного сектора, возможны два случая.</p>
<p>В первом случае, когда вирусы используют различные секторы, они будут работать вместе. Сначала получает управление вирус, заразивший дискету последним. Он выполняет свою работу и загружает второй вирус, который заразил дискету раньше. В принципе такая цепочка вирусов может быть достаточно длинной. Последний вирус, который получит таким образом управление, в конце концов загрузит настоящий загрузочный сектор.</p>
<p>Обычно перед заражением диска (или дискеты), загрузочные вирусы проверяют, был ли он заражен ранее. Поэтому повторное заражение одним вирусом не происходит. Если же после заражения диска одним вирусом, его заразит другой загрузочный вирус, то первый вирус посчитает, что он не заражал диск раньше и заразит его еще раз. В результате может потеряться исходная загрузочная запись и компьютер зависнет во время загрузки.</p>
<p>Во втором случае вирусы, заразившие дискету, хранят настоящий загрузочный сектор в одном и том же месте. Когда второй вирус заражает дискету, он записывает код первого вируса в сектор, где первый вирус хранит настоящую загрузочную запись. В результате исходная загрузочная запись оказывается безвозвратно утерянной, а компьютер зависает: второй вирус будет снова и снова считывать и запускать свой вирусный код.</p>
<h4>Вирус Ball</h4>
<p>Первый раз мы столкнулись с вирусами много лет назад, еще будучи студентами московского инженерно физического института. В то время персональные компьютеры еще только начали появляться и были большой редкостью. Наша кафедра снимала несколько часов машинного времени в неделю в одном научном институте.</p>
<p>И вот в один прекрасный день на экране компьютера появился небольшой шарик. Он перемещался по экрану, отражаясь от его границ и некоторых символов. Первое время мы были в ужасной панике, думая что испортили дорогостоящий компьютер IBM PC/XT и все его программное обеспечение.</p>
<p>После перезагрузки шарик исчезал и мы надеялись, что дефект пропадет сам собой. Только через несколько дней мы решили сказать об этом местным инженерам. Они прореагировали очень спокойно, сообщив нам, что это компьютерный вирус Ping Pong, живущий на их компьютерах очень давно.</p>
<p>Для борьбы с вирусом использовали специальную антивирусную программу SCAN фирмы McAfee. Она легко находила вирус на дискетах и жестких дисках компьютеров, а затем удаляла его. После такой процедуры вирус долгое время не появлялся и некоторое время мы жили спокойно.</p>
<p>Однако кроме нас машинное время снимали много других организаций и каждый приходил работать со своими дискетами, поэтому вирус кочевал с дискеты на дискету. Вылечить его было практически невозможно, так как очень сложно было заставить всех пользователей проверить все свои дискеты.</p>
<p>Впоследствии выяснилось, что вирус Ping Pong, он же вирус Ball, распространялся через загрузочные секторы дискет и дисков. Оригинальный загрузочный сектор записывается на свободное место. Соответствующий сектор помечается как испорченный (Bad cluster). Испорченный кластер несколько уменьшал доступный размер дисков и дискет, но мы списывали это на их низкое качество.</p>
<h4>Вирус Stoned</h4>
<p>Второй вирус, с которым мы столкнулись, также оказался загрузочным. Антивирусные программы распознавали его как вирус Stoned. Он получил это название из-за того, что во время загрузки операционной системы на экране иногда появляется надпись "Your PC is now Stoned!". Мы немного остановимся на этом вирусе, так как он имеет очень много модификаций. Насчитывается большое количество вирусов, для которых он послужил прототипом.</p>
<p>Вирус достаточно легко опознается визуально. На дискетах он записывает себя на место загрузочной записи, а на жестких дисках - на место главной загрузочной записи. Если вы просмотрите соответствующие секторы в любом редакторе, например Norton Disk Editor, вы увидите надписи "Your PC is now Stoned!" и "LEGALISE MARIJUANA!". Как пользоваться программой Norton Disk Editor, вы узнаете из шестой главы нашей книги.</p>
<p>Когда вирус Stoned появился в первый раз, мы изучали язык ассемблера и особенности архитектуры персональных компьютеров, совместимых с IBM PC. Поэтому мы полностью дизассемблировали код вируса и подробно его изучили.</p>
<p>На дискетах исходная загрузочная запись копируется в третий сектор на первой стороне нулевой дорожки. Для дискет с объемом 360 Кбайт этот сектор приходится на последний сектор корневого каталога.</p>
<p>При заражении жесткого диска исходная главная загрузочная запись копируется в другое место. Она размещается в седьмом секторе на нулевой стороне нулевой дорожки. Этот сектор обычно не используется и остается свободным.</p>
<p>Некоторые загрузочные вирусы, не использующие методы маскировки (которые будут описаны ниже) могут быть легко обнаружены просмотром загрузочного сектора. Как выглядит загрузочная запись дискеты, созданной средствами операционной системы MS-DOS версии 5.0, в редакторе Disk Editor из пакета Norton Utilities вы можете посмотреть на рисунке 1.2.</p>
<div align="center">
<img src="img/aaf00/fig12.gif" alt="Рис. 1.2. Загрузочная запись"/>
<p><strong>Рис. 1.2. Загрузочная запись</strong></p>
</div>
<p>Загрузочная запись на ваших дискетах и жестких дисках может отличаться от приведенной нами. Это зависит как от версии операционной системы, используемой при форматировании диска, так и от некоторых других параметров.</p>
<p>Если вирус заразит загрузочную запись, он, естественно, изменит ее. Во многих случаях такое изменение заметно невооруженным взглядом. На рисунке 1.3 мы привели внешний вид загрузочного сектора дискеты, зараженной вирусом Form.</p>
<div align="center">
<img src="img/aaf00/fig13.gif" alt="Рис. 1.3. Вирус Form в загрузочной записи"/>
<p><strong>Рис. 1.3. Вирус Form в загрузочной записи</strong></p>
</div>
<p>К сожалению, не все загрузочные вирусы можно так легко распознать. Активные загрузочные вирусы, использующие различные механизмы маскировки, могут обманывать Disk Editor. Например, такие вирусы могут перехватывать обращение Disk Editor к первому сектору жестких дисков и дискет, подменяя этот сектор копией оригинального первого сектора (копия первого сектора создается вирусом в момент заражения диска). В этом случае изменение загрузочного сектора не будет заметно.</p>
<div class="notel">
<em>Перед тем как использовать Disk Editor, загрузите MS-DOS с чистой системной дискеты. Программа Disk Editor также должна быть записана на дискете. В этом случае вирус не сможет задействовать свои механизмы маскировки</em>
</div>
<h3>Вирусы, внедряющиеся в файлы</h3>
<p>Самую большую группу составляют вирусы, внедряющиеся в файлы. Они могут заражать практически любые файлы, содержащие выполнимый код. В первую очередь это файлы программ, имеющие расширения COM и EXE. Но не только они подвергаются нападению вирусов. Файлы оверлеев (расширения имен файлов OVL, OVI, OVR и др.), драйверов (SYS) также могут быть инфицированы.</p>
<p>Существует три большие группы файлов, которые непосредственно может запускать пользователь, вводя их имя в системном приглашении операционной системы MS-DOS. К ним относятся выполнимые файлы в формате COM и EXE, а также командные файлы, имеющие расширение BAT.</p>
<p>Выполнимые файлы в формате COM и EXE в корне отличаются от командных файлов с расширением BAT. В отличие от последних, они состоят из команд центрального процессора, то есть содержат машинные инструкции. Вместе с командами процессора в выполнимых файлах могут размещаться данные: тексты сообщений, числовые константы и т. д. Чтобы создать выполнимый файл, используют специальные программы-трансляторы и редакторы связей.</p>
<p>Файлы в форматах COM и EXE отличаются в основном только своим форматом. Выполнимый файл COM состоит из одних инструкций процессора и данных. Размер COM файла обычно не превышает 65536 байт. Естественно это накладывает большие ограничения на программы в этом формате.</p>
<p>Когда вы запускаете программу в формате COM, операционная система считывает файл программы с жесткого диска или дискеты и размещает его в оперативной памяти, выбирая для этого свободный участок. Затем операционная система передает управление на самую первую команду загруженной программы. После окончания работы программы она возвращает управление операционной системе.</p>
<p>Файлы в формате EXE имеют значительно более сложную структуру, чем файлы COM. За счет этого они могут иметь больший размер, превышающий 65536 байт.</p>
<p>Кроме процессорных команд и данных, файлы в формате EXE содержат специальный заголовок, расположенный в самом начале файла. Заголовок EXE-файлов имеет сложный формат. На наш взгляд, его точный формат представляет интерес в основном для авторов вирусов. Поэтому мы приведем здесь только самые общие сведения.</p>
<p>Первое поле заголовка содержит сигнатуру EXE-файла - два символа MZ. Вы можете просмотреть любой EXE-файл в текстовом редакторе. Два первых символа всегда будут MZ. Некоторые выполнимые файлы могут иметь другую сигнатуру - ZM. Они также распознаются операционной системой как файлы в формате EXE.</p>
<p>Затем в заголовке файла следует таблица настройки. Когда пользователь запускает EXE-файл, операционная система загружает его в оперативную память, а затем настраивает его в соответствии с таблицей настройки. Только после этого управление передается на первую команду программы, адрес которой также записан в заголовке файла. Подробно формат заголовка EXE-файла описан в 18 томе из серии книг &ldquo;Библиотека системного программиста&rdquo;.</p>
<p>Командные BAT-файлы - это обычные текстовые файлы, состоящие из команд операционной системы. Для создания такого файла достаточно иметь любой текстовый редактор, который может сохранять файлы в обычном текстовом формате. В качестве примера можно привести текстовый редактор Notepad, входящий в состав операционной системы Windows.</p>
<p>Кроме команд операционной системы и вызовов других программ, командный файл может содержать строки комментариев. Такие строки обозначаются командой REM и полностью игнорируются. Вы можете воспользоваться строками комментариев, чтобы добавить текстовое описание к командному файлу или чтобы временно запретить выполнение отдельных команд такого файла:</p>
<pre class="source">
REM Подключаем драйверы локальной сети
lsl.com
ne2000.com
ipxodi.com
netx
/c=c:\net\net.cfg
REM login - команда временно отключена -
</pre>
<p>Когда вы запускаете командный файл, операционная система считывает его строка за строкой и выполняет прочитанные команды (рис. 1.4).</p>
<div align="center">
<img src="img/aaf00/fig14.gif" alt="Рис. 1.4. Программа до заражения"/>
<p><strong>Рис. 1.4. Программа до заражения</strong></p>
</div>
<p>Заражая файл, вирусы тем или иным способом записывают свой код внутрь выполняемого файла и изменяют его таким образом, чтобы после запуска файла управление получил код вируса (рис. 1.5). Вирус может записать свой код в конец, начало или середину файла. Вирус также может разделить свой код на несколько блоков и разместить их в разных местах зараженной программы.</p>
<p>Далее вирус отрабатывает свои задачи: заражает другие файлы, устанавливает в памяти собственные резидентные модули и выполняет другие функции. Затем вирус, как правило, передает управление зараженной программе и далее она исполняется как обычно.</p>
<div align="center">
<img src="img/aaf00/fig15.gif" alt="Рис. 1.5. Запуск зараженной программы"/>
<p><strong>Рис. 1.5. Запуск зараженной программы</strong></p>
</div>
<p>Обычно изменения в зараженных файлах видны невооруженным глазом в любом редакторе, в который можно загрузить выполнимый файл для просмотра. Кроме того заметно увеличение длинны зараженного файла. Некоторые вирусы, находясь резидентными в памяти, могут маскироваться. В этом случае изменения в зараженном файле будут незаметны.</p>
<p>На рисунках 1.6 и 1.7 мы привели участки дампа файла MOUSE.COM до и после его заражения вирусом OneHalf. Без труда можно заметить, что зараженный файл длиннее незараженного на 3544 байт.</p>
<div align="center">
<img src="img/aaf00/fig16.gif" alt="Рис. 1.6. Дамп файла MOUSE.COM"/>
<p><strong>Рис. 1.6. Дамп файла MOUSE.COM</strong></p>
</div>
<p>Вы также можете увидеть изменения в самом выполнимом файле. Заметно, что изменены несколько первых байт файла (в них записана команда перехода на код вируса). В конце зараженного файла появились новые данные - это код самого вируса.</p>
<div align="center">
<img src="img/aaf00/fig17.gif" alt="Рис. 1.7. Дамп файла MOUSE.COM, зараженного вирусом OneHalf"/>
<p><strong>Рис. 1.7. Дамп файла MOUSE.COM, зараженного вирусом OneHalf</strong></p>
</div>
<h4>Вирусы-спутники</h4>
<p>Как известно, в операционной системе MS-DOS существуют три типа файлов, которые пользователь может запустить на выполнение. Это командные или пакетные файлы. Командные файлы состоят из команд операционной системы и имеют расширение имени файла BAT.</p>
<p>В одном каталоге могут одновременно находиться несколько выполнимых файлов, имеющих одинаковое имя, но разное расширение имени. Например, в каталоге DOS записаны файлы MSD.COM и MSD.EXE. Вы можете создать в этом же каталоге командный файл MSD.BAT.</p>
<p>Когда вы желаете выполнить программу и вводите ее имя в системном приглашении MS-DOS, вы обычно не указываете расширение файла. Какой же файл в этом случае будет выполнен?</p>
<p>Оказывается, в этом случае операционная система MS-DOS будет выполнять файл, имеющий расширение COM. Если в текущем каталоге или в каталогах, указанных в переменной среды PATH, существуют только файлы с расширением EXE и BAT, то выполняться будет файл с расширением EXE.</p>
<p>Когда вирус-спутник заражает файл, имеющий расширение EXE или BAT, он создает в этом же каталоге еще один файл, имеющий такое же имя и расширение COM. Вирус записывает себя в этот COM-файл.</p>
<p>В качестве иллюстрации сказанного мы приводим содержимое каталога C:\PROGRAM. Первоначально в нем был записан один файл программы расчета CALC.EXE. После заражения этого файла вирусом-спутником в каталоге C:\PROGRAM появился файл CALC.COM:</p>
<pre>
C:\PROGRAM&gt;DIR
 Volume in drive C is LIBRARY
 Volume Serial Number is 1F64-394F
 Directory of C:\PROGRAM
.             &lt;DIR&gt;        26.11.95  18:55
..            &lt;DIR&gt;        26.11.95  18:55
CALC          COM         1 754  30.09.93   6:20
CALC          EXE        29 390  30.09.93   6:20
         2 file(s)       31 144 bytes
         2 dir(s)    26 599 424 bytes free
</pre>
<p>Если, запуская зараженную программу CALC.EXE, вы наберете в системном приглашении ее имя без расширения, то будет запущен вирус-спутник, файл которого имеет расширение COM:</p>
<pre>C:\PROGRAM&gt;CALC</pre>
<p>Получив управление, вирус может выполнять различные действия: заражать другие файлы, устанавливать резидентный модуль, и т. д. Затем вирус может запустить саму зараженную программу, имеющую расширение EXE.</p>
<p>В отличие от других файловых вирусов, вирусы-спутники обычно никак не изменяют зараженные программы. Поэтому для лечения зараженных файлов достаточно просто удалить файлы вируса, имеющие расширение COM.</p>
<p>Для маскировки вирусы спутники обычно устанавливают для файла вируса атрибут &ldquo;Скрытый&rdquo;. В этом случае команда DIR не отобразит имя файла вируса.</p>
<pre>
C:\PROGRAM&gt;DIR
 Volume in drive C is LIBRARY
 Volume Serial Number is 1F64-394F
 Directory of C:\PROGRAM
.             &lt;DIR&gt;        26.11.95  18:55
..            &lt;DIR&gt;        26.11.95  18:55
CALC          EXE        29 390  30.09.93   6:20
         1 file(s)       29 390 bytes
         2 dir(s)    26 599 424 bytes free
</pre>
<p>Однако такая маскировка очень слаба. Достаточно указать команде DIR параметр /A и она покажет список всех файлов в текущем каталоге, включая скрытые и системные файлы.</p>
<h5>Вирус CloneWar</h5>
<p>Под таинственным названием CloneWar скрывается целая группа вирусов-спутников. Во избежании путаницы их различают по длине файла вируса-спутника. На время написания книги были известны 5 вариантов вируса CloneWar длинной 228, 246, 261, 546 и 923 байт. Механизм их распространения полностью соответствует описанной нами технологии. Вирус выполняет поиск в текущем каталоге выполнимых файлов с расширением EXE. Затем он создает файл с таким же именем, но с расширением COM и записывает себя в него.</p>
<p>Когда пользователь вводит после системного приглашения имя зараженной программы без расширения, то запускается файл с расширением COM, который содержит вирус. Он заражает другие EXE файлы, а затем запускает зараженную программу.</p>
<p>Самая короткая из известных версий вируса CloneWar имеет длину 228 байт. Версия 246 вируса CloneWar содержит внутри себя небольшой стих:</p>
<pre>
Beyond
The rim of the star-light
My love
Is wand'ring in star-flight
I know
He'll find in star-clustered reaches
Love
Strange love a star woman teaches.
I know
His journey ends never
His star trek
Will go on forever.
But tell him
While he wanders his starry sea
Remember, remember me.
</pre>
<p>Самая большая версия вируса, имеющая длину 923 байта, проверяет значение системного таймера и в некоторых случаях исполняет через динамик компьютера небольшую мелодию. Затем код вируса зацикливается, вызывая зависание компьютера.</p>
<p>Со временем идея вируса-спутника получила дальнейшее развитие. Кто-то из писателей вирусов резонно заметил, что любой выполнимый файл можно переименовать, а затем создать файл с таким же именем, но содержащий код вируса. Когда пользователь запускает свою программу, на самом деле запускается программа-вирус. Она заражает другие программы, а затем загружает в оперативную память и исполняет настоящую программу пользователя.</p>
<p>Простейшие вирусы-спутники используют всего несколько функций операционной системы - поиск файла с заданным именем в текущем каталоге, переименование файла и создание нового файла. Подобные средства работы с файлами существуют фактически во всех системах программирования. Поэтому написать подобный вирус может практически любой начинающий программист, в распоряжении которого есть система разработки программ, которая может создавать выполнимые файлы.</p>
<h5>Вирус Carbuncle</h5>
<p>Вирус Carbuncle также представляет собой вирус-спутник, но работает не так, как вирус CloneWar.</p>
<p>При запуске вирус Carbuncle создает в текущем каталоге файл CARBUNCL.COM. Для маскировки этому файлу присваивается атрибут скрытый. Затем вирус ищет в текущем каталоге выполнимые файлы. Если вирус найдет в каталоге файл с расширением EXE, то он изменяет его расширение на CRP и создает пакетный файл с таким же именем. Этот файл получает расширение BAT. В него вирус записывает несколько команд MS-DOS, позволяющих запустить файл вируса CARBUNCL.COM и саму зараженную программу. Ниже мы привели пример такого файла для зараженной программы PROGRAM.EXE.</p>
<pre>
@ECHO OFF
CARBUNCL
RENAME PROGRAM.CRP PROGRAM.EXE
PROGRAM.EXE
RENAME PROGRAM.EXE PROGRAM.CRP
CARBUNCL
</pre>
<p>Если пользователь решит запустить зараженную программу и введет в системном приглашении имя программы без указания расширения, то операционная система просмотрит весь каталог в поисках файла с таким именем. Так как файл с расширением EXE она не обнаружит, то будет выполнен файл с расширением BAT.</p>
<p>Чтобы замаскировать исполнение нескольких команд пакетного файла, команда @ECHO OFF отключает вывод на экран исполняемых команд пакетного файла.</p>
<p>Следующая строка пакетного файла, созданного вирусом, запускает сам вирус CARBUNCL.COM. Затем зараженному файлу возвращается его настоящее расширение EXE и выполняется его запуск. После того как программа отработает, ее расширение опять заменяется на CRP. В конце снова запускается файл вируса CARBUNCL.COM.</p>
<p>Так как после заражения программы файл с расширением EXE уже не существует, то если при запуске программы указать ее полное имя с расширением, операционная система не сможет найти этот файл и на экране появится предупреждающее сообщение:</p>
<pre>Bad command or file name</pre>
<p>Вирус CloneWar ведет себя в этой ситуации значительно лучше. В этом случае сразу будет запущена настоящая программа. Вирус просто не получит управления.</p>
<p>Вирус Carbuncle занимается не только распространением своих копий. В некоторых случаях он может уничтожить зараженный файл. При запуске файл вируса проверяет значение системного таймера и если оно меньше или равно 16, то вирус записывает свой код в файл первого зараженного файла в текущем каталоге.</p>
<p>Внутри файла вируса содержатся следующие текстовые строки:</p>
<pre>
@ECHO OFF
CARBUNCL
RENAME
PC CARBUNCLE: Crypt Newsletter 14
</pre>
<h4>Вирусы в COM и EXE файлах</h4>
<p>Формат выполнимых COM-файлов достаточно прост, чтобы любой программист средней квалификации, знакомый с языком ассемблера, смог написать вирус.</p>
<p>Основная идея таких вирусов заключается в том, что вирус записывает свой код внутрь заражаемого файла. В самом простом случае вирус дописывает свой код в конец файла. Затем вирус считывает и сохраняет несколько первых байт заражаемого файла. На их место записывается команда передачи управления коду вируса.</p>
<p>После запуска зараженной программы управление передается первой команде, замененной вирусом на команду перехода. Поэтому управление сразу передается вирусу.</p>
<p>Получив управление, вирус выполняет действия, определенные его автором. Обычно в этот момент вирус заражает другие выполнимые файлы, устанавливает собственные резидентные модули, совершает другие противоправные действия.</p>
<p>Окончив эту работу, вирус восстанавливает первые команды зараженного файла и передает на них управление. Теперь начинает работать настоящая программа в ее неизменном виде.</p>
<p>Вирусы, заражающие выполнимые файлы, могут записывать свой код не только в конец файла. В качестве примера можно привести вирус Anarchy.2048 и Megadeth. Когда Megadeth заражает выполнимый COM-файл программы, он считывает и сохраняет в конце файла первые байты кода программы. Затем вирус записывает свой код в начало файла, поверх только что сохраненного кода программы.</p>
<p>Во время запуска программы код вируса сразу получает управление. Выполнив все свои действия, он восстанавливает начало зараженного файла, уничтожая свой код и передает ему управление.</p>
<p>Мы уже говорили, что размер выполнимых файлов в формате COM обычно не превышает 65536 байт. В принципе, можно создать COM файлы большего размера, но для этого они должны самостоятельно загружать себя. Большинство вирусов, заражающих COM-файлы, следят, чтобы суммарный размер файла и вируса не превышал данного значения. Если это условие не выполняется, заражение не происходит.</p>
<p>Среди вирусов, заражающих только COM-файлы, существуют и своего рода шедевры. Например, вирус Micro-92 имеет длину всего 92 байта. Вирус резидентный. Существует только в качестве академического. Автор вируса, Соловьев Михаил Анатольевич, прислал его непосредственно Лозинскому, гарантируя, что он не получит дальнейшего распространения.</p>
<p>Однако рекорд продержался недолго. Игорь Данилов создал вирус Micro-66 длиной 66 байт. Он существует только в качестве коллекционного экземпляра, никогда не распространялся и распространяться не будет. На момент написания книги самый короткий из известных нам вирусов имел длину 58 байт.</p>
<p>Процедура заражения вирусами EXE-файлов немного отличается от только что рассмотренной нами. Такие вирусы должны учитывать, что EXE-файлы имеют заголовок. При заражении вирус записывает себя в файл программы и может изменить заголовок EXE-файла.</p>
<h4>Вирусы в драйверах</h4>
<p>В операционной системе MS-DOS существует специальный вид программ, называемых драйверами. Драйверы запускаются только на этапе загрузки операционной системы, во время ее инициализации и интерпретации файла конфигурации CONFIG.SYS. Файлы драйверов обычно имеют расширение SYS.</p>
<p>Ряд вирусов разработан специально для заражения драйверов. Такие вирусы дописывают свой код к файлу драйвера и модифицируют его таким образом, чтобы вирус остался в оперативной памяти компьютера после загрузки драйвера.</p>
<p>Основные файлы операционной системы IO.SYS и MSDOS.SYS также могут быть заражены. Интересно, что в Microsoft Windows 95 файл MSDOS.SYS не содержит исполняемого кода, а предназначен для хранения параметров конфигурации системы:</p>
<pre>
[Paths]
WinDir=C:\WIN
WinBootDir=C:\WIN
HostWinBootDrv=C

[Options]
BootMulti=1
BootGUI=1
Network=0
;
;The following lines are required for compatibility with other programs.
;Do not remove them (MSDOS.SYS needs to be &gt;1024 bytes).
;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
...
;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
</pre>
<p>Естественно, в случае заражения этого файла Windows 95 перестанет правильно работать.</p>
<h4>Вирусы в BAT-файлах</h4>
<p>Среди огромного количества файловых вирусов, заражающих выполнимые файлы в формате COM и EXE, существует несколько вирусов, способных заражать пакетные файлы. Для этого используется весьма изощренный способ. Мы рассмотрим его на примере вируса BAT.Batman. При заражении пакетного файла в его начало вставляется текст следующего вида:</p>
<pre>
@ECHO OFF
REM [...]
copy %0 b.com&gt;nul
b.com
del b.com
rem [...]
</pre>
<p>В квадратных скобках [...] схематично показано расположение байт, которые являются ассемблерными инструкциями или данными вируса. Команда @ECHO OFF отключает вывод на экран названий выполняемых команд. Строка, начинающаяся с команды REM, является комментарием и никак не интерпретируется.</p>
<p>Команда copy %0 b.com&gt;nul копирует зараженный командный файл в файл B.COM. Затем этот файл запускается и удаляется с диска командой del b.com.</p>
<p>Самое интересное, что выполнимый файл B.COM, созданный вирусом, до единого байта совпадает с зараженным командным файлом. Но командный файл состоит из команд операционной системы, а выполнимый COM-файл - из команд центрального процессора. Как же работает такая программа? Если переименовать любой текстовый файл в выполнимый, просто заменив его расширение на COM, он, конечно же, не будет работать. В лучшем случае компьютер просто зависнет.</p>
<p>Оказывается, что если интерпретировать первые две строки зараженного BAT-файла как программу, она будет состоять из команд центрального процессора, которые фактически ничего не делают.</p>
<table summary="" border="1">
<tr><th>Текст BAT-файла</th><th>&nbsp;</th><th>&nbsp;</th><th>Команды ассемблера</th><th>Описание команд</th></tr>
<tr><td>@ECHO OFF</td><td>@</td><td>40h</td><td>INC AX</td><td>Увеличить на единицу значение регистра AX</td></tr>
<tr><td rowspan="10">&nbsp;</td><td>E</td><td>45h</td><td>INC BP</td><td>Увеличить на единицу значение регистра BP</td></tr>
<tr><td>C</td><td>43h</td><td>INC BX</td><td>Увеличить на единицу значение регистра BX</td></tr>
<tr><td>H</td><td>48h</td><td>DEC AX</td><td>Уменьшить на единицу значение регистра AX</td></tr>
<tr><td>O</td><td>4Fh</td><td>DEC DI</td><td>Уменьшить на единицу значение регистра DI</td></tr>
<tr><td>&nbsp;</td><td>20h</td><td>AND [BX+46],CL</td><td>Сравнить значение регистра CL со значением ячейки памяти</td></tr>
<tr><td>O</td><td>4Fh</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>F</td><td>46h</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>F</td><td>46h</td><td>INC SI</td><td>Увеличить на единицу значение регистра SI</td></tr>
<tr><td>&nbsp;</td><td>0Dh</td><td>OR AX,520A</td><td>Записать в регистр AX результат логической операции ИЛИ между текущим значением AX и 520Ah</td></tr>
<tr><td>&nbsp;</td><td>0Ah</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>REM</td><td>R</td><td>52h</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td rowspan="4">&nbsp;</td><td>E</td><td>45h</td><td>INC BP</td><td>Увеличить на единицу значение регистра BP</td></tr>
<tr><td>M</td><td>4Dh</td><td>DEC BP</td><td>Уменьшить на единицу значение регистра BP</td></tr>
<tr><td>&nbsp;</td><td>20h</td><td>AND [SI],DH</td><td>Записать в регистр AX результат логической операции И между значением регистра DH и значением ячейки памяти</td></tr>
<tr><td>&nbsp;</td><td>34h</td><td>&nbsp;</td><td>&nbsp;</td></tr>
</table>
<p>Центральный процессор выполняет эти команды, а затем начинает выполнять настоящий код вируса, записанный после признака комментария REM. Получив управление, вирус перехватывает прерывания операционной системы и оставляет себя резидентным в оперативной памяти компьютера.</p>
<p>Резидентная часть вируса следит за записью данных в файлы. Если первая строка, записываемая в файл, содержит команду @echo, вирус считает, что записывается командный файл и заражает его.</p>
<h5>Вирус BAT.Winstart</h5>
<p>Вирус BAT.Winstart использует такую же технологию, что и вирус BAT.Batman. При запуске зараженного BAT-файла вирус копирует его в файл Q.COM, который создается в корневом каталоге диска C:. Затем файл Q.COM запускается уже как обычный выполнимый файл. В этот раз он устанавливает свой резидентный модуль в оперативной памяти и переименовывает файл C:\Q.COM в C:\WINSTART.BAT. Резидентный модуль вируса отслеживает момент запуска пользователем других программ и создает файл WINSTART.BAT в текущем каталоге.</p>
<pre class="source">
@ECHO OFF
:s%r#
COPY %0.BAT C:\Q.COM&gt;NUL
C:\Q
[...]
</pre>
<p>Когда командный файл WINSTART.BAT интерпретируется, как выполнимый файл в формате COM, то первая строка @ECHO OFF будет состоять из команд центрального процессора, которые фактически ничего не делают (см. вирус BAT.Batman). Вторая строка :s%r# будет воспринята как команда перехода на код вируса, схематично показанный квадратными скобками. Получив управление, основной коод вируса перехватывает прерывания операционной системы и оставляет себя резидентным в оперативной памяти компьютера.</p>
<p>Почему командный файл вируса называется WINSTART.BAT?</p>
<p>Файл WINSTART.BAT содержит команды, выполняемые при запуске операционной системой Windows в расширенном режиме. В этот файл обычно вносят вызовы резидентных программ, которые должны быть доступны только приложениям Windows. Программы MS-DOS, выполняемые в Windows, не имеют доступа к этим резидентным программам. За счет этого для программ MS-DOS остается больше свободной памяти.</p>
<p>Файл WINSTART.BAT не создается автоматически при установке Windows. Он должен быть создан самим пользователем и записан в каталог Windows, корневой каталог диска C: или любой другой каталог, определенный переменной среды PATH.</p>
<p>Вероятно, автор вируса рассчитывал на то, что вирус BAT.Winstart будет получать управление всякий раз, когда на компьютере запускается операционная система Windows.</p>
<h4>Заражение файлов AUTOEXEC.BAT и CONFIG.SYS</h4>
<p>Файлы конфигурации AUTOEXEC.BAT и CONFIG.SYS, содержат команды, выполняемые во время загрузки операционной системмы. В том числе в этих файлах перечислены драйвера и программы, которые надо загрузить.</p>
<p>Обычно файлы AUTOEXEC.BAT и CONFIG.SYS создаются во время установки операционной системы и модифицируются во время установки различного программного обеспечения. Начинающие пользователи сами не изменяют эти файлы и не знают, что в них находится.</p>
<p>Целый ряд вирусов, например Em, Nocopy, Some, DrWatson, вносят изменения в файлы AUTOEXEC.BAT и CONFIG.SYS. Эти вирусы создают на диске выполнимый файл, содержащий код вируса, а затем наглым образом вставляют команду запуска этого файла в AUTOEXEC.BAT или CONFIG.SYS.</p>
<div class="notes">
<p><em>Вирус BAT.282</em></p>
<p><em>Неопасный нерезидентный вирус. Создает в корневых каталогах дисков B: и C: файл VIRUS.BAT, содержащий вирусный код. Вставляет в файл AUTOEXEC.BAT вызов файла VIRUS.BAT</em></p>
</div>
<p>Обращайте внимание на все изменения в файлах AUTOEXEC.BAT и CONFIG.SYS. Изменение этих файлов, не связанное с установкой нового программного обеспечения, может быть результатом работы вируса.</p>
<h4>Комбинированные вирусы</h4>
<p>Большая часть вирусов не ограничивается заражением выполнимых файлов одного типа, например, только EXE- или только COM-файлов. Такие вирусы могут заражать и EXE- и COM-файлы. Некоторые вирусы также заражают еще и файлы оверлеев и драйверов.</p>
<p>Существуют файлово-загрузочные вирусы. Они распространяются как через выполнимые файлы, так и через загрузочные секторы жестких дисков и дискет. Если вы получите такой вирус, записав на свой компьютер зараженный выполнимый файл, то получив управление, вирус запишет свою копию в главную загрузочную запись или загрузочный сектор жесткого диска. Дальнейшее распространение вируса происходит уже двумя путями - при копировании с компьютера зараженных программ и через загрузочные секторы дискет, используемых на компьютере.</p>
<p>За счет того, что один и тот же вирус может заражать различные объекты - выполнимые файлы, драйверы, загрузочные секторы, он получает больше возможностей для распространения.</p>
<h4>Повторное заражение файлов и загрузочных секторов</h4>
<p>Большинство вирусов заражают один и тот же файл или загрузочную запись только один раз. Такие вирусы перед заражением нового файла проверяют, не был ли он заражен раньше. В качестве признака, по которому определяется заражение, могут использоваться нестандартное время создания файла (операционная система MS-DOS позволяет устанавливать время создания файла 62 секунды), заведомо неправильная дата создания файла (например 2001 год). Более сложные вирусы определяют факт заражения поиском своей сигнатуры и т. д.</p>
<p>Самые примитивные вирусы могут заражать один файл по нескольку раз. Размер такого файла будет постоянно увеличиваться, значительно сокращая объем доступной дисковой памяти.</p>
<p>Несколько разных вирусов могут заразить один и тот же файл или загрузочную запись. Когда такой файл запускается, то сначала управление получает один вирус, затем другой и наконец выполняется сама зараженная программа.</p>
<div class="notes">
<p><em>Вирус Yankee Doodle</em></p>
<p><em>Целый ряд вирусов, заражающих выполнимые файлы. Некоторые версии вируса в определенное время исполняют на встроенном динамике компьютера мелодию Yankee Doodle. Интересно, что этот вирус борется с загрузочным вирусом Ball. Он изменяет его код таким образом, что вирус Ball через некоторое время самостоятельно удаляет себя с жесткого диска компьютера.</em></p>
</div>
<h3>Вирус DIR</h3>
<p>Летом 1991 года разразилась эпидемия нового вируса. Его проявления были весьма интересны. Во время копирования зараженных файлов в любом случае копировались только 1024 байта, несмотря на то, что фактические длины файлов были совершенно другие. Проверка целостности структуры файловой системы с помощью программы CHKDSK или Norton Disk Doctor выявляла наличие большого количества потерянных кластеров и пересечений файлов. Если, обнаружив нарушение в структуре файловой системы, пользователь пытался ее исправить, то все зараженные файлы оказывались испорченными.</p>
<p>Однако, несмотря на то что внешне зараженные программы кажутся совершенно неработоспособными, они работали как обычно. Так появился новый тип вируса, впоследствии названный DIR.</p>
<p>Способ размножения вируса DIR значительно отличается от используемых обычными файловыми вирусами и вирусами-спутниками. Тем не менее, мы отнесли его к группе файловых вирусов, так как объектом нападения становятся именно исполнимые файлы программ.</p>
<p>Чтобы лучше понять механизм распространения вируса DIR, мы проведем небольшой экскурс в структуру файловой системы MS-DOS. Более подробную информацию вы найдете в шестой главе этой книги.</p>
<p>При описании загрузочных вирусов мы уже рассказывали, что данные хранятся на жестких дисках и дискетах в отдельных секторах. Несколько секторов, расположенных рядом, называют кластером. Когда на диске создается новый файл, операционная система отводит для него несколько свободных кластеров. Кластеры файла не обязательно должны следовать друг за другом. Поэтому операционная система хранит список номеров всех кластеров, распределенных файлу, в специальной таблице. Эта таблица называется таблицей распределения файлов (FAT - File Allocation Table).</p>
<p>В таблице распределения файлов для каждого кластера есть один элемент. Его значение характеризует состояние кластера. Например, свободный кластер отмечается нулевым значением, а кластер, непригодный для использования, отмечается числом FF7h (FFF7h). Если кластер распределен файлу, то соответствующий элемент FAT содержит номер следующего кластера файла. Последний кластер файла отмечается числом в диапазоне от FF8h до FFFh (от FFF8h до FFFFh).</p>
<p>Сама таблица FAT находится практически сразу после загрузочной записи логического диска. Точное ее расположение описано в специальной структуре данных, записанной в загрузочном секторе. Однако таблица FAT не содержит ни названий файлов, ни других их атрибутов. Для этого операционная система поддерживает другую служебную структуру, которая называется корневым каталогом. Каждый логический диск имеет собственный корневой каталог.</p>
<p>В корневом каталоге описаны файлы и другие каталоги, которые в нем содержатся. Описание каждого файла и каталога включает его имя с расширением, дату и время создания, длину (для каталога она равна нулю), атрибуты и зарезервированное поле, которое не используется. Еще в описании файла хранится номер первого кластера, отведенного файлу или каталогу. Получив этот номер, операционная система может узнать все остальные номера кластеров файла через таблицу FAT (рис. 1.8).</p>
<p>Другие каталоги имеют точно такую же структуру, что и корневой каталог. В них также находятся описания файлов и других подкаталогов.</p>
<p>Когда пользователь запускает файл на выполнение, операционная система просматривает описания файлов в текущем каталоге текущего логического диска. Если файл с нужным именем найден, операционная система узнает из описания файла номер первого кластера файла, а затем по таблице FAT определяет остальные номера кластеров. После этого данные из кластеров файла считываются в оперативную память. Здесь они объединяются в один непрерывный участок, даже если кластеры файла были разбросаны по всему логическому диску.</p>
<p>Затем операционная система выполняет подготовительную работу, зависящую от типа файла (COM- или EXE-файл) и передает ему управление. На этом загрузка программы завершается и программа начинает работать.</p>
<p>Заражение вирусом DIR происходит следующим образом. Вирус DIR копирует свой код в один из кластеров заражаемой дискеты или логического диска. Этот кластер помечается в таблице FAT как конец файла. Затем вирус меняет описания файлов COM и EXE в структурах каталогов. Вирус записывает вместо номера первого кластера файла номер кластера, содержащего его код (рис. 1.9). Настоящий номер первого кластера зараженного файла шифруется и записывается в неиспользуемую область описания файла.</p>
<div align="center">
<img src="img/aaf00/fig18.gif" alt="Рис. 1.8. Структура каталогов"/>
<p><strong>Рис. 1.8. Структура каталогов</strong></p>
</div>
<p>Когда пользователь запускает один из зараженных файлов, с диска считывается только один кластер, содержащий код вируса. Таким образом, вирус сразу получает управление. Он устанавливает себя резидентным в оперативной памяти и перехватывает все обращения к диску. Затем вирус определяет настоящее расположение файла программы и загружает ее.</p>
<div align="center">
<img src="img/aaf00/fig19.gif" alt="Рис. 1.9. Структура каталогов после заражения вирусом DIR"/>
<p><strong>Рис. 1.9. Структура каталогов после заражения вирусом DIR</strong></p>
</div>
<p>Если теперь операционная система будет обращаться к каталогу, вирус передаст ей правильные значения для номеров первых кластеров зараженных файлов.</p>
<p>Впоследствии появилось несколько разновидностей вируса DIR, отличающихся друг от друга в основном только скрытыми функциями, выполняемыми вирусами. Для лечения вируса DIR и его разновидностей вы можете использовать антивирусную программу Aidstest, однако можно обойтись и без антивируса, достаточно скопировать выполнимые файлы, заменив их расширение, например, на CO_ и EX_ соотвественно.</p>
<h3>Маскировка вирусов</h3>
<p>Обычные вирусы, заражающие файлы, обнаружить достаточно легко. Для этого можно, например, записать длины всех выполнимых файлов и периодически проверять их. Идентифицировать такие вирусы также очень просто. Так как вирусы всегда дописывают к файлу одну и ту же последовательность кода, антивирусные программы могут просматривать выполнимые файлы и загрузочные секторы в поисках таких последовательностей. В большинстве случаев антивирусная программа может не хранить в себе шаблоны всех известных вирусов. Достаточно определенных характерных для данного вируса последовательностей, которые называются сигнатурами.</p>
<p>Например, для вируса BAT.Batman характерной может служить следующая последовательность (подробное описание вируса BAT.Batman смотри выше):</p>
<pre class="source">
copy %0 b.com&gt;nul
b.com
del b.com
</pre>
<p>Для вируса WinWord.Concept такой характерной последовательностью может служить одна из следующих строк:</p>
<pre>
see if we're already installed
iWW6IInstance
WW6Infector
</pre>
<p>Многие загрузочные вирусы также легко могут быть обнаружены простым просмотром загрузочных секторов жестких дисков компьютера и дискет. Например, вирус Stoned, содержит строки "Your PC is now Stoned!" и "LEGALISE MARIJUANA!".</p>
<p>Однако далеко не все вирусы ведут себя так грубо. Многие из них маскируют свое присутствие, используя для этого различные приемы. Вследствии естественного отбора антивирусными программами шанс выжить есть только у вирусов, применяющих разнообразные методы маскировки.</p>
<h4>Шифрующиеся и полиморфные вирусы</h4>
<p>Чтобы затруднить обнаружение, некоторые вирусы шифруют свой код. Каждый раз, когда вирус заражает новую программу, он зашифровывает собственный код, используя новый ключ. В результате два экземпляра такого вируса могут значительно отличаться друг от друга, даже иметь разную длину.</p>
<p>Естественно, вирус может работать только в том случае, если исполняемый код расшифрован. Когда запускается зараженная программа (или начинается загрузка с зараженной загрузочной записи) и вирус получает управление, он должен расшифровать свой код.</p>
<p>Процедура расшифровки не может сама быть зашифрована, в противном случае она не сможет работать. Этим пользуются антивирусные программы, использующие в качестве сигнатуры код процедуры расшифровки.</p>
<p>Тем не менее, авторы вирусов нашли выход из этой ситуации. Для шифрования вирусов они стали использовать не только разные ключи, но и разные процедуры шифрования. Два экземпляра таких вирусов не имеют ни одной совпадающей последовательности кода. Такие вирусы, которые могут полностью изменять свой код, получили название полиморфных. Наиболее известные из них - это Phantom-1, Natas, OneHalf, SatanBug.</p>
<p>Первым полиморфным вирусом считают V2Px.1260. Он был создан Марком Вашбурном (Mark Washburn) в качестве экспериментального вируса. На настоящий момент существует огромное количество полиморфных вирусов. Вот только несколько их названий: Basilisk.1639, CeCe.1994, CeCe.1998, CommanderBomber, Dir-II.TheHndV, Flip.2153, Flip.2343, Flip.2365, Fly.1769, Holms.6161, Invisible.2926, Invisible.3223, RDA.Fighter.5871, RDA.Fighter.5969, RDA.Fighter.7408, RDA.Fighter.7802.</p>
<p>К сожалению, сегодня создавать полиморфные вирусы могут не только программисты, обладающие высокой квалификацией. Существует несколько готовых средств разработки таких вирусов. Они позволяют разрабатывать полиморфные вирусы без понимания того, как последние устроены.</p>
<p>Первым таким средством создания полиморфных вирусов стал Dark Angel MuTation Engine (иногда называется MtE или DAME), созданный болгарским автором вирусов известным, как Dark Avenger.</p>
<p>В состав MuTation Engine входит объектный модуль, который необходимо подключить к создаваемому вирусу, подробная документация и пример его использования. Благодаря MuTation Engine появилось много полиморфных вирусов. Среди них MtE.CoffeeShop, MtE.Darkstar, MtE.Dedicated.</p>
<p>Вслед за MuTation Engine появились еще несколько средств разработки полиморфных вирусов, имеющих различный уровень сложности и сервиса:</p>
<ul>
<li><em>AWME (Anti WEB Mutation Engine)</em></li>
<li><em>CLME (Crazy Lord Mutation Engine)</em></li>
<li><em>DSCE (Dark Slayer Confusion Engine)</em></li>
<li><em>GCAE (Golden Cicada Abnormal Engine)</em></li>
<li><em>NED (NuKE Encryption Device)</em></li>
<li><em>SMEG (Simulated Metamorphic Encryption Generator)</em></li>
<li><em>TPE (TridenT Polymorphic Engine)</em></li>
<li><em>VICE (Virogen's Irregular Code Engine)</em></li>
</ul>
<p>После появления очередного средства разработки полиморфных вирусов некоторые авторы вирусов создавали на их основе собственные вирусы.</p>
<p>Интересно, что AWME является отечественной разработкой и создан в Казани. По нашим сведениям, AWME ориентирован на противодействие антивирусной программе Doctor Web. Более подробно об этом можно прочитать в разделе &ldquo;Doctor Web&rdquo;. AWME распространяется в виде исходного текста на языке ассемблера.</p>
<p>Современные антивирусные средства, например Doctor Web, умеют не только успешно идентифицировать полиморфные вирусы, но также и удалять их из зараженной программы.</p>
<p>Шифрование кода вируса значительно усложняет процесс его исследования. Обычные программы не смогут дизассемблировать такой вирус. Тот, кто отважится разобраться в зашифрованном вирусе, должен будет разбираться с ним, выполняя код вируса команда за командой в пошаговом режиме отладчика.</p>
<h4>Стелс-вирусы</h4>
<p>Стелс-вирусы пытаются скрыть свое присутствие в компьютере. Они имеют резидентный модуль, постоянно находящийся в оперативной памяти компьютера. Этот модуль устанавливается в момент запуска зараженной программы или при загрузке с диска, зараженного загрузочным вирусом.</p>
<p>Резидентный модуль вируса перехватывает обращения к дисковой подсистеме компьютера. Если операционная система или другая программа считывают файл зараженной программы, то вирус подставляет настоящий, незараженный, файл программы. Для этого резидентный модуль вируса может временно удалять вирус из зараженного файла. После окончания работы с файлом он заражается снова.</p>
<p>Примером стелс-вируса может служить Magdzie.1114. Это файловый вирус, заражающий выполнимые файлы в формате EXE. При запуске зараженной программы в оперативной памяти устанавливается вирусный резидентный модуль, который перехватывает обращения к файловой системе компьютера. Если операционная система запускает или открывает для чтения файл зараженной программы, вирус временно удаляет из нее свой код. Обратное заражение происходит, когда операционная система закрывает файл.</p>
<p>Вирус Magdzie проявляется, удаляя все файлы, название которых начинается с CHKLIST. 27 мая вирус выводит на экран небольшой текст и движущийся графический узор.</p>
<p>Загрузочные вирусы действуют по такой же схеме. Когда какая-либо программа считывает данные из загрузочного сектора, они заменяются настоящим содержимым загрузочного сектора.</p>
<p>В качестве загрузочного вируса, использующего для маскировки стелс-технологию, можно привести вирус July29. Вирус распространяется, замещая главную загрузочную запись на жестких дисках и загрузочную запись на дискетах. Настоящие загрузочные секторы сохраняются. Когда программа пытается прочитать или записать данные в главную загрузочную запись жесткого диска или загрузочную запись дискеты, резидентный модуль вируса подставляет неинфицированный сектор.</p>
<p>Маскировка стелс-вирусов срабатывает только в том случае, если в оперативной памяти компьютера находится резидентный модуль вируса. Когда вы загружаете компьютер с системной дискеты, у вируса нет шансов получить управление и поэтому стелс-механизм не работает.</p>
<p>Большинство антивирусных программ требует, чтобы для проверки и лечения компьютера он был загружен с системной дискеты, на которой нет вирусов. Такая дискета должна быть подготовлена заранее. Более подробно об этой процедуре вы можете прочитать в разделе &ldquo;Создание системной дискеты&rdquo;.</p>
<h4>Комбинированный метод маскировки</h4>
<p>Чтобы достичь еще большей неуязвимости вирусы могут комбинировать различные методы маскировки. Так, многие вирусы комбинируют в себе свойства полиморфных и стелс-вирусов.</p>
<p>К таким вирусам относятся вирусы серии OneHalf. Эти вирусы не только скрывают свое присутствие, используя стелс-технологию, они также маскируются, полностью изменяя свой код при заражении очередного файла или загрузочного сектора.</p>
<h3>Внешние проявления болезни</h3>
<p>Большинство вирусов не только размножаются, заражая новые и новые компьютеры, они еще выполняют дополнительные действия или, другими словами, спецэффекты, предусмотренные их автором.</p>
<p>У разных вирусов эти дополнительные действия могут быть опасными или неопасными, бросающимися в глаза или скрытыми, трудно обнаружимыми. Рассказать обо всех проявлениях вирусов невозможно, для этого надо описать каждый вирус. Мы расскажем только о наиболее типичных и наиболее интересных случаях.</p>
<div class="notel">
<em>Даже те вирусы, которые не совершают явных разрушительных действий, могут представлять опасность из-за ошибок, допущенных авторами вирусов</em>
</div>
<h4>Опасные вирусы</h4>
<p>Большую и самую опасную группу составляют вирусы, выполняющие разрушение программного обеспечения компьютера и файлов данных, записанных на его дисках.</p>
<p>Вирусы могут стирать файлы с жесткого диска, записывать мусор в отдельные секторы диска. Действие таких вирусов часто проявляется в разрушении файловой системы компьютера. Отдельные вирусы способны полностью уничтожить всю информацию на жестких дисках компьютера и дискетах, выполнив операцию форматирования.</p>
<p>Действие других вирусов менее бросается в глаза, и от этого они становятся еще опасней. Эти вирусы могут незаметно изменять данные в случайным образом выбранных файлах. Вы можете долгое время не замечать эти изменения, пока они не приведут к серьезным последствиям.</p>
<p>Интересный и опасный случай представляют вирусы, которые изменяют программную среду компьютера таким образом, что становятся ее неотъемлемой частью. Подобные вирусы очень сложно удалить. Если файлы, зараженные этими вирусами, просто удалить или восстановить с резервных копий, то система вообще может перестать работать.</p>
<p>В качестве примера можно привести файлово-загрузочный резидентный вирус OneHalf. Проникая в компьютер, вирус заражает главную загрузочную запись. Во время загрузки компьютера вирус постепенно шифрует секторы жесткого диска, начиная с самых последних. Когда резидентный модуль вируса находится в памяти, он контролирует все обращения к зашифрованным секторам и расшифровывает их, так что все программное обеспечение компьютера работает нормально. Если OneHalf просто удалить из оперативной памяти и загрузочного сектора, то станет невозможно правильно прочитать информацию, записанную в зашифрованных секторах диска.</p>
<p>Когда вирус зашифрует половину жесткого диска, он отображает на экране надпись:</p>
<pre>
Dis is one half.
Press any key to continue ...
</pre>
<p>После этого вирус ожидает, когда пользователь нажмет на какую-либо клавишу и продолжает свою работу. Для некоторых версий вируса отображаемая им надпись может несколько отличаться от приведенной нами.</p>
<p>Вирус OneHalf использует различные механизмы для своей маскировки. Он является стелс-вирусом и использует при распространении полиморфные алгоритмы. Обнаружение и удаление вируса OneHalf - достаточно сложная задача. Далеко не все антивирусные программы, которые определяют этот вирус могут его удалить. Например, антивирусная программа Norton Antivirus for Windows 95 версии 4.0 только обнаруживает OneHalf. Чтобы его удалить, пользователь должен вызвать специальную службу.</p>
<p>По итогам работы
антивирусной скорой помощи АО &ldquo;ДиалогНаука&rdquo; вирус OneHalf занимает одно из первых мест по распространенности. Это связано с тем, что многие популярные антивирусные программы, например AIDSTEST, не обнаруживают этот вирус. Тем не менее, вы можете удалить OneHalf при помощи антивирусной программы Doctor Web. Эта программа позволяет обнаружить и полностью освободить компьютер от многочисленных вариантов вируса OneHalf. Doctor Web аккуратно расшифровывает все участки жесткого диска, зашифрованные вирусом. Операция расшифровки может занять значительное время, в зависимости от того, насколько много секторов диска вирус успел зашифровать.</p>
<h4>Разрушение аппаратуры компьютера</h4>
<p>Могут ли вирусы вызывать аппаратные повреждения компьютера? На момент написания книги точной информации о таких вирусах не было. Сведения о вирусах, которые могут перепрограммировать видеоадаптер таким образом, чтобы он выжег люминофор на экране монитора, и вирусах, которые вводят в резонанс головки жесткого диска, достоверно не подтверждены.</p>
<p>Тем не менее, существуют вирусы, которые могут основательно вывести компьютер из строя. Многие компьютерные вирусы стирают или портят содержимое энергонезависимой CMOS-памяти компьютера. В результате чего компьютер перестает загружаться.</p>
<p>Отдельные вирусы используют еще более изощренный метод - они устанавливают в CMOS-памяти пароль для загрузки системы. При этом блокируется как загрузка компьютера, так и доступ к программе Setup. Убрать такой пароль можно, на время отключив питание энергонезависимой памяти. Для этого необходимо открыть корпус компьютера и переставить перемычки на системной плате.</p>
<p>Существуют системные платы (например Enterprise-II), на которых CMOS-память и питающий их аккумулятор расположены внутри одной микросхемы. Сбросить такую CMOS-память, отключив питание, невозможно. После того как вирус установит свой пароль, вам остается только угадать его или отправить системную плату на завод-изготовитель (либо просто купить новую системную плату).</p>
<h4>Вирус и человек</h4>
<p>В 1994 году в печати появилось сообщение о новом компьютерном вирусе, который может убить пользователя компьютера. Вирус якобы использует прием, давно известный в рекламной сфере: если человек смотрит кино и каждый двадцать пятый кадр заменяется другим изображением, то он подсознательно воспринимает изображение, не осознавая этого. Действуя на подсознание таким образом, можно склонить человека к определенным действиям.</p>
<p>Вирус заменяет некоторые кадры изображения на экране компьютера. Изображение, которое вирус передает подсознанию пользователя, вызывает у последнего повышение давления и, возможно, смерть.</p>
<p>Мы не станем останавливаться на медицинских и психологических аспектах этого вопроса - этим должны заниматься медики и психологи. От себя заметим, что до настоящего момента достоверной информации о вирусе-убийце нет. В принципе, уровень современной компьютерной техники позволяет менять изображение на мониторе с достаточной частотой - до сорока кадров в секунду. И, возможно, скоро ваше здоровье действительно будет напрямую связано со &ldquo;здоровьем&rdquo; компьютера.</p>
<h4>Вирусы и логические бомбы</h4>
<p>Многие вирусы содержат в себе логические бомбы. До определенного момента такой вирус никак себя не проявляет. Когда наступит время, логическая бомба срабатывает и вирус выполняет скрытую в нем функцию.</p>
<p>Самые известные вирусы, срабатывающие по достижении определенного времени - Michelangelo и Jerusalem. Вирус Michelangelo уничтожает информацию с диска, используемого для загрузки 6 марта, в день рождения Микеланджело. Вирус Jerusalem или Черная пятница удаляет файлы всех программ, запускаемых в пятницу тринадцатого числа.</p>
<div class="notes">
<p><em>Вирус Armagedon.1079</em></p>
<p><em>Неопасный резидентный вирус. С пяти до шести часов утра вирус пытается соединится через модем с удаленным абонентом. Содержит строку "Armagedon the GREEK"</em></p>
</div>
<h4>Безопасные вирусы</h4>
<p>Много вирусов не выполняют деструктивных действий, а содержат своего рода шутки - забавные видео- или аудио-эффекты. Такие вирусы могут отображать на экране монитора разнообразные надписи, проигрывать на встроенном динамике компьютера простенькие мелодии и т. д. Тем не менее, большинство вирусов не содержат в себе абсолютно ничего интересного, кроме факта, что кому-то не лень было тратить свое время на такую ерунду.</p>
<p>Абсолютно безопасных вирусов небывает. Даже если они не выполняют явных разрушительных действий, в них могут содержаться ошибки, вызывающие неправильную работу операционной системы и пользовательских программ. Кроме того, внедряясь в программы, вирусы нарушают авторские права программистов.</p>
<p>В любом случае, если компьютер стал вести себя странно, следует сразу прекратить работу и проверить его на заражение вирусами. Возможно, быстрое обнаружение вируса не позволит ему нанести значительный ущерб.</p>
<h3>Вирусы в файлах документов</h3>
<p>Долгое время мало кто подозревал, что компьютерные вирусы могут распространяться, заражая текстовые файлы документов. Пользователи свободно обменивались документами, подготовленными в различных текстовых редакторах, не опасаясь, что вместе с ними на компьютер проникнет вирус.</p>
<p>Однако летом 1995 г. появился первый такой вирус. Этот вирус, получивший название WinWord.Concept, распространяется, заражая файлы документов в формате текстового процессора Microsoft Word for Windows версии 6.0 и 7.0.</p>
<p>С первого взгляда такое сообщение кажется фантастическим, так как вирус должен содержать выполняемые команды, а в документе обычно хранится только текст и его шрифтовое оформление. Не все пользователи, даже проработав в среде Microsoft Word for Windows несколько лет, знают, что вместе с документом могут храниться макрокоманды, созданные с использованием специального языка программирования WordBasic. Эти макрокоманды фактически являются самыми настоящими программами.</p>
<h4>Первая ласточка - вирус WinWord.Concept</h4>
<p>Вирус WinWord.Concept никак не маскирует свое присутствие. Наоборот, он создан таким образом, чтобы облегчить свое обнаружение и анализ. Макрокоманды вируса WinWord.Concept не закрыты от чтения и их очень легко проанализировать. Мы получили этот вирус в АО &ldquo;ДиалогНаука&rdquo; и самостоятельно провели такой анализ. Вирус состоит из пяти макрокоманд, общий объем которых составляет примерно 110 строк на языке WordBasic. В добавок к этому автор вируса снабдил его комментариями.</p>
<p>Когда пользователь открывает зараженный файл документа, Microsoft Word for Windows автоматически выполняет содержащуюся в нем макрокоманду AutoOpen. Эта макрокоманда принадлежит вирусу. Она просматривает названия всех макрокоманд, определенных в файле стилей NORMAL.DOT. Если среди них обнаружена макрокоманда PayLoad, считается, что файл стилей уже заражен. Если присутствует макрокоманда FileSaveAs, вирус также не будет устанавливаться. Видимо автор посчитал, что в этом случае нужно слишком много возиться.</p>
<p>Если просмотрен весь список макрокоманд и среди них не обнаружены ни макрокоманды PayLoad, ни FileSaveAs, вирус копирует в файл стилей NORMAL.DOT макрокоманды PayLoad, FileSaveAs, AAAZFS и AAAZAO.</p>
<p>После копирования макрокоманд вирус добавляет в файл конфигурации WINWORD6.INI текстового процессора параметр WW6I:</p>
<pre>WW6I=1</pre>
<p>В конце выполнения вирусной макрокоманды AutoOpen вирус отображает на экране временную диалоговую панель. На этом установка вируса считается оконченной и вы увидите в окне редактирования текстового процессора открытый документ.</p>
<p>Заражение документов происходит, когда пользователь сохраняет их при помощи команды "Save As". В этом случае выполняется макрокоманда вируса FileSaveAs. Она отображает на экране обычную диалоговую панель "Save As".</p>
<p>Пользователь вводит в этой диалоговой панели имя файла документа, под которым он будет сохранен. Заметим, что обычно документ сохраняется в формате &ldquo;Word Document&rdquo; (формат указывается в поле &ldquo;Save File as Type&rdquo;). В принципе, документ можно сохранить и в других форматах, например, в обычном текстовом формате или в формате RIF (Rich-Text Format).</p>
<p>Если пользователь сохраняет документ в формате документов текстового процессора Microsoft Word for Windows (формат &ldquo;Word Document&rdquo;), тогда вирус изменяет формат сохраняемого документа. Вместо того чтобы сохранить документ в формате документов текстового процессора Microsoft Word for Windows, он сохраняет его в формате файла стилей, предварительно записав в него макрокоманды AutoOpen, AAAZAO, AAAZFS и PayLoad.</p>
<p>Таким образом, WinWord.Concept незаметно изменяет формат документа, сохраняя его на диске как файл стилей. Внешне такой файл практически не отличается от обыкновенного файла документа. Он также имеет расширение DOC, а при загрузке в текстовый процессор вы увидите набранный вами текст.</p>
<p>Никаких дополнительный действий вирус WinWord.Concept не выполняет. В макрокоманду PayLoad, которая могла быть использована для этого, автор включил только один комментарий:</p>
<pre>
Sub MAIN
	REM That's enough to prove my point
End Sub
</pre>
<p>Но за счет того, что зараженный документ сохраняется в формате файла стилей, текстовый процессор не позволит вам сохранить его в другом формате. Когда вы выберете из меню File строку Save As, на экране появится диалоговая панель Save As, но поле выбора типа документа - &ldquo;Save File as Type&rdquo; будет показано серым цветом и недоступно для изменения.</p>
<h4>Как обнаружить WinWord.Concept?</h4>
<p>Вы легко можете проверить, заражен ли текстовый процессор Microsoft Word for Windows вирусом WinWord.Concept даже без специальных программ. Самый простой способ основан на том, что активный вирус записывает в файл конфигурации WINWORD6.INI параметр WW6I.</p>
<p>Файл WINWORD6.INI располагается в каталоге Windows и вы можете просмотреть его в любом текстовом редакторе, например в редакторе Notepad, входящем в состав Windows.</p>
<p>Запустите приложение Notepad. Если файл WINWORD6.INI имеет большой размер и вам трудно его просматривать, выберите из меню Search строку Find. На экране откроется диалоговая панель Find. Введите в поле Find What текст WW6I, который надо найти и нажмите кнопку Find Next. Если в файле обнаружится параметр WW6I, скорее всего, ваш компьютер заражен вирусом WinWord.Concept.</p>
<p>Другой способ обнаружения вируса предполагает, что вы запустили текстовый процессор Microsoft Word for Windows. Выберите из меню Tools строку Macro. На экране появится диалоговая панель Macro (рис. 1.10). Из списка Macros Available In выберите строку All Active Templates. Обратите внимание на список макрокоманд Macro Name. Если в нем находятся строки AAAZAO, AAAZFS, AutoOpen, FileSaveAs, PayLoad, текстовый процессор инфицирован вирусом WinWord.Concept.</p>
<div align="center">
<img src="img/aaf00/fig1a.gif" alt="Рис. 1.10. Диалоговая панель &quot;Macro&quot;"/>
<p><strong>Рис. 1.10. Диалоговая панель "Macro"</strong></p>
</div>
<p>И еще один способ самостоятельного обнаружения вируса основан на том, что зараженные файлы документов или стилей содержат в себе несколько незашифрованных текстовых строк:</p>
<pre>
see if we're already installed
iWW6IInstance
WW6Infector
AAAZFS
AAAZAO
That's enough to prove my point
</pre>
<p>Эти строки можно обнаружить с помощью любой программы просмотра файлов в формате ASCII. Например, с помощью встроенной программы просмотра оболочки Norton Commander.</p>
<p>Просмотр вручную всех файлов на всех дисках компьютера займет много времени. Чтобы ускорить этот процесс, удобно воспользоваться специальными программами поиска. Очень удобно приложение Find File, входящее в состав Microsoft Office.</p>
<p>Запустите приложение Find File и откройте диалоговую панель Search. Вирус WinWord.Concept может располагаться в файлах *.DOC, *.DOT, *.BAK. Поэтому укажите эти имена в поле File Name. Затем нажмите кнопку Advanced Search. На экране появится диалоговая панель Advanced Search. Нажмите на закладку Location и пользуясь органами управления этой панели, сформируйте список каталогов, в которых будет проводится поиск. Мы рекомендуем внести в этот список корневые каталоги всех логических дисков компьютера.</p>
<p>Затем нажмите на закладку Summary и введите в поле Containing Text текст для поиска. В качестве текста можно воспользоваться предложением &ldquo;That's enough to prove my point&rdquo;, текст которого взят из вируса. Убедитесь, что поиск будет выполняться по всем файлам. Для этого поля Title, Autor, Keywords и Subject должны остаться незаполненными. Убедитесь также, что в процессе поиска будут просмотрены все файлы вне зависимости от времени их создания. Для этого нажмите закладку Timestamp.</p>
<p>Нажмите кнопку OK. Вы вернетесь в диалоговую панель Search. Чтобы начать поиск, нажмите кнопку OK. Приложение Find File просмотрит все файлы документов и стилей. После окончания поиска оно составит список имен файлов, в которых было обнаружено искомое предложение и которые, вероятно, инфицированы вирусом WinWord.Concept.</p>
<h4>Вирус WinWord.Nuclear</h4>
<p>Практически сразу после появления вируса WinWord.Concept был обнаружен еще один вирус подобного вида WinWord.Nuclear. Этот вирус использует точно такую же технологию распространения, что и вирус WinWord.Concept.</p>
<p>Вирус WinWord.Nuclear уже далеко не такой безобидный, как WinWord.Concept. Когда пользователь направляет свой документ на печать, то вирус с вероятностью 1/12 добавляет в конце файла собственную фразу:</p>
<pre>
	And finally I would like to say:
	STOP ALL FRENCH NUCLEAR TESTING IN THE PACIFIC!
</pre>
<p>В переводе на русский язык она звучит следующим образом:</p>
<pre>
	И в конце я хотел бы сказать:
	ОСТАНОВИТЕ ВСЕ ФРАНЦУЗСКИЕ ИСПЫТАНИЯ ЯДЕРНОГО ОРУЖИЯ В ТИХОМ ОКЕАНЕ!
</pre>
<p>Если фраза добавится в конце черновой распечатки, это только полбеды, но в случае, когда распечатанный документ отправляется адресату непросмотренным, можно представить себе удивление последнего. Такая ситуация может возникнуть, если к компьютеру подключен факс-модем и вместо печати документа на принтере он отправляется удаленному абоненту в качестве факсимильного сообщения.</p>
<p>Достаточно странно, что вирус, написанный пацифистом, пятого апреля пытается удалить основные файлы операционной системы - IO.SYS, MSDOS.SYS и COMMAND.COM. Но из-за ошибок автора вируса и особенностей текстового процессора эта попытка не удается.</p>
<p>Вирус WinWord.Nuclear заражает не только файлы документов и стилей. Что удивительно, WinWord.Nuclear может заразить обыкновенные выполнимые файлы в формате COM и EXE. Он также может заразить EXE-файлы, предназначенные для операционной системы Windows.</p>
<p>Для заражения выполнимых файлов используется оригинальный способ. Вирус запускает программу DEBUG, передавая ей в качестве параметра ранее сформированный им файл PH33R.SCR.</p>
<p>Программа DEBUG - это простой отладчик, который входит в состав дистрибутива MS-DOS и копируется на жесткий диск компьютера во время установки операционной системы, поэтому он присутствует практически на всех компьютерах. В числе прочего DEBUG позволяет просмотреть и изменить содержимое оперативной памяти, запустить программу и т. д.</p>
<h4>Вирусы в макрокомандах</h4>
<p>Мы уже рассказали вам о вирусах в макрокомандах текстового процессора Microsoft Word for Windows. Вирусы, использующие подобные пути распространения, существуют не только в Microsoft Word for Windows.</p>
<div class="notel">
<em>Когда мы уже заканчивали писать эту книгу, поступили сообщения о появлении еще трех вирусов, предназначенных для текстового процессора Microsoft Word for Windows - WinWord.Colours, WinWord.DMV и WinWord.Hot</em>
</div>
<p>В качестве примера можно привести вирус WinMacro.Weider, распространяющийся в среде редактора электронных таблиц Excel. Этот пакет имеет встроенные средства создания макрокоманд, сходные с языком WordBasic текстового процессора Microsoft Word for Windows.</p>
<p>Появление подобных вирусов возможно и в других приложениях Windows. На наш взгляд, единственной возможностью обезопасить себя от таких новинок является постоянное обновление ваших антивирусных программ и внимательное изучение публикаций по антивирусной тематике.</p>
<p>Вирус WinWord.Concept, а также другие аналогичные вирусы можно назвать кросс-платформными. Компьютер с любой архитектурой, а не только совместимый с IBM PC, на котором установлен текстовый процессор Microsoft Word for Windows, может быть заражен таким вирусом.</p>
<h4>Как противостоять вирусам в файлах документов</h4>
<p>Текстовый процессор Microsoft Word for Windows позволяет запретить автоматическое выполнение макрокоманд. Для этого можно воспользоваться одним из перечисленных ниже способов:</p>
<ul>
<li><em>При запуске Microsoft Word for Windows из приложения Program Manager держите нажатой клавишу &lt;Shift&gt;</em></li>
<li><em>Укажите Microsoft Word for Windows дополнительный параметр /m (WINWORD.EXE&nbsp;/m).</em></li>
<li><em>Когда вы открываете документ для редактирования, держите нажатой клавишу &lt;Shift&gt;.</em></li>
</ul>
<p>Естественно, использование этих средств вызывает некоторые неудобства, а в некоторых случаях может привести к нежелательным последствиям (будет запрещено автоматическое выполнение всех макрокоманд, даже тех которые нужны). Кроме того, есть сведения, что эти приемы срабатывают не во всех случаях.</p>
<p>Вместо этого вы можете сами полностью блокировать автоматическое выполнение макрокоманд. Для этого следует определить макрокоманду с именем AutoExec. Эта макрокоманда будет автоматически вызываться при каждом запуске текстового процессора.</p>
<p>Выберите из меню Tools строку Macro. На экране появится диалоговая панель Macro. Наберите в поле Macro Name строку AutoExec и нажмите кнопку Create. Появится окно текстового редактора, содержащее заготовку макрокоманды AutoExec:</p>
<pre class="source">
	Sub MAIN
	End Sub
</pre>
<p>Вставьте между этими двумя строками команду DisableAutoMacros:</p>
<pre class="source">
	Sub MAIN
		DisableAutoMacros
	End Sub
</pre>
<p>Завершите работу текстового процессора, отвечая утвердительно на предложение записать новую макрокоманду в файл NORMAL.DOT и предложение сохранить сам файл NORMAL.DOT. Если вы работаете в русской версии текстового процессора Microsoft Word for Windows, этот метод также можно использовать с учетом русских названий меню и диалоговых панелей.</p>
<p>К сожалению, запрещение автоматического выполнения макрокоманд не позволяет обнаружить и обезвредить уже существующие вирусы, но дальнейшая их деятельность в среде Microsoft Word for Windows будет остановлена.</p>
<h3>Вирусы и Windows</h3>
<p>Несмотря на то, что выполнимые файлы Windows, которые вы можете запускать, также имеют расширение EXE, формат этих файлов значительно отличается от выполнимых файлов операционной системы MS-DOS. Новый формат выполнимых файлов получил название Microsoft New Executable (NewEXE) или Windows Executable. Мы будем называть эти файлы выполнимыми файлами в формате Windows. Обычные вирусы не в состоянии правильно внедриться в такие файлы и зараженная программа становиться неработоспособной.</p>
<p>Однако, несмотря на то что Windows установлена на большинстве персональных компьютеров, старые вирусы не вымерли. В первую очередь это произошло из-за того, что работа в среде Windows совсем не означает отказа от программного обеспечения MS-DOS. Существует достаточно много нужных программ, предназначенных для работы в MS-DOS. В первую очередь это небольшие утилиты - программы-архиваторы, программы для копирования дискет - и, конечно же, огромное количество всевозможных игр. Естественно, все это программное обеспечение используется и будет использоваться еще очень долго.</p>
<p>Но даже полный отказ от программ MS-DOS не снимет угрозу распространения вирусов. Во-первых, остается возможность заражения загрузочных секторов жестких дисков и дискет. Во-вторых, внимание писателей вирусов рано или поздно переключиться на Windows и появятся новые типы вирусов, способных функционировать и распространяться в новой среде. Подтверждением этому стали вирусы, заражающие выполнимые файлы Windows, и вирусы, заражающие документы, подготовленные в текстовом процессоре Microsoft Word for Windows. В начале 1996 года, практически сразу после появления Microsoft Windows 95, появилось сообщение о первом вирусе, разработанном специально для этой операционной системы. Этот вирус получил название BOZA.</p>
<h4>Вирусы MS-DOS для Windows</h4>
<p>Обычный выполнимый файл Windows может служить отличной средой для распространения вирусов. Если вы запускаете выполнимый файл операционной системы Microsoft Windows из командной строки MS-DOS, он сообщает, что его необходимо запускать из Windows:</p>
<pre>This program requires Microsoft Windows.</pre>
<p>или</p>
<pre>This program cannot be run in DOS mode.</pre>
<p>Иногда вместо этого сообщения может отображаться какая-нибудь другая информация или выполняться иные действия. Например, некоторые приложения Windows, запущенные из среды MS-DOS, пытаются загрузить Windows.</p>
<p>Авторы вирусов не упустили возможность внедрить вирус в этот участок кода. Вирус Grog.Bog.233 выполняет поиск выполнимых файлов Windows и заражает их, добавляя команды вируса в код, выполняемый при запуске файла в среде MS-DOS. Если запустить такой файл в MS-DOS, то он сначала выводит на экран предупреждающее сообщение, а затем управление передается вирусу.</p>
<div class="notes">
<p><em>Вирус SMEG.Trivia.2437</em></p>
<p><em>Неопасный нерезидентный полиморфный вирус. В пятницу 13 числа выводит сообщение "This program requires Microsoft Windows.", после чего заканчивает выполнение инфицированной программы. Данный вирус был создан Black Baron для демонстрации использования его полиморфного генератора SMEG версии 0.3</em></p>
</div>
<p>Конечно, вирус Grog.Bog.233 трудно назвать настоящим вирусом, созданным для работы в операционной системе Windows. В конечном итоге он работает только при запуске зараженного файла в MS-DOS. Более того, в операционной системе Windows 95 этот вирус будет работать, только если вы завершите графическую оболочку Windows, оставив компьютер работать в режиме командной строки.</p>
<h4>Вирусы, заражающие выполнимые файлы Windows</h4>
<p>Данный класс вирусов на сегодня, пожалуй, один из самых немногочисленных. Возможно, это связано с тем, что люди, способные написать такие вирусы, имеют слишком высокую квалификацию, чтобы бесцельно тратить свое время.</p>
<p>В качестве примера вирусов для Windows мы рассмотрим вирусы Win.Vir14 (другие названия - WinVir или WVir), Win.Twitch (Twitch), Win.CyberTech, Win.Vik и Win.Lamer.</p>
<p>Вирус Win.Vir14 заражает выполнимые EXE-файлы в формате операционной системы Windows. Выполнимые файлы MS-DOS не заражаются. Когда пользователь запускает зараженное приложение, управление сразу получает вирус. Он просматривает файлы текущего каталога и заражает выполнимые файлы Windows. Вирус дописывает свой код к заражаемым файлам и увеличивает их размер.</p>
<p>Затем вирус восстанавливает запущенный файл, удаляя из него код вируса. После этого приложение завершается и управление сразу возвращается операционной системе. Сама зараженная программа не выполняется. Если пользователь попробует запустить это приложение еще раз, оно будет работать как обычно.</p>
<p>Внутри кода вируса содержатся две текстовые строки:</p>
<pre>
	Virus_for_Windows v1.4
	MK92
</pre>
<p>Вирус Win.Twitch значительно более сложный, чем WinVir. Когда пользователь запускает зараженный файл Windows, вирус оставляет в оперативной памяти компьютера работающий модуль, а затем выполняет настоящее приложение. Модуль, оставленный в памяти, вызывает периодическое подергивание изображения на экране монитора.</p>
<p>Из всех известных на сегодня вирусов Windows, наиболее опасен вирус Win.CyberTech. После запуска на компьютере программы, зараженной вирусом Win.CyberTech, он изменяет ядро операционной системы - модуль KERNEL. В зависимости от версии Windows и режима, в котором она работает, заражаются файлы KRNL386.EXE или KRNL286.EXE. Вирус перехватывает функцию WinExec, которая используется для запуска приложений Windows и заражает все запускаемые приложения.</p>
<p>После заражения очередного приложения, вирус определяет текущую дату и проверяет несколько условий:</p>
<ul>
<li>Сегодня число между 29-м апреля и 1-м мая</li>
<li>Сегодня пятница и число от 1-го до 13-го</li>
<li>Сегодня число между 26-м и 31-м декабря</li>
<li>Сегодня 6-е марта и год после 1994</li>
</ul>
<p>Если хотя бы одно из этих условий выполняется, вирус отображает на экране небольшую диалоговую панель с единственной кнопкой OK. Когда пользователь нажмет кнопку, вирус начинает разрушать данные, записанные на жестком диске компьютера.</p>
<p>Вирус Win.Lamer - первый из известных нам вирусов Windows, который применяет для маскировки полиморфный механизм. Заражая очередное приложение, Win.Lamer изменяет свой код, чтобы затруднить антивирусным программам свое обнаружение.</p>
<h3>Операционная система OS/2 и вирусы/2</h3>
<p>В последнее время все большую популярность получает операционная система OS/2, разработанная известной фирмой IBM. С выходом в свет новой, полностью 32-разрядной мультизадачной версии этой операционной системы IBM OS/2 Warp, многие пользователи стали устанавливать ее на своих компьютерах.</p>
<p>На момент написания книги было известно всего несколько вирусов, предназначенных специально для операционной системы OS/2 - OS2Vir1, OS2.First, OS2.Jiskefet, OS2.Rexx.</p>
<p>Описание вируса OS2Vir1, которое мы обнаружили в справочной системе IBM AntiVirus, с трудом позволяет назвать его настоящим вирусом. Способность OS2Vir1 к распространению ограничивается заражением EXE файлов, расположенных в текущем каталоге. Заражая выполнимый файл, OS2Vir1 записывает свой код в начало файла-жертвы, не сохраняя оригинальный код программы. Поэтому зараженная программа оказывается неработоспособной. Трудно предположить, что вирус, использующий такую технологию заражения, получит сколько-нибудь широкое распространение.</p>
<p>Вирусы OS2.First, OS2.Jiskefet, OS2.Rexx несколько сложнее. Они могут распространяться, сохраняя у заражаемых программ способность нормально работать. Все три известных нам вируса - OS2.First, OS2.Jiskefet и OS2.Rexx используют вызовы операционной системы DOS. Поэтому их нельзя назвать вирусами, полностью разработанными для операционной системы OS/2.</p>
<h3>Автоматизированные средства разработки вирусов</h3>
<p>Нет, мы не ошиблись, и это не типографская опечатка. В этом разделе речь действительно пойдет об автоматизированных средствах разработки вирусов. На сегодня в мире насчитывается больше десятка таких средств. С их помощью создание нового вируса становится не сложнее, чем создание нового документа в текстовом редакторе. Используя автоматизированные средства разработки вирусов, любой пользователь может создать собственный вирус буквально за пару минут.</p>
<p>Самые простые средства разработки работают в пакетном режиме - все настройки выполняются через обыкновенный текстовый файл. Результатом их работы является файл с исходным текстом вируса, написанного на языке ассемблера. Из этого &ldquo;полуфабриката&rdquo; легко получить готовый вирус, воспользовавшись транслятором с языка ассемблера.</p>
<p>Надо отметить, что исходный текст вируса может служить хорошим пособием для будущих писателей вирусов. Тем более, что обычно вместе со средствами разработки вирусов поставляется полная документация.</p>
<p>Более сложные автоматизированные средства разработки вирусов имеют продуманную диалоговую оболочку со множеством вложенных меню.</p>
<p>Вот только несколько названий автоматизированных средств разработки вирусов:</p>
<ul>
<li><em>The Virus Construction Set (VCS)</em></li>
<li><em>The Virus Creation Laboratory (VCL)</em></li>
<li><em>The Phalcon/Skism Mass Prodused Code generator (PS-MPC)</em></li>
<li><em>The Instant Virus Production kit (IVP)</em></li>
<li><em>The Second Generation in Virus Creation (G<sup>2</sup>)</em></li>
</ul>
<h4>Лаборатория компьютерного оружия</h4>
<p>Автоматизированные средства разработки дают хорошее представление о возможностях вирусов. Поэтому мы рассмотрим их более подробно на примере The Virus Creation Laboratory (VCL). VCL представляет собой достаточно старую разработку. Она датирована 1992 годом:</p>
<pre>
	Copyright (c) 1992 Nowhere Man and [NuKE] WaReZ
	Version 1.00
</pre>
<p>Создание вируса при помощи VCL становится просто детской забавой. Программа имеет развитую диалоговую оболочку, содержащую многочисленные меню, окна и диалоговые панели.</p>
<div>
<img src="img/aaf00/fig1vcl.gif" alt="" align="left"/>
<p>Уровень сервиса, предоставляемый пользователю VCL, практически не поддается описанию. Например, для большего удобства в состав дистрибутива VCL входят PIF-файл для запуска из среды Windows и пиктограмма.</p>
</div>
<p>Любому, кто создает вирус при помощи VCL, достаточно задать в меню и диалоговых панелях его свойства. На рисунке 1.11 показано, как можно задать основные свойства будущего вируса. Обычные переключатели меню Options позволяют указать, какие типы файлов вирус должен поражать, будет ли он реализовывать алгоритмы самошифровки и защиты от отладки. Вы можете указать способ поиска новых жертв, насколько быстро вирус должен заражать файлы компьютера и т. д.</p>
<div align="center">
<img src="img/aaf00/fig1b.gif" alt="Рис. 1.11. Автоматизированные средства разработки вирусов"/>
<p><strong>Рис. 1.11. Автоматизированные средства разработки вирусов</strong></p>
</div>
<p>Большинство вирусов не только создают свои копии, заражая новые файлы и загрузочные секторы дисков, они также могут выполнять всевозможные действия. VCL легко позволяет подключить к вирусу вредоносные функции. Для этого предназначено меню Effects. Список действий, которые VCL позволяет встроить в вирус, представлен в таблице приведенной ниже. Прочитайте эту таблицу внимательно - ведь это список признаков появления вируса на вашем компьютере! Конечно, список неполный, вирусы могут выполнять гораздо более сложные действия.</p>
<table summary="" border="1">
<tr><th>Эффект</th><th>Описание</th></tr>
<tr><td>Beep the PC speaker</td><td>Подать звуковой сигнал через встроенный динамик компьютера</td></tr>
<tr><td>Change low RAM</td><td>Изменить объем стандартной оперативной памяти</td></tr>
<tr><td>Clear the screen</td><td>Очистить экран монитора компьютера</td></tr>
<tr><td>Cold reboot</td><td>Выполнить холодную перезагрузку компьютера</td></tr>
<tr><td>Corrupt file(s)</td><td>Разрушить файлы с заданными именами</td></tr>
<tr><td>Disable LPT port</td><td>Отключить параллельный порт компьютера</td></tr>
<tr><td>Disable Print Screen</td><td>Отключить функцию печати содержимого экрана</td></tr>
<tr><td>Disable COM port</td><td>Отключить последовательный порт компьютера</td></tr>
<tr><td>Display a string</td><td>Вывести на экран заданную строку</td></tr>
<tr><td>Drop a program</td><td>Выполнить программу</td></tr>
<tr><td>Erase file(s)</td><td>Удалить файлы</td></tr>
<tr><td>Lock up the computer</td><td>Зациклить компьютер</td></tr>
<tr><td>Machine gun sound</td><td>Подать звук стреляющего пистолета</td></tr>
<tr><td>Out value to port</td><td>Вывести определенное значение в задаанный порт компьютера</td></tr>
<tr><td>Out random to ports</td><td>Вывести случайное значение в задаанный порт компьютера</td></tr>
<tr><td>Play a tune</td><td>Проиграть мелодию</td></tr>
<tr><td>Print a string</td><td>Напечатать на принтере текстовую строку</td></tr>
<tr><td>Drop to ROM BASIC</td><td>Запустить интерпретатор языка BASIC, записанный в ПЗУ компьютера</td></tr>
<tr><td>Send string to COM</td><td>Вывести строку в последовательный порт. Эту возможность можно использовать для программирования модемов</td></tr>
<tr><td>Swap two LPT ports</td><td>Поменять имена двух параллельных портов компьютера</td></tr>
<tr><td>Swap two COM ports</td><td>Поменять имена двух последовательных портов компьютера</td></tr>
<tr><td>Trash a disk</td><td>Испортить информацию в нескольких секторах на заданном диске</td></tr>
<tr><td>Trash some disks</td><td>Испортить информацию в нескольких секторах на каком-нибудь диске</td></tr>
<tr><td>Display an ANSI</td><td>Вывести на экран строку команд ANSI. Она может содержать такие команды как установка курсора в заданную позицию экрана, выбор цвета текста и цвета фона, отображение символов и т. д.</td></tr>
<tr><td>Warm reboot</td><td>Выполнить &ldquo;теплую&rdquo; перезагрузку компьютера</td></tr>
</table>
<p>Создаваемый вирус может создавать несколько эффектов из приведенного списка. Те, кому этого недостаточно, могут подключить к вирусу собственные модули, определенные в ассемблерном файле.</p>
<div align="center">
<img src="img/aaf00/fig1c.gif" alt="Рис. 1.12. Выбор условия для срабатывания вируса"/>
<p><strong>Рис. 1.12. Выбор условия для срабатывания вируса</strong></p>
</div>
<p>Для каждого выбранного эффекта VCL позволяет выбрать условие его выполнения (рис. 1.12). Условия могут основываться на некоторых характеристиках компьютера и его программной среды. Следующая таблица содержит список параметров, которые могут проверять вирусы, созданные VCL.</p>
<table summary="" border="1">
<tr><th>Параметр</th><th>Описание</th></tr>
<tr><td>Country code</td><td>Код страны</td></tr>
<tr><td>CPU type</td><td>Тип центрального процессора компьютера</td></tr>
<tr><td>Day</td><td>Текущий день месяца</td></tr>
<tr><td>DOS version</td><td>Версия операционной системы</td></tr>
<tr><td>EMS memory</td><td>Объем расширенной памяти</td></tr>
<tr><td>Number of game ports</td><td>Количество игровых портов, установленных в компьютере</td></tr>
<tr><td>Hour</td><td>Текущий час</td></tr>
<tr><td>Number of floppies</td><td>Количество дисководов, подключенных к компьютеру</td></tr>
<tr><td>Minute</td><td>Текущая минута</td></tr>
<tr><td>Month</td><td>Текущий месяц</td></tr>
<tr><td>Number of LPT ports</td><td>Количество параллельных портов компьютера</td></tr>
<tr><td>RAM memory</td><td>Объем оперативной памяти</td></tr>
<tr><td>Random number</td><td>Случайное число</td></tr>
<tr><td>Clock rollover</td><td>Переполнение таймера</td></tr>
<tr><td>Second</td><td>Текущая секунда</td></tr>
<tr><td>Number of COM ports</td><td>Количество последовательных портов компьютера</td></tr>
<tr><td>Weekday</td><td>Текущий день недели</td></tr>
<tr><td>Year</td><td>Текущий год</td></tr>
<tr><td>All files infected</td><td>Инфицирование всех файлов</td></tr>
<tr><td>Under 4DOS</td><td>Работа в среде 4DOS</td></tr>
</table>
<p>Когда все свойства заданы, для создания вируса достаточно нажать всего одну клавишу. По выбору вы можете получить исходный текст вируса на языке ассемблера или готовый к исполнению файл.</p>
<p>Исходный текст вируса на языке ассемблера, который создает VCL, имеет исчерпывающие комментарии, позволяющие в нем легко разобрааться:</p>
<pre class="source">
search_files	proc	near
		mov	dx,offset com_mask	; DX points to "*.COM"
		call	find_files		; Try to infect a file
done_searching:	ret				; Return to caller
com_mask	db	"*.COM",0		; Mask for all .COM files
search_files	endp

find_files	proc	near
		push	bp			; Save BP
		mov	ah,02Fh			; DOS get DTA function
		int	021h
</pre>
<p>К счастью, антивирусные программы могут достаточно хорошо обнаруживать вирусы, созданные при помощи автоматизированных средств разработки. Поэтому такие разработки скорее всего не смогут значительно распространиться и нанести большой вред.</p>
<h3>Плохие программы</h3>
<p>К сожалению, не только вирусы мешают нормальной работе компьютера и его программному обеспечению. Принято выделять еще, по крайней мере, три вида вредоносных программ. К ним относятся программы-черви, троянские программы и логические бомбы. Четкого разделения на эти виды не существует, троянские программы могут содержать вирусы, в вирусы могут быть встроены логические бомбы и т. д.</p>
<h4>Троянские программы</h4>
<p>Все знакомы с греческим мифом о том, как была завоевана неприступная Троя. Греки оставили ночью у ворот Трои деревянного коня, внутри которого притаились солдаты. Когда горожане, движимые любопытством, втащили коня за стены города, солдаты вырвались наружу и завоевали город.</p>
<p>Троянские программы действуют подобным образом. Их основное назначение совершенно безобидное или даже полезное. Но когда пользователь запишет программу в свой компьютер и запустит ее, она может незаметно выполнять другие, недокументированные функции.</p>
<p>Часто троянские программы используются для первоначального распространения вирусов. Такая программа записывается автором на станцию BBS, и оттуда загружается ничего не подозревающими пользователями на свои компьютеры. Когда пользователь запустит ее, она, помимо выполнения маскирующей функции, заражает компьютер вирусом.</p>
<p>После того как троянская программа выполнит свою скрытую функцию, она может самоуничтожиться, чтобы затруднить обнаружение причины нарушений в работе системы.</p>
<h4>Логические бомбы</h4>
<p>Логической бомбой называется программа или ее отдельные модули, которые при выполнении определенного условия выполняют несанкционированные действия. Логическая бомба может сработать по достижении определенной даты, когда в базе данных появится или исчезнет запись и т. д. Условие, при котором бомба срабатывает, определяется ее создателем. Логическая бомба может быть встроена в вирусы, троянские программы или в обыкновенное программное обеспечение.</p>
<p>Широко известен случай, когда программист, разрабатывающий бухгалтерскую систему, заложил в нее логическую бомбу. Она периодически проверяла ведомости на получение зарплаты и когда из нее исчезла фамилия создателя программы, бомба уничтожила всю систему.</p>
<p>Логические бомбы используются шантажистами. Через определенное время, после того как программист, встроивший логическую бомбу, покидает компанию, она может полностью разрушить систему. Шантажист сообщает руководству компании, что в систему заложена логическая бомба и он может ее удалить (за определенную плату).</p>
<h4>Программы-черви</h4>
<p>Программы-черви нацелены их авторами на выполнение определенной функции. Они могут быть ориентированы на проникновение в систему и модификацию некоторых данных.</p>
<p>Можно создать программу-червь, подсматривающую пароль для доступа к банковской системе и изменяющую базу данных таким образом, чтобы на счет программиста была переведена большая сумма денег.</p>
<p>Самая известная программа-червь написана студентом Корнельского (Cornell) университета Робертом Моррисом (Robert Morris). Червь был запущен второго ноября 1988 года в сеть Internet. За пять часов червь Морриса смог проникнуть на более чем 6000 компьютеров, подключенных к сети.</p>
<p>Очень сложно узнать, является ли программа троянской и заложена ли в нее логическая бомба. Программист имеет полную власть над своим детищем. Изучение сомнительной программы или системы может занять очень много времени и потребовать значительных финансовых затрат.</p>
<p>Мы не рекомендуем копировать к себе программы с BBS, обмениваться программным обеспечением со своими знакомыми и приобретать незаконные копии фирменного программного обеспечения. В любую из этих программ могут быть встроены дополнительные вредоносные функции и их использование приведет к нарушению работы вашей компьютерной системы.</p>
<h3>Как происходит заражение</h3>
<p>Как вирусы попадают в компьютер? Вы обязательно должны уяснить себе этот вопрос, чтобы по возможности перекрыть все возможные каналы поступления новых вирусов.</p>
<p>К счастью, вирус не может просто так появиться на компьютере (если, конечно, вы сами не разрабатываете его). Когда незараженный компьютер полностью изолирован от внешнего мира - от него отключены дисководы, он не подключен к локальной сети и в нем не установлен модем, вирус не может попасть в такой компьютер.</p>
<p>Компьютерный вирус не появится от того, что вы оставили на ночь открытой форточку и устроили сквозняк. Дождь и снег за окном также не могут служить источником возникновения компьютерного вируса.</p>
<p>Чтобы вирус проник на компьютер, необходимо, чтобы последний выполнил зараженную программу или загрузился с зараженной дискеты. Наиболее часто вирусы попадают в компьютер вместе с пиратским программным обеспечением, программами Freeware и Shareware.</p>
<p>Вот основные пути, по которым вирусы проникают в компьютер:</p>
<ul>
<li><em>получение программ с электронной доски объявлений и через глобальные сети;</em></li>
<li><em>обмен дискетами и программами;</em></li>
<li><em>проникновение вируса из локальной сети</em></li>
</ul>
<p>Мы не можем сейчас предусмотреть все возможные пути проникновения вирусов в компьютер. Так, например, совсем недавно появился новый вид вирусов, распространяющихся через файлы документов текстового процессора Microsoft Word for Windows. После этого даже казавшееся ранее абсолютно безопасным копирование документов несет в себе опасность заражения.</p>
<h4>Использование пиратского программного обеспечения</h4>
<p>Незаконное использование программного обеспечения, при котором оно многократно копируется многими людьми, легко позволяет вирусам распространяться от компьютера к компьютеру. В нашей стране, да и во всем мире, пиратское копирование программ широко распространено.</p>
<p>Быстрее всего вирусы распространяются, заражая выполнимые файлы компьютерных игр. Немногие могут удержаться, чтобы не скопировать у хорошего знакомого новую версию популярной игры, просто переписав на свои дискеты все ее файлы. Затем кто-нибудь перепишет игру у вас и так далее и так далее... Если на одном из компьютеров этой цепочки находится вирус, и он заразит выполнимые файлы игры, то все остальные любители развлечений также получат вирус.</p>
<p>Только в случае законного использования программ вы можете быть спокойны за то, что не получите вирус или троянскую программу. В крайнем случае, у вас будет кому выдвинуть претензии.</p>
<p>Тем не менее, известны случаи, когда даже фирменное программное обеспечение содержало в себе вирус, поэтому вы всегда должны внимательно относиться к проблеме антивирусной защиты компьютера.</p>
<h4>Широкое использование программ Freeware и Shareware</h4>
<p>Помимо фирменного программного обеспечения существуют так называемые бесплатные (Freeware) и условно бесплатные (Shareware) программы. Вы можете свободно копировать и использовать такое программное обеспечение. Программы Shareware отличаются от Freeware тем, что если вы используете их дольше определенного срока и они вам понравились, вы должны отправить их создателю небольшое количество денег, обычно от пяти до двадцати американских долларов.</p>
<p>В качестве Shareware распространяются программы архиваторы, например архиватор ARJ, различные графические пакеты и другие мелкие полезные программы.</p>
<div class="notel">
<em>Для того чтобы файловый вирус проник в компьютер, достаточно запустить зараженную программу с дискеты или с сетевого диска</em>
</div>
<p>Несмотря на свою привлекательность, программное обеспечение Freeware и Shareware может послужить для проникновения вирусов. Это происходит вследствии того, что программы Freeware и Shareware поступают конечному пользователю через длинную цепочку копирований. Существует вероятность, что во время такого копирования программа может быть заражена вирусом.</p>
<p>Поэтому следует по возможности избегать бесплатных и условно бесплатных программ. Особенно это касается тех случаев, когда компьютер используется для выполнения ответственных задач.</p>
<h4>Электронная доска объявлений и глобальные сети</h4>
<p>За последние несколько лет широкое распространение получили так называемые электронные доски объявлений (Bulletin Board System - BBS). BBS - это компьютер, снабженный одним или несколькими модемами, на котором выполняется специальная почтовая программа. Эта программа позволяет пользователям удаленных компьютеров связываться с BBS по телефонным линиям и выполнять обмен сообщениями и файлами.</p>
<p>Каждый обладатель модема может позвонить на BBS со своего компьютера, записать на нее или считать себе любые файлы. Таким образом, на BBS может попасть программа, зараженная вирусом, троянская программа или программа-червь.</p>
<p>Правила пользования различными BBS могут значительно отличаться друг от друга. Для некоторых BBS запрещена запись новых файлов. Пользователь может только загрузить файлы с BBS и обмениваться текстовыми сообщениями. На других BBS, наоборот, поощряется запись пользователями новых файлов. От объема записанных пользователем файлов зависит, какой объем файлов пользователь может получить для себя.</p>
<p>Несмотря на то, что все вновь загруженные файлы должны, по идее, проверяться системным оператором BBS на вирусы, иногда они этого могут не делать. Даже если проверка осуществляется, новые вирусы, не известные антивирусным программам, используемым системным оператором BBS, могут остаться незамеченными. В случае, когда на BBS загружена троянская программа, проверка антивирусными программами скорее всего ничего не даст.</p>
<p>Многие авторы вирусов специально записывают на BBS зараженные программы, чтобы инициировать таким образом распространение своего детища. Однако совсем не обязательно, что зараженная программа записана на BBS специально. Возможно тот, кто ее записал, сам не знал о наличии вируса.</p>
<p>Другие пользователи, которые перепишут с BBS на диски своего компьютера зараженную программу, получат вместе с ней вирус.</p>
<p>Следует помнить, что не только выполнимые файлы могут быть заражены вирусами. Даже текстовый файл в формате Microsoft Word for Windows может содержать в себе вирус.</p>
<div class="notel">
<em>Любой файл, содержащий в себе выполнимые инструкции, будь то команды центрального процессора или программы, написанные на языке макрокоманд, могут содержать вирус</em>
</div>
<p>Если вам все же приходится использовать в своей работе программы, полученные с BBS, необходимо в обязательном порядке проверять их на наличие вирусов.</p>
<h4>Обмен дискетами</h4>
<p>Ваш компьютер подвергается опасности заражения вирусами не только когда вы записываете себе выполнимые файлы и файлы документов, содержащие макрокоманды.</p>
<p>Загрузочные вирусы могут проникнуть в компьютер, когда он загружается с зараженной дискеты. Подчеркнем, что зараженная дискета не обязательно должна быть системной, то есть содержать файлы операционной системы. Загрузочный вирус может быть на любой дискете.</p>
<p>Обычно это происходит, когда вы случайно оставляете дискету в дисководе, а затем перезагружаете компьютер. Во время первоначальной загрузки компьютер считывает загрузочную запись с дискеты и передает ей управление. Если дискета заражена, вирус сразу получает управление и заражает жесткий диск компьютера. Теперь даже после выключения питания компьютера и загрузки его с жесткого диска вирус будет активизирован.</p>
<p>Файловые вирусы получают управление при запуске зараженного файла. Возможно, что работая на компьютере, вы не запустите ни одного зараженного файла и вирус так и не получит управления. Загрузочный вирус выполняется каждый раз, когда вы загружаете компьютер.</p>
<p>Сама по себе зараженная загрузочным вирусом дискета не представляет непосредственной опасности. Вы можете вставить ее в компьютер, скопировать с нее любые файлы или записать новые файлы с жесткого диска компьютера. Вирус при этом не сможет заразить компьютер. Только загрузка с дискеты позволяет вирусу активизироваться.</p>
<p>Базовая система ввода/вывода (Basic Input Output System - BIOS) большинства современных компьютеров позволяет установить порядок загрузки операционной системы. Если вы укажете, что операционная система должна загружаться сначала (или только) с жесткого диска, загрузочный вирус не проникнет к вам с зараженной дискеты, даже если вы случайно оставите ее в дисководе. Чтобы установить порядок загрузки операционной системы, надо запустить программу BIOS Setup, а затем руководствоваться описанием системной платы компьютера.</p>
<p>Однако мы не советуем вам специально экспериментировать с зараженными дискетами и копировать с них выполнимые файлы. Многие файлово-загрузочные вирусы могут также распространяться, заражая обычные выполнимые файлы. Такой вирус может заразить загрузочные секторы жесткого диска при запуске обычной программы.</p>
<p>Известны случаи, когда загрузочный вирус был обнаружен на отформатированных дискетах, только что купленных в магазине. Вирус попал на них еще на заводе, во время форматирования новых дискет.</p>
<h4>Вирусы на компакт-дисках</h4>
<p>В настоящее время все большее распространение получают устройства чтения компакт-дисков. Эти устройства позволяют читать специальные диски, объем которых составляет больше 600 Мбайт. Постоянное снижение цены на устройства чтения компакт-дисков и их совершенствование позволяют предположить, что в скором времени все компьютеры будут оснащены таким устройством.</p>
<p>К сожалению, записать информацию на компакт-диск значительно сложнее, чем прочитать. Существует две технологии их изготовления. Принципиальное различие между ними состоит в количестве дисков, которые можно изготовить за определенное время. Ни одна из этих технологий не позволяет стирать уже записанные данные и записывать на их место другие.</p>
<p>Первая технология предполагает наличие сложного технологического оборудования. Заготовки для таких дисков изготавливаются на основе алюминия и имеют крайне низкую стоимость, но запись на них информации окупается только при больших тиражах. Поэтому на алюминиевых дисках обычно выпускают дистрибутивы современного программного обеспечения, сложные игры, энциклопедии, то есть все, что находит широкий спрос.</p>
<p>Вторая технология позволяет изготавливать единичные экземпляры компакт-дисков, но устройства для их записи значительно дешевле и подключаются к компьютеру как дисковод. Сами же заготовки дисков выполняются с напылением золота и стоят дороже алюминиевых.</p>
<p>Файлы, записанные на компакт-дисках, могут быть заражены вирусами. Но в отличие от жестких дисков и дискет, это может случиться только если файл был заражен и записан на компакт-диск уже зараженным. Последующее использование компакт-диска не вызовет его заражения ни в каком случае, даже если компьютер, на котором вы работаете, забит вирусами до отказа. Секрет прост - обычные устройства чтения компакт-дисков физически не могут записывать данные на диск, и предназначены только для чтения.</p>
<p>Тем не менее вирус может находиться на компакт-диске. Это происходит в том случае, когда фирма, подготовившая компакт-диск к выпуску, не позаботилась о антивирусной безопасности и вирус заразил файл перед записью его на диск.</p>
<p>Особенно внимательно следует обращаться с пиратскими (не лицензионными) компакт-дисками, выпущенными подпольно. Никто не даст вам гарантию, что на них нет вирусов.</p>
<p>Большинство антивирусных программ позволяют проверить компакт-диск на вирусы. Следует только иметь в виду, что если вирус обнаружен, вылечить такой файл непосредственно на компакт-диске невозможно. В качестве одного из вариантов вы можете скопировать зараженный файл к себе на жесткий диск и сразу вылечить его с помощью антивирусной программы. Пользоваться можно только этим вылеченным файлом.</p>
<h4>Проникновение вируса из локальной сети</h4>
<p>Широкие возможности обмена данными, которые предоставляют локальные сети, позволяют вирусам распространяться с огромной скоростью. Мы посвятили локальным сетям отдельную главу. А сейчас отметим только, что вирус может проникнуть на компьютер, подключенный к локальной сети, когда пользователь копирует себе файлы из сети или просто запускает программы из сетевых каталогов.</p>
<h2>2 Как с ними бороться</h2>
<p>Не надо ждать, пока вирусы заразят ваш компьютер и успеют испортить хранимые в нем данные. Чем раньше начнется подготовка к нападению вирусов - тем лучше. Правильно организованная защита позволит сразу обнаружить появившийся вирус и он не сможет нанести программному обеспечению и вашим данным большого урона.</p>
<p>Основным средством борьбы с вирусами остаются антивирусные программы. В этой главе мы приведем основные сведения об антивирусных программах, приведем несколько примеров их использования.</p>
<p>Однако даже без применения антивирусных программ можно постараться предотвратить проникновение вирусов в компьютер и постараться уменьшить вред, который они нанесут в случае заражения.</p>
<p>Для тех, кто не смог уберечь свой компьютер от вирусов, мы дадим советы, как предотвратить дальнейшее распространение вируса и удалить его, максимально сохранив свои данные.</p>
<h3>Методы обнаружения вирусов</h3>
<p>Вы можете пользоваться антивирусным программным обеспечением, не имея представления о том, как оно устроено. Однако, в настоящее время существует очень много антивирусных программ, так что вам так или иначе придется на чем-то остановить свой выбор. Чтобы этот выбор был по возможности обоснован и установленные программы обеспечивали максимальную степень защиты от вирусов, необходимо изучить методики, применяемые этими программами.</p>
<p>Существует несколько основопологающих методик обнаружения и защиты от вирусов. Антивирусные программы могут реализовывать только некоторые методики или их комбинации.</p>
<ul>
<li><em>Сканирование</em></li>
<li><em>Обнаружение изменений</em></li>
<li><em>Эвристический анализ</em></li>
<li><em>Резидентные мониторы</em></li>
<li><em>Вакцинирование программ</em></li>
<li><em>Аппаратная защита от вирусов</em></li>
</ul>
<p>Кроме того, большинство антивирусных программ обеспечивают автоматическое восстановление зараженных программ и загрузочных секторов.</p>
<h4>Объекты заражения</h4>
<p>В первой главе мы уже рассказали о различных типах вирусов и о способах их распространения. Перед тем как приступить к рассмотрению антивирусных средств, перечислим области файловой системы компьютера, которые подвергаются заражению вирусами и которые необходимо проверять:</p>
<ul>
<li><em>Выполнимые файлы программ, драйверов</em></li>
<li><em>Главная загрузочная запись и загрузочные секторы</em></li>
<li><em>Файлы конфигурации AUTOEXEC.BAT и CONFIG.SYS</em></li>
<li><em>Документы в формате текстового процессора Microsoft Word for Windows</em></li>
</ul>
<p>Когда резидентный вирус становится активным, он помещает свой постоянно работающий модуль в оперативной памяти компьютера. Поэтому антивирусные программы должны выполнять проверку оперативной памяти. Так как вирусы могут использовать не только стандартную память, то желательно выполнять проверку верхней памяти. Например, антивирус Doctor Web проверяет первые 1088 Кбайт оперативной памяти.</p>
<h4>Сканирование</h4>
<p>Самая простая методика поиска вирусов, заключается в том, что антивирусная программа последовательно просматривает проверяемые файлы в поиске сигнатур известных вирусов. Под сигнатурой понимается уникальная последовательность байт, принадлежащая вирусу, и не встречающаяся в других программах.</p>
<p>Определение сигнатуры вируса довольно сложная задача. Сигнатура не должна содержаться в нормальных программах, не зараженных данным вирусом. В противном случае возможны ложные срабатывания, когда вирус обнаруживается в совершенно нормальной, не зараженной программе.</p>
<p>Конечно, программам-сканерам не обязательно хранить в себе сигнатуры всех известных вирусов. Они могут, например, хранить только контрольные суммы сигнатур.</p>
<p>Антивирусные программы-сканеры, которые могут удалить обнаруженные вирусы, обычно называются полифагами. Самой известной программой-сканером является Aidstest Дмитрия Лозинского. Aidstest выполняет поиск вирусов по их сигнатурам. Поэтому он обнаруживает только простейшие полиморфные вирусы.</p>
<p>В первой главе мы рассказывали о так называемых шифрующихся и полиморфных вирусах. Полиморфные вирусы полностью изменяют свой код при заражении новой программы или загрузочного сектора. Если вы выделите два экземпляра одного и того же полиморфного вириуса, то они могут не совпадать ни в одном байте. Как следствие, для таких вирусов невозможно определить синатуру. Поэтому простые антивирусные программы-сканеры не могут обнаружить полиморфные вирусы.</p>
<p>Антивирусные программы-сканеры могут обнаружить только уже известные вирусы, которые были предварительно изучены и для которых была определена сигнатура. Таким образом, использование программ-сканеров не защищает ваш компьютер от проникновения новых вирусов.</p>
<p>Для эффективного использования антивирусных программ, реализующих метод сканирования, необходимо постоянно обновлять их, получая самые последние версии.</p>
<h4>Эвристический анализ</h4>
<p>Эвристический анализ является относительно новым методом в обнаружении вирусов. Он позволяет обнаруживать ранее неизвестные вирусы, причем для этого не надо предварительно собирать данные о файловой системе, как этого требует метод обнаружения изменений.</p>
<p>Антивирусные программы, реализующие метод эвристического анализа, проверяют программы и загрузочные секторы дисков и дискет, пытаясь обнаружить в них код, характерный для вирусов. Так например, эвристический анализатор может обнаружить, что в проверяемой программе присутствует код, устанавливающий резидентный модуль в памяти.</p>
<p>Антивирусная программа Doctor Web, входящая в состав комплекта AO &ldquo;ДиалогНаука&rdquo;, имеет мощный эвристический анализатор, позволяющий обнаружить большое количество новых вирусов.</p>
<p>Если эвристический анализатор сообщает, что файл или загрузочный сектор возможно заражен вирусом, вы должны отнестись к этому с большим вниманием. Желательно исследовать такие файлы с помощью самых последних версий антивирусных программ или направить их для детального изучения в АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>В комплект IBM AntiVirus входит специальный модуль, ориентированный на обнаружение вирусов в загрузочных секторах. Этот модуль использует запатентованную технологию (patent-pending neural network technology from IBM) эвристического анализа и позволяет определить, заражен ли загрузочный сектор вирусом.</p>
<h4>Обнаружение изменений</h4>
<p>Когда вирус заражает компьютер, он обязательно делает изменения на жестком диске, например, дописывает свой код в выполнимый файл, добавляет вызов программы-вируса в файл AUTOEXEC.BAT, изменяет загрузочный сектор, создает файл-спутник.</p>
<p>Антивирусные программы могут предварительно запомнить характеристики всех областей диска, которые подвергаются нападению вируса, а затем периодически проверять их (отсюда происходит их название программы-ревизоры). Если будет обнаружено изменение, тогда возможно что на компьютер напал вирус.</p>
<p>Обычно программы-ревизоры запоминают в специальных файлах образы главной загрузочной записи, загрузочных секторов логических дисков, параметры всех контролируемых файлов, а также информацию о структуре каталогов и номера плохих кластеров диска. Могут проверяться и другие характеристики компьютера - объем установленной оперативной памяти, количество подключенных к компьютеру дисков и их параметры.</p>
<p>Программы-ревизоры могут обнаружить большинство вирусов, деже тех, которые ранее не были известны. Вирусы, заражающие файлы программ только при их копировании, ревизоры как правило обнаружить не могут, так как они не знают параметров файла, которые были до копирования.</p>
<p>Однако следует учитывать, что не все изменения вызваны вторжением вирусов. Так, загрузочная запись может изменится при обновлении версии операционной системы, а некоторые программы записывают внутри своего выполнимого файла данные. Командные файлы изменяются еще чаще, например, файл AUTOEXEC.BAT обычно изменяется во время установки нового программного обеспечения.</p>
<p>Программы-ревизоры не помогут и в том случае, когда вы записали в компьютер новый файл, зараженный вирусом. Правда, если вирус заразит другие программы, уже учтенные ревизором, он будет обнаружен.</p>
<p>Простейшая программа-ревизор Microsoft Anti-Virus (MSAV) входит в состав операционной системы MS-DOS. Основным, и возможно единственным ее достоинством является то, что на нее не нужно дополнительно тратить деньги.</p>
<p>Значительно более развитые средства контроля предоставляет программа-ревизор Advanced Diskinfoscope (ADinf), входящая в состав антивирусного комплекта АО &ldquo;ДиалогНаука&rdquo;. Более подробно мы рассмотрим эти средства в следующем разделе, а сейчас только заметим, что вместе с ADinf вы можете использовать лечащий модуль ADinf Cure Module (ADinfExt). ADinf Cure Module использует собранную ранее информацию о файлах для восстановления их после поражения неизвестными вирусами.</p>
<p>Конечно, не все вирусы могут быть удалены ADinf Cure Module и другими программными средствами, основанными на контроле и периодической проверке компьютера. Например, если новый вирус шифрует диск, как это делает вирус OneHalf, тогда его удаление без расшифровки диска скорее всего приведет к потере информации. Вирусы такого типа могут быть удалены только после внимательного изучения специалистами и включения модулей для борьбы с ними в обычные полифаги - Aidstest или Doctor Web.</p>
<p>Известные нам на момент написания книги антивирусные программы-ревизоры непригодны для обнаружения вирусов в файлах документов, так как они по своей сути постоянно изменяются. Ряд программ после внедрения в них кода вакцины перестают работать. Поэтому для контроля за ними следует использовать программы-сканеры или эвристический анализ.</p>
<h4>Резидентные мониторы</h4>
<p>Существует еще целый класс антивирусных программ, которые постоянно находятся в оперативной памяти компьютера, и отслеживают все подозрительные действия, выполняемые другими программами. Такие программы носят название резидентных мониторов или сторожей.</p>
<p>Резидентный монитор сообщит пользователю, если какая-либо программа попытается изменить загрузочный сектор жесткого диска или дискеты, выполнимый файл. Резидентный монитор сообщит вам, что программа пытается оставить в оперативной памяти резидентный модуль и т. д.</p>
<p>Большинство резидентных мониторов позволяют автоматически проверять все запускаемые программы на заражение известными вирусами, тоесть выполняют функции сканера. Такая проверка будет занимать некторое время и процесс загрузки программы замедлится, но зато вы будете уверены, что известные вирусы не смогут активизироваться на вашем компьютере.</p>
<p>К сожалению, резидентные мониторы имеют очень много недостатков, которые делают этот класс программ малопригодными для использования.</p>
<p>Многие программы, даже не содержащие вирусов, могут выполнять действия, на которые реагируют резидентные мониторы. Например, обычная команда LABEL изменяет данные в загрузочном секторе и вызывает срабатывание монитора.</p>
<p>Поэтому работа пользователя будет постоянно прерываться раздражающими сообщениями антивируса. Кроме того, пользователь должен будет каждый раз решать, вызвано ли это срабатывание вирусом или нет. Как показывает практика, рано или поздно пользователь отключает резидентный монитор.</p>
<p>И наконец, самый маленький недостаток резидентных мониторов заключается в том, что они должны быть постоянно загружены в оперативную память и, следовательно, уменьшают объем памяти, доступной другим программам.</p>
<p>В составе операционной системы MS-DOS уже есть резидентный антивирусный монитор VSafe.</p>
<h4>Вакцинирование программ</h4>
<p>Для того, чтобы человек смог избежать некоторых заболеваний, ему делают прививку. Существует способ защиты программ от вирусов, при котором к защищаемой программе присоединяется специальный модуль контроля, следящий за ее целостностью. При этом может проверяться контрольная сумма программы или какие-либо другие характеристики. Когда вирус заражает вакцинированный файл, модуль контроля обнаруживает изменение контрольной суммы файла и сообщает об этом пользователю.</p>
<p>Увы, в отличие от прививок человеку, вакцинирование программ во многих случаях не спасает их от заражения. Стелс-вирусы легко обманывают вакцину. Зараженные файлы работают также как обычно, вакцина не обнаруживает заражения. Поэтому мы не станем останавливаться на вакцинах и продолжим рассмотрение других средств защиты.</p>
<h4>Аппаратная защита от вирусов</h4>
<p>На сегодняшний день одним из самых надежных спсобов защиты компьютеров от нападений вирусов являются аппаратно-программные средства. Обычно они представляют собой специальный контроллер, вставляемый в один из разъемов расширения компьютера и программное обеспечение, управляющее работой этого контроллера.</p>
<p>Благодаря тому, что контроллер аппаратной защиты подключен к системной шине компьютера, он получает полный контроль над всеми обращениями к дисковой подсистеме компьютера. Программное обеспечение аппаратной защиты позволяет указать области файловой системы, которые нельзя изменять. Вы можете защитить главную загрузочную запись, загрузочные сектора, выполнимые файлы, файлы конфигурации и т. д.</p>
<p>Если аппаратно-программный комплекс обнаружит, что какая-либо программа пытается нарушить установленную защиту, он может сообщить об этом пользователю и заблокировать дальнейшею работу компьютера.</p>
<p>Аппаратный уровень контроля за дисковой подсистемой компьютера не позволяет вирусам замаскировать себя. Как только вирус проявит себя, он сразу будет обнаружен. При этом совершенно безразлично, как работает вирус и какие средства он использует для доступа к дискам и дискетам.</p>
<p>Аппаратно-программные средства защиты позволяют не только защитить компьютер от вирусов, но также вовремя пресечь работу троянских программ, нацеленных на разрушение файловой системы компьютера. Кроме того аппаратно-программные средства позволяют защитить компьютер от неквалифицированного пользователя и злоумышленника, они не дадут ему удалить важную информацию, отформативать диск, изменить файлы конфигурации.</p>
<p>В настоящее время в России серийно производится только аппаратно-программный комплекс Sheriff. Он надежно предотвратит заражение компьютера, позволит пользователю тратить значительно меньше времени на антивирусный контроль компьютера обычными программными средствами.</p>
<p>За рубежом производится намного больше средств аппаратно-программной защиты, но их цена занчительно выше, чем у Sheriff и составляет несколько сотен американских долларов. Вот несколько названий таких комплексов:</p>
<table summary="" border="1">
<tr><th>Наименование комплекса</th><th>Изготовитель</th></tr>
<tr><td>Virustrap</td><td>JAS Technologies of the Americas</td></tr>
<tr><td>C:Cure</td><td>Leprechaum Software International</td></tr>
<tr><td>V-Card</td><td>Digital Enterprises</td></tr>
<tr><td>Thunderbyte</td><td>Glynn International</td></tr>
<tr><td>Immune</td><td>Swabian Electronics Reutlingen</td></tr>
<tr><td>VIRUS BUSTER</td><td>Telstar Electronics</td></tr>
<tr><td>ExVira</td><td>Bugovics &amp; Partner</td></tr>
</table>
<p>Помимо выполнения своей основной функции, аппаратно-программные средства защиты компьютера могут обеспечивать различный дополнительный сервис. Они могут управлять разграничением прав доступа различных пользователей к ресурсам компьютера - жестким дискам, дисководам и т. д.</p>
<h4>Защита, встроенная в BIOS компьютера</h4>
<p>Многие фирмы, выпускающие системные платы компьютеров, стали встраивать в них простейшие средства защиты от вирусов. Эти средства позволяют контролировать все обращения к главной загрузочной записи жестких дисков, а также к загрузочным секторам дисков и дискет. В случае, если любая программа попытается изменить содержимое загрузочных секторов, срабатывает защита и пользователь получает соответствующее предупреждение. При этом он может разрешить это изменение или запретить его.</p>
<p>Однако, такой контроль нельзя назвать настоящим контролем на аппаратном уровне. Программный модуль, отвечающий за контроль доступа к загрузочным секторам, находится в ПЗУ BIOS и может быть обойден вирусами, если они заменяют загрузочные секторы, обращаясь непосредственно к портам ввода/вывода контроллера жестких и гибких дисков.</p>
<p>Существуют вирусы, которые пытаются отключить антивирусный контроль BIOS, изменяя некоторые ячейки в энергонезависимой памяти (CMOS-памяти) компьютера.</p>
<div class="notes">
<p><em>Вирусы Tchechen.1912 и 1914</em></p>
<p><em>Очень опасные резидентные шифрованные вирусы. Пытаются найти в ПЗУ BIOS текстовые строки Megatrends и AWARD. Если поиск закончился успешно, они считают, что в компьютере установлен BIOS фирм AWARD или AMI, отключают контроль за загрузочными секторами и заражают главную загрузочную запись жеского диска. Примерно через месяц после заражения вирус удаляет информацию со всего первого жесткого диска</em></p>
</div>
<p>Самое простое средство аппаратной защиты - отключить от компьютера все каналы, через которые в него может проникнуть вирус. Если компьютер не подключен к локальной сети и в нем не установлен модем, то достаточно отключить накопители на гибких дисках и основной канал поступления вирусов в компьютер будет перекрыт.</p>
<p>Однако такое отключение далеко не всегда возможно. В большинстве случаев пользователю для нормальной работы необходим доступ к дисководам или модемам. Кроме того, зараженные программы могут проникнуть в компьютер через локальную сеть или компакт-диски, а их отключение значительно сузит область применения компьютера.</p>
<h3>Методы удаления вирусов</h3>
<p>Обнаружить вирус на компьютере &ndash; это только половина дела. Теперь его необходимо удалить. В большинстве случаев антивирусные программы, которые обнаруживают вирус, могут его удалить. Существуют две основные методики, используемые антивирусными программами для удаления вирусов.</p>
<div class="notel">
<p><em>Если вы обнаружили вирус, проверяя выполнимые файлы, с расширениями имени COM и EXE, следует проверить все другие типы файлов, в которых содержится исполнимый код. В первую очередь это файлы с расширением SYS, OVL, OVI, OVR, BIN, BAT, BIN, LIB, DRV, BAK, ZIP, ARJ, PAK, LZH, PIF, PGM, DLL, DOC</em></p>
<p><em>Вы даже можете проверить вообще все файлы на жестких дисках компьютера. Возможно кто-нибудь переименовал зараженный выполнимый файл, изменив его расширение. Например, файл EDITOR.EXE переименовали в EDITOR.EX_. Такой файл проверен не будет. Если впоследствии его переименуют обратно, вирус снова сможет активизироваться и распространиться в компьютере</em></p>
</div>
<p>Первая, наиболее распространенная методика предусматривает, что антивирусная программа удаляет уже известный вирус. Чтобы вирус мог быть правильно удален, необходимо чтобы он был изучен, разработан алгоритм его лечения и этот алгоритм был реализован в новой версии антивируса.</p>
<p>Вторая методика позволяет восстанавливать файлы и загрузочные секторы, зараженные ранее неизвестными вирусами. Для этого антивирусная программа заранее, до появления вирусов, должна проанализировать все выполняемые файлы и сохранить о них много разнообразной информации.</p>
<p>При последующих запусках антивирусной программы она повторно собирает данные о выполняемых файлах и сверяет ее с данными, полученными ранее. Если обнаруживаются несоответствия, то возможно файл заражен вирусом.</p>
<p>В этом случае антивирус пытается восстановить зараженный файл, используя для этого сведения о принципах внедрения вирусов в файлы и информацию о данном файле, полученную до его заражения.</p>
<p>Некоторые вирусы заражают файлы и загрузочные секторы, замещая своим кодом часть заражаемого объекта, то есть безвозвратно уничтожая заражаемый объект. Файлы и загрузочные секторы, зараженные такими вирусами, не могут быть вылечены по первой методике, но как правило могут быть восстановлены по второй методике. Если восстановить зараженные выполнимые файлы с помощью антивирусных программ не получается, вы должны будете восстановить их с дистрибутива или резервной копии или просто удалить (если они не нужны).</p>
<p>С главной загрузочной записью и загрузочными секторами дело обстоит несколько сложнее. Если антивирусная программа не в состоянии восстановить их в автоматическом режиме, вы должны будете сделать это вручную, воспользовавшись командами FDISK, SYS, FORMAT. Ручное восстановление загрузочных секторов будет описано несколько позже, в шестой главе.</p>
<p>Существует целая группа вирусов, которые, заражая компьютер, становятся частью его операционной системы. Если вы просто удалите такой вирус, например восстановив зараженный файл с дискеты, то система может стать частично или полностью неработоспособной. Такие вирусы надо лечить пользуясь первой методикой.</p>
<p>В качестве примера таких вирусов можно привести загрузочные вирусы OneHalf и группу вирусов VolGU.</p>
<p>Во время загрузки компьютера вирус OneHalf постепенно шифрует содержимое жесткого дисска. Если вирус находится резидентным в памяти, то он перехватывает все обращения к жесткому диску. В случае, когда какая-либо программа пытается считать уже зашифрованный сектор, вирус расшифровывает его. Если вы удалите вирус OneHalf, информация на зашифрованной части жесткого диска станет недоступной.</p>
<p>Вирус VolGU не шифрует данные, но он не менее опасен, чем OneHalf. Каждый сектор жесткого диска хранит не только данные, записанные в нем, он также содержит дополнительную проверочную информацию. Она представляет собой контрольную сумму всех байт сектора. Эта контрольная сумма используется для проверки соохранности информацции.</p>
<p>Обычно, когда программа обращается к дисковой подсистеме компьютера, считываются и записываются только данные, контрольная сумма корректируется автоматически. Вирус VolGU, перехватывает обращения всех программ к жесткому диску и при записи данных на диск портит контрольные суммы секторов.</p>
<p>Когда вирус активен, он позволяет считывать секторы с неправильной контрольной суммой. Если просто удалить такой вирус, тогда секторы с неправильной контрольной суммой читаться не будут. Операционная система сообщит вам о ошибке чтения с жесткого диска (сектор не найден).</p>
<h3>Подготовка к вирусной атаке</h3>
<p>Пользователи компьютеров должны заблаговременно подготовиться к возможной атаке вирусов, а не ждать до последней минуты, когда вирус уже появится. Благодаря этому вы сможете быстрее обнаружить вирус и удалить его.</p>
<p>В чем же должна заключаться такая подготовка?</p>
<ul>
<li><em>Заранее подготовьте системную дискету. Запишите на нее антивирусные программы-полифаги, например Aidstest и Doctor Web</em></li>
<li><em>Постоянно обновляйте версии антивирусных программ, записанных на системной дискете</em></li>
<li><em>Периодически проверяйте компьютер при помощи различных антивирусных средств. Контролируйте все изменения на диске с помощью программы-ревизора, например ADinf. Новые и изменившиеся файлы проверяйте программами-полифагами Aidstest и Doctor Web</em></li>
<li><em>Проверяйте все дискеты перед использованием. Для проверки применяйте как можно более поздние версии антивирусных программ</em></li>
<li><em>Проверяйте все выполнимые файлы, записываемые на компьютер</em></li>
<li><em>Если вам нужен высокий уровень защиты от вирусов, установите в компьютере аппаратный контроллер защиты, например Sheriff. Совместное использование аппаратного контроллера и традиционных антивирусных средств позволят максимально обезопасить вашу систему</em></li>
</ul>
<h4>Создание системной дискеты</h4>
<p>Обычно в компьютере установлены два накопителя на гибких магнитных дисках. Один - для дискет размером 5.25 дюйма, а второй для дискет размером 3.5 дюйма. Операционная система MS-DOS, а также операционные системы Windows, Windows 95, Windows NT и OS/2 присваивают им имена A: и B:. Какой из дисководов имеет имя A:, а какой B:, зависит от аппаратуры компьютера.</p>
<p>Как правило, пользователь может изменить имена дисководов. Для этого необходимо открыть корпус компьютера и переключить несколько разъемов. Если есть такая возможность, то эту работу следует доверить техническому специалисту.</p>
<p>Накопители на магнитных дисках размером 5.25 дюйма постепенно выходят из употребления, поэтому в новых компьютерах устанавливают только один накопитель на гибких магнитных дисках, рассчитанный на дискеты размера 3.5 дюйма. В этом случае он имеет имя A:, диск B: отсутствует.</p>
<p>Загрузить компьютер с помощью системной дискеты можно только с дисковода A:. Таким образом, для изготовления системной дискеты к своему компьютеру вы должны взять дискету соответствующего размера.</p>
<p>Существует множество программ, позволяющих подготовить системную дискету. Такие программы входят в состав всех операционных систем - MS-DOS, Windows 3.1, Windows 95 и OS/2 и др.</p>
<p>Самыми простыми программами для подготовки системных дискет являются команды FORMAT или SYS, входящие в состав операционных систем MS-DOS и Windows 95 и поэтому в первую очередь мы опишем именно их.</p>
<h5>Использование команды FORMAT</h5>
<p>Команда FORMAT выполняет форматирование дискеты и может записать на нее файлы операционной системы. При форматировании гибких дисков FORMAT выполняет разметку дорожек на дискете, и формирует системные области - загрузочный сектор, таблицу размещения файлов и корневой каталог.</p>
<p>Во время форматирования дискеты вся информация, записанная на ней, стирается. Так как FORMAT заново записывает на дискету загрузочный сектор, то если она ранее была заражена загрузочным вирусом, вирус удаляется. Можно сказать, что команда FORMAT выполняет основную функцию антивируса - удаляет с дискеты любые вирусы.</p>
<p>При вызове команды FORMAT можно задать большое количество различных параметров. Их описание вы можете найти в четвертом томе серии &ldquo;Персональный компьютер - шаг за шагом&rdquo;, который называется &ldquo;Что вы должны знать о своем компьютере&rdquo;. В этой книге мы опишем только несколько самых необходимых нам параметров:</p>
<pre>FORMAT drive: [/S] [/U] [/Q]</pre>
<p>В качестве параметра drive вы должны задать имя дисковода, который будет форматировать дискету. Параметр /S означает, что после форматирования дискеты на нее переносятся основные файлы операционной системы и дискета становится системной. Для подготовки системной дискеты следует обязательно указать этот параметр.</p>
<p>Как мы говорили, команда FORMAT удаляет с форматируемой дискеты все записанные на ней файлы. Обычно FORMAT записывает на дискете скрытую информацию, позволяющую в случае необходимости восстановить удаленные с нее файлы.</p>
<div class="notel">
<em>Для восстановления файлов, удаленных во время выполнения форматирования дискеты, используйте команду UNFORMAT</em>
</div>
<p>Если вы твердо уверены, что воосстанавливать их не придется, можно ускорить форматирование дискеты, указав дополнительный параметр /U. В этом случае информация о удаляемых файлах не сохраняется и их нельзя будет восстановить.</p>
<p>Вы можете значительно ускорить процесс подготовки системной дискеты, если укажите команде FORMAT дополнительный параметр /Q. В этом случае выполняется быстрое форматирование дискеты:</p>
<p>Опишем процесс подготовки системной дискеты более подробно. Введите следующую команду:</p>
<pre>FORMAT A: /S /U</pre>
<p>На экране появится предложение вставить дискету в дисковод A: и нажать клавишу &lt;Enter&gt;:</p>
<pre>
	Insert new diskette for drive A:
	and press ENTER when ready...
</pre>
<p>Начнется процесс форматирования. На экране в процентах будет отображаться объем выполненной работы.</p>
<pre>
	Formatting 1.2M
	77 percent completed.
</pre>
<p>После окончания форматирования на дискету записываются основные файлы операционной системы. Затем вы можете ввести метку дискеты. Метка должна содержать не более одиннадцати символов. После ввода метки нажмите клавишу &lt;Enter&gt;. Если вы не желаете присваивать дискете метку, нажмите клавишу &lt;Enter&gt; сразу:</p>
<pre>
	Format complete.
	System transferred
	
	Volume label (11 characters, ENTER for none)?
</pre>
<p>Затем на экране появится различная статистическая информация: общая емкость дискеты, объем пространства, занятый файлами операционной системы, объем доступного свободного пространства. Если на дискете обнаружены плохие секторы, недоступные для использования, отображается их суммарный объем в байтах. Ниже выводится размер сектора в байтах, количество свободных секторов на дискете и ее серийный номер:</p>
<pre>
    1,213,952 bytes total disk space
      198,656 bytes used by system
    1,015,296 bytes available on disk
    
          512 bytes in each allocation unit.
	1,983 allocation units available on disk.

Volume Serial Number is 2C74-14D4
Format another (Y/N)?
</pre>
<p>На этом подготовку системной дискеты можно считать завершенной. Если вы не планируете сразу создать несколько системных дискет, нажмите клавишу &lt;N&gt;. Чтобы создать еще одну системную дискету, нажмите клавишу &lt;Y&gt; и повторите описанный нами процесс еще раз.</p>
<h5>Использование команды SYS</h5>
<p>Если у вас есть свободная чистая отформатированная дискета, быстрее всего можно сделать ее системной при помощи команды SYS. Для этого вставьте дискету в дисковод компьютера и введите следущую команду:</p>
<pre>SYS [drive1:][path] drive2:</pre>
<p>Команда SYS имеет один обязательный параметр - <em>drive2</em>. Этот параметр должен задавать имя дисковода, в котором подготавливается системная дискета. Вам следует указать в качестве параметра <em>drive2</em> имя A: или B:.</p>
<div class="notel">
<em>Загрузка компьютера происходит с диска A:. Вы должны изготовить системную дискету соответствующего размера</em>
</div>
<p>Необязательные параметры <em>drive1</em> и <em>path</em> определяют расположение системных файлов на диске. Если вы не укажете эти параметры, команда SYS будет брать системные файлы из корневого каталога текущего диска.</p>
<h5>Запись антивирусных программ на системную дискету</h5>
<p>На системной дискете располагаются основные файлы операционной системы MS-DOS: IO.SYS, MSDOS.SYS, COMMAND.COM, DBLSPACE.BIN. Если системная дискета изготовлена в операционной системе совместимой с MS-DOS, например IBM PC-DOS, то имена этих файлов могут быть другие.</p>
<p>Файлы IO.SYS и MSDOS.SYS представляют собой ядро операционной системы. Файл COMMAND.COM обычно называют командным процессором. Это та самая программа, которая выводит на экран компьютера системное приглашение и выполняет команды операционной системы. Последний файл на системной дискете - DBLSPACE.BIN. Он содержит расширение операционной системы, которое обеспечивает доступ к уплотненным дискам системы DoubleSpace.</p>
<p>Основные файлы операционной системы - IO.SYS, MSDOS.SYS имеют атрибут "скрытый файл" и не показываются командой DIR. Чтобы увидеть их, добавьте к команде DIR параметр /A.</p>
<pre>DIR A:\ /A</pre>
<p>После того как вы изготовили системную дискету, на ней осталось еще много свободного места. Суммарный объем, занимаемый основными файлами операционной системы MS-DOS - IO.SYS, MSDOS.SYS, COMMAND.COM, DBLSPACE.BIN составляет около 200 Кбайт. Таким образом, если вы использовали дискету с высокой плотностью запсиси, то в вашем распоряжении оказывается больше мегабайта свободного пространства.</p>
<p>Запишите на системную дискету программное обеспечение, необходимое для тестирования и восстановления поврежденной операционной системы. В первую очередь необходимо записать антивирусные программы, выполняющие поиск вирусов и программу для проверки целостности файловой системы. Полезно записать команды FORMAT и FDISK - они могут понадобиться для ручного восстановления системы. Для удобства можно дополнительно записать на системную дискету оболочку, например Norton Commander, и любой текстовый редактор.</p>
<p>В следующей таблице перечислены программы, которые окажут вам помощь при восстановлении работоспособности компьютера. Желательно все их записать на системную дискету. В случае, если они не поместятся на одну системную дискету, подготовьте еще одну дискету и запишите оставшиеся программы на нее.</p>
<table summary="" border="1">
<tr><th>Программа</th><th>Назначение</th></tr>
<tr><td>Aidstest</td><td>Антивирусная программа-полифаг. Позволяет обнаружить и удалить большое количество вирусов. Полиморфные вирусы, которые Aidstest не может обнаружить, определяются программой Doctor Web</td></tr>
<tr><td>Doctor Web</td><td>Антивирусная программа-полифаг, в которой реализован эвристический алгоритм поиска вирусов. Позволяет обнаружить сложные полиморфные вирусы. Вы должны использовать ее вместе с антивирусом Aidstest</td></tr>
<tr><td>ScanDisk или Norton Disk Doctor</td><td>Во многих случаях причиной неисправности и странного поведения компьютера служат не вирусы, а испорченная файловая система. Программы ScanDisk и Norton Disk Doctor обнаруживают и автоматически исправляют ошибки в файловой системе MS-DOS</td></tr>
<tr><td>CheckIt</td><td>Программа для тестирования всех подсистем компьютера. Позволяет обнаружить неисправность аппаратуры</td></tr>
<tr><td>Norton Commander</td><td>Оболочка для операционной системы MS-DOS. Значительно облегчает работу с компьютером. Содержит встроенный текстовый редактор, программы просмотра файлов в различных форматах</td></tr>
<tr><td>FORMAT</td><td>Команда MS-DOS. Предназначена для форматирования жестких и гибких дисков компьютера</td></tr>
<tr><td>FDISK</td><td>Команда MS-DOS. Предназначена для создания и удаления логических дисков. Команды FDISK и FORMAT могут понадобиться в случае полного разрушения информации на жестком диске. Их применение описывается в главе &ldquo;Восстановление файловой системы&rdquo;</td></tr>
<tr><td>Disk Editor</td><td>Редактор диска. Позволяет просматривать и редактировать любую информацию, записанную на диске, включая системные области. Disk Editor позволяет отредактировать главный загрузочный сектор, загрузочные секторы, таблицы размещения FAT, стуктуры каталогов и файлы</td></tr>
</table>
<p>В некоторых случаях для доступа к жестким дискам компьютера могут использоваться специальные драйверы или резидентные программы. Их обязательно нужно записать на подготовленную системную дискету. Чтобы они автоматически подключались при загрузке компьютера с системной дискеты, создайте на ней файлы CONFIG.SYS и AUTOEXEC.BAT, записав в них команды загрузки необходимых драйверов.</p>
<p>Если к компьютеру подключено устройство чтения компакт-дисков, запишите на системную дискету программное обеспечение, необходимое для его использования. Для MS-DOS вам надо записать драйвер устройства чтения и программу MSCDEX, входящую в состав операционной системы. Доступ к устройству чтения позволит оперативно восстановить программное обеспечение, записанное на компакт-дисках.</p>
<div class="notel">
<em>Операционная система Windows 95 не нуждается в программе MSCDEX, однако если графическая оболочка этой системы на загружается, MSCDEX все же надо подключить</em>
</div>
<p>После того как вы полностью подготовили системную дискету и записали не нее все необходимые программы, установите на нее защиту от записи. Для этого на дискете размером 5,25" необходимо заклеить прорезь на краю дискеты, а на дискете размером 3,5" открыть окно защиты. Защита от записи даст гарантию того, что вы случайно не испортите содержимое дискеты и вирусы не смогут на нее проникнуть. Так как дискеты иногда выходят из строя, то на этот случай лучше всего иметь несколько идентичных системных дискет.</p>
<h4>Загрузка с системной дискеты</h4>
<p>Чтобы загрузить компьютер с системной дискеты, надо установить приоритетную загрузку операционной системы с гибких магнитных дисков. Приоритет загрузки операционной системы определяется в CMOS-памяти. Чтобы изменить его, следует запустить программу Setup. Подробнее о программе Setup вы можете узнать из четвертого тома серии &ldquo;Персональный компьютер - шаг за шагом&rdquo;, который называется &ldquo;Что вы должны знать о своем компьютере&rdquo;.</p>
<p>Существуют вирусы, изменяющие приоритет загрузки компьютера. Для этого они меняют данные, записанные в CMOS-памяти. Примером таких вирусов могут быть вирусы Mammoth.6000 и ExeBug. Эти вирусы отключают в CMOS-памяти дисководы, временно подключая их, если какая-либо программа желает прочитать или записать информацию на дискету. Когда пользователь пытается загрузить компьютер с дискеты, загрузка будет выполняться с жесткого диска, так как дисковод отключен. Вирус получит управление, а затем выполнит загрузку компьютера с дискеты.</p>
<p>При этом с точки зрения пользователя все выглядит как обычно. Он видит, что операционная система загружается с дискеты, но к этому времени вирус уже находится в оперативной памяти и контролирует работу компьютера.</p>
<p>Поэтому непосредственно перед тем как выполнять загрузку MS-DOS с системной дискеты, убедитесь, что содержимое CMOS-памяти установлено правильно. Для этого запустите программу установки параметров BIOS и проверьте указанный там тип дисководов, а также порядок загрузки компьютера.</p>
<p>Вставьте системную дискету в дисковод A: и перезапустите компьютер. Если вы подозреваете наличие вирусов, для перезагрузки необходимо выключить и включить питание компьютера или нажать кнопку "Reset" на корпусе компьютера. Некоторые вирусы отслеживают перезагрузку при помощи клавиш &lt;Ctrl+Alt+Del&gt; и могут остаться в оперативной памяти даже после такой загрузки с системной дискеты.</p>
<p>После первоначального тестирования компьютера начнется загрузка операционной системы с дискеты. При этом должен гореть светодиод дисковода A:. Процесс загрузки с дискеты проходит несколько медленнее, чем с жесткого диска, поэтому вам придется немного подождать. Когда загрузка операционной системы завершится, на экране появиться соответствующее сообщение.</p>
<p>Затем операционная система запросит у вас текущую дату и время. Дата и время запрашиваются только в том случае, если на дискете (диске) отсутствует системный конфигурационный файл AUTOEXEC.BAT.</p>
<p>Если вы не хотите изменять дату и время, нажмите два раза клавишу &lt;Enter&gt;. В этом случае дата и время останутся без изменения, и на экране появится системное приглашение MS-DOS:</p>
<pre>A:\&gt;</pre>
<p>Вы можете создать на системной дискете пустой файл AUTOEXEC.BAT, тогда дата и время запрашиваться не будут и после загрузки операционной системы на экране сразу появится системное приглашение.</p>
<h3>Можно ли предотвратить проникновение вирусов</h3>
<p>Если периодически не проводить работу по профилактике и лечению компьютеров от вирусов, возможность потери хранимой информации и разрушения операционной среды становится более чем реальной.</p>
<p>Негативные последствия вашей халатности могут быть различными, в зависимости от того, какой вирус попадет в компьютер. Вы можете потерять либо часть информации из файлов, хранящихся в компьютере, либо отдельные файлы, либо даже все файлы на диске. Но хуже всего, если вирус внесет небольшие изменения в файлы данных, которые сначала могут быть не замечены, а потом приведут к ошибкам в финансовых или научных документах.</p>
<p>Работы по профилактике и лечению компьютеров от вирусов могут включать следующие действия:</p>
<ul>
<li><em>Устанавливать программное обеспечение следует только с дистрибутивов</em></li>
<li><em>Установите на всех ваших дискетах защиту от записи и снимайте ее только в случае необходимости</em></li>
<li><em>Ограничьте обмен программами и дискетами, проверяйте такие программы и дискеты на наличие вирусов</em></li>
<li><em>Периодически проверяйте оперативную память и диски компьютера на наличие вирусов с помощью специальных антивирусных программ</em></li>
<li><em>Выполняйте резервное копирование информации пользователя</em></li>
</ul>
<h4>Не знакомьтесь с незнакомыми людьми</h4>
<p>Никакие меры защиты не помогут защитить компьютер от проникновения вирусов, если вы не будете предварительно проверять все записываемые в него выполнимые файлы. На сегодняшний день такая проверка осуществима только с помощью антивирусных программ-полифагов.</p>
<p>Постоянное появление все новых и новых вирусов требует использования самых последних версий антивирусных программ. Желательно, чтобы ими обеспечивался поиск не только известных вирусов, но также и эвристический анализ проверяемых программ и загрузочных секторов. Он позволит обнаружить файлы, зараженные новыми, еще неизвестными и неизученными вирусами.</p>
<div class="notel">
<em>К сожалению, антивирусные программы не могут дать полной гарантии отсутствия в проверяемом программном обеспечении вирусов и тем более троянских программ или логических бомб. Записывая на свой компьютер программное обеспечение неизвестного происхождения, вы всегда рискуете</em>
</div>
<p>В больших организациях имеет смысл выделить специальный компьютер для установки в него сомнительного программного обеспечения, например компьютерных игр. Этот компьютер должен быть изолирован от остальных компьютеров организации. В первую очередь необходимо отключить его от локальной сети и запретить пользователям не только копировать с него программы, но и записывать на него файлы со своих рабочих дискет, заранее не защищенных от записи.</p>
<p>На время работы с подозрительным программным обеспечением используйте программы-мониторы, например монитор VSafe, входящий в состав MS-DOS. Если программа действительно окажется заражена вирусом или она содержит логическую бомбу, монитор сообщит о любых несанкционированных действиях с ее стороны. К сожалению программы-мониторы типа VSafe легко могут быть обмануты вирусами, поэтому более надежно использовать программно-аппаратные средства защиты.</p>
<p>В состав антивирусного комплекта &ldquo;ДиалогНаука&rdquo; входит программно-апаратный комплекс защиты Sheriff. Помимо всего прочего, он выполняет все функции программ мониторов, но делает это значительно лучше. За счет того что контроль компьютера обеспечивается специальным контроллером защиты на аппаратном уровне, вирусы не смогут обмануть Sheriff.</p>
<h4>Как защитить дискеты от записи</h4>
<p>Вы можете защитить свои дискеты от записи. Защита работает на уровне аппаратуры компьютера и ее нельзя отключить программными методами. Поэтому вирус не сможет заразить загрузочный сектор и выполнимые файлы, записанные на дискете с установленной защитой от записи.</p>
<p>Рекомендуется хранить все дискеты с установленной защитой от записи, и снимать ее только в случае, когда надо записать на нее новую информацию.</p>
<div class="notel">
<em>Все дистрибутивы программного обеспечения, записанные на дискетах, следует защитить от записи. Большинство программного обеспечения можно устанавливать с дискет, на которых установлена защита от записи</em>
</div>
<p>Если вы попытаетесь записать данные на дискету с установленной защитой от записи, операционная система выведет на экран компьютера предупреждающее сообщение. Оно может иметь различный вид, в зависимости от того, какие средства используются для записи на дискету.</p>
<p>Например, если вы используете команды COPY или XCOPY операционной системы MS-DOS, и пытаетесь записать файл на защищенную дискету, тогда на экране появится следующее сообщение:</p>
<pre>
	Write protect error reading drive A
	Abort, Retry, Fail?
</pre>
<p>Пользователь должен ответить, как операционная система должна поступить в этой ситуации. Вы можете выбрать три ответа: Abort, Retry или Fail. Для этого достаточно ввести с клавиатуры первый символ выбранного отвеста: Abort - &lt;A&gt;, Retry - &lt;R&gt;, Fail - &lt;F&gt;. Можно использовать как заглавные так и строчные буквы.</p>
<p>Выбор Abort или Fail означает, что операционная система должна отказаться от попытки записать информацию на дискету (Abort просто отменяет выполнение операции, а Fail указывает на необходимость вернуть программе код ошибки). Если вам надо выполнить операцию записи, снимите с дискеты защиту от записи и выберите Retry.</p>
<p>Необходимо внимательно отнестись к сообщению о попытке записи на защищенную дискету. Чтение файлов с дискеты, и запуск с нее большинства программ не должны вызывать записи на нее. Если вы уверены, что запись на дискету выполняться не должна, но она происходит, велика вероятность, что компьютер заражен вирусом.</p>
<p>Некоторые вирусы блокируют вывод сообщения о попытке нарушения защиты от записи, когда заражают выполнимые файлы или загрузочный сектор дискеты. Это позволяет им остаться незамеченными, если на дискете установлена защита. Тем не менее, вы достигнете желаемого результата, дискета останется незараженной.</p>
<div class="notes">
<p><em>Вирус Plague.2647</em></p>
<p><em>Неопасный резидентный стелс-вирус. При открытии инфицированных файлов удаляет из них свой код, а затем снова заражает, когда файл закрывается. При заражении файлов на дискетах проверяет, установлена ли защита от записи. Если защита установлена, вирус не будет пытаться заразить файлы на нем. Содержит строку "PLAGUE"</em></p>
</div>
<p>Защиту от записи можно установить на дискету любого размера - 3,5 дюймов и 5,25 дюймов. Проще всего это делается на дискетах размера 3,5 дюймов. Вам достаточно закрыть маленькое отверстие в углу дискеты специальной пластмассовой крышкой, как это показано на рис. 2.1. Снять защиту от записи также просто: достаточно открыть защитное отверстие.</p>
<div align="center">
<img src="img/aaf00/fig21.gif" alt="Рис. 2.1. Защита от записи на дискете размера 3,5 дюймов"/>
<p><strong>Рис. 2.1. Защита от записи на дискете размера 3,5 дюймов</strong></p>
</div>
<p>Чтобы защитить от записи дискету 5,25&rdquo;, нужно заклеить прорезь в конверте дискеты (рис. 2.2). Для этого используется небольшой прямоугольный кусочек клейкой бумаги. Обычно такая бумага продается вместе с дискетами. В крайнем случае вы можете воспользоваться обычной изолентой. Снять защиту от записи можно, удалив приклеенный вами кусочек бумаги.</p>
<p>Часто снимать и устанавливать защиту на дискете 5,25&rdquo; очень трудно, рано или поздно это надоест и вирус сможет проникнуть на дискету. Поэтому по возможности откажитесь от дискет размером 5,25&rdquo; и замените их более удобными дискетами размера 3,5&rdquo;.</p>
<div align="center">
<img src="img/aaf00/fig22.gif" alt="Рис. 2.2. Защита от записи на дискете размера 5,25 дюймов"/>
<p><strong>Рис. 2.2. Защита от записи на дискете размера 5,25 дюймов</strong></p>
</div>
<h4>Правильный выбор порядка загрузки компьютера</h4>
<p>Операционная система может быть загружена или с жесткого дисска или с дискеты. Обычно компьютер загружается с жесткого диска, однако если в момент включения питания компьютера или его перезагрузки в дисковод A: вставлена дискета (случайно или нарочно), загрузка операционной системы начнется с нее. Если дискета заражена загрузочным вирусом, он получит управление и сразу попытается заразить жесткий диск компьютера.</p>
<p>Большинство компьютеров позволяют указать приоритет, в котором должна выполняться загрузка операционной системы. Этот порядок устанавливается при помощи программы BIOS Setup. Более подробно о программе BIOS Setup вы прочитаете в разделе &ldquo;Восстановление файловой системы&rdquo;.</p>
<p>Чтобы защитить компьютер от случайного заражения загрузочным вирусом, укажите, что операционная система должна загружаться сначала с диска C:, и только в случае его неисправности - с диска A:.</p>
<p>Если надо загрузить компьютер с дискеты, удостоверьтесь, что на ней нет вирусов. Для этого сначала проверьте ее несколькими антивирусными программами, например программами Doctor Web и Aidstest.</p>
<p>Лучше всего, если вы приготовите системную дискету заранее, а чтобы ее случайно не испортили, установите на ней защиту от записи. На системную дискету полезно записать программы для диагностики компьютера - антивирусные программы, программы проверки целостности файловой системы и исправности аппаратуры компьютера. Как создать системную дискету мы рассказали в разделе &ldquo;Создание системной дискеты&rdquo;.</p>
<h4>Непопулярные меры</h4>
<p>В организациях очень эффективными могут оказаться жесткие меры защиты, связанные с отключением от компьютеров каналов возможного поступления вирусов. В первую очередь это относится к дисководам для гибких дисков. Дисководы могут быть отключены физически и сняты с компьютера или их можно отключить только в CMOS-памяти, при этом на программу BIOS Setup следует поставить пароль.</p>
<p>В идеальном случае от компьютера надо отключить все дисководы, устройства чтения компакт-дисков, модемы, последовательные и параллельные порты, сетевые адаптеры. Конечно это нереально, однако не следует полностью отказываться от такой идеи.</p>
<h4>Резервное копирование</h4>
<p>Очень важно организовать резервное копирование информации, хранимой в компьютере. В зависимости от средств, которыми вы располагаете, можно выполнять полное копирование жестких дисков компьютера или копирование только самой важной информации, которая не может быть восстановлена другим путем.</p>
<p>Для резервного копирования обычно используют магнитные ленты. Запись на них осуществляется специальными цифровыми магнитофонами, называемыми стримерами. Объем магнитных кассет составляет от 200 Мбайт до 4 Гбайт. В последнее время стали доступны устройства магнито-оптической дисковой памяти. По надежности и удобству использования они значительно превосходят магнитную ленту. Объем магнитооптических дисков широко варьируются и составляет от десятков мегабайт до нескольких гигабайт.</p>
<p>Если в вашем распоряжении нет ни стримера, ни магнитооптического диска, то во многих случаях достаточно использовать простые дискеты. Конечно запись на дискеты - это самый плохой способ резервного копирования. Во-первых, дискеты имеют очень маленький объем - немногим больше одного мегабайта. Во-вторых, дискеты очень ненадежны. Иногда с них не удается считать ранее записанную информацию.</p>
<div class="notel">
<em>Одной резервной копии недостаточно. Вы должны иметь несколько резервных копий. Вот небольшой пример. Вы выполняете очередное копирование и вдруг происходит сбой питания или нападение вируса. Компьютер зависает, данные записанные в компьютере и их копия оказываются испорченными</em>
</div>
<p>Выполняя резервное копирование, надо быть предельно осторожным. Перед копированием всегда проверяйте целостность копируемой информации. Выполняйте поиск вирусов и проверку файловой системы. Для этого используйте самые последние версии антивирусов и программы типа ScanDisk. Если не соблюдать этого правила, то все резервные копии рано или поздно окажутся испорченными.</p>
<p>В особо ответственных случаях выполняйте циклическое копирование данных. Например, одну копию обновляйте каждый день, вторую - каждую неделю, третью - каждый месяц.</p>
<h5>Архивирование файлов</h5>
<p>Если для резервного копирования используются обычные дискеты, тогда перед записью на них файлов их следует сжать какой-либо программой архивации. Программы-архиваторы позволяют уменьшить размер дисковой памяти, занимаемый файлами. Это происходит за счет устранения избыточности информации, хранимой в сжимаемых файлах.</p>
<p>Сжатые файлы могут занимать значительно меньше места на диске, чем их оригиналы. Так, текстовые файлы, подготовленные, например, в текстовом процессоре Microsoft Word for Windows, обычно уменьшаются вдвое. Конечно, работать с таким файлом невозможно. Перед работой его надо восстановить с помощью той же программы архивации.</p>
<p>В настоящее время наиболее популярны архиваторы ARJ, PKZIP, RAR. Все они выполняют примерно одинаковые функции и могут быть использованы для создания резервных копий документов.</p>
<p>Более подробно вопросы архивирования данных рассмотрены в десятом томе серии &ldquo;Библиотека системного программиста&rdquo;, который называется &ldquo;Компьютер IBM PC/AT, MS-DOS и Windows. Вопросы и ответы&rdquo;. Сейчас мы только приведем пример использования архиватора ARJ для подготовки резервных копий файлов. Формат вызова архиватора ARJ достаточно сложен:</p>
<pre>ARJ &lt;команда&gt; [-&lt;ключ&gt; [-&lt;ключ&gt;...]] &lt;имя архива&gt; [&lt;имена файлов&gt;...]</pre>
<p>Первый параметр - <em>команда</em> - определяет режим работы архиватора:</p>
<table summary="" border="1">
<tr><th>Команда</th><th>Режим работы архиватора</th></tr>
<tr><td>A</td><td>Добавление новых файлов в архив</td></tr>
<tr><td>D</td><td>Удаление файлов из архива</td></tr>
<tr><td>E</td><td>Извлечение файлов из архива</td></tr>
<tr><td>L</td><td>Просмотр содержимого архива</td></tr>
<tr><td>M</td><td>Перенос файлов в архив. Файлы записываются в архив, а затем исходные файлы удаляются с диска</td></tr>
<tr><td>X</td><td>Восстановление файлов вместе со структурой каталогов и подкаталогов, в которой эти файлы были расположены при архивации</td></tr>
<tr><td>E</td><td>Восстановление файлов архива. Структура каталогов и подкаталогов не восстанавливается, все файлы из архива помещаются в один каталог</td></tr>
<tr><td>U</td><td>Обновить файлы в архиве. В архив записываются только измененные и новые файлы. Файлы, оставшиеся без изменения, заново не архивируются. За счет этого экономится много времени</td></tr>
</table>
<p>После одной из приведенных команд могут следовать один или несколько необязательных дополнительных параметров <em>ключ</em>. Дополнительные параметры должны выделяться символом '-'. Приведем таблицу наиболее важных дополнительных параметров и опишем их назначение:</p>
<table summary="" border="1">
<tr><th>Дополнительный параметр</th><th>Назначение</th></tr>
<tr><td>-G</td><td>Защита создаваемого архива паролем</td></tr>
<tr><td>-R</td><td>Используется с командами "a" или "m" для указания того, что в архив должны войти файлы из текущего каталога и всех его подкаталогов</td></tr>
<tr><td>-V</td><td>Создание и восстановление многотомных архивов, расположенных на нескольких дискетах. Каждая дискета содержит один том архива (файл). Существует несколько модификаций параметра -v:
<p>VV - выдавать звуковой сигнал между обработкой отдельных томов архива;</p>
<p>VA - автоматически определять объем свободного пространства на дискете (размер очередного тома архива);</p>
<p>Vnnnnn - размер отдельных томов архива, например V20000 - создать архив из томов по 20 Кбайт;</p>
<p>V360, V720, V1200, V1440 - создать тома, фиксированного размера по 360 Кбайт, 720 Кбайт, 1,2 Мбайт, 1,44 Мбайт</p></td></tr>
<tr><td>-JR</td><td>Восстановить файлы из поврежденного архива. Используйте этот параметр, если восстановление файлов из архива прервалось сообщением архиваторе о нарушениях в структуре файла-архива</td></tr>
<tr><td>-X&lt;file_name&gt;</td><td>Не архивировать файл, указанный далее. В имени файла можно использовать символы '?' и '*'</td></tr>
<tr><td>-Y</td><td>Архиватор не будет запрашивать у пользователя разрешения для выполнение различных действий, например для создания нового файла многотомного архива, создания каталогов</td></tr>
</table>
<p>После дополнительных параметров следует имя файла архива, а за ним - список имен извлекаемых, добавляемых или удаляемых файлов. При указании имен этих файлов можно использовать символы '?' и '*'. Если вы не укажете список file_names, то будут подразумеваться все файлы, расположенные в текущем каталоге или архиве.</p>
<p>Программы-архиваторы очень удобны для создания резервных копий на дискетах. Если файл архива не помещается на одной дискете, архиватор позволяет создать многотомный архив, состоящий из нескольких файлов. Для этого надо указать дополнительный параметр V. Отдельные файлы многотомного архива можно записать на несколько дискет.</p>
<p>Следующая команда создает многотомный архив, из всех файлов, расположенных в текущем каталоге и всех его подкаталогах, за исключением файлов, имеющих имя TMP или расширение имени BAK. Файлы многотомного архива будут иметь размер немного больший, чем 1,44 Мбайт. Вы сможете записать их на 3-дюймовые дискеты.</p>
<pre>ARJ A -R -X*.BAK -XTMP.* -V1440 !COLLAPS</pre>
<p>Файлы созданного архива будут иметь имя !COLLAPS и различные расширения:</p>
<pre>
	!COLLAPS.ARJ
	!COLLAPS.A01
	!COLLAPS.A02
	!COLLAPS.A03
	....
</pre>
<p>Восстановить файлы, записанные в этом многотомном архиве, можно либо предварительно скопировав их на жесткий диск компьютера или непосредственно с дискет. Например, для восстановления с дискет используйте следующую команду:</p>
<pre>ARJ X -V A:\!COLLAPS</pre>
<p>После восстановления файла архива пользователю будет выдан запрос на обработку следующего файла архива. Вставьте в дисковод следующую дискету и нажмите кнопку &lt;Y&gt;.</p>
<h5>Резервное копирование документов в Windows 95</h5>
<p>Операционная система Windows 95 предоставляет удобные средства для резервного копирования отдельных документов и целых каталогов на дискеты. Для этого достаточно открыть пиктограмму My Computer и перейти в каталог, файлы из которого надо записать на дискеты.</p>
<p>Затем переместите указатель мыши на пиктограмму того файла или каталога, который должен быть скопирован, и нажмите правую кнопку мыши. На экране появится небольшое меню.</p>
<div align="center">
<img src="img/aaf00/fig23.gif" alt="Рис. 2.3. Запись каталога Library на дискеты"/>
<p><strong>Рис. 2.3. Запись каталога Library на дискеты</strong></p>
</div>
<p>Выберите из этого меню строку Send To, а затем в открывшемся временном меню укажите дисковод, на котором будет происходить копирование. На рисунке 2.3 мы показали, как надо выполнять копирование каталога Library на дискеты размера 3,5 дюйма.</p>
<p>После того как вы укажете дисковод, начнется процесс копирования. Если для копирования всех файлов каталога одной дискеты окажется недостаточно, операционная система попросит вас вставить следующую дискету.</p>
<p>К сожалению, продемонстрированный нами способ выгрузки не позволяет скопировать на дискеты файлы, размер которых превышает объем самой дискеты. Поэтому скопировать, таким образом, очень большие документы невозможно.</p>
<h4>Проверим, нет ли вирусов</h4>
<p>Для проверки новых программ, которые вы записываете в свой компьютер, надо использовать антивирусные программы-полифаги последних версий. Они смогут обнаружить любые вирусы, известные на момент создания программы-антивируса. Желательно, чтобы используемые вами антивирусы выполняли эвристический анализ программ. Возможно, это позволит обнаружить новые, еще не известные вирусы.</p>
<p>Популярность антивирусных программ Aidstest и Doctor Web настолько велика, что они установлены практически на каждом компьютере. Поэтому сейчас мы проверим ваш компьютер с помощью этих программ и посмотрим, нет ли в нем вирусов.</p>
<p>Если у вас нет самых последних версий антивирусов, воспользуйтесь теми программами, которые у вас есть. Несмотря на то, что такая проверка будет неполной, она все же позволит обнаружить большое количество вирусов.</p>
<h5>Поиск вирусов на жестком диске компьютера</h5>
<p>В начале проверим все жесткие диски компьютера программой Aidstest. Введите в системном приглашении DOS следующую команду.</p>
<pre>AIDSTEST *</pre>
<p>Внимательно следите за сообщениями, выдаваемыми программой во время проверки компьютера. Если будет обнаружен вирус, Aidstest сообщит об этом.</p>
<p>Многие вирусы, которые не обнаруживает Aidstest, могут быть пойманы программой Doctor Web. Кроме того, Doctor Web позволяет выполнить эвристический анализ программ и загрузочных секторов. Поэтому повторите проверку с помощью Doctor Web.</p>
<pre>DRWEB * /CL /HI /AR /HA1 /RV /UP</pre>
<p>Антивирус Doctor Web проверит все жесткие диски компьютера, при этом он выполнит поиск вирусов не только непосредственно в выполнимых файлах, но и в файлах архивов, а также в сжатых выполнимых файлах. Если вирусы будут обнаружены, программа выведет на экран соответствующее сообщение.</p>
<p>Во всех примерах, приведенных в этом разделе, выполняется только поиск вирусов, ни один из обнаруженных вирусов не будет удален. Для этого надо запустить программу-антивирус еще один раз, загрузившись с системной дискеты.</p>
<h5>Поиск вирусов на дискетах</h5>
<p>Все новые дискеты, а также дискеты, которые вы отдавали кому-либо, необходимо проверить на заражение вирусами. Для этого используйте антивирусы-полифаги Aidstest и Doctor Web. Последовательно вызовите сначала одну, а затем другую программы. В следующем примере показано как проверить дискету, вставленную в дисковод A:.</p>
<pre>
	AIDSTEST A: /B
	DRWEB A: /CL /AR /HA1 /UP /NM /OF
</pre>
<h5>Вирусы в файлах архивов</h5>
<p>Чтобы увеличить объем свободного пространства на жестком диске и дискетах, многие пользователи архивируют редко используемые файлы. Для этого могут использоваться специальные программы-архиваторы, уменьшающие размер файлов за счет устранения избыточности данных, записанных в файле. Когда пользователю вновь требуется файл из архива, он снова использует программу-архиватор.</p>
<p>Файлы внутри архива хранятся в сжатом виде, исключающем возможность поиска вируса по их сигнатурам. Поэтому, если вы записали в архив зараженную программу, она может остаться незаметной для многих антивирусов.</p>
<p>Некоторые антивирусные программы, например Doctor Web, позволяют проверять файлы, записанные внутри архивов. Проверяя архивы, Doctor Web временно восстанавливает записанные в нем файлы и последовательно просматривает их.</p>
<div class="notel">
	<em>Если вы обнаружили в своем компьютере вирусы, обязательно проверьте все файлы архивов, даже если ваша антивирусная программа не умеет работать с архивами. Самостоятельно восстановите файлы из всех архивов на диске, а затем проверьте их вашей антивирусной программой</em>
</div>
<p>Обычно, когда на одном компьютере работает несколько человек, они используют различные средства разграничения доступа к жестким дискам. Например Diskreet из пакета Norton Utilities, позволяет создать несколько логических дисков. Каждый пользователь может иметь доступ только к некоторым дискам, остальные для него будут полностью недоступны.</p>
<div class="notes">
	<p><em>Вирус ArjVirus</em></p>
	<p><em>Неопасный нерезидентный вирус. Выполняет поиск в текущем каталоге и его подкаталогах файлов архивов, созданных программой-архиватором ARJ. Файлы архивов вирус отличает только по их расширению - ARJ.</em></p>
	<p><em>Если файл архива будет обнаружен, вирус создает файл, имеющий случайное имя, состоящее из четырех символов от 'A' до 'V', с расширением COM. В этот файл вирус записывает 5 Кбайт своего кода и в конце дополняет его произвольным количеством байт.</em></p>
	<p><em>Затем вирус вызывает программу-архиватор ARJ, считая, что он расположен в одном из каталогов, перечисленных в переменной PATH. Для этого используется командный процессор:</em></p>
	<p><em>C:\COMMAND.COM /C ARJ A &lt;ArjFile&gt; &lt;ComFile&gt;</em></p>
	<p><em>В качества параметра ArjFile указывается имя найденного вирусом файла-архива. Параметр ComFile содержит имя только что созданного выполнимого файла вируса. Такая команда добавляет в обнаруженный вирусом файл-архив новый выполнимый файл вируса. Затем исходный файл вируса удаляется.</em></p>
	<p><em>Чтобы пользователь не увидел на экране информацию, обычно отображаемую программой-архиватором ARJ, вирус временно отключает весь вывод на экран монитора.</em></p>
	<p><em>Основная идея вируса заключается в том, что пользователь восстановивший файлы из зараженного архива обнаружит в нем неизвестный выполнимый файл и запустит его из любопытства</em></p>
</div>
<p>Необходимо выполнять поиск вирусов на всех дисках. Лучше всего если это будет делать пользователь, имеющий доступ ко всем дискам компьютера. В противном случае каждый пользователь должен будет проверять доступные ему диски. Если кто-либо из пользователей обнаружит, что на диске, доступном ему, присутствует вирус, он обязательно должен сообщить об этом всем другим пользователям компьютера.</p>
<h3>Если вы обнаружили вирус</h3>
<p>Самую большую ценность представляют ваши данные, записанные в компьютере. Это могут быть текстовые документы, файлы электронных таблиц, базы данных, исходные тексты программ и т. д. Их стоимость может в много и много раз превышать стоимость самого компьютера и установленного в нем программного обеспечения.</p>
<p>Любое программное обеспечение, разрушенное вирусами, можно восстановить с дистрибутивов или резервных копий. А вот с данными дело обстоит значительно хуже. Если данные постоянно не копировались, они могут быть безвозвратно потеряны.</p>
<p>Поэтому обнаружив вирус, в первую очередь надо перезагрузиться с чистой дискеты и скопировать ваши данные с жесткого диска компьютера на дискеты, магнитные ленты или любые другие устройства хранения информации. Только после этого можно приступать к лечению компьютера.</p>
<p>Если обнаружен вирус, то возможно, он уже разрушил хранимую в компьютере информацию. Разрушения могут носить различный характер. Возможно, файлы с данными будут уничтожены полностью и вы даже не сможете их прочитать, а возможно они будут изменены незначительно и вы не сможете это сразу заметить.</p>
<div class="notes">
	<p><em>Вирус Rogue.1208</em></p>
	<p><em>Опасный резидентный вирус. Уничтожает файлы с расширением DBF, записывая в них первый байт 'R' и производя с остальным содержимым файла логическую операцию ИСКЛЮЧАЮЩЕЕ ИЛИ с числом 13, до первого символа, который имеет код 13. Уничтожает файлы CHKLIST ???. В месяц, когда сумма значения года и значения месяца равна 2000, вирус выводит текст: &ldquo;Now you got a real virus! I'm the ROGUE ...!&rdquo;</em></p>
</div>
<p>Постарайтесь выяснить, какой именно вирус попал к вам в компьютер и что он делает. Получить подобную информацию можно из описаний вирусов, поставляемых вместе с антивирусными программами. Фактически все антивирусные программы имеют такие списки. Они могут быть выполнены в виде простых текстовых файлов или в виде специальных гипертекстовых баз данных.</p>
<p>Если вы обнаружили в компьютере вирус, он уже мог успеть распространиться, заразив другие компьютеры в вашей организации. Их необходимо проверить в обязательном порядке. Многие пользователи сегодня имеют компьютеры у себя дома. Они также могут оказаться заражены.</p>
<p>Необходимо проверить все дискеты, использовавшиеся для работы с зараженными компьютерами. Они могут оказаться заражены загрузочными и файловыми вирусами. Вирус может сохраниться на них, а затем снова заразить компьютер. Дискеты, зараженные вирусами, надо вылечить или отформатировать.</p>
<h3>Как лечить компьютер</h3>
<p>После того как вы попытались скопировать с компьютера все свои данные (документы, исходные тексты, файлы баз данных) пора начинать лечение компьютера и удаление заразивших его вирусов. Для вас существует как минимум три возможности удалить вирусы из компьютера.</p>
<p>Самый простой из них заключается в полной смене всего программного обеспечения, установленного в компьютере. Вы должны будете переустановить операционную систему и все остальные программы заново. Если вирус заразил загрузочную запись, то ее можно обновить, отформатировав логические диски компьютера, воспользовавшись для этого командой FORMAT. Однако даже форматирование не удалит вирус из главной загрузочной записи жесткого диска. Для этого следует воспользоваться командой FDISK с недокументированным параметром /MBR, а затем снова создать на жестком диске разделы и логические диски.</p>
<p>Такие операции, как форматирование логического диска, удаление раздела или логического диска командой FDISK полностью уничтожают все файлы на данном диске. Поэтому предварительно удалять файлы нет никакой необходимости.</p>
<p>После того как вы заново создадите на жестком диске разделы и логические диски и отформатируете их, можно приступать к установке операционной системы и остальных программ. Полная установка программного обеспечения компьютера отнимает много времени. Чтобы ускорить этот процесс, по возможности устанавливайте программные продукты не с дискет, а с компакт-дисков.</p>
<p>Вы можете значительно облегчить восстановление работоспособности компьютера, если заблаговременно будете выполнять резервное копирование всей информации, записанной в компьютере. В этом случае после создания и форматирования логических дисков можно восстановить программное обеспечение с этих резервных копий. Как будет происходить это восстановление, зависит от средств, используемых вами при создании резервных копий.</p>
<p>Вторая возможность предполагает ручное удаление вирусов и восстановление поврежденных загрузочных секторов и файлов. Этот метод наиболее сложный и требует высокой квалификации. Мы расскажем о ручном восстановлении компьютера несколько позже в главе &ldquo;Ручное восстановление операционной системы&rdquo;.</p>
<p>И, наконец, последняя возможность предполагает применение специальных антивирусных программ. Антивирусные программы сами обнаружат и удалят вирусы, восстановив работоспособность компьютера. К сожалению, такое восстановление не всегда возможно, так как большая категория вирусов необратимо портит программы и данные, записанные на дисках компьютера. В этом случае необходимо заново установить программное обеспечение.</p>
<p>Сейчас мы очень кратко рассмотрим лечение компьютера антивирусными программами-полифагами Aidstest и Doctor Web. Более подробно об этих и других программах, позволяющих удалить вирусы из компьютера, читайте в следующей главе, которая называется &ldquo;Лучшее средство&rdquo;.</p>
<h5>Лечение компьютера антивирусными программами</h5>
<p>Целый ряд резидентных вирусов, находясь в памяти компьютера, препятствует успешному лечению зараженных программ и загрузочных секторов. Поэтому желательно выполнять лечение только после загрузки компьютера с системной дискеты, свободной от вирусов. На эту дискету предварительно надо записать антивирусные программы-полифаги, например Aidstest и Doctor Web.</p>
<p>Программа Aidstest позволяет удалить обнаруженные ей вирусы. Для этого запустите Aidstest с параметром /F:</p>
<pre>AIDSTEST * /F</pre>
<p>Некоторые вирусы не могут быть обнаружены и удалены программой Aidstest, поэтому ее надо использовать совместно с антивирусом Doctor Web:</p>
<pre>DRWEB * /CL /UP /CU</pre>
<p>Программы Aidstest и Doctor Web могут лечить не только жесткие диски, но и дискеты. Для этого вместо параметра *, означающего работу со всеми жесткими дисками компьютера, надо указать имя дисковода:</p>
<pre>
	AIDSTEST A: /F
	DRWEB A: /CL /UP /CU
</pre>
<h2>3 Лучшее средство против вирусов</h2>
<p>Проблема борьбы с вирусами приобрела настолько важное значение, что множество фирм, включая Microsoft, уделяют борьбе с ними все большее внимание. Среди зарубежных фирм, выпускающих антивирусное программное обеспечение, следует отметить McAfee, Central Point, IBM, S&amp;S International, Symantec. Особенно хочется отметить отечественные антивирусные разработки АО &ldquo;ДиалогНаука&rdquo;, в которые входят такие известные программы как Aidstest, Doctor Web и ADinf.</p>
<p>Такое разнообразие ставит пользователя перед сложной проблемой выбора системы антивирусной защиты своего компьютера. Мы постараемся помочь вам, отметив критерии выбора, на которые следует обратить особое внимание. Чтобы дать вам представление о возможностях современных антивирусов, мы рассмотрим несколько таких средств, предназначенных для различных операционных систем - MS-DOS, Microsoft Windows, Microsoft Windows 95 и OS/2. Особое внимание мы уделим методике антивирусной защиты, позволяющей с наибольшей надежностью защитить вашу компьютерную систему.</p>
<h3>Антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;</h3>
<p>В состав антивирусного комплекта АО &ldquo;ДиалогНаука&rdquo; входит несколько основных программ - Aidstest, Doctor Web, Doctor Web for WinWord, Advanced Diskinfoscope (ADinf) и ADinf Cure Module. Отдельно можно приобрести программно-аппаратный комплекс защиты от вирусов Sheriff.</p>
<p>Программы, входящие в состав антивирусного комплекта АО &ldquo;ДиалогНаука&rdquo;, используют все современные способы для борьбы с вирусами - поиск известных вирусов по их сигнатурам, эвристический анализ программ, позволяющий обнаружить неизвестные вирусы, контроль за изменениями на жестком диске.</p>
<p>Для поиска известных вирусов предназначены два антивируса-полифага. Это Aidstest и Doctor Web. Они позволяют обнаружить и удалить более чем 3000 известных на сегодняшний день вирусов. Полифаг Doctor Web обнаруживает не только известные вирусы. Эвристический анализатор Doctor Web может найти ранее неизвестные вирусы, которые еще не были проанализированы.</p>
<p>Новые вирусы появляются постоянно. Никакие законы и запреты не могут их остановить. Для успешного обнаружения и лечения вирусов программам-полифагам необходима разнообразная информация, которую можно получить только тщательным изучением зараженных программ. Поэтому успех практически любой антивирусной программы-полифага предполагает постоянное обновление версий программы или пополнение базы данных, содержащей информацию об известных вирусах.</p>
<p>Антивирусный комплект АО &ldquo;ДиалогНаука&rdquo; является в этом смысле наилучшим вариантом для отечественных пользователей. Специалисты АО &ldquo;ДиалогНаука&rdquo; в первую очередь занимаются вирусами, которые распространены в России и других странах бывшего СССР. Возможно, вирусные базы полифагов Aidstest и Doctor Web содержат меньшее количество вирусов, чем некоторые другие антивирусы, зато именно эти вирусы, скорее всего, могут заразить ваш компьютер.</p>
<p>Во многом это достигается за счет хорошо налаженных каналов поступления новых вирусов. Любой пользователь компьютера, в чьем распоряжении находится модем, может позвонить на станцию BBS АО &ldquo;ДиалогНаука&rdquo; и передать для изучения программы, зараженные новыми вирусами. Если переданная программа действительно заражена, то очередная версия Aidstest или Doctor Web будет его лечить.</p>
<p>Новые версии полифага Aidstest выходят постоянно (несколько раз в месяц) по мере появления новых вирусов. Версии полифага Doctor Web обновляются значительно реже. Чтобы Doctor Web смог лечить новые вирусы, достаточно получить файл-дополнение к вирусной базе программы. Эти файлы обычно выходят несколько раз в месяц. Получить их можно на станции BBS АО &rdquo;ДиалогНаука&rdquo; или непосредственно в офисе фирмы.</p>
<p>Удобнее всего купить подписку на антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;. В этом случае вы сможете постоянно получать самые последние версии антивирусных программ. Владельцы модема могут связаться через него со станцией электронной почты BBS DialogueScience и получать антивирусы буквально не вставая из-за своего стола.</p>
<p>Кроме программ-полифагов в антивирусный комплект входит ревизор диска ADinf. Эта программа запоминает в собственных файлах (таблицах) различную информацию о программной среде компьютера - загрузочные секторы, контрольные суммы выполнимых файлов, расположение плохих кластеров, структуры каталога и т. д. Если какой-нибудь из этих параметров изменится, то очередная проверка компьютера ревизором ADinf сразу выявит изменения.</p>
<p>Интересной особенностью ADinf является обращение к файловой системе в обход операционной системы. Это позволяет легко обнаруживать стелс-вирусы, маскирующие свое присутствие в компьютере.</p>
<p>В дополнение к ADinf поставляется лечащий модуль ADinf Cure Module. Он удаляет обнаруженные вирусы из зараженных файлов. Интересно, что в отличие от полифагов Aidstest и Doctor Web, модуль ADinf Cure Module удаляет даже новые вирусы. То есть он не нуждается в информации о каждом вирусе.</p>
<p>Чтобы удалить вирус ADinf Cure Module использует сведения полученные о файле до его заражения. Поэтому необходимо установить ADinf и ADinf Cure Module еще до заражения компьютера.</p>
<p>По настоящему полный заслон на пути вирусов ставит программно-аппаратный комплекс Sheriff. В дополнение ко всему Sheriff очень хорошо выполняет функции программы-монитора. Он немедленно реагирует на все несанкционированные действия программ, например, форматирование жесткого диска, изменение выполнимых файлов, изменение загрузочных секторов, блокируя эти операции и сообщая о них пользователю. Если для вашей работы нужен только чисто программный монитор, используйте программу VSafe из дистрибутива операционной системы MS-DOS.</p>
<p>Единственный метод борьбы с вирусами, не реализованный в антивирусном комплекте АО &ldquo;ДиалогНаука&rdquo;, это вакцинирование программ. Из-за низкой эффективности вакцинирования его использование совершенно нецелесообразно.</p>
<div class="notel">
	<em>Служба антивирусной скорой помощи, организованная АО &ldquo;ДиалогНаука&rdquo;, высылает заказчику квалифицированных специалистов для лечения компьютеров в особо ответственных случаях</em>
</div>
<p>Программы антивирусного комплекта работают в среде DOS, однако вы сможете их использовать и в других операционных системах, например Microsoft Windows и Microsoft Windows 95.</p>
<p>Программы Doctor Web, ADinf и ADinf Cure Module также работают и в среде операционной системы OS/2. Текущая версия Aidstest не совместима с OS/2.</p>
<h4>Полифаг Aidstest</h4>
<p>Самой популярной антивирусной программой в России вот уже много лет является Aidstest, разработанный в конце 1988 года Лозинским Дмитрием Николаевичем. На момент создания книги вышло уже более 1400 версий программы. Aidstest умеет обнаруживать более 1500 вирусов в загрузочных секторах и выполнимых файлах. В том числе он успешно справляется с вирусами семейства DIR, вызвавшими эпидемию летом 1991 года и появляющимися вновь и вновь до сих пор.</p>
<p>Принципы, заложенные много лет назад в основу программы Aidstest, не позволяют ей обнаруживать и удалять полиморфные вирусы. Поэтому одной программы Aidstest явно недостаточно для обеспечения антивирусной безопасности компьютера. Вы обязательно должны пользоваться другими средствами комплекта. В первую очередь программой-полифагом нового поколения Doctor Web и ревизором ADinf.</p>
<p>Тем не менее, отказываться от Aidstest сегодня еще рано. Существует достаточно много вирусов, которые удаляет Aidstest, но которые не включены в вирусную базу Doctor Web. Возможно в скором времени вирусные базы Aidstest и Doctor Web будут объединены, тогда можно будет ограничиться использованием одной программы.</p>
<p>Полное описание программы Aidstest можно получить из документации. Сейчас мы приведем только самые главные параметры этой программы. Формат вызова Aidstest имеет следующий вид:</p>
<pre>AIDSTEST <strong>путь</strong> [<strong>ключ</strong>]...[<strong>ключ</strong>]</pre>
<p>Первый, обязательный, параметр программы <strong>путь </strong>определяет, какие файлы надо проверить. В качестве этого параметра вы можете указать имя логического диска, путь к каталогу или непосредственно имя файла для проверки. Если необходимо проверить все логические диски компьютера, укажите в качестве параметра <strong>путь</strong> символ &lsquo;*&rsquo;. Чтобы кроме логических дисков проверялись сетевые диски, компакт-диски и диски, образованные  командой SUBST, вместо одного символа &lsquo;*&rsquo; укажите два.</p>
<p>После параметра <strong>путь</strong> следуют необязательные параметры, задающие различные режимы работы программы Aidstest. При вводе параметров не следует задавать символы квадратных скобок. Если вы ошиблись в задании параметров или не указали ни одного параметра, на экран выдается краткое описание программы. Ниже описаны только основные параметры программы.</p>
<table summary="" border="1">
<tr><th>Параметр</th><th>Описание</th></tr>
<tr><td>/E</td><td>Если видеоадаптер компьютера не русифицирован, укажите этот параметр. Aidstest будет пользоваться собственными русскими шрифтами</td></tr>
<tr><td>/F</td><td>Для лечения зараженных программ и загрузочных секторов укажите Aidstest дополнительный параметр /F. Те программы, которые невозможно восстановить, будут удалены</td></tr>
<tr><td>/G</td><td>По умолчанию Aidstest проверяет только выполнимые файлы, имеющие расширения COM, EXE и SYS. Параметр /G позволяет проверить все файлы на дисках компьютера, вне зависимости от их расширений. Если в компьютере обнаружен вирус, рекомендуется выполнить проверку всех файлов</td></tr>
<tr><td>/Q</td><td>В режиме лечения компьютера Aidstest удаляет зараженные файлы, которые нельзя восстановить. Чтобы перед удалением файлов у пользователя запрашивалось подтверждение, укажите параметр /Q</td></tr>
<tr><td>/S</td><td>Параметр /S необходимо указывать вместе с параметром /F для восстановления файлов, испорченных вирусами семейства DIR, в тех случаях, когда сам вирус отсутствует на диске</td></tr>
</table>
<h5>Как найти вирус</h5>
<p>Программа Aidstest умеет обнаруживать вирусы без предварительной загрузки компьютера с чистой системной дискеты. Поэтому лучше всего записать программу Aidstest на жесткий диск компьютера и периодически проверять ей компьютер. Насколько часто нужно пользоваться Aidstest зависит от того, как и для чего используется компьютер. В большинстве случаев достаточно выполнять ежедневную проверку компьютера, включив вызов Aidstest в файл AUTOEXEC.BAT, а также отдельно проверять все новые файлы, записываемые на компьютер и все дискеты, которые в него вставляются. Особое внимание надо уделять проверке свободно распространяемого программного обеспечения, загруженного по электронной почте со станций BBS и FTP-серверов, а также дискетам, полученным от знакомых и друзей.</p>
<div class="notel">
	<em>По мере появления новых вирусов выпускаются новые версии антивируса Aidstest. Чтобы обеспечить надежную защиту компьютера, всегда используйте последние версии антивируса</em>
</div>
<p>При ежедневной проверке компьютера можно ограничиться проверкой выполнимых файлов, имеющих расширения COM, EXE и SYS. Следующая команда проверяет загрузочные секторы и выполнимые файлы на диске C:</p>
<pre>AIDSTEST C:</pre>
<p>Программа отображает на экране наиболее важную информацию и начинает проверять сначала загрузочные сектора указанного диска, а затем выполнимые файлы. По окончании проверки на экране отображается краткая статистическая информация:</p>
<pre>
Проверка "C:" (метка тома: PROGRAMM)
___ "C:" ___
Проверено файлов:		518
Заражено файлов:		0
	- начальных секторов:	0
Следов вирусов DIR:		0
</pre>
<p>Если в ходе проверки на дисках компьютера или дискетах обнаружатся вирусы, на экране будут показаны имена зараженных файлов и названия заразивших их вирусов.</p>
<pre>
Проверка "A:" (метка тома: PROGRAMM)
Вирус в начальном секторе &ldquo;FORM&rdquo;
a:\C-639.COM - болен (Khizhnjak-639)
a:\COMMAND.COM - болен (V-475)
a:\FORMAT.COM - болен (Mini-129)

___ "A:" ___
Проверено файлов:		28
Заражено файлов:		3
	 - начальных секторов:	1
Следов вирусов DIR:		0
</pre>
<p>В этот раз Aidstest обнаружил на нашей дискете сразу четыре вируса. Один загрузочный - FORM и три файловых - Khizhnjak-639, V-475, Mini-129. Возможно, на дискете есть еще и другие вирусы, вы обязательно должны повторить проверку дискеты антивирусом Doctor Web.</p>
<p>После обнаружения на диске вирусов в выполнимых файлах повторите проверку еще раз, добавив в командной строке Aidstest параметр /G. На этот раз антивирус проверит все файлы на диске. Не забывайте выполнять такую проверку, так как иногда пользователи создают резервные копии файлов, изменяя их расширение. Например, резервная копия выполнимого файла MAYRAIN.EXE может называться MAYRAIN.BAK или MAYRAIN.EX_.</p>
<h5>Лечение компьютера</h5>
<p>Когда вирус обнаружен, надо решать что с ним делать. Вы можете удалить вирус с помощью антивирусной программы или удалить весь зараженный файл, восстановив его с дистрибутива или резервной копии.</p>
<p>Aidstest позволяет удалить обнаруженные им вирусы. Для этого надо указать дополнительный параметр /F. Если вы не укажете программе Aidstest такой дополнительный параметр, то она будет осуществлять только поиск вирусов.</p>
<p>В режиме лечения антивирус восстановит зараженные файлы и загрузочные секторы. Если зараженный файл испорчен и не может быть восстановлен, он будет удален. Чтобы перед удалением таких файлов, у пользователя требовалось подтверждение, добавьте параметр /Q.</p>
<p>Удалять вирусы из компьютера рекомендуется только после загрузки компьютера с чистой загрузочной дискеты. Это гарантирует, что вирус не получит управление и не установит в оперативной памяти резидентный модуль, который сможет помешать лечению.</p>
<div class="notel">
	<em>Для загрузки с дискеты необходимо применять так называемую "холодную" перезагрузку, т. е. использовать кнопку сброса на корпусе компьютера или процедуру включения-выключения питания. Многие вирусы умеют оставаться в памяти компьютера после того, как пользователь нажмет комбинацию клавиш &lt;Alt + Ctrl + Del&gt;</em>
</div>
<p>Существуют несколько вирусов, изменяющих данные, записанные в CMOS-памяти, таким образом, что компьютер всегда будет загружаться с диска C:.</p>
<p>К вирусам, изменяющим порядок загрузки компьютера, относятся некоторые модификации вируса ExeBug и вирус Mammoth.6000. Эти вирусы включают и выключают в CMOS-памяти признак наличия дисковода A: . Перед записью или чтением с дискеты вирусы включают признак наличия дисковода, а после отключают.</p>
<p>В результате при загрузке с чистой системной дискеты дисководы могут оказаться не установленными, и система в таком случае попытается загрузиться с жесткого инфицированного диска. Вирус первым получит управление, установит свою резидентную копию в память, включит в CMOS-памяти признак наличия дисковода A: и передаст управление загрузочному сектору дискеты, вставленной в дисковод. В результате вирус получит управление даже при загрузке с чистой системной дискеты!</p>
<p>Перед перезагрузкой компьютера проверьте порядок загрузки компьютера, выбранный в CMOS-памяти. Сначала загрузка должна происходить с диска A: и только затем с диска C:. Затем проверьте тип дисководов, указанный в конфигурации компьютера. Он должен соответствовать действительным параметрам дисководов, подключенных к компьютеру.</p>
<p>Чтобы просмотреть конфигурацию компьютера и порядок его загрузки, запустите программу BIOS Setup. Более подробно об этой программе вы можете прочитать в разделе &ldquo;Восстановление файловой системы&rdquo;.</p>
<p>Ниже представлен пример использования антивируса Aidstest для обнаружения и лечения вирусов на диске C:.</p>
<pre>AIDSTEST C: /F /Q</pre>
<p>Программа проверит файлы на диске C:. Все обнаруженные вирусы сказу будут удалены:</p>
<pre>
Проверка "A:" (метка тома: PROGRAMM)
Вирус в начальном секторе &ldquo;FORM&rdquo; - ОБЕЗВРЕЖЕН
a:\C-639.COM - болен (Khizhnjak-639) - ОБЕЗВРЕЖЕН
a:\COMMAND.COM - болен (V-475) - ОБЕЗВРЕЖЕН
a:\FORMAT.COM - болен (Mini-129) - ОБЕЗВРЕЖЕН

___ "A:" ___
Проверено файлов:		28
Заражено файлов:		3
	- начальных секторов:	1
Следов вирусов DIR:		0

Исправлено файлов:		3
- строк каталогов:		0
Стерто файлов:			0 
</pre>
<h4>Полифаг Doctor Web</h4>
<p>Другая антивирусная программа-полифаг, входящая в состав антивирусного комплекта АО &ldquo;ДиалогНаука&rdquo;, разработана Даниловым Игорем Анатольевичем. Также как и Aidstest, программа Doctor Web является полифагом, но при этом она основана совершенно на других принципах, благодаря чему позволяет обнаруживать полиморфные вирусы и успешно удалять их. Специальные методы позволяют Doctor Web обрабатывать шифрованные вирусы.</p>
<p>В отличие от большинства антивирусных программ-полифагов, Doctor Web обнаруживает новые, неизвестные вирусы. Для этого применяется эвристический анализатор. Этот анализатор в автоматическом режиме изучает код проверяемых программ и загрузочных записей, пытаясь обнаружить в них участки кода, выполняющие характерные для вирусов действия.</p>
<div class="notel">
	<em>Программа Doctor Web позволяет обнаружить и удалить опасный вирус OneHalf, широко распространившийся в последнее время. При этом Doctor Web восстанавливает зашифрованный вирусом жесткий диск компьютера. В зависимости от объема жесткого диска и того, насколько далеко зашел процесс его шифровки, на восстановление может потребоваться несколько десятков минут. В последнее время появились новые модификации вируса OneHalf, имеющие отличия в процедуре шифрования диска компьютера, поэтому надо использовать самые последние версии Doctor Web</em>
</div>
<p>Программа Doctor Web работает как в диалоговом, так и в пакетном режиме. Пакетный режим лучше всего использовать для проверки компьютера во время его загрузки, вызывая Doctor Web из файла AUTOEXEC.BAT. Чтобы Doctor Web начал работать в пакетном режиме, следует задать параметр /CL.</p>
<p>Полную информацию обо всех параметрах и режимах работы программы Doctor Web вы можете прочитать в документации антивирусного пакета АО &ldquo;ДиалогНаука&rdquo;. Сейчас мы перечислим только основные параметры программы:</p>
<table summary="" border="1">
<tr><th>Параметр</th><th>Описание</th></tr>
<tr><td>/AL</td><td>Проверка всех файлов на заданном диске</td></tr>
<tr><td>/AR</td><td>Проверка файлов, находящихся внутри архивов. Обеспечивается проверка архивов, созданных программами-архиваторами ARJ, PKZIP и RAR</td></tr>
<tr><td>/CL</td><td>Запуск программы в пакетном режиме</td></tr>
<tr><td>/CU[D][R][P]</td><td>Лечение файлов и системных областей дисков, удаление найденных вирусов. Если указан параметр D, тогда инфицированные файлы не лечатся, а просто удаляются с диска компьютера. Вместо удаления инфицированных файлов их можно переименовать. Для этого следует указать параметр R. В этом случае первый символ в расширении имени файла заменяется на символ 'V'. Если указан дополнительный параметр P, тогда перед удалением вирусов запрашивается подтверждение у пользователя</td></tr>
<tr><td>/DA</td><td>Проверка компьютера один раз в сутки. Этот режим рекомендуется использовать для запуска программы из файла AUTOEXEC.BAT</td></tr>
<tr><td>/DL</td><td>Удаление файлов, восстановление которых невозможно</td></tr>
<tr><td>/FN</td><td>Если видеоадаптер компьютера не русифицирован, укажите этот параметр. Doctor Web будет пользоваться собственными русскими шрифтами</td></tr>
<tr><td>/HA[&lt;уровень&gt;]</td><td>Эвристический анализ файлов и поиск в них неизвестных вирусов. Существует два уровня анализа: 0 - минимальный, 1 - максимальный. По умолчанию устанавливается минимальный уровень эвристического анализа</td></tr>
<tr><td>/HI</td><td>Поиск вирусов в адресном пространстве оперативной памяти от 0 Кбайт до 1088 Кбайт</td></tr>
<tr><td>/RV</td><td>Контроль за заражением проверяемых файлов активным резидентным вирусом</td></tr>
<tr><td>/TD&lt;диск&gt;:</td><td>Когда Doctor Web проверяет упакованные файлы и файлы архивов, он может создавать временные файлы. Вы можете самостоятельно задать диск, на котором создаются временные файлы, с помощью параметра /TD</td></tr>
<tr><td>/UP[N]</td><td>Проверка выполнимых файлов, упакованных программами DIET, PKLITE, LZEXE, EXEPACK, PROTECT, COMPACK, CRYPTCOM, а также файлов, вакцинированных антивирусом CPAV. Чтобы Doctor Web не отображал на экране названия программы архиватора, использованной для упаковки проверяемого файла, укажите дополнительный параметр N</td></tr>
</table>
<h5>Как найти вирус</h5>
<p>Программа Doctor Web позволяет обнаружить вирусы без предварительной загрузки компьютера с чистой системной дискеты. Вы можете вызывать Doctor Web каждый раз во время загрузки компьютера, поместив вызов программы в файл AUTOEXEC.BAT. Лучше всего использовать Doctor Web совместно с ревизором диска ADinf. Подробнее об этом можно прочитать в разделе &ldquo;Взаимодействие программ антивирусного комплекта&rdquo;.</p>
<p>Для первоначальной проверки компьютера можно использовать следующую команду:</p>
<pre>DRWEB * /CL /HA1 /HI /RV /UP /AR /OK</pre>
<p>Полифаг Doctor Web проверит оперативную память компьютера, затем автоматически подключит все файлы вирусных баз-дополнений, расположенных в каталоге программы. Затем начнется последовательная проверка всех выполняемых файлов на всех дисках компьютера. Также будут проверяться файлы внутри файлов архивов.</p>
<pre>
 В памяти компьютера вирусов не обнаружено
 Подключение файла WEB60109.308 : 
 Файл-дополнение подключен к вирусной базе программы.
 Добавлено определений новых вирусов - 42
 Поиск вирусов и инфицированных программ на диске C :
 Метка тома: WORK DISK
 c:\PILOT.ARJ - архив ARJ
 c:\BALLON\SCREEN\SCR.ARJ - архив ARJ
 c:\BALLON\REPORT.WEB - Ok
 c:\BALLON\MENU\MENU.ARJ - архив ARJ
 c:\NC45\BITMAP.EXE упакован EXEPACK
 c:\NC45\RBVIEW.EXE
</pre>
<p>После окончания проверки, Doctor Web отображает на экране отчет о проделанной работе. В нем указывается количество проверенных файлов и загрузочных секторов, количество обнаруженных вирусов и время проверки компьютера:</p>
<pre>
  Отчет для диска С:
  Проверено : файлов  и  загрузочных  секторов - 245
  Обнаружено: вирусов и инфицированных  программ - 0
  Время сканирования:                       00:05:39
</pre>
<p>Если во время проверки будут обнаружены вирусы, программа сообщит об этом. Напротив названия каждого зараженного файла указывается имя обнаруженного в нем вируса.</p>
<pre>
Поиск вирусов и инфицированных программ на диске C :
BOOT SECTOR инфицирован Form
c:\TETRA\DWOL.EXE - Ok
c:\TETRA\IDSORT.LST - Ok
c:\TETRA\REPORT.WEB - Ok
c:\TETRA\OVLOAD\KELA.EXE инфицирован TPE.Kela.4546
c:\TETRA\OVLOAD\EBBOI.COM инфицирован HelloUser.402
c:\TETRA\OVLOAD\APOC1.COM - Ok
c:\GAME\APOC1016.EXE - Ok
c:\GAME\GREEN.COM - Ok
c:\GAME\KLOM.EXE инфицирован XAM.278
c:\GAME\DOOM2DTH.EXE инфицирован Doom.666
c:\GAME\GKBEC.COM инфицирован Beer.3490
c:\NET\LOG.EXE инфицирован Novell.3120
</pre>
<p>Вместе с антивирусом Doctor Web поставляется файл с описаниями известных вирусов VIRLIST.WEB. Перед тем как удалять обнаруженные вирусы, рекомендуется прочитать их описания. Файл VIRLIST.WEB может поставляться в архиве VIR-WEB.LZH. Для восстановления файлов из этого архива используйте архиватор LHA.</p>
<p>При проверке компьютера в режиме эвристического анализа, Doctor Web, может сообщить о том, что файл инфицирован неизвестным вирусом. Название неизвестного вируса составляется из слова Virus и одного или нескольких терминов, описанных в следующей таблице:</p>
<table summary="" border="1">
<tr><th>Термин</th><th>Обнаружен</th></tr>
<tr><td>COM</td><td>Вирус, заражающий COM-файлы</td></tr>
<tr><td>EXE</td><td>Вирус, заражающий EXE-файлы</td></tr>
<tr><td>TSR</td><td>Резидентный вирус</td></tr>
<tr><td>BOOT</td><td>Вирус, заражающий загрузочные секторы дисков</td></tr>
<tr><td>CRYPT</td><td>Зашифрованный или полиморфный вирус</td></tr>
</table>
<p>Названия обнаруженных таким образом вирусов могут выглядеть следующим образом:</p>
<pre>
D:\PROGRESS\DID\NCAA.EXE возможно инфицирован COM.CRYPT.Virus
D:\PROGRESS\FOXWOOD\README.EXE возможно инфицирован EXE.TSR.Virus
D:\FORMER\LOOM.EXE возможно инфицирован COM.EXE.TSR.CRYPT.Virus
</pre>
<p>Эти сообщения означают, что эвристический анализ данных файлов обнаружил подозрительные участки кода, характерные для вирусов. Такие файлы нужно передать специалистам для дальнейшего изучения.</p>
<h5>Как лечить компьютер</h5>
<p>Если проверка компьютера обнаружила вирусы, вам надо приступить к его лечению. Для этого необходимо загрузить компьютер с системной дискеты и запустить с нее программу Doctor Web. Системная дискета должна быть подготовлена заранее на компьютере, не зараженном вирусами, и на ней должна быть установлена защита от записи.</p>
<p>После перезагрузки компьютера с системной дискеты загрузите Doctor Web:</p>
<pre>DRWEB * /CL /NM /TDC: /UP /CU</pre>
<p>Теперь полифаг Doctor Web не только будет обнаруживать вирусы, а будет их удалять.</p>
<pre>
Поиск вирусов и инфицированных программ на диске C :
BOOT SECTOR инфицирован Form - исцелен!
c:\TETRA\OVLOAD\KELA.EXE инфицирован TPE.Kela.4546 - исцелен!
c:\TETRA\OVLOAD\EBBOI.COM инфицирован HelloUser.402 - исцелен!
c:\GAME\KLOM.EXE инфицирован XAM.278 - исцелен!
c:\GAME\DOOM2DTH.EXE инфицирован Doom.666 - исцелен!
c:\GAME\GKBEC.COM инфицирован Beer.3490 - исцелен!
c:\NET\LOG.EXE инфицирован Novell.3120 - исцелен!
</pre>
<p>Если во время проверки компьютера, Doctor Web обнаружил зараженные файлы внутри файла архива, то он не сможет вылечить их автоматически. Архив надо раскрыть, а затем вылечить все зараженные файлы. После этого вы можете снова записть вылеченные файлы в архив.</p>
<h5>Диалог с Doctor Web</h5>
<p>Мы рассказали как работать с Doctor Web в пакетном режиме. Такой способ удобен при автоматической проверке компьютера. Для проверки в ручном режиме значительно удобнее пользоваться диалоговым режимом программы.</p>
<p>Чтобы запустить Doctor Web в диалоговом режиме не указывайте параметр /CL. Остальные параметры также можно не указывать, вы сможете их задать или изменить непосредственно во время работы программы.</p>
<h5>Как подключить файлы-дополнения для вирусной базы</h5>
<p>Новые вирусы появляются с завидной регулярностью. Для их удаления необходимо постоянно пополнять базу данных программы, содержащую информацию о вирусах. Программа Doctor Web позволяет подключать к этой базе данных внешние файлы-дополнения, содержащие сведения о новых вирусах.</p>
<p>Файлы-дополнения выпускаются постоянно, по мере поступления и изучения новых вирусов. Вы можете получить их через модем с BBS &ldquo;ДиалогНаука&rdquo;, по сети FIDO из эхо-конференции ADinf.Support, или по сети Relcom из телеконференции REL.FIDO.ADINF.SUPPORT.</p>
<p>В случае крайней необходимости можно получить файлы дополнений в текстовом виде через факсимильный аппарат, а затем ввести их в компьютер, набрав в любом текстовом редакторе. Если факсимильного аппарата у вас нет, файл дополнений в принципе можно записать на слух по телефону.</p>
<p>Файлы-дополнения имеют имена WEBymmdd.vvv. Символ <em>y</em> означает последнюю цифру года, <em>mm</em> - номер текущего месяца, <em>dd</em> - день месяца выпуска файла-дополнения, а <em>vvv</em> - номер версии программы, для которой предназначен файл. Если вы получили файл-дополнение по сети, то его надо сохранить в файле с соответствующим именем.</p>
<p>Чтобы подключить новые файлы-дополнения, запишите их в каталог программы Doctor Web. После запуска программы они подключатся автоматически. Вы можете выделить для файлов дополнений отдельный каталог и указать к нему путь в диалоговой оболочке Doctor Web.</p>
<h5>Вирусы для текстового процессора Microsoft Word for Windows</h5>
<p>Программа Doctor Web позволяет обнаружить на диске компьютера известные вирусы, распространяющиеся в среде текстового процессора Microsoft Word for Windows. Для этого следует ей указать на необходимость проверки файлов документов, имеющих расширения DOT и DOC.</p>
<p>Если такие вирусы будут обнаружены, воспользуйтесь для их удаления антивирусом Doctor Web for WinWord. Этот антивирус описан в следующем разделе &ldquo;Антивирус Doctor Web for WinWord&rdquo;. Антивирусная программа Doctor Web, предназначенная для работы в среде DOS, может только обнаружить вирусы в файлах-документах, но не удалять их.</p>
<h4>Антивирус Doctor Web for WinWord</h4>
<p>В разделе &ldquo;Вирусы в файлах документов&rdquo; мы рассказали о новом типе вирусов, заражающих файлы документов, подготовленные в текстовом процессоре Microsoft Word for Windows версии 6.0 и 7.0. В момент написания книги были известны всего несколько таких вирусов WinWord.Concept, WinWord.Nuclear, WinWord.Color.</p>
<p>Для борьбы с вирусами в текстовых файлах документов Даниловым Игорем Анатольевичем был разработан специальный антивирус Doctor Web for WinWord. Он может быть использован для обнаружения и удаления известных и неизвестных вирусов. Doctor Web for WinWord не является программой в полном смысле этого слова, скорее это документ, содержащий макрокоманды антивируса. В настоящее время он распространяется в файле с именем DRWEBWW.DOC.</p>
<div class="notel">
	<em>В настоящее время Doctor Web for WinWord распространяется совершенно свободно. Вы можете получить это средство непосредственно в офисе АО &ldquo;ДиалогНаука&rdquo; или через модем со станции BBS &ldquo;ДиалогНаука&rdquo;</em>
</div>
<p>Чтобы установить Doctor Web for WinWord, достаточно запустить текстовый процессор Microsoft Word for Windows и загрузить в него файл DRWEBWW.DOC. В момент открытия файла среда текстового процессора будет автоматически проверена на заражение вирусами. Обнаруженные вирусы можно сразу же удалить.</p>
<p>Если вирусов не найдено, тогда вам будет предложено установить Doctor Web for WinWord. Согласитесь с этим предложением, в случае необходимости вы всегда сможете отключить антивирус, открыв файл DRWEBWW.DOC еще один раз. После окончания установки в главном меню Microsoft Word for Windows появится меню Dr.Web (рис. 3.1). Через это меню пользователь может настроить антивирус и выполнить проверку текстовых документов.</p>
<div align="center">
	<img src="img/aaf00/fig31.gif" alt="Рис. 3.1. Меню Doctor Web for WinWord" />
	<p><strong>Рис. 3.1. Меню Doctor Web for WinWord</strong></p>
</div>
<p>Настройка режимов работы Doctor Web for WinWord не должна вызвать у вас никаких затруднений. Откройте диалоговую панель настройки антивируса, выбрав из меню Dr.Web строку Settings. На экране появится диалоговая панель, показанная на рисунке 3.2.</p>
<p>Если вы установили у себя Doctor Web for WinWord, его можно настроить на поиск вирусов в открываемых файлах. Такая функция очень удобна, так как у вас отпадает необходимость частой проверки всех файлов документов. Даже если вы запишете на жесткий диск компьютера зараженный документ, вирус не сможет заразить вашу систему, так как он будет обнаружен в момент открытия файла.</p>
<p>Тем не менее, в любом случае желательно периодически проверять все файлы документов, хранимые в компьютере, даже если они не используются. В противном случае незамеченный зараженный файл может быть передан на другой компьютер, не защищенный Doctor Web for WinWord.</p>
<p>Антивирус Doctor Web for WinWord позволяет выполнять эвристический анализ макрокоманд проверяемых файлов. Для этого надо включить переключатель Strange macro (рис. 3.2). Такой режим позволяет обнаружить подозрительные макрокоманды, принадлежащие новым, ранее неизвестным вирусам.</p>
<p>Обнаружив подозрительные макрокоманды, Doctor Web for WinWord предлагает их удалить. Вы должны самостоятельно проверить эти макрокоманды и решить вопрос об их удалении.</p>
<div align="center">
	<img src="img/aaf00/fig32.gif" alt="Рис. 3.2. Выбор режима работы Doctor Web for WinWord" />
	<p><strong>Рис. 3.2. Выбор режима работы Doctor Web for WinWord</strong></p>
</div>
<p>Чтобы начать проверку дисков компьютера, выберите из меню Dr.Web строку Scan. Антивирус проверит, сколько дисков компьютера доступно и откроет диалоговую панель с кнопками, названия которых соответствуют именам этих дисков. Doctor Web for WinWord позволяет проверить не только жесткие диски компьютера, но также компакт-диски, сетевые диски и дискеты.</p>
<p>Перед тем как вы сможете проверять документы, записанные на дискетах, установите в диалоговой панели настройки антивируса переключатель Check FDD. Вставьте дискету, которую надо проверить, в дисковод и выберите из Dr.Web строку Scan. Теперь в открывшейся диалоговой панели появится кнопка для проверки дискет.</p>
<p>Файлы документов, поступающие вам от других пользователей, следует проверять на заражение вирусами. Обязательно проверяйте файлы, поступившее к вам по электронной почте и полученные со станций BBS.</p>
<p>Обнаружив вирус, Doctor Web for WinWord предлагает его удалить. Перед удалением вируса мы рекомендуем сделать резервную копию зараженного документа. После того как вы убедитесь в том, что вирус удален и документ не поврежден, удалите резервную копию зараженного документа.</p>
<p>После удаления вируса из файла документа он остается в формате файла стилей. Если вы решите сохранить такой документ в другом формате и выберете из меню File строку Save As, то увидите, что в открывшейся диалоговой панели Save As, список форматов Save as type будет недоступен. Чтобы исправить формат документа, откройте новый документ, выбрав из меню File строку New, скопируйте в него через универсальный обменный буфер Clipboard содержимое исходного файла, а затем сохраните новый документ. Теперь старый документ можно удалить и работать с новым документом.</p>
<h4>Ревизор диска ADinf и лечащий модуль ADinf Cure Module</h4>
<p>Использование антивирусных программ не может гарантировать полную защиту компьютера от заражения вирусами. Антивирусные программы-полифаги типа Aidstest и Doctor Web в первую очередь настроены на обнаружение уже известных вирусов и их клонов. В Doctor Web есть эвристический анализатор, обнаруживающий большинство новых вирусов, но все же существует небольшая вероятность появления вируса, который не будет обнаружен. Кроме того, даже если новый вирус будет обнаружен, вылечить его сразу не удастся. Поэтому в антивирусный комплект включена программа-ревизор ADinf, созданная Мостовым Дмитрием Юрьевичем.</p>
<p>Ревизор диска ADinf сохраняет в своих таблицах различную информацию о жестком диске компьютера - загрузочных секторах, сбойных кластерах, структуре каталогов и выполнимых файлах (рис. 3.3). Это позволяет выявить любой вирус, как только он проявит себя и попытается заразить новые файлы или загрузочные секторы.</p>
<p>Так как стелс-вирусы перехватывают обращения к дисковой подсистеме компьютера и скрывают присутствие вируса, ADinf считывает информацию с диска, минуя операционную систему. Для чтения диска ADinf обращается непосредственно к соответствующей функции BIOS, записанной в ПЗУ компьютера. В этом случае вирус не может перехватить обращение к диску, и ADinf получает достоверную информацию.</p>
<p>На этом, в частности, основан метод поиска активных стелс-вирусов. Ревизор ADinf считывает проверяемые файлы и загрузочные секторы двумя способами: через операционную систему и непосредственно через вызов BIOS. Полученные данные сравниваются. Если между ними обнаруживаются различия, значит в памяти находится активный стелс-вирус, скрывающий свое присутствие.</p>
<div align="center">
	<img src="img/aaf00/fig33.gif" alt="Рис. 3.3. Проверка диска ревизором ADinf" />
	<p><strong>Рис. 3.3. Проверка диска ревизором ADinf</strong></p>
</div>
<p>В состав антивирусного комплекта входит дополнительный модуль ADinf Cure Module, предназначенный для использования совместно с ревизором ADinf. ADinf Cure Module разработан Ладыгиным В. С., Зуевым Д. Г. и Мостовым Д. Ю. В нашей книге мы рассматриваем ADinf версии 10.5a и лечащий модуль ADinf Cure Module версии 3.03.</p>
<p>Дополнив ревизор ADinf лечащим модулем ADinf Cure Module, вы получаете возможность не только обнаружить появление вируса, но также и удалить его. Интересно, что ADinf Cure Module не содержит вирусной базы данных и может удалить даже новый, ранее неизвестный вирус. Для этого лечащий модуль использует информацию о зараженном файле, собранную им до того, как файл был поражен вирусом. Версии 3.03 и 3.04 ADinf Cure Module позволяют удалить вирусы из COM-, EXE-, SYS-, XTP- и BAT-файлов.</p>
<p>Когда книга готовилась к публикации, вышла новая версия ревизора ADinf 10.6 и лечащий модуль ADinf Cure Module версии 3.04. По сравнению с предыдущими версиями программ, в них добавлена возможность установки ADinf и ADinf Cure Module на сетевом диске.</p>
<p>Теперь при работе в локальной сети ADinf и ADinf Cure Module можно установить на сервере, что облегчит администратору смену версий программ. При запуске с сетевого диска ADinf по умолчанию ищет свой файл настроек и личные таблицы в каталоге C:\ADINF на локальной машине. Этот каталог можно изменить, указав дополнительный параметр -HOME:&lt;путь&gt;. Улучшена совместимость с новой операционной системой Windows 95 - изменен алгоритм работы с  файлами при  лечении, что обеспечивает сохранение  длинных имен файлов.</p>
<h5>Несколько слов о настройке ADinf</h5>
<p>Программа ADinf позволяет настроить режим проверки компьютера, чтобы достичь лучшего результата. Настройка программы достаточно сложна и описана в документации к программе. Поэтому мы ограничимся кратким описанием самых важных возможностей настройки программы.</p>
<p>Во время проверки компьютера ADinf записывает полученную информацию в таблицы, расположенные в специальных файлах. Таблицы ADinf бывают двух типов - общие и личные. Общие таблицы создаются в корневых каталогах проверяемых дисков. Личные таблицы создаются в каталоге ADinf или в любом другом указанном пользователем каталоге. Несколько пользователей одного компьютера могут иметь собственные копии личных таблиц в своих каталогах и независимо контролировать диски. Выбрать работу с личными или общими таблицами можно в меню Параметры.</p>
<p>Режим проверки компьютера устанавливается в меню Параметры. Для этого надо выбрать строку Режимы работы. Можно включить быстрый режим поиска (режим fast) и режим поиска (режим info).</p>
<p>В быстром режиме не проверяются контрольные суммы файлов, и вы узнаете только о новых и стертых файлах и каталогах, а также о файлах, у которых изменилась длина. Таблицы с информацией о диске обновляться не будут. Режим поиска выполняет полную проверку диска без обновления информации в таблицах ревизора.</p>
<p>Для каждодневной проверки компьютера рекомендуется отключить быстрый режим и режим поиска. В этом случае будут проверяться контрольные суммы файлов, что позволит обнаружить изменения в их структуре.</p>
<p>Вы можете указать, как вычислять контрольные суммы файлов с различными расширениями. Для этого выберите из меню Параметры строку Настройка, а затем в открывшемся временном меню выберите строку Список расширений. Откроется временное меню, содержащее две строки - Расширения и Тип CRC. Первая строка позволяет изменить список расширений контролируемых файлов, а вторая позволяет выбрать тип контрольных сумм для файлов с данным расширением.</p>
<p>В ревизоре ADinf реализованы три типа контрольных сумм - Без CRC, Быстрая и Полная. Тип Без CRC, означает что контрольная сумма не будет рассчитываться. Быстрые контрольные суммы основаны на знании внутренней структуры исполняемых файлов с расширениями COM и EXE. Этот тип контрольных сумм надежно защищает выполнимые файлы от внедрения в них вируса, но некоторые изменения в выполнимых файлах, не связанные с внедрением вирусов, могут остаться незамеченными. Полные контрольные суммы рассчитываются на основе всего файла. Любые изменения файла будут обнаружены. Надо заметить, что полные контрольные суммы рассчитываются медленнее быстрых.</p>
<p>Наиболее важно правильно указать объекты (загрузочные записи, файлы и т. д.), контролируемые ревизором ADinf. Выберите из меню Параметры строку Настройки, а затем из открывшегося временного меню строку Что контролировать. На экране появится меню Контроль (рис. 3.4).</p>
<p>Через это меню можно указать, какие файлы подлежат контролю - только с указанными расширениями или все, ввести список неизменяемых файлов, включить контроль загрузочных секторов, проверять вновь появившиеся плохие кластеры, проверять структуру каталогов, выполнять контроль таблицы параметров жестких дисков HDPT, а также выполнять автоматическую проверку на стелс-вирусы в новых и измененных файлах.</p>
<div align="center">
	<img src="img/aaf00/fig34.gif" alt="Рис. 3.4. Выбор вида контроля" />
	<p><strong>Рис. 3.4. Выбор вида контроля</strong></p>
</div>
<p>Мы рекомендуем обязательно включить контроль за всеми выполнимыми файлами и загрузочными секторами. Необходимо также включить проверку на стелс-вирусы в новых и измененных файлах. Это позволит ADinf сразу сообщить вам о появлении вирусов в компьютере.</p>
<p>Для каждого логического диска компьютера можно отдельно задать метод обращения к дискам. Выберите из меню Параметры строку Настройки, а затем из открывшегося временного меню строку Обращение к дискам. На экране появится список имен логических дисков компьютера. С помощью клавиш управления курсором и клавиши пробела для каждого диска можно указать метод обращения - BIOS, Int 13h, Int 25h.</p>
<p>Метод BIOS предполагает, что ADinf обращается к дискам компьютера, непосредственно вызывая процедуры, записанные в ПЗУ BIOS. Это позволяет преодолеть маскировку стелс-вирусов и прочитать именно ту информацию, которая записана на диске. Вирус не может в этом случае вмешаться и исказить данные, считанные с диска.</p>
<p>Некоторые вирусы пытаются маскироваться даже при чтении диска процедурами BIOS. Для этого они перехватывают специальное прерывание Int 76h, вырабатываемое контроллером жесткого диска по окончании некоторых операций, и искажают считанные данные фактически на уровне контроллера жесткого диска. Ревизор ADinf применяет специальные методы и не позволяют таким вирусам остаться незамеченными.</p>
<p>В некоторых ситуациях ADinf не может воспользоваться процедурами BIOS для доступа к дискам. Как правило, это происходит, если установлены драйверы дисков, например драйвер Disk Manager или драйверы SCSI-дисков. В этом случае выберите для этих дисков метод доступа Int 13h.</p>
<p>Если в вашей системе установлены программы динамического сжатия - DoubleSpace, DriveSpace, SuperStor или Stacker, тогда для этих дисков надо установить метод доступа Int 25h. Этот метод предполагает обращение к дискам средствами операционной системы DOS.</p>
<div class="notel">
	<em>Методы доступа Int 13h и Int 25h оставляют стелс-вирусам больше возможностей для маскировки, поэтому предпочтительней пользоваться методом доступа BIOS</em>
</div>
<h5>Проверка компьютера</h5>
<p>Перед проверкой компьютера выберите диски, которые надо проанализировать. Их названия следует выбрать из меню Диски. Для этого установите курсор на соответствующую строку меню с именем диска и нажмите клавишу &lt;Insert&gt; или клавишу пробела. Около названия диска появится знак плюс (рис. 3.5).</p>
<div align="center">
	<img src="img/aaf00/fig35.gif" alt="Рис. 3.5. Выбор дисков для проверки" />
	<p><strong>Рис. 3.5. Выбор дисков для проверки</strong></p>
</div>
<p>Чтобы начать проверку компьютера, воспользуйтесь меню Работа, представленным на рисунке 3.6. Для проверки устройств, помеченных в меню Диски, выберите строку Проверить диск. Если проверить надо все диски компьютера, достаточно выбрать строку Проверить все. В этом случае не надо предварительно указывать проверяемые устройства в меню Диски.</p>
<div align="center">
	<img src="img/aaf00/fig36.gif" alt="Рис. 3.6. Проверка компьютера" />
	<p><strong>Рис. 3.6. Проверка компьютера</strong></p>
</div>
<p>Если ADinf обнаружит, что на диске произошли изменения, характерные для заражения вирусами, на экране появляется предупреждающее сообщение (рис. 3.7). Все найденные подозрительные изменения помечены символом &radic;. Для продолжения работы нажмите любую клавишу на клавиатуре компьютера. Диалоговая панель с предупреждающим сообщением закроется и вы сможете перейти к изучению результатов проверки диска (рис. 3.8).</p>
<div align="center">
	<img src="img/aaf00/fig37.gif" alt="Рис. 3.7. Предупреждающее сообщение ADinf" />
	<p><strong>Рис. 3.7. Предупреждающее сообщение ADinf</strong></p>
</div>
<p>Возможно, что изменения в файловой системе вызваны не заражением вирусами, а другими причинами. Например, изменение загрузочных секторов может быть вызвано установкой новой версии операционной системы. Странная дата создания файла (например, дата больше 2000 года) могут быть вызваны неправильной установкой часов компьютера. Изменение файлов, занесенных в список неизменяемых, может быть вызвано установкой новых версий этих программ.</p>
<p>Чтобы подробнее изучить обнаруженные программой ADinf изменения, выберите из списка &ldquo;Изменения на диске&rdquo; нужную позицию и нажмите клавишу &lt;Enter&gt;.</p>
<div align="center">
	<img src="img/aaf00/fig38.gif" alt="Рис. 3.8. Результаты проверки диска" />
	<p><strong>Рис. 3.8. Результаты проверки диска</strong></p>
</div>
<p>Наиболее подозрительны изменения в секторе главной загрузочной записи (на рисунке она называется Master-boot сектор), загрузочном секторе и выполнимых файлах. Сообщения об их изменении ни в коем случае нельзя оставлять без внимания.</p>
<p>Чтобы подробнее изучить изменения в секторе главной загрузочной записи выберите первую строчку в списке &ldquo;Изменения на диске&rdquo; или нажмите клавишу &lt;F2&gt;. На экране появится диалоговая панель Master-boot сектор, содержащая информацию о главном загрузочном секторе (рис. 3.9). Строка в верхней части панели сообщает об изменении программы начальной загрузки - &ldquo;Изменился загрузчик&rdquo;. Если вы не устанавливали новой версии операционной системы, то, скорее всего, компьютер заражен загрузочным вирусом.</p>
<p>Ниже расположены две таблицы, отражающие состояние таблицы разделов в настоящий момент и во время предыдущей проверки. Более подробно об этих таблицах вы можете узнать в главе &ldquo;Восстановление файловой системы&rdquo;.</p>
<div align="center">
	<img src="img/aaf00/fig39.gif" alt="Рис. 3.9. Изменения в секторе главной загрузочной записи" />
	<p><strong>Рис. 3.9. Изменения в секторе главной загрузочной записи</strong></p>
</div>
<p>Программа ADinf позволяет восстановить старую главную загрузочную запись, которая была сохранена во время предыдущей проверки компьютера. Используйте эту возможность, только если вы полностью уверены, что со времени последней проверки на компьютере не было установлено программное обеспечение, меняющее главную загрузочную запись. Главная загрузочная запись может быть изменена во время установки новой версии операционной системы, программы распределения доступа и некоторых систем защиты от копирования.</p>
<div class="notel">
	<em>Перед тем как начинать восстановление сектора главной загрузочной записи или загрузочного сектора мы рекомендуем сделать резервные копии ваших файлов документов и баз данных, хранимых в компьютере</em>
</div>
<p>Если изменился загрузочный сектор диска, вы можете детально просмотреть изменения. Для этого надо выбрать из диалоговой панели Результаты проверки диска (рис. 3.8) строку Загрузочный сектор или нажать клавишу &lt;F3&gt;. На экране откроется новая диалоговая панель, показанная на рисунке 3.10.</p>
<div align="center">
	<img src="img/aaf00/fig3a.gif" alt="Рис. 3.10. Изменения в загрузочном секторе" />
	<p><strong>Рис. 3.10. Изменения в загрузочном секторе</strong></p>
</div>
<p>Особое внимание в этой диалоговой панели следует обратить на изменение команды перехода на программу загрузки операционной системы (Jump на загрузчик) и изменение самой программы загрузки (Область загрузчика DOS). Их изменение может быть вызвано заражением компьютера загрузочным вирусом.</p>
<div class="notel">
	<em>Обнаружив с помощью ADinf изменения в секторе главной загрузочной записи, загрузочном секторе или в выполняемых файлах, проверьте компьютер с помощью полифагов Aidstest и Doctor Web. Ревизор ADinf сразу может восстановить старые загрузочные сектора, но если компьютер был заражен вирусами типа OneHalf или VolGU, можно потерять информацию, записанную на дисках компьютера</em>
</div>
<p>Загрузочный сектор, как правило, изменяется при установке новой версии операционной системы, некоторых систем распределения доступа и после форматирования диска командой FORMAT. Конечно, в этих случаях вируса в компьютере, скорее всего, нет и восстанавливать старый загрузочный сектор не надо.</p>
<p>С большим вниманием надо отнестись к изменениям в выполнимых файлах. Если ADinf обнаружит такие файлы, просмотрите их список. Для этого выберите в диалоговой панели Результаты проверки диска (рис. 3.8) строку Измененных файлов или нажмите клавишу &lt;F7&gt;. На экране появится диалоговая панель Изменившиеся файлы (рис. 3.11).</p>
<div align="center">
	<img src="img/aaf00/fig3b.gif" alt="Рис. 3.11. Изменение выполнимых файлов" />
	<p><strong>Рис. 3.11. Изменение выполнимых файлов</strong></p>
</div>
<p>Просмотрите весь список изменившихся файлов, выбирая их один за другим. ADinf сообщит о каждом файле дату и время его последнего изменения, старую длину файла и его новую длину. Если изменение длины файла не сопровождается изменением даты его последней модификации, возможно файл заражен вирусом.</p>
<p>Особое внимание следует обратить на случаи, когда изменились файлы, занесенные в список неизменяемых. Обычно в этот список включаются основные файлы операционных систем, другие часто используемые выполнимые файлы. По умолчанию в списке неизменяемых файлов включены файлы COMMAND.COM, IBMBIO.COM, IBMDOS.COM, IO.SYS, NC.EXE, NCMAIN.EXE и WIN.COM.</p>
<p>Некоторые программы записывают в свой выполнимый файл различную информацию, например конфигурацию программы и т. д. Но обычно в этом случае меняется дата и время создания файла.</p>
<p>В любом случае рекомендуется проверить все измененные выполнимые файлы при помощи каких-нибудь программ-полифагов. Удобнее всего организовать взаимодействие ревизора ADinf и полифагов Aidstest и Doctor Web. ADinf может подготовить для этих программ список измененных, новых и перемещенных файлов, которые необходимо проверить. Более подробно о возможностях такого взаимодействия программ антивирусного комплекта АО &ldquo;ДиалогНаука&rdquo; мы расскажем в разделе Взаимодействие программ антивирусного комплекта.</p>
<h5>Лечение зараженных файлов</h5>
<p>Одно из преимуществ ADinf перед многими другими программами-ревизорами заключается в лечащем модуле ADinf Cure Module. Если ревизор ADinf обнаружил изменения в выполнимых файлах, характерные для заражения вирусами, а полифаги Aidstest и Doctor Web не могут обнаружить вирус, скорее всего, компьютер заражен новым вирусом, еще не включенным в вирусную базу этих полифагов. Запустите еще раз полифаг Doctor Web, включив режим эвристического анализа. В этом режиме Doctor Web позволит обнаружить новый вирус, но не сможет удалить их.</p>
<p>Теперь можно воспользоваться лечащим модулем ADinf Cure Module. Он позволяет удалить большинство новых вирусов, еще не известных полифагам Aidstest и Doctor Web.</p>
<p>Лечение файлов надо выполнять, загрузившись с системной лечащей дискеты ADinf Cure Module. Эту дискету необходимо подготовить заранее во время установки ADinf Cure Module. Более подробную информацию о процессе лечения можно получить в документации на антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;.</p>
<div class="notel">
	<em>Перед тем как загрузиться с лечащей дискеты ADinf Cure Module, установите на ней защиту от записи. В противном случае программа не будет работать</em>
</div>
<p>После загрузки компьютера с этой дискеты автоматически запустится программа ADinf Cure Module. После того как вы ответите на несколько вопросов, вы сможете выбрать изменившиеся файлы, которые необходимо вылечить. Программа ADinf Cure Module восстанавливает файл только в том случае, если результирующий файл точно соответствует файлу до его заражения. Если зараженный файл восстановить не удается, ADinf Cure Module сообщит об этом.</p>
<p>В этом случае воспользуйтесь последними версиями полифагов Aidstest и Doctor Web. Если они также не обнаружат вирус, возможно изменения в файле связаны с заменой файла во время установки новых версий программ.</p>
<p>Рекомендуется дополнительно установить резидентный монитор, например VSafe  - он входит в состав дистрибутива операционной системы MS-DOS и некоторое время поработать в таком режиме. Если компьютер заражен вирусом, он рано или поздно себя проявит. Об этом вам сообщит резидентный монитор. Если резидентный монитор будет срабатывать, сообщая о нарушении защиты, постарайтесь передать подозрительные файлы, обнаруженные ADinf, специалистам по вирусам для их дальнейшего исследования.</p>
<h4>Взаимодействие программ антивирусного комплекта</h4>
<p>Программы антивирусного комплекта являются не просто набором дополняющих друг друга программ, они могут и должны использоваться совместно. Рекомендуется следующая последовательность установки и использования комплекта.</p>
<p>Перед установкой программ антивирусного комплекта в компьютер проверьте его на заражение известными вирусами. Для этого воспользуйтесь антивирусными программами полифагами Aidstest и Doctor Web.</p>
<p>Затем установите программы антивирусного комплекта на жесткий диск компьютера - Aidstest, Doctor Web, ADinf и ADinf Cure Module, руководствуясь документацией комплекта или отдельных программ. Если вы работаете в среде операционной системы Windows или Windows 95 и используете текстовый процессор Microsoft Word for Windows версии 6.0 или 7.0, установите антивирус Doctor Web for WinWord.</p>
<p>Ревизор диска ADinf позволяет создать список новых и измененных файлов, требующих проверки антивирусными программами полифагами Aidstest и Doctor Web. Вы можете создать специальный пакетный файл, в котором сначала вызывается ADinf, а затем антивирусы-полифаги. Вот пример такого файла.</p>
<pre class="source">
	@echo off

	ADINF * <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="f1deb1b2">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>:\ADDTEST.LST /A

	if errorlevel 50 goto end
	if errorlevel 40 goto vir_in_mem
	if errorlevel 30 goto end
	if not exist C:\ADDTEST.LST goto end

	DRWEB /@+C:\ADDTEST.LST /CL /HA1 /RV /HI /UPN /NS
	
	if errorlevel 2 goto new_vir
	if errorlevel 1 goto vir

	AIDSTEST <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="d3fc9390">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>:\ADDTEST.LST /G /NB

	if errorlevel 3 goto end
	if errorlevel 2 goto end
	if errorlevel 1 goto vir

:no_vir
	echo Вирусы не обнаружены
	goto end

:vir_in_mem
	pause Обнаружен активный вирус, противодействующий ADinf
	goto end

:vir
	pause Внимание! Обнаружен известный вирус
	goto end

:new_vir
	pause Внимание! Подозрение на неизвестный вирус

:end
</pre>
<p>Для надежной проверки диска важно правильно настроить список расширений проверяемых файлов и режимы работы ADinf, чтобы не пропустить существенных зменений на диске. Настройка ADinf наиболее полно описана в документации на антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>Если среди измененных файлов, антивирусы Aidstest или Doctor Web обнаружат вирусы, рекомендуется перезагрузить компьютер с ранее подготовленной системной дискеты, на которой записаны Aidstest и Doctor Web, и проверить все файлы и загрузочные записи на дисках компьютера.</p>
<p>Можно организовать более сложное взаимодействие антивирусов, чем в приведенном нами примере. Например, можно повторно вызывать антивирусы-полифаги для лечения зараженных файлов и выполнить заключительный вызов ADinf для окончательной проверки компьютера. Однако надо иметь в виду, что такое автоматическое лечение очень опасно. Перед лечением зараженных файлов и загрузочных записей рекомендуется провести анализ ситуации и как минимум сделать резервные копии ваших документов и файлов баз данных.</p>
<h4>Программно-аппаратный комплекс Sheriff</h4>
<p>Дополнительно к антивирусному комплекту АО &ldquo;ДиалогНаука&rdquo; можно приобрести программно-аппаратный комплекс защиты Sheriff. Совместное использование традиционных антивирусных программ и контроля с помощью аппаратных средств обеспечивают наибольшую безопасность системы.</p>
<p>Комплекс, разработанный Фоминым Юрием Николаевичем, включает адаптер защиты и управляющее им программное обеспечение. Адаптер защиты представляет собой плату расширения, предназначенную для установки в системную шину ISA. Плата имеет маленький формат и может быть вставлена в 8-разрядный разъем ISA.</p>
<p>Программно аппаратный комплекс можно использовать с операционными системами, совместимыми с MS-DOS (IBM PC-DOS, DR-DOS, Novell DOS), а также с Microsoft Windows версий 3.1 и 3.11, Microsoft Windows for Workgroups версии 3.11 и новой операционной системой Microsoft Windows 95.</p>
<p>Контроллер защиты контролирует доступ к контроллеру жесткого диска на уровне портов ввода/вывода и сообщает программному обеспечению Sheriff о выполнении любой программой или пользователем несанкционированных действий. Программное обеспечение блокирует дальнейшую работу компьютера, предотвращая возможную порчу программного обеспечения компьютера и записанных в нем данных.</p>
<p>Даже если контроллер жесткого диска подключен к компьютеру через системную шину VLB, PCI или EISA, адаптер защиты будет работать на таком компьютере.</p>
<p>Вот несколько основных возможностей и особенностей комплекса Sheriff:</p>
<ul>
	<li><em>Блокирует выполнение операций, характерных для вирусов и троянских программ. Sheriff предотвращает форматирование жестких дисков; запись в область загрузочных секторов жестких дисков; запись в секторы, распределенные защищаемым файлам, элементам каталогов и таблице размещения файлов; запись в секторы и логические диски, отмеченные как доступные только для чтения; обращение к дискам в обход специально предназначенного для этого прерывания; прямое обращение к портам контроллера жестких дисков</em></li>
	<li><em>Решает проблемы несанкционированного доступа, запрашивая пароль во время начальной загрузки компьютера. Если загрузить защищенный компьютер с дискеты, жесткий диск будет недоступен</em></li>
	<li><em>Содержит в себе систему разграничения доступа для нескольких пользователей, позволяющую определить для каждого пользователя пароль и персональные права доступа к ресурсам компьютера</em></li>
	<li><em>Защиту Sheriff можно отключить только при помощи специальной установочной дискеты. Другие способы отключения контроля связаны с полной потерей данных</em></li>
</ul>
<h5>Совместное использование Sheriff и других программ комплекта</h5>
<p>Чтобы на компьютере, защищенном комплексом Sheriff, запустить остальные программы антивирусного комплекта, их необходимо настроить соответствующим образом. В противном случае защита сработает и компьютер окажется блокирован.</p>
<p>Для настройки ADinf и ADinf Cure Module, откройте в ADinf меню Параметры и выберите из него строку Настройки. На экране появится временное меню. Выберите из него строку Сер. Номер Sheriff и введите пять первых цифр серийного номера вашего экземпляра Sheriff. Например, если Sheriff имеет серийный номер 123450981705763, надо ввести цифры 12345 (рис. 3.12).</p>
<div align="center">
	<img src="img/aaf00/fig3c.gif" alt="Рис. 3.12. Ввод серийного номера Sheriff" />
	<p><strong>Рис. 3.12. Ввод серийного номера Sheriff</strong></p>
</div>
<p>Если вы желаете воспользоваться программами Aidstest, Doctor Web, то в командной строке вызова этих программ надо добавить дополнительный параметр /Z и /SH соответственно, указав после него первые пять цифр серийного номера Sheriff:</p>
<pre>
	AIDSTEST C: /Z12345
	DRWEB C: /SH12345
</pre>
<h3>Антивирусный пакет AVP</h3>
<p>Антивирусный пакет Antiviral Toolkit Pro (AVP) создан фирмой КАМИ, основной разработчик - Касперский Евгений Валентинович. Пакет AVP позволяет обнаружить и удалить около 6000 различных вирусов. К сожалению, большое количество обнаруживаемых вирусов еще не является полной гарантией от заражения компьютера. Всегда найдется новый вирус, не входящий в вирусную базу программы.</p>
<p>Пакет AVP использует почти все средства для обнаружения вирусов. Он позволяет сканировать файлы, загрузочные записи и оперативную память компьютера в поисках известных вирусов. Анализатор кода может обнаружить большинство новых вирусов, но для их лечения надо получить обновления вирусной базы данных.</p>
<p>Антивирус AVP также позволяет вычислять контрольные суммы проверяемых файлов, а затем периодически проверять их. Расхождения в контрольных суммах файла может служить сигналом, что файл заражен вирусом. В отличае от ревизора ADinf, антивирус AVP не умеет обращаться к дискам компьютера непосредственно через функции BIOS. Поэтому многие активные стелс-вирусы могут оказаться незамеченными AVP.</p>
<p>Однако AVP не дает возможности удалить новые вирусы. В этом плане лучше использовать ADinf и лечащий модуль ADinf Cure Module, входящие в состав антивирусного комплекта АО &ldquo;ДиалогНаука&rdquo;. ADinf Cure Module позволяет удалить большинство новых вирусов, еще не включенных в вирусные базы программ-полифагов.</p>
<p>Вместе с AVP поставляется антивирусный резидентный монитор Antiviral Monitor. Он позволяет обнаружить и сообщить обо всех проявлениях, которые могут быть вызваны компьютерными вирусами. Antiviral Monitor также позволяет выполнять автоматическую проверку всех запускаемых и открываемых файлов на заражение известными вирусами.</p>
<p>В настоящий момент фирма КАМИ не выпускает программно-апаратных средств антивирусной защиты, подобных комплексу Sheriff, продаваемых вместе с антивирусным комплектом АО &ldquo;ДиалогНаука&rdquo;. Поэтому если необходима антивирусная защита высокой надежности, лучше ориентироваться на программно-аппаратный комплекс Sheriff, и антивирусные программы из комплекта АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>Вместе с AVP можно купить компьютерную энциклопедию вирусов - AVP Virus Encyclopedia. Она содержит описания большого количества вирусов, структурированные по различным признакам. Для наиболее интересных вирусов можно просмотреть и прослушать выполняемые вирусами эффекты.</p>
<div align="center">
	<img src="img/aaf00/fig3d.gif" alt="Рис. 3.13. Вирус Ambulance" />
	<p><strong>Рис. 3.13. Вирус Ambulance</strong></p>
</div>
<p>Например, для вируса Ambulance энциклопедия AVP Virus Encyclopedia позволяет просмотреть эффект, иногда вызываемый этим вирусом. В нижней части экрана под звуки сирены движется автомобиль скорой помощи (рис. 3.13).</p>
<h3>Антивирусный пакет Microsoft Anti-Virus</h3>
<p>В состав дистрибутива операционной системы MS-DOS версии 6.0 и более поздних версий входит программа Microsoft Anti-Virus. Комплект Microsoft Anti-Virus включает в себя не только антивирусы для операционной системы MS-DOS, но также и для Windows. Надо заметить, что этот антивирус не является разработкой самой фирмы Microsoft, а изготовлен фирмой Central Point Software Product.</p>
<p>Новая версия операционной системы Microsoft Windows 95 не содержит встроенных антивирусных средств, в том числе в ней отсутствует Microsoft Anti-Virus. Поэтому для Microsoft Windows 95 вы должны использовать другие средства защиты.</p>
<p>Процедуры установки и использования этих антивирусных программ описаны во втором томе серии "Персональный компьютер. Шаг за шагом". Поэтому мы повторим только самые основные сведения и больше внимания уделим методике использования Microsoft Anti-Virus и его сравнению с другими антивирусными средствами.</p>
<p>Антивирусная программа Microsoft Anti-Virus для MS-DOS выполняет функции полифага и ревизора. Она позволяет обнаружить известные вирусы и вылечить их. Кроме того, она запоминает основную информацию о выполнимых файлах и проверяет ее при последующих запусках.</p>
<p>В отличае от ревизора ADinf, антивирусная программа Microsoft Anti-Virus не умеет обращаться к дискам компьютера непосредственно через функции BIOS. Поэтому многие активные стелс-вирусы могут оказаться незамеченными.</p>
<p>Для запуска Microsoft Anti-Virus для MS-DOS, введите в командной строке DOS следующую команду:</p>
<pre>MSAV.EXE</pre>
<div align="center">
	<img src="img/aaf00/fig3e.gif" alt="Рис. 3.14. Антивирусная программа Microsoft Anti-Virus для MS-DOS" />
	<p><strong>Рис. 3.14. Антивирусная программа Microsoft Anti-Virus для MS-DOS</strong></p>
</div>
<p>На экране появится диалоговая оболочка программы (рис 3.14). В верхней части расположен заголовок программы, ниже него список дисков, которые можно проверить. В окне Main Menu находятся 5 кнопок, управляющие работой программы.</p>
<table summary="" border="1">
<tr><th>Кнопка</th><th>Назначение</th></tr>
<tr><td>Detect</td><td>Выполнить поиск вирусов</td></tr>
<tr><td>Detect &amp; Clean</td><td>Выполнить поиск и удаление вирусов</td></tr>
<tr><td>Select new drive</td><td>Выбрать диск для проверки</td></tr>
<tr><td>Options</td><td>Установить режим работы Microsoft Anti-Virus</td></tr>
<tr><td>Exit</td><td>Закончить работу с Microsoft Anti-Virus</td></tr>
</table>
<p>Чтобы изменить режим поиска вирусов, нажмите кнопку Options. На экране появится временная диалоговая панель с переключателями, показанная на рисунке 3.15.</p>
<div align="center">
	<img src="img/aaf00/fig3f.gif" alt="Рис. 3.15. Настройка Microsoft Anti-Virus" />
	<p><strong>Рис. 3.15. Настройка Microsoft Anti-Virus</strong></p>
</div>
<table summary="" border="1">
<tr><th>Переключатель</th><th>Режим работы программы</th></tr>
<tr><td>Verify Integrity</td><td>Антивирус сверяет информацию, записанную в файлах CHKLIST.MS (см. переключатель "Verify Integrity") с текущими характеристиками файлов. Если при проверке выявляются различия, на экран выдается предупреждающее сообщение</td></tr>
<tr><td>Create New Checksums</td><td>Во время проверки файлов на наличие вирусов в каждом каталоге создается файл CHKLIST.MS. В этом файле записываются сведения обо всех выполнимых файлах, содержащихся в каталоге (размер файла, дата создания, атрибуты). К выполнимым файлам относятся все файлы с расширениями EXE, COM, BAT, OV*, SYS, BIN, APP, CMD, PGM, PRG, DRV, DLL, 386, FON, ICO, PIF. При последующих проверках характеристики всех выполнимых файлов сверяются с данными из файлов CHKLIST.MS. Если обнаруживается несовпадение, антивирус отображает предупреждающее сообщение</td></tr>
<tr><td>Create Checksums on Floppy</td><td>Если включен этот переключатель и переключатель, "Create New Checksums", тогда во время проверки файлов, расположенных на дискете, в каждом каталоге создается файл CHKLIST.MS</td></tr>
<tr><td>Disable Alarm Sound</td><td>Отключаются все звуковые сигналы</td></tr>
<tr><td>Create Backup</td><td>Перед восстановлением зараженных файлов создаются резервные копии инфицированных файлов. Файлы резервных копий создаются с расширением VIR</td></tr>
<tr><td>Create Report</td><td>Создавать файл отчета, содержащий информацию о результатах проверки диска. Файл создается в корневом каталоге проверяемого диска и имеет имя MSAV.RPT</td></tr>
<tr><td>Prompt While Detect</td><td>Если переключатель находится во включенном положении, то при обнаружении вируса или несоответствия информации, записанной в файле CHKLIST.MS, с параметрами проверяемых файлов дальнейшая проверка прерывается и на экране отображается предупреждающее сообщение "Virus Found" или "Verify Error" соответственно</td></tr>
<tr><td>Anti-Stealth</td><td>Выполняется проверка на наличие активных стелс-вирусов, маскирующихся на уровне операционной системы</td></tr>
<tr><td>Check All Files</td><td>Переключатель позволяет выполнить проверку всех файлов, расположенных на диске</td></tr>
</table>
<p>Если вы постоянно работаете в среде Microsoft Windows, тогда вам лучше использовать для проверки компьютера Microsoft Anti-Virus for Windows.</p>
<div>
	<img src="img/aaf00/fig3av.gif" alt="AV" align="left" />
	<p>Для проверки компьютера на наличие вирусов и	восстановления пораженных файлов и системных областей можно воспользоваться приложением Microsoft Anti-Virus.</p>
</div>
<p>Чтобы запустить Microsoft Anti-Virus, переключитесь в Windows на приложение Program Manager. Затем установите указатель мыши на пиктограмму приложения Microsoft Anti-Virus, расположенную в группе Microsoft Tools, и сделайте двойной щелчок левой кнопкой мыши.</p>
<p>Если группа Microsoft Tools отсутствует, тогда запустите файл MWAV.EXE, он должен находится в каталоге DOS. На экране появится главное окно "Microsoft Anti-Virus" (рис. 3.16).</p>
<div align="center">
	<img src="img/aaf00/fig3g.gif" alt="Рис. 3.16. Приложение Microsoft Anti-Virus" />
	<p><strong>Рис. 3.16. Приложение Microsoft Anti-Virus</strong></p>
</div>
<p>В группе Drivers отображаются пиктограммы всех дисковых устройств, к которым имеет доступ операционная система - накопители на гибких и жестких магнитных дисках, а также, если компьютер подключен к локальной сети, сетевые диски.</p>
<p>Выберите диски, которые надо проверить на наличие вирусов. Для этого достаточно последовательно щелкнуть указателем мыши по изображениям соответствующих устройств. Их названия выделяются цветом, после чего выполняется предварительный сбор информации об устройстве.</p>
<p>Информация о выбранных устройствах отображается в группе Status. В поле Selected выводится количество выбранных устройств Drivers, количество каталогов Directories и общее количество файлов на выделенных устройствах Files.</p>
<p>Чтобы начать проверку выбранных дисков, нажмите кнопку Detect. Если вирусы обнаружены и их надо удалить, нажмите кнопку Detect and Clean. Вы можете задавать различные режимы проверки компьютера. Для этого выберите в меню Options строку Set Options. На экране появится диалоговая панель Options (рис. 3.17).</p>
<div align="center">
	<img src="img/aaf00/fig3h.gif" alt="Рис. 3.17. Диалоговая панель &quot;Options&quot;" />
	<p><strong>Рис. 3.17. Диалоговая панель "Options"</strong></p>
</div>
<p>В этой диалоговой панели расположены девять переключателей, управляющих приложением Microsoft Anti-Virus for Windows. Переключатели и их назначение практически полностью соответствует переключателям, управляющим антивирусом Microsoft Anti-Virus. Добавлен только один переключатель Wipe Deleted Files. После его включения антивирус будет применять специальные приемы для удаления с диска файлов, зараженных вирусами. Восстановление таких файлов с помощью приложений, аналогичных Microsoft Undelete, будет невозможно.</p>
<h4>Резидентный монитор VSafe</h4>
<p>В состав Microsoft Anti-Virus входит резидентный монитор VSafe, позволяющий постоянно контролировать работу компьютера. После загрузки, он будет сообщать пользователю о любых подозрительных действиях программ, которые могут быть вызваны работой вирусов.</p>
<p>Запуск VSafe желательно выполнять в момент загрузки компьютера, поместив его вызов в конце конфигурационного файла AUTOEXEC.BAT, перед запуском командных оболочек типа Norton Commander или операционной системы Windows:</p>
<pre>VSAFE.COM</pre>
<p>Программе VSafe можно указать несколько параметров, устанавливающих режим его работы. Однако вместо этого есть возможность вызова специальной диалоговой панели, в которой выполняются все настройки программы. Если вы работаете в среде DOS, то для этого надо нажать комбинацию клавиш &lt;Alt + V&gt;. На экране откроется диалоговая панель, показанная на рисунке 3.18.</p>
<div align="center">
	<img src="img/aaf00/fig3i.gif" alt="Рис. 3.18. Диалоговая панель VSafe Warning Options" />
	<p><strong>Рис. 3.18. Диалоговая панель VSafe Warning Options</strong></p>
</div>
<p>В этой панели расположен ряд переключателей, управляющих работой монитора. Устанавливая те или иные переключатели, вы определяете какие операции будут контролироваться. Чтобы установить переключатель или сбросить его, надо нажать соответствующую цифровую клавишу. Например, чтобы изменить положение переключателя Resident надо нажать клавишу &lt;2&gt;.</p>
<table summary="" border="1">
<tr><th>Переключатель</th><th>Назначение</th></tr>
<tr><td>HD Low level format</td><td>Некоторые вирусы и троянские программы форматируют жесткие диски компьютера. Если переключатель установлен, то попытка отформатировать жесткий диск будет перехвачена и пользователь получит предупреждающее сообщение </td></tr>
<tr><td>Resident</td><td>Выдается предупреждение при попытке программы остаться резидентной в памяти компьютера</td></tr>
<tr><td>General write protect</td><td>Предупреждение выдается при любой попытке программы выполнить запись на диск</td></tr>
<tr><td>Check executable files</td><td>Проверяет целостность выполнимых файлов в момент их запуска. Сравнивается размер, дата создания и атрибуты файла запускаемого файла с информацией, записанной в файле CHKLIST.MS. Когда вы запустите зараженный файл, на экране появится предупреждение и вы сможете заняться лечением этого файла</td></tr>
<tr><td>Boot sector viruses</td><td>Устанавливается защита против вирусов, распространяющихся через загрузочный сектор</td></tr>
<tr><td>Protect HD boot sector</td><td>Сообщение выдается при попытке записи в загрузочный сектор или таблицу разделов жесткого диска. Изменения в загрузочный сектор и таблицу разделов жесткого диска, как правило, вносят вирусы</td></tr>
<tr><td>Protect FD boot sector</td><td>Выдается сообщение при попытке записи в загрузочный сектор дискеты (гибкого диска). Изменения в загрузочном секторе дискеты, как правило, вносят вирусы, которые уже находятся на компьютере</td></tr>
<tr><td>Protect executable files</td><td>Выдается предупреждение при попытке изменить выполнимые файлы. Как правило, при нормальной работе операционной системы изменения в выполнимые файлы не вносятся. Такие изменения могут служить сигналом, что данный файл заражен</td></tr>
</table>
<p>Когда вы закончите установку переключателей, закройте панель VSafe Warning Options, нажав клавишу &lt;Esc&gt;. После перезагрузки компьютера положение переключателей восстановится.</p>
<p>Чтобы каждый раз при загрузке компьютера не менять положение переключателей, их положение можно задавать в командной строке VSafe. Сначала надо указать префикс параметра - символ слеша, затем номер переключателя и символ + или -, в зависимости от того надо включить или выключить переключатель.</p>
<p>Например, чтобы включить контроль за резидентными программами и включить проверку загрузочных секторов, измените вызов VSafe следующим образом:</p>
<pre>VSAFE.COM /2+ /6-</pre>
<p>Обнаружив, что какая-либо программа пытается нарушить установленную защиту, монитор VSafe немедленно сообщает об этом пользователю. На рисунке 3.19 представлено сообщение монитора о том, что файл MODE.COM изменен. Сообщение появляется в момент запуска файла. Такое изменение часто является результатом заражения программы файловым вирусом. Монитор VSafe позволяет предотвратить нарушение защиты, нажав кнопку Stop. В этом случае программа MODE.COM не будет запущена.</p>
<div align="center">
	<img src="img/aaf00/fig3j.gif" alt="Рис. 3.19. Сообщение монитора VSafe" />
	<p><strong>Рис. 3.19. Сообщение монитора VSafe</strong></p>
</div>
<p>Если вы работаете в среде операционной системы Windows, вы также можете использовать монитор VSafe. Для этого надо запустить программу VSafe Manager for Windows.</p>
<div>
	<img src="img/aaf00/fig3vsm.gif" alt="Mwavtsr" align="left" />
	<p>Выполнимый файл VSafe Manager for Windows называется MWAVTSR.EXE и расположен в каталоге MS-DOS. Чтобы приложение VSafe Manager for Windows автоматически запускалось при каждом старте Windows, добавьте его в группу StartUp приложения Program Manager</p>
</div>
<p>При запуске приложения VSafe Manager for Windows на экране появляется окно приложения, показанное на рисунке 3.20.</p>
<div align="center">
	<img src="img/aaf00/fig3k.gif" alt="Рис. 3.20. Диалоговая панель Vsafe Manager" />
	<p><strong>Рис. 3.20. Диалоговая панель Vsafe Manager</strong></p>
</div>
<p>Нажмите кнопку Options. Появляется диалоговая панель Vsafe Options (рис. 3.21). В ней расположен ряд переключателей, управляющих работой приложения. Они соответствуют переключателям резидентного монитора VSafe, описанным выше. Через диалоговую панель Vsafe Options можно полностью управлять резидентным монитором VSafe.</p>
<div align="center">
	<img src="img/aaf00/fig3l.gif" alt="Рис. 3.21. Диалоговая панель Vsafe Options" />
	<p><strong>Рис. 3.21. Диалоговая панель Vsafe Options</strong></p>
</div>
<p>Чтобы при последующих запусках Windows на экране не появлялась диалоговая панель Vsafe Manager, откройте в приложении Program Manager окно группы StartUp и щелкните один раз по пиктограмме Vsafe Manager. Затем нажмите комбинацию клавиш &lt;Alt + Enter&gt;. На экране появится панель Program Item Properties. Установите переключатель Run Minimized. Теперь при загрузке Windows приложение Vsafe Manager будет запускаться в виде пиктограммы.</p>
<p>К сожалению, резидентный монитор VSafe обманется некоторыми вирусами. Так вирус AntiC.1000, заражающий выполнимые файлы, может обнаружить в оперативной памяти резидентный монитор VSafe. В этом случае он выводит небольшой текст - "И даже VSafe тебе не поможет...". Чтобы антивирус не смог обнаружить факт заражения, вирус удаляет с диска файлы, имеющие расширение *.MS. В этих файлах хранится информация  о контролируемых файлах и если она будет удалена, Microsoft Anti-Virus не сможет обнаружить в них изменения.</p>
<p>Чтобы отключить резидентный монитор, удалите пиктограмму Vsafe Manager из группы StartUp и удалите вызов программы VSAFE.COM из файла AUTOEXEC.BAT.</p>
<p>Антивирус Microsoft Anti-Virus позволяет удалить только известные вирусы, информация о которых есть в его базе данных. Новые вирусы появляются постоянно, поэтому версию антивируса необходимо постоянно обновлять.</p>
<p>К сожалению, Microsoft Anti-Virus не может не только удалить, но даже обнаружить полиморфные вирусы типа OneHalf. Из-за этого защита при помощи одного только антивируса Microsoft Anti-Virus недостаточна и необходимо дополнительно использовать другие средства.</p>
<h3>Антивирус Norton AntiVirus for Windows 95</h3>
<p>Как вы уже знаете, в дистрибутив операционной системы MS-DOS входит антивирусный пакет Microsoft Anti-Virus. В его составе несколько антивирусных программ для MS-DOS и Windows. Новая операционная система Microsoft Windows 95 не содержит в себе встроенных антивирусных средств. Поэтому мы включили в нашу книгу немного сведений о пакете Norton AntiVirus, предназначенном специально для этой операционной системы.</p>
<p>Так как новые вирусы появляются с завидным постоянством, то необходимо периодически обновлять вирусную базу Norton AntiVirus, содержащую описания известных вирусов. В противном случае при проверке можно пропустить новый вирус, заразивший компьютер.</p>
<div class="notel">
	<em>Некоторые вирусы, созданные в России и не получившие широкого распространения за рубежом, могут не определяться программой Norton AntiVirus. Поэтому мы рекомендуем в первую очередь пользоваться отечественными разработками антивирусных программ</em>
</div>
<p>Операционная система Windows 95 имеет много новшеств по сравнению со старыми операционными системами MS-DOS и Windows. В частности, внесены изменения в файловую систему. Теперь пользователь может задавать для файлов длинные имена (до двухсот шестидесяти пяти символов). Некоторые старые программы, разработанные для прежних версий Windows, не работают с длинными именами файлов. Ряд антивирусных программ пользуются низкоуровневым доступом к жесткому диску и также не работают совместно с Windows 95.</p>
<p>Мы не стали описывать процедуру установки Norton AntiVirus for Windows 95, вы сможете найти ее в документации, а уделили основное внимание описанию возможностей этого пакета, его достоинствам и недостаткам.</p>
<p>После установки на компьютере Norton AntiVirus for Windows 95 версии 4.0 создается новая папка Norton AntiVirus, содержащая ряд приложений (рис. 3.22).</p>
<div align="center">
	<img src="img/aaf00/fig3m.gif" alt="Рис. 3.22. Папка Norton AntiVirus" />
	<p><strong>Рис. 3.22. Папка Norton AntiVirus</strong></p>
</div>
<p>В следующей таблице мы перечислим пиктограммы пакета Norton AntiVirus и приведем их краткие описания.</p>
<table summary="" border="1">
<tr><th>Пиктограмма</th><th>Приложение</th></tr>
<tr><td><img src="img/aaf00/fig3n1.gif" alt="NAV Icon" /></td><td>Некоторые вирусы могут разрушить операционную систему компьютера таким образом, что она перестанет загружаться. Приложение Create Rescue Disk позволяет создать дискету, с которой вы сможете загрузить Windows 95 и восстановить ее работоспособность</td></tr>
<tr><td><img src="img/aaf00/fig3n2.gif" alt="NAV Icon" /></td><td>Приложение Norton AntiVirus Auto-Protect постоянно работает в фоновом режиме и проверяет все запускаемые программы на заражение известными вирусами. Кроме того, Norton AntiVirus Auto-Protect позволяет отслеживать все подозрительные действия и предупреждать о них пользователя</td></tr>
<tr><td><img src="img/aaf00/fig3n3.gif" alt="NAV Icon" /></td><td>Основное приложение пакета Norton AntiVirus. Выполняет поиск вирусов в компьютере. Приложение Norton AntiVirus позволяет выбрать режим проверки компьютера, просмотреть информацию об известных вирусах, просмотреть журнал, содержащий информацию о предыдущих проверках компьютера</td></tr>
<tr><td><img src="img/aaf00/fig3n4.gif" alt="NAV Icon" /></td><td>Приложение Norton Program Scheduler позволяет выполнять запуск Norton AntiVirus в автоматическом режиме. Например, вы можете указать время когда Scheduler должен запустить антивирус для проверки всех файлов на диске. Вместо Norton Program Scheduler вы можете воспользоваться приложением System Agent, входящим в состав Microsoft Plus! For Windows 95</td></tr>
<tr><td><img src="img/aaf00/fig3n5.gif" alt="NAV Icon" /></td><td>Приложение Uninstall Norton AntiVirus позволяет отключить антивирусную защиту и удалить все файлы пакета с жесткого диска компьютера. Отключение антивирусной защиты увеличивает шансы вирусов заразить компьютер, поэтому если вы отказались от использования Norton AntiVirus, мы рекомендуем вам попробовать другие антивирусные программы, например, антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;</td></tr>
</table>
<h4>Антивирус Norton AntiVirus</h4>
<p>Запустите приложение Norton AntiVirus. На экране откроется главное окно Norton AntiVirus (рис. 3.23). В верхней части окна, под главным меню, расположен ряд кнопок, позволяющих настроить режим работы приложения, просмотреть информацию об известных вирусах, установить программу автоматического запуска Norton Program Scheduler и просмотреть журнал предыдущих проверок компьютера.</p>
<p>В средней части окна расположены две группы переключателей, при помощи которых можно выбрать проверяемые диски. В группе переключателей, расположенной слева, перечислены имена всех дисков компьютера и их метки (если такие есть). Чтобы проверить диск, необходимо включить переключатель, расположенный около него. Вы можете выбрать любую комбинацию проверяемых дисков, например, A:, C:, F: или C:, D:, E: и G:.</p>
<p>Вы можете указать не только отдельные имена проверяемых дисков, но и целые группы. Группа переключателей Drive types позволяет указать, что проверке подлежат все дисководы для гибких дисков, все жесткие диски и все сетевые диски. Вы можете проверить не только жесткие диски компьютера, но также все сетевые диски, к которым ваш компьютер имеет доступ и компакт-диски.</p>
<div align="center">
	<img src="img/aaf00/fig3n.gif" alt="Рис. 3.23. Главное окно приложения Norton AntiVirus" />
	<p><strong>Рис. 3.23. Главное окно приложения Norton AntiVirus</strong></p>
</div>
<p>С правой стороны окна Norton AntiVirus расположены три кнопки - Scan Now, Exit и Help. Они позволяют начать проверку компьютера, завершить приложение Norton AntiVirus, а также получить справочную информацию.</p>
<p>Чтобы начать проверку выбранных дисков, нажмите кнопку Scan Now. Антивирус выполнит проверку оперативной памяти и загрузочных секторов. Затем будут проверены основные файлы операционной системы. Если никаких нарушений не будет обнаружено, начинается проверка дисков (рис. 3.24).</p>
<div align="center">
	<img src="img/aaf00/fig3o.gif" alt="Рис. 3.24. Проверка диска C:" />
	<p><strong>Рис. 3.24. Проверка диска C:</strong></p>
</div>
<p>Ход проверки компьютера зависит от того, как настроен Norton AntiVirus. Зараженные файлы могут обрабатываться в автоматическом режиме или вручную. Более подробно о настройке Norton AntiVirus можно прочитать в следующей главе.</p>
<p>Для более опытных пользователей рекомендуется ручная обработка. В этом случае антивирус позволяет самому пользователю решать, что делать с обнаруженным вирусом (рис. 3.25) - удалить вирус, удалить сам зараженный файл или оставить файл без обработки. Вы можете просмотреть информацию о пойманном вирусе, нажав кнопку Info.</p>
<div align="center">
	<img src="img/aaf00/fig3p.gif" alt="Рис. 3.25. Список обнаруженных вирусов" />
	<p><strong>Рис. 3.25. Список обнаруженных вирусов</strong></p>
</div>
<p>После того как вы обработаете все вирусы или нажмете кнопку Done, на экране появится диалоговая панель, содержащая статистические данные о проверке компьютера. Закрыв эту панель, вы вернетесь в главное окно программы.</p>
<div class="notes">
	<p><em>Вирус Beer.2794</em></p>
	<p><em>Опасный резидентный шифрованный вирус, заражает выполнимые файлы в формате COM и EXE. Уничтожает файлы DISKDATA.DTL, VIRUSES.INF, DIRINFO, -V.MSG или A-DINF-_.___. Иногда проигрывает мелодию и выводит текст "Сейчас бы пивка"</em></p>
</div>
<h4>Настройка режимов поиска вирусов</h4>
<p>Перед тем как приступить к поиску вирусов на компьютере, следует настроить Norton AntiVirus. Для этого вы можете нажать кнопку Options или выбрать из меню Tools строку Options. На экране появится блокнот Options, содержащий несколько страничек - диалоговых панелей (рис. 3.26). Для выбора страницы следует нажать указателем мыши на закладки, расположенные в верхней части окна.</p>
<p>Сейчас мы дадим основные рекомендации по настройке всех режимов Norton AntiVirus.</p>
<p>Первая страница блокнота настроек, которую мы рассмотрим, называется Scanner (рис. 3.26). Она задает все основные параметры работы антивируса в режиме ручной проверки компьютера. Самая главная группа переключателей What to scan определяет, где приложение будет искать вирусы. От того, насколько правильно вы установите эти переключатели, зависит эффективность проверки компьютера.</p>
<p>Первый переключатель Memory управляет поиском вирусов в оперативной памяти и позволяет обнаружить активные вирусы.</p>
<p>Переключатель Master boot record управляет поиском вирусов в главном загрузочном секторе жестких дисков компьютера. Желательно выполнять эту проверку всегда, так как главный загрузочный сектор - излюбленное место для вирусов.</p>
<p>Следующий переключатель Boot record включает поиск вирусов в загрузочных секторах жестких дисков и дискет. Имеет смысл установить этот переключатель, также как переключатель Master boot record, потому, что они оба отвечают за поиск загрузочных вирусов. Вы обязательно должны включить переключатель Boot record при поиске вирусов на дискетах.</p>
<p>Переключатель Within compressed files задает режим поиска внутри файлов архивов. Обычно такая проверка бывает полезна, так как вирусы могут попасть в архив во время его создания, когда вы записываете в него зараженный файл. Существуют вирусы, которые могут записать новый файл с вирусом в архив, и можно представить себе вирус, способный заразить файлы внутри архива.</p>
<p>В группе What to scan также расположен переключатель с зависимой фиксацией, который позволяет выбрать файлы для проверки. Вы можете задать проверку всех файлов на выбранных дисках или только файлов, имеющих определенные расширения. Чтобы проверить все файлы, этот переключатель надо перевести в положение All files. Если вам надо проверить только выполнимые файлы, переведите переключатель в положение Program files. По умолчанию будут проверены все файлы, имеющее расширения COM, EXE, OV?, SYS, DRV, APP, CMD, PGM, PRG, DLL и 386, но вы можете изменить этот список произвольным образом.</p>
<div align="center">
	<img src="img/aaf00/fig3q.gif" alt="Рис. 3.26. Страница Scanner Setting" />
	<p><strong>Рис. 3.26. Страница Scanner Setting</strong></p>
</div>
<p>Если во время проверки компьютера Norton AntiVirus обнаружит вирус, он может выполнить различные действия, от сообщения пользователю до остановки компьютера. Для того чтобы определить поведение Norton AntiVirus при обнаружении вируса, предназначена группа How to respond.</p>
<p>Список When a virus is found содержит перечень возможных вариантов:</p>
<table summary="" border="1">
<tr><th>Строка из списка</th><th>Действие Norton AntiVirus при обнаружении вируса</th></tr>
<tr><td>Prompt</td><td>На экране появляется приглашение. Пользователю разрешается самостоятельно решить судьбу зараженного файла. Этот режим предполагает, что пользователь хорошо разбирается в программном обеспечении компьютера и в состоянии решить что делать с зараженным файлом или загрузочным сектором</td></tr>
<tr><td>Notify Only</td><td>Выводится сообщение об обнаружении вируса. Сам вирус не удаляется. В этом случае пользователь должен либо удалить зараженный файл самостоятельно, либо вылечить его, запустив Norton AntiVirus в другом режиме</td></tr>
<tr><td>Repair Automatically</td><td>В этом режиме все обнаруженные вирусы будут автоматически удаляться. К сожалению, не во всех случаях такое лечение будет успешным. Некоторые вирусы так заражают файлы, что они не подлежат лечению и должны быть восстановлены с резервной копии или с дистрибутива</td></tr>
<tr><td>Delete Automatically</td><td>Это очень опасный режим, в котором обнаруженный вирус будет удален вместе с зараженным файлом. Следует иметь в виду, что после удаления большинства файлов программное обеспечение компьютера скорее всего перестанет работать и вам может потребоваться устанавливать его заново</td></tr>
<tr><td>Shutdown Computer</td><td>Компьютер немедленно отключается. Этот режим можно использовать, если компьютер обслуживается специалистами, которых можно вызвать в случае вирусной атаки. Немедленное отключение компьютера, зараженного вирусами, и вызов специалиста во многих случаях позволят сохранить информацию, записанную в нем</td></tr>
</table>
<p>Если вы выбрали строку Prompt, то при обнаружении вируса на экране появится диалоговая панель с кнопками, указывающими, что делать с зараженным файлом. Таких кнопок четыре: Repair - восстановить файл, удалив вирус, Delete - удалить зараженный файл, Continue - продолжить проверку компьютера и ни чего не делать с обнаруженным вирусом, Exclude - исключить файл из всех последующих проверок компьютера. Некоторые кнопки из перечисленных выше можно заблокировать, для этого следует выключить соответствующий переключатель в группе Buttons to display if prompted.</p>
<p>Некоторые дополнительные параметры режима проверки компьютера задаются в диалоговой панели Scanner Advanced Setting (рис. 3.27). Чтобы ее открыть, нажмите кнопку Advanced.</p>
<div align="center">
	<img src="img/aaf00/fig3r.gif" alt="Рис. 3.27. Диалоговая панель Scanner Advanced Setting" />
	<p><strong>Рис. 3.27. Диалоговая панель Scanner Advanced Setting</strong></p>
</div>
<p>Диалоговая панель Options - Startup Settings определяет, как будет проверяться компьютер при загрузке операционной системы (рис. 3.28). Ряд переключателей, объединенных в группу What to scan, указывают антивирусу, что конкретно он должен проверять.</p>
<table summary="" border="1">
<tr><th>Переключатель</th><th>Описание и рекомендации по использованию</th></tr>
<tr><td>Memory</td><td>Позволяет проверить, нет ли активных вирусов в оперативной памяти компьютера</td></tr>
<tr><td>Master boot record</td><td>Выполняет поиск загрузочных вирусов в главной загрузочной записи жесткого диска компьютера</td></tr>
<tr><td>Boot record</td><td>Проверяет загрузочные секторы в поисках загрузочных вирусов</td></tr>
<tr><td>System files</td><td>Проверяет основные файлы операционной системы</td></tr>
<tr><td>Programs run from AUTOEXEC.BAT</td><td>Выполняет поиск файловых вирусов в программах, запускаемых при загрузке компьютера из файла AUTOEXEC.BAT</td></tr>
</table>
<p>Для повышения степени защиты компьютера вы можете установить все перечисленные в таблице переключатели, но время загрузки компьютера несколько увеличиться. Если проверка компьютера при его загрузке будет выполняться слишком долго, ее можно прервать нажав комбинацию клавиш, установленную переключателем Bypass keys.</p>
<div align="center">
	<img src="img/aaf00/fig3s.gif" alt="Рис. 3.28. Диалоговая панель Options - Startup Settings" />
	<p><strong>Рис. 3.28. Диалоговая панель Options - Startup Settings</strong></p>
</div>
<p>Когда Norton AntiVirus обнаружит вирус, он может вывести для пользователя предупреждающее сообщение. Вы имеете возможность задать его сами. Для этого выберите диалоговую панель Options - Alerts Settings (рис. 3.29). Включите переключатель Display alert message и наберите текст сообщения в окне редактора, расположенном под этим переключателем. Дополнительно можно установить подачу звукового сигнала, включив переключатель Sound audible alert.</p>
<div align="center">
	<img src="img/aaf00/fig3t.gif" alt="Рис. 3.29. Диалоговая панель Options - Alerts Settings" />
	<p><strong>Рис. 3.29. Диалоговая панель Options - Alerts Settings</strong></p>
</div>
<p>Если вы проверяете компьютер на наличие вирусов во время своего отсутствия, вы можете захотеть, чтобы предупреждающее сообщение отображалось на экране не дольше заданного времени. Поэтому установите переключатель Remove alert dialog after и укажите промежуток времени в секундах.</p>
<p>К сожалению, не всегда попытка лечения файла оказывается успешной. Иногда после удаления вируса вылеченная программа оказывается неработоспособной. Поэтому перед восстановлением файла обычно делают резервную копию. Если вылеченная программа оказывается неработоспособной, ее восстанавливают с резервной копией. Вирус в этом случае остается нетронутым.</p>
<p>Большинство антивирусных программ, в том числе и Norton AntiVirus, позволяет автоматически создавать резервные копии файлов программ перед их лечением. Вы можете управлять этой возможностью. Выберите диалоговую панель Options - General Settings (рис. 3.30).</p>
<p>Чтобы разрешить создание резервных копий, включите переключатель Back up file before attempting a repair, и введите расширение, которое будет присваиваться файлам копий. По умолчанию используется расширение VIR.</p>
<p>Таким образом, резервным копиям выполнимых файлов COM и EXE присваивается одинаковое расширение VIR. Отличить их можно просмотрев несколько первых символов из этих файлов. Выполнимые файлы программ в формате EXE начинаются символами MZ или ZM.</p>
<div align="center">
	<img src="img/aaf00/fig3u.gif" alt="Рис. 3.30. Диалоговая панель Options - General Settings" />
	<p><strong>Рис. 3.30. Диалоговая панель Options - General Settings</strong></p>
</div>
<p>В диалоговой панели Options - General Settings находится еще один переключатель Scan high memory when scanning memory. Он отвечает за проверку верхней области памяти во время теста оперативной памяти компьютера. Для повышения надежности защиты включите этот переключатель.</p>
<p>Антивирус Norton AntiVirus выполняет функции ревизора диска. Он позволяет записать необходимую информацию о загрузочных секторах и выполнимых файлах, а затем сверять ее. Если будет обнаружено совпадение, вероятнее всего загрузочный сектор или файл подверглись нападению вируса.</p>
<p>По умолчанию Norton AntiVirus записывает информацию только о загрузочных секторах и основных файлах операционной системы, но вы можете расширить этот список, выбрав диалоговую панель Options - Inoculation Settings (рис. 3.31). Для этого включите переключатель Inoculate program files.</p>
<div align="center">
	<img src="img/aaf00/fig3v.gif" alt="Рис. 3.31. Диалоговая панель Options - Inoculation Settings" />
	<p><strong>Рис. 3.31. Диалоговая панель Options - Inoculation Settings</strong></p>
</div>
<p>Иногда требуется исключить ряд файлов из проверки на вирусы. Примером такого файла могут служить некоторые выполнимые файлы антивирусных программ, содержащие сигнатуры известных вирусов. Список таких файлов вы можете поддерживать, вызвав на экран диалоговую панель Options - Exclusions List Setting (рис. 3.32).</p>
<div align="center">
	<img src="img/aaf00/fig3w.gif" alt="Рис. 3.32. Диалоговая панель Options - Exclusions List Setting" />
	<p><strong>Рис. 3.32. Диалоговая панель Options - Exclusions List Setting</strong></p>
</div>
<p>Вы можете добавлять новые имена файлов в список, изменять их и удалять из списка с помощью кнопок New, Edit и Remove.</p>
<p>Во время проверки компьютера Norton AntiVirus ведет журнал регистрации, в который записывает все основные события, такие как обнаружение вируса и т. д. Вы можете управлять ведением этого журнала через диалоговую панель Activity Log Settings (рис. 3.33).</p>
<div align="center">
	<img src="img/aaf00/fig3x.gif" alt="Рис. 3.33. Диалоговая панель Options - Activity Log Settings" />
	<p><strong>Рис. 3.33. Диалоговая панель Options - Activity Log Settings</strong></p>
</div>
<p>Переключатели, расположенные в группе Log following events, определяют события, которые будут занесены в файл журнала. В группе Limit log file size можно указать максимальный размер файла журнала, а список Activity log filename - выбрать имя для файла журнала.</p>
<p>Впоследствии вы сможете просмотреть файл журнала, нажав кнопку Activity Log в главном окне приложения (рис. 3.33).</p>
<h4>Автоматическая защита компьютера</h4>
<p>В состав комплекта Norton AntiVirus for Windows 95 входит приложение Norton AntiVirus Auto-Protect. Будучи запущенным, это приложение постоянно работает в фоновом режиме, контролируя работу компьютера.</p>
<p>После запуска Norton AntiVirus Auto-Protect в нижней части экрана появляется небольшая пиктограмма, изображающая монитор с осциллограммой (см. правую пиктограмму на рис. 3.34). Эта пиктограмма означает, что компьютер находится под защитой.</p>
<div align="center">
	<img src="img/aaf00/fig3y.gif" alt="Рис. 3.34. Папка Norton AntiVirus Auto-Protect" />
	<p><strong>Рис. 3.34. Папка Norton AntiVirus Auto-Protect</strong></p>
</div>
<p>Вы можете временно отключить Norton AntiVirus Auto-Protect и настроить режим его работы. Для этого сделайте двойной щелчок мышью по пиктограмме AntiVirus Auto-Protect. На экране появится диалоговая панель управления приложением (рис. 3.35), содержащая три кнопки. Кнопка Minimaze позволяет закрыть эту диалоговую панель.</p>
<div align="center">
	<img src="img/aaf00/fig3z.gif" alt="Рис. 3.35. Диалоговая панель Norton AntiVirus Auto-Protect" />
	<p><strong>Рис. 3.35. Диалоговая панель Norton AntiVirus Auto-Protect</strong></p>
</div>
<p>Чтобы временно отключить защиту компьютера с помощью Norton AntiVirus Auto-Protect, нажмите кнопку Disable. Защита будет отключена, а в нижней части экрана пиктограмма Norton AntiVirus Auto-Protect изменит свой внешний вид (рис. 3.36). Чтобы снова включить защиту, опять щелкните два раза мышью по перечеркнутой пиктограмме и в открывшейся диалоговой панели нажмите кнопку Enable.</p>
<div align="center">
	<img src="img/aaf00/fig3aa.gif" alt="Рис. 3.36. Папка Norton AntiVirus Auto-Protect" />
	<p><strong>Папка Norton AntiVirus Auto-Protect</strong></p>
</div>
<p>Norton AntiVirus Auto-Protect постоянно работает в фоновом режиме и проверяет все запускаемые программы на заражение известными вирусами. Кроме того, Norton AntiVirus Auto-Protect позволяет отслеживать все подозрительные действия и предупреждать о них пользователя</p>
<p>Кнопка Configure служит для настройки автоматической защиты от вирусов. После того как вы на нее нажмете, на экране появится диалоговая панель Options - Auto-Protect Settings (рис. 3.37).</p>
<div align="center">
	<img src="img/aaf00/fig3ab.gif" alt="Рис. 3.37. Диалоговая панель Options - Auto-Protect Settings" />
	<p><strong>Рис. 3.37. Диалоговая панель Options - Auto-Protect Settings</strong></p>
</div>
<p>Эта диалоговая панель почти соответствует уже рассмотренной нами панели основного приложения Norton AntiVirus (рис. 3.26). Она содержит описанные нами ранее две группы переключателей - Scan a file when и How to respond. Поэтому сейчас мы расскажем о дополнительных особенностях этой панели.</p>
<p>В первую очередь это переключатель Load Auto-Protect at startup. Если включить его, тогда Norton AntiVirus Auto-Protect будет автоматически запускаться каждый раз при загрузке компьютера.</p>
<p>Переключатель Auto-protect can be disabled позволяет заблокировать возможность временного отключения защиты. Для этого переключатель должен быть выключен. Вы можете воспользоваться этой возможностью, если на компьютере работают начинающие пользователи. Лучше всего использовать этот переключатель вместе с переключателем Show icon on task bar, который позволяет не отображать пиктограмму приложения в нижней части экрана.</p>
<p>Интересной особенностью приложения Norton AntiVirus Auto-Protect является то, что оно позволяет обнаруживать в выполнимых файлах не только известные, но также неизвестные вирусы. Для этого применяется специальная технология, которая называется Sensor technology. Нажмите кнопку Sensor. На экране появится диалоговая панель Auto-Protect Virus Sensor Settings (рис. 3.38).</p>
<div align="center">
	<img src="img/aaf00/fig3ac.gif" alt="Рис. 3.38. Диалоговая панель Auto-Protect Virus Sensor Settings" />
	<p><strong>Рис. 3.38. Диалоговая панель Auto-Protect Virus Sensor Settings</strong></p>
</div>
<p>Чтобы включить режим поиска неизвестных вирусов, установите переключатель Use virus sensor technology. Список When an unknown virus is found и группа переключателей Buttons to display if prompted, определяют реакцию антивируса в случае обнаружения неизвестного вируса.</p>
<p>Кроме проверки запускаемых файлов Norton AntiVirus Auto-Protect выполняет все функции обычного резидентного монитора. Он отслеживает все действия, которые могут стать причиной разрушения программного обеспечения компьютера и хранимых в нем данных, сообщая о них пользователю. Вы можете установить, в каких случаях Norton AntiVirus Auto-Protect будет сообщать вам о &ldquo;нападении вирусов&rdquo;. Для этого нажмите кнопку Advanced в диалоговой панели Options - Auto-Protect Settings. Откроется новая диалоговая панель Auto-Protect Advanced Settings (рис. 3.39).</p>
<div align="center">
	<img src="img/aaf00/fig3ad.gif" alt="Рис. 3.39. Диалоговая панель Auto-Protect Advanced Settings" />
	<p><strong>Рис. 3.39. Диалоговая панель Auto-Protect Advanced Settings</strong></p>
</div>
<p>В группе Virus-like activity monitors перечислены ситуации, которые отслеживает приложение. Для каждой ситуации вы можете выбрать реакцию приложения Prompt - разрешить пользователю самому решить, выполнять ли данную операцию, Allow - разрешить выполнение операции, Don&rsquo;t Allow - запретить выполнение операции.</p>
<p>Вот список таких ситуаций с краткими описаниями и рекомендациями.</p>
<table summary="" border="1">
<tr><th>Переключатель</th><th>Описание и рекомендации</th></tr>
<tr><td>Low-level format of hard disk</td><td>Низкоуровневое форматирование жесткого диска. Очень опасная операция. Вызывает полную потерю всех данных на диске. Если монитор обнаружил попытку выполнить форматирование жесткого диска, практически наверняка компьютер заражен вирусом, троянской программой или логической бомбой. Вы должны отменить операцию форматирования и немедленно проверить компьютер на наличие вирусов</td></tr>
<tr><td>Write to hard disk boot record</td><td>Запись данных в загрузочные секторы жесткого диска. Обычно такая операция выполняется загрузочными вирусами при заражении жестких дисков компьютера. Однако изменение загрузочных секторов может быть вызвано значительно более прозаической причиной. Загрузочные секторы изменяются, когда вы изменяете метку диска командой LABEL и устанавливаете новую версию операционной системы. Если монитор сообщит о попытке изменения загрузочных секторов, вы должны самостоятельно проанализировать ситуацию и решить, не вызвано ли такое изменение вашими действиями. В случае если вы не форматировали диски, не меняли метку диска, не устанавливали новую версию операционной системы, то возможно компьютер заражен вирусом. Тогда отмените операцию записи загрузочного сектора и проверьте компьютер на наличие вирусов</td></tr>
<tr><td>Write to floppy disk boot record</td><td>Запись данных в загрузочные секторы дискеты. Обычно такая операция выполняется загрузочными вирусами при заражении дискеты. В тоже время изменение загрузочного сектора может быть вызвано форматированием дискеты, изменением ее метки, командой LABEL, записью на нее операционной системы командой SYS. Если монитор сообщит о попытке изменения загрузочного сектора дискеты, проанализируйте ситуацию и решите, не вызвано ли такое изменение вашими действиями. При необходимости проверьте компьютер на заражение вирусами</td></tr>
<tr><td>Write to program files</td><td>Запись данных в выполнимый файл. Эту операцию выполняет большинство файловых вирусов, заражая свои новые жертвы. Тем не менее, выполнение записи в выполнимый файл не может однозначно говорить о том, что компьютер заражен вирусом. Некоторые программы записывают в свой выполнимый файл различную информацию, например, свою конфигурацию. Если монитор сообщит о попытке изменения выполнимого файла, обратите внимание на файл в который выполняется запись. Если вы уверены, что это неизменяемый файл, скорее всего, компьютер заражен вирусом</td></tr>
<tr><td>Read-only attribute change</td><td>Изменение атрибута файла. Некоторые вирусы, заражая выполнимые файлы, предварительно снимают с них атрибут &ldquo;только читаемый файл&rdquo;. Это может сигнализировать о вирусной атаке. Атрибуты файла могут меняться не только вирусами. Например, популярная программа Norton Commander позволяет устанавливать атрибуты файлов произвольным образом</td></tr>
</table>
<p>Приложение Norton AntiVirus Auto-Protect имеет те же недостатки, что и остальные резидентные мониторы. Оно отнимает время на проверку программ во время их запуска, занимает ресурсы компьютера. Монитор может надоесть вам, постоянно сообщая об изменении выполнимых файлов и т. д. Мы рекомендуем пользоваться защитой Norton AntiVirus Auto-Protect во время запуска подозрительных или просто новых программ неизвестного происхождения.</p>
<div class="notes">
	<p><em>Вирус Gloomy.2725</em></p>
	<p><em>Заражает выполнимые файлы в формате COM и EXE, резидентный. При каждом шестнадцатом запуске программы портит случайный сектор. Удаляет с диска файлы с именами "*.MS" и "*.?AS". Заменяет главную загрузочную запись на программу, которая после 511 загрузок компьютера форматирует диск. Содержит тексты "Gloomy Nutcracker(AB5) from the city of Brest(BY) with best wishes!" и "Only the Hope dies last!".</em></p>
</div>
<p>Если на вашем компьютере установлена операционная система Windows 95, вы можете использовать монитор Norton AntiVirus Auto-Protect при запуске новых программ, а в качестве основных антивирусных программ пользоваться комплектом АО &ldquo;ДиалогНаука&rdquo;.</p>
<h3>Антивирус для OS/2 - IBM AntiVirus/2</h3>
<p>Малое количество вирусов, специально созданных для OS/2, не означает что компьютеры с этой операционной системой находятся в безопасности. Так как программы, разработанные для MS-DOS, могут работать в среде OS/2, то обычные вирусы MS-DOS все еще представляют опасность для компьютера, а также для установленного в нем программного обеспечения и, самое главное, опасность для данных пользователя.</p>
<p>В принципе для защиты от вирусов компьютера с установленной на нем операционной системой OS/2 можно применять обычные антивирусные средства, разработанные для операционной системы DOS. Однако в некоторых случаях это программное обеспечение не сможет нормально функционировать. Одной из причин служат отличия файловой системы OS/2. Если на жестких дисках компьютера имеются разделы OS/2 в формате высокопроизводительной файловой системы HPFS, не совместимой с FAT, то антивирусные программы DOS не смогут с ней работать.</p>
<div>
	<img src="img/aaf00/fig3ibm.gif" alt="IBM Anti-virus" align="left" />
	<p>Чтобы защитить компьютеры пользователей OS/2 от вирусов, фирма IBM выпустила в свет антивирус IBM AntiVirus/2, специально предназначенный для этой операционной системы.</p>
</div>
<p>Главное окно антивирусной программы IBM AntiVirus/2 представлено на рисунке 3.40. Как видите, интерфейс антивируса позволяет максимально упростить процедуру проверки компьютера. Для этого достаточно просто нажать кнопку Push here. Простота IBM AntiVirus/2 несомненно относится к достоинствам этого антивируса. Даже пользователь, имеющий поверхностные знания о вирусах, сможет успешно с ним работать.</p>
<div align="center">
	<img src="img/aaf00/fig3ae.gif" alt="Рис. 3.40. Главное окно IBM AntiVirus/2" />
	<p><strong>Рис. 3.40. Главное окно IBM AntiVirus/2</strong></p>
</div>
<p>После запуска антивирус начнет последовательно просматривать файлы на жестком диске компьютера. Если будут обнаружены вирусы, на экране появится диалоговая панель с предложением удалить их (рис. 3.41). Пользователю предлагается несколько вариантов. Он может удалить вирус, восстановив зараженный файл или загрузочный сектор. Для этого следует выбрать из списка зараженные файлы, подлежащие восстановлению и нажать кнопку Disinfect.</p>
<p>Зараженные загрузочные секторы могут быть восстановлены, даже если из них невозможно удалить вирус. При этом зараженный загрузочный сектор заменяется программой IBM AntiVirus/2. Чтобы выполнить замену, нажмите кнопку Replace.</p>
<p>И наконец, зараженный вирусом файл можно удалить, воспользовавшись кнопкой Erase. Файлы, удаленные программой IBM AntiVirus/2, невозможно восстановить даже с помощью специальных программ, поэтому пользуйтесь этой операцией с большой осторожностью. Удаляя зараженный файл, надо иметь в виду, что возможно после этого программное обеспечение компьютера перестанет нормально работать и его придется переустанавливать с дистрибутивов или резервных копий. Проверяйте резервные копии программного обеспечения на заражение вирусами. В противном случае они могут быть испорчены.</p>
<div class="notel">
	<em>Любой из перечисленных способов удаления вируса предпочтительнее работы на компьютере, зараженном вирусом. Никак не проявляя себя внешне, вирус может планомерно уничтожать данные, записанные на диске</em>
</div>
<p>Чтобы отложить лечение зараженных файлов, достаточно нажать кнопку Close и диалоговая панель IBM AntiVirus/2 - Virus infection report будет закрыта, а вы вернетесь в главное окно программы.</p>
<div align="center">
	<img src="img/aaf00/fig3af.gif" alt="Рис. 3.41. Обнаружены вирусы" />
	<p><strong>Рис. 3.41. Обнаружены вирусы</strong></p>
</div>
<p>Программа IBM AntiVirus/2 позволяет задавать различные режимы проверки компьютера. Вы сами можете задать, какие диски и какие файлы будут проверяться. Для этого выберите из главного меню приложения Check строку Check system. На экране появится диалоговая панель Check system for viruses (рис. 3.42).</p>
<p>Органы управления группы позволяют указать диски и каталоги, которые должны быть проверены. Рекомендуется проверять все диски компьютера со всеми каталогами. Если компьютер подключен к сети, появляется возможность поиска вирусов на сетевых дисках.</p>
<p>Если компьютер используется в качестве почтовой станции, можно ограничиться проверкой только почтовых каталогов, в которые поступают новые файлы.</p>
<div align="center">
	<img src="img/aaf00/fig3ag.gif" alt="Рис. 3.42. Диалоговая панель Check system for viruses" />
	<p><strong>Рис. 3.42. Диалоговая панель Check system for viruses</strong></p>
</div>
<p>Все ли файлы будут проверяться, определяется положением переключателя с зависимой фиксацией, размещенного в группе Files to check. Для ежедневной антивирусной профилактики можно проверять только программные файлы. Чтобы сократить время проверки, установите в группе Look for known viruses in переключатель New/changed files. В этом случае будут проверяться только новые и изменившиеся файлы.</p>
<p>Если вирус обнаружен, то лучше всего проверить все файлы в компьютере, включая файлы внутри архивов. Для этого установите переключатели в группе Look for known viruses in, как это показано на рисунке 3.42.</p>
<p>Так как практически все известные вирусы работают в среде MS-DOS, то контролю за программами, работающими в окне DOS, уделяется наибольшее внимание. Чтобы настроить режим контроля за программами MS-DOS, выберите из меню Setup строку Shield DOS. Откроется диалоговая панель Shield DOS (рис. 3.43).</p>
<div align="center">
	<img src="img/aaf00/fig3ah.gif" alt="Рис. 3.43. Диалоговая панель Shield DOS" />
	<p><strong>Рис. 3.43. Диалоговая панель Shield DOS</strong></p>
</div> 
<p>Основные параметры контроля устанавливаются в группе Features, содержащей несколько переключателей, описанных в следующей таблице:</p>
<table summary="" border="1">
<tr><th>Переключатель</th><th>Описание</th></tr>
<tr><td>Prevent common DOS viruses</td><td>Проверять заражение известными вирусами</td></tr>
<tr><td>Use expanded memory</td><td>Задействовать дополнительную память. Переключатель доступен только в том случае, если включен переключатель Prevent common DOS viruses</td></tr>
<tr><td>Warn when viral activity occurs</td><td>Антивирус сообщит пользователю, если вирус проявит активность</td></tr>
<tr><td>Check diskette boot records when used</td><td>Автоматическая проверка загрузочных секторов всех используемых дискет. Достаточно удобная функция. Немного замедляет работу с дискетами, зато позволяет обнаружить дискеты, инфицированные загрузочными вирусами</td></tr>
<tr><td>Check files when opened</td><td>Включает проверку файлов перед их запуском на выполнение</td></tr>
</table>
<p>Мы рассказали, как проверить жесткие диски и диски, доступные через локальную сеть. Для проверки дискет нужно воспользоваться меню Check и выбрать из него строку Check diskettes. На экране появится диалоговая панель Check diskettes (рис. 3.44).</p>
<div align="center">
	<img src="img/aaf00/fig3ai.gif" alt="Рис. 3.44. Диалоговая панель Check diskettes" />
	<p><strong>Рис. 3.44. Диалоговая панель Check diskettes</strong></p>
</div>
<p>Чтобы IBM AntiVirus/2 успешно защищал компьютер от проникновения в него вирусов, необходимо постоянно обновлять вирусные базы данных программы. Это позволит обнаружить новые вирусы, появившиеся с момента выпуска программы. Обновление вирусной базы данных выполняется очень просто. Достаточно выбрать из меню Update строку Update и указать расположение файла с обновлениями вирусной базы данных.</p>
<h2>4 вирусы и локальные сети</h2>
<p>Сетевые технологии внедряются с невиданными темпами. В последнее время большинство фирм, имеющих хотя бы несколько персональных компьютеров, объединяют их в одноранговые локальные сети или локальные сети с выделенными серверами. Широкое распространение локальных сетей вызвано тем, что они позволяют поднять качество работы пользователей на новый уровень, при этом экономятся значительные материальные средства.</p>
<p>Локальные сети позволяют объединить ресурсы многих компьютеров, сделав их доступными для всех пользователей сети.</p>
<p>Например, фирма может приобрести один дорогостоящий лазерный принтер и подключить его к сети. В этом случае любой пользователь сможет печатать на нем так, как будто бы этот принтер подключен к его компьютеру.</p>
<p>Другая возможность, которая появляется при объединении компьютеров в сеть - совместное использование дисковой памяти. Можно установить на одном из компьютеров, подключеном к сети, диск большой емкости (скажем, несколько Гбайт) и предоставить доступ к этому диску для всех или некоторых пользователей. Так как локальные сети передают информацию очень быстро, пользователи могут работать с сетевыми дисками как с локальными, передавая информацию с одного компьютера на другой.</p>
<p>Однако у всякой медали есть обратная сторона. И если пользователи локальной сети могут легко передавать файлы друг другу, то вместе с ними также легко могут распространяться и компьютерные вирусы.</p>
<div class="notes">
	<p><em>Novell.3120, Novell.3128</em></p>
	<p><em>Опасные резидентные вирусы.</em></p>
	<p><em>Если на рабочей станции загружена сетевая оболочка Novell NetWare, вирусы Novell.3120, Novell.3128 предпринимают попытку "взлома" системы защиты файл-сервера.</em></p>
	<p><em>Содержат в своем теле следующие строки:</em></p>
	<p><em>HYPERVISOR, SECURITY_EQUALS, SUPERVISOR, GROUPS_I'M_IN, PASSWORD, IDENTIFICATION, IDENTIFICATIONThe, Hypervisor, LOGIN_CONTROL, SYS:SYSTEM/SYS:LOGIN/, NET$BIND.SYS, NET$BVAL.SYS NET$OBJ.SYS NET$PROP.SYS NET$VAL.SYS, SECURITY_EQUALS, SUPERVISOR, GROUPS_I'M_IN, PASSWORD, IDENTIFICATION, IDENTIFICATIONThe, LOGIN_CONTROL</em></p>
</div>
<p>В этой главе мы расскажем вам, как можно защитить локальную сеть персональных компьютеров от вирусного вторжения. При этом мы начнем с использования чисто административных мер (которые сами по себе являются достаточно эффективными), а закончим описанием методик применения специализированных сетевых антивирусных программ.</p>
<h3>Разновидности локальных сетей</h3>
<p>Так как методы защиты локальных сетей от вирусов сильно зависят от архитектуры сети, перед описанием конкретных приемов защиты и методик мы немного расскажем о том, какие бывают локальные сети.</p>
<p>Все существующие на данный момент локальные сети по своей архитектуре можно разделить на три группы.</p>
<p>К первой группе относятся небольшие одноранговые сети, объединяющие несколько компьютеров. Такие компьютеры называются рабочими станциями сети. В одноранговой сети все рабочие станции равноправны и равнозначны с точки зрения выполняемых ими функций. Каждая рабочая станция может предоставить в распоряжение всех пользователей сети свои ресурсы, например, принтер, диски или факс-модем.</p>
<p>Вторая группа локальный сетей - это сети с так называемым выделенным сервером (в сети может быть несколько выделенных серверов) или централизованные сети. В таких сетях один или несколько компьютеров выделяют свои ресурсы в коллективное пользование. При этом рабочие станции имеют доступ к сетевым принтерам и дискам, подключенным к серверу, но не к принтерам и дискам других рабочих станций. По своей идеологии эта группа сетей противоположна первой, объединяющей ресурсы рабочих станций.</p>
<p>Сети третьей группы на самом деле есть ни что иное, как комбинация одноранговых сетей с сетями второй группы, использующими выделенные серверы. При использовании такого конгламерата получается, с одной стороны, удобное взаимодействие между отдельными рабочими станциями, с другой - возможность обращения к централизованным ресурсам выделенных серверов (например, к серверам баз данных или почтовым серверам).</p>
<h4>Одноранговые сети</h4>
<p>К одноранговым сетям относятся такие средства, как Novell NetWare Lite, Microsoft Windows for Workgroups, Microsoft Windows 95, Lantastic и другие. Программное обеспечение перечисленных выше одноранговых сетей позволяет выделить ресурсы любой рабочей станции в коллективное пользование.</p>
<p>На рис. 4.1 показан пример небольшой одноранговой сети, состоящей из четырех рабочих станций. К одной из рабочих станций подключен лазерный принтер.</p>
<div align="center">
	<img src="img/aaf00/fig41.gif" alt="Рис. 4.1. Пример организации простейшей одноранговой сети" />
	<p><strong>Рис. 4.1. Пример организации простейшей одноранговой сети</strong></p>
</div>
<p>Каждый пользователь сети любого типа имеет свой идентификатор. В крупных сетях идентификаторы пользователей и пароли для подключения к сети назначает специально выделенный для этого человек - системный администратор или, как его еще называют, супервизор сети. В одноранговой сети пользователи сами выбирают и устанавливают свои идентификаторы.</p>
<p>Пользователи одноранговой сети самостоятельно выделяют ресурсы своих рабочих станций в коллективное пользование. При этом они могут указывать разрешенный вид доступа: полный доступ на чтение и запись, доступ только на чтение, никакого доступа. Дополнительно пользователь одноранговой сети может указать, что для получения доступа к ресурсам его рабочей станции другие пользователи сети должны указать пароль.</p>
<p>В примере, приведенном на рис. 4.1, рабочая станция пользователя с идентификатором ivanov имеет доступ к локальным ресурсам (диски a:, b: и c:), и к сетевым ресурсам рабочих станций boss (диск c:) и sizov (диск d:).</p>
<p>Пользователь с идентификатором petrov дополнительно имеет доступ к сетевому принтеру, подключенному к рабочей станции пользователя с идентификатором boss. Что же касается пользователя boss, то в данном случае он не подключен ни к одному сетевому ресурсу.</p>
<p>Как выглядят для пользователя рабочей станции сетевы ресурсы других рабочих станций?</p>
<p>Точно также, как и собственные, локальные.</p>
<p>Этот момент очень важен для понимания способа распространения вирусов в одноранговой сети.</p>
<p>После подключения к сетевому диску, расположенному на другой рабочей станции, пользователь получает в свое распоряжение еще одно дисковое устройство. И хотя физически это устройство может находится в другой комнате или на другом этаже здания, с ним можно работать таким же образом, что и с локальным.</p>
<p>Необходимо, однако, помнить, что если вы записываете файл на такой сетевой диск, он немедленно становится доступным пользователю той рабочей станции, что предоставила этот диск в коллективное пользование.</p>
<p>Аналогично, если вы предоставили свой локальный диск в коллективное пользование, и не установили никакого ограничения доступа на запись, будьте готовы к тому, что на нем в любой момент могут появится новые файлы (а также исчезнуть старые!).</p>
<div class="notel">
	<em>Если сетевой диск или каталог доступен для вас на запись и ваша рабочая станция заражена вирусом, произойдет заражение сетевого диска или каталога</em>
</div>
<p>Поэтому если кто-нибудь запишет на ваш диск зараженную программу и вы запустите на выполнение, вирус может поразить ваш компьютер.</p>
<p>Более того, если вы имеете доступ на запись к другим сетевым дискам, вирус может заразить и те компьютеры, к дискам которого у вас есть доступ. Если же у вас есть доступ на запись ко всем дискам всех рабочих станций сети, начнется локальная вирусная эпидемия.</p>
<h4>Сети с выделенными серверами</h4>
<p>В сетях с выделенными серверами один или несколько компьютеров выполняют специальные функции. Они служат только для выделения ресурсов в коллективное пользование со стороны рабочих станций. Как правило, за экраном выделенных серверов пользователи не работают (часто к компьютерам, работающим в роли серверов, вообще не подключают ни клавиатуру, ни видеомонитор). Это повышает устойчивость сети и производительность серверов.</p>
<p>На рис. 4.2 показана конфигурация локальной сети с одним выделенным сервером.</p>
<div align="center">
	<img src="img/aaf00/fig42.gif" alt="Рис. 4.2. Пример организации сети с выделенным сервером" />
	<p><strong>Рис. 4.2. Пример организации сети с выделенным сервером</strong></p>
</div>
<p>В этой сети имеется три рабочих станции и сервер с именем source. Выделенный сервер создается (или как еще говорят, генерируется) системным администратором. Он определяет имя сервера, а также имена сетевых ресурсов и права доступа к ним.</p>
<p>В данном случае все пользователи имеют доступ к дисковым томам sys и users, а также к очереди печати laserprn. Эти сетевые ресурсы физически расположены на сервере, однако пользователи могут работать с ними почти также, как и с локальными ресурсами.</p>
<p>Сети с выделенными серверами не предоставляют пользователям возможность получения доступа к ресурсам рабочих станций. Поэтому непосредственное взаимодействие пользователей, работающих, например, над одним проектом, в таких сетях затруднено.</p>
<p>В результате для обмена файлами администратор создает на томах сервера каталоги, доступные всем пользователям на чтение и запись. Такие каталоги - потенциальный способ быстрого распространения вирусов по рабочим станциям сети.</p>
<p>Кроме того, на дисках сервера обычно находятся программы, предназначенные для запуска с рабочих станций. Если в них окажется вирус, он также может &ldquo;перескочить&rdquo; на диск рабочей станции, запустившей зараженную программу.</p>
<p>Вирусная защищенность одноранговых сетей зависит от пользователей. В противоположность этому, устойчивость к вирусам сети с выделенными серверами в значительной степени зависит от того, как системный администратор настроил права доступа пользователей к сетевым ресурсам. В нашей книге мы приведем конкретные рекомендации по такой настройке.</p>
<h4>Комбинация одноранговых и централизованных сетей</h4>
<p>Мы уже говорили, что пользователи централизованных сетей чувствуют себя в изоляции друг от друга. Даже если компьютеры находятся рядом, нет никаких средств для того чтобы выделить локальный диск одной рабочей станции в пользование другой.</p>
<p>Тем не менее, у центализованных сетей есть свои преимущества. Они более управляемы, так как находятся в полной власти системного администратора. Так как для сервера используется выделенный компьютер со специализированной сетвой операционной системой, быстродействие централизованной сети оказывается заметно выше, чем одноранговой.</p>
<p>С другой стороны, одноранговые сети очень удобны для объединения рабочих групп пользователей. Современные одноранговые операционные системы, такие как Microsoft Windows 95, содержат в себе средства, позволяющие не просто обмениваться файлами или печатать на принтере соседа, но выполнять коллективную работу над одним документом, передавать по сети содержимое универсального буфера обмена Clipboard, &ldquo;разговаривать&rdquo; с помощью экрана и клавиатуры или даже проводить видеоконференции.</p>
<p>Но системные администраторы не стоят перед выбором: установить им одноранговую сеть или централизованную. Можно использовать обе одновременно, дополняя высокую производительность централизованных сетей удобными средствами взаимодействия пользователей внутри рабочих групп, присущими одноранговым сетям.</p>
<p>На рис. 4.3 показана комбинированная сеть, в которой пользователи имеют доступ не только к сетевым ресурсам сервера, но и к ресурсам других рабочих станций.</p>
<div align="center">
	<img src="img/aaf00/fig43.gif" alt="Рис. 4.3. Комбинирование централизованной и одноранговой сети" />
	<p><strong>Рис. 4.3. Комбинирование централизованной и одноранговой сети</strong></p>
</div>
<p>Следует заметить, что администрирование комбинированных сетей намного сложнее, чем централизованных, так как в системе присутствует такая неуправляемая компонента, как пользователи рабочих станций. Выделяя в коллективное пльзование ресурсы своих рабочих станций, пользователи могут сильно ослабить защиту системы от вирусов и от несанкционированного доступа.</p>
<p>В этом случае администратор должен сочетать меры по обеспечению безопасности централизованной сети с защитой рабочих станций и &ldquo;воспитательной&rdquo; работой среди пользователей.</p>
<h3>Способы распространения вирусов в сетях</h3>
<p>Распространение вирусов в одноранговых, централизованных и комбинированных сетях происходит по разному, однако результат практически всегда один и тот же - программы, расположенные на рабочих станциях и дисках сервера оказываются зараженными.</p>
<p>Рассмотрим особенности распространения вирусов в перечисленных выше типах компьютерных сетей.</p>
<h4>Вирусы в одноранговых сетях</h4>
<p>Распространение вирусов в одноранговых сетях возможно благодаря тому, что пользователи предоставляют доступ на запись к дискам своих рабочих станций.</p>
<p>Все происходит очень просто.</p>
<p>Рано или поздно один из пользователей приносит дискету, зараженную загрузочным или файловым вирусом. При активизации вирус просматривает все диски, доступные на запись, и заражает расположенные там программы.</p>
<p>Некоторые загрузочные вирусы, которые распространяются только через загрузочные секторы локальных дисков, не могут перейти через сеть на диски другой рабочей станции, даже если к этому диску имеется доступ на запись. Дело здесь в том, что для записи в загрузочные секторы необходимо использовать систему ввода-вывода, расположенную в BIOS, а эта система &ldquo;не умеет&rdquo; работать с секторами сетевых дисков. Способ записи вируса в загрузочные секторы, основанный на непосредственной работе с дисковым контроллером, также не подходит для сетевого диска, так как контроллер подключен к другой станции и его порты ввода-вывода абсолютно недоступны.</p>
<p>Однако комбинированные файлово-загрузочные вирусы закрепляются в загрузочных секторах локального диска рабочей станции и заражает файлы, расположенные на всех дисках, доступных для записи. В том числе, разумеется, и файлы, расположенные на сетевых дисках, принадлежащих другим рабочим станциям.</p>
<p>Если пользователь предоставил к своим дискам доступ только на чтение, но на них записаны зараженные программы, то другие пользователи смогут запустить такую программу. В результате этого их локальные диски окажутся зараженными.</p>
<h4>Вирусы в централизованных сетях</h4>
<p>Несмотря на то что в централизованных сетях пользователи не имеют доступа к ресурсам других рабочих станций, имеется по крайней мере две возможности для распространения вирусов.</p>
<p>Во-первых, вирус может попасть с одной из рабочих станций на диски сервера, доступные для записи, заразив записанные там программы. Когда пользователь другой рабочей станции запустит зараженную программу непосредственно с диска сервера или вначале перепишет ее на локальный диск и затем запустит ее там, рабочая станция окажется зараженной. Таким образом, через некоторое, возможно очень небольшое время, вирус попадет с сервера на вс рабочие станции сети и заразит их.</p>
<p>Во-вторых, существует принципиальная возможность создания такого вируса, который сумеет подобрать пароль системного администратора и записать себя даже на диски, защищенные от записи. И все это несмотря на то, что современые сетевые операционные системы имеют достаточно мощную и надежную систему разграничения доступа. Однако известно: что один человек сделал, другой может сломать.</p>
<p>Несмотря на то, что система паролей потенциально обладает высокой устойчивостью, усилия пользователей могут свести всю защиту на нет. Например, для того чтобы облегчить себе жизнь, они не задают пароли вообще или указывают в качестве пароля свое имя или фамилию, год рождения и т. п.</p>
<div class="notel">
	<em>Следите за тем, чтобы пользователи задавали пароли для подключения к сети</em>
</div>
<p>Между тем существует список наиболее распространенных паролей, который доступен через электронные доски объявлений и, конечно же, имеется в распоряжении разработчиков вирусов. Таким образом, при подборе пароля вирусу не нужно перебирать громадное количество случайно выбранных комбинаций символов, а достаточно пройтись по указанному списку. Вероятность успеха при этом достаточно велика.</p>
<div class="notes">
	<p><em>Login-2971/2967, Login-2972/2968</em></p>
	<p><em>Резидентный вирус.</em></p>
	<p><em>Заражает программы с расширением имени COM и EXE.</em></p>
	<p><em>При заражении COM-файла записывает четыре лишних байта. Плагиат на ставший классическим вирус M2C. Содержит многочисленные куски вируса M2C, ставшие после модификации &ldquo;оригинального варианта&rdquo; абсолютно бессмысленными. Собственное творчество автора направлено на определение чужих паролей в локальной сети. Для этого во время работы программы LOGIN.EXE перехавтываются коды символов, введенных с клавиатуры, которые затем накапливаются. В результате эти коды оказываются в  зараженных файлах.</em></p>
</div>
<p>Правильно настроив права доступа пользователей и саму систему управления доступом, системный администратор может значительно уменьшить опасность поражения вирусами дисков сервера. Существенную помощь в защите сервера могут оказать специальные антивирусные программы и аппаратные средства защиты, которые мы рассмотрим в нашей книге.</p>
<h4>Вирусы в комбинированных сетях</h4>
<p>Как и следовало ожидать, в комбинированных сетях вирусы могут распространяться как непосредственно между рабочими станциями, так и через диски серверов. При этом вирусы могут попадать на диски, доступные для записи или же они могут предпринимать попытки подбора паролей для получения доступа к дискам, защищенным от записи.</p>
<p>Взяв на себя ответственность по сопровождению комбинированной сети, для предотвращения возникновения вирусной эпидемии системный администратор должен защищать от вирусов не только сервер, но и рабочие станции.</p>
<h4>Вирус в оперативной памяти сервера</h4>
<p>Так как вирус является программой, для активизации он должен быть загружен в оперативную память, после чего вирусу должно быть передано управление.</p>
<p>Когда вирус &ldquo;живет&rdquo; на рабочей станции, так и происходит. Пользователь запускает зараженную программу или загружает операционную систему с дискеты, зараженной загрузочным вирусом, в результату чего вирус тем или иным способом оказывается в оперативной памяти рабочей станции.</p>
<p>Если же пользователь запускает зараженную программу непосредственно с диска сервера, вирус опять-таки попадает в оперативную память рабочей станции, с которой был выполнен запуск.</p>
<p>Таким образом, обычный вирус, не рассчитанный специально для работы под управлением сетевой операционной системы, может изменить только содержимое файлов, расположенных на доступных для записи дисках. Но он <em>не может</em> изменить загрузочные секторы на дисках сервера, так как для этого вирус должен попасть в оперативную память сервера как программа и получить управление.</p>
<p>Тем не менее, возможно создание таких вирусов, которые запускают себя как процесс в среде сетевой операционной системы. Такие вирусы наиболее опасны, так как им доступны все ресурсы сервера.</p>
<p>Например, взломав тем или иным способом пароль супервизора, вирус может записать себя в системный каталог сервера Novell NetWare в виде nlm-программы и указать ее имя в файле автоматического конфигурирования startup.ncf. При этом вирусная nlm-программа будет получать управление каждый раз при загрузке сервера.</p>
<p>Современные сетевые операционные системы, такие например, как Microsoft Windows NT, допускают удаленный запуск процедур. Эта возможность также может быть использована специализированными сетевыми вирусами для распространения или для нанесения повреждений.</p>
<h3>Защита от вирусов одноранговых сетей</h3>
<p>В этом разделе мы рассмотрим методику защиты от вирусов наиболее распространенных одноранговых сетей Novell NetWare Lite,&nbsp;Microsoft AddOn for Workgroups, Microsoft Windows for Workgroups версии 3.11 и Microsoft Windows&nbsp;95.</p>
<p>Для защиты одноранговых сетей необходимо использовать комбинацию административных мер со специализированным антивирусным программным обеспечением.</p>
<p>Задача защиты одноранговой сети может быть разделена на две задачи:</p>
<ul>
	<li>защита рабочих станций от проникновения в них вирусов извне;</li>
	<li>предотвращение быстрого и бесконтрольного распространения вирусов с одной рабочей станции на остальные.</li>
</ul>
<p>Что касается способов решения первой задачи, то тут можно принимать те же меры, что и для защиты компьютеров, не подключенных к сети. Это установка специализированного ативирусного программного обеспечения, отключение НГМД (непопулярная, но достаточно эффективная мера), жесткий контроль за новым программным обеспечением с помощью антивирусных программ (даже если они не предназначены специально для работы в сети).</p>
<div class="notel">
	<em>Проверяйте все новые программы, перед тем как устанавливать их в сетевые каталоги. Используйте для этого специальные антивирусные средства</em>
</div>
<p>Одноранговые сети обычно не позволяют создавать бездисковые рабочие станции, так как соответствующие сетевые программы должны находиться на локальных дисках рабочих станций. Однако администратор сети (или кто-то из технического персонала) может отключить НГМД или вовсе изъять их из компьютера. В этом случае пользователь не сможет вставить никакую дискету в компьютер, в том числе дискету с зараженной программой.</p>
<p>Надежнее всего отключить НГМД аппаратно, однако для такого отключения нужно открывать корпус компьютера. В качестве альтернативы мы предлагаем отключение при помощи программы BIOS Setup. Дополнительно администратор сети должен назначить пароль для запуска этой программы, чтобы пользователь не смог самостоятельно подключить НГМД.</p>
<div class="notel">
	<em>Бездисковые рабочие станции или станции с отключенными накопителями на гибких магнитных дисках представляют собой серьезное препятствие для проникновения вирусов в сеть</em>
</div>
<p>Казалось бы, работать на компьютере с отключенным НГМД неудобно, но это только на первый взгляд. К тому же все зависит от того, какая именно работа выполняется. Если несколько пользователей обращаются к общей базе данных, расположенной на диске одной из рабочих станций, записывая в нее информацию или извлекая ее оттуда с целью просмотра или печати, НГМД не нужен.</p>
<p>Другое преимущество рабочих станций с отключенными НГМД - невозможность кражи секретной или конфиденциальной информации недобросовестными сотрудниками. Здесь только нужно учесть, что в настоящее время появились дисковые устройства, подключаемые к параллельному или последовательному порту компьютера. Их можено использовать для чтения или записи. Кроме того, к указанным выше портам нетрудно подключить малогабаритный компьютер типа Notebook, организовав несанкционированную передачу данных с помощью, например, такой распространенной программы, как Norton Commander. Однако обсуждение проблем обеспечения безопасности такого рода выходит за рамки нашей книги, посвященной борьбе с вирусами. Тем не менее, в ответственных случаях можно отключить неиспользуемые параллеьные и последовательные порты с помощью все той же программы BIOS Setup. Практически все современные версии BIOS позволяют это сделать.</p>
<p>Вторая задача (предотвращение распространения вируса в сети), решается прежде всего правильной организацией доступа пользователей к сетевым ресурсам. Существенную помощь в этом также окажут антивирусные средства, позволяющие обнаружить вирус на ранней стадии его появления,  предотвратив дальнейшее распространение.</p>
<p>Основное правило распределения доступа заключается в том, что не следует предоставлять пользователям права доступа, которые не нужны им для выполнения работы.</p>
<div class="notel">
	<em>Никогда и ни при каких обстоятельствах не предоставляйте обычным пользователям права записи во все сетевые каталоги и особенно в корневые каталоги сетевых томов</em>
</div>
<p>Администратор должен тщательно продумать права доступа для сетевых каталогов. При этом следует по возможности не предоставлять пользователям права на запись, особенно для каталогов, содержащих загрузочные файлы программ. Очевидно, если пользователь имеет права на запись в сетевой каталог, содержащий программы, то при возникновении на его рабочей станции вирусов, они заразят файлы в сетевом каталоге.</p>
<p>Приведем конкретные рекомендации по административным мерам защиты наиболее распространенных одноранговых сетей.</p>
<h4>Novell NetWare Lite</h4>
<p>Сеть Novell NetWare Lite достаточно распространена ввиду простоты установки и сопровождения. Эта сеть нетребовательна к ресурсам и неплохо работает даже на дешевых компьютерах с процессором i80286 и объемом оперативной памяти 1 Мбайт. Сетевое программное обечпечение Novell NetWare Lite поставляется на дискетах. Для каждой рабочей станции вы должны приобрести отдельный комплект дискет.</p>
<p>Полностью процедура установки и настройки сети Novell NetWare Lite приведена в 4 томе нашей серии книг &ldquo;Персональный компьютер. Шаг за шагом&rdquo;, который называется &ldquo;Сети компьютеров в вашем офисе&rdquo;. Однако для удобства мы расскажем о том, как в сети Novell NetWare Lite выполняются процедуры создания пользователей и определение прав доступа к сетевым ресурсам. Именно эти вопросы наиболее важны для организации защиты от вирусов административными методами.</p>
<p>После установки Novell NetWare Lite на диске C: рабочей станции создается каталог NWLITE, в котором есть два подкаталога с именами NLCNTL и TUTOR, а также файлы са&shy;мой оболочки NetWare Lite.</p>
<p>В каталоге C:\NWLITE имеется файл startnet.bat, который предназначен для запуска сетевой оболочки. Вот его содержимое:</p>
<pre>
	LSL
	NE2000
	IPXODI
	A
	SHARE
	SERVER
	CLIENT
</pre>
<p>В этом файле запускается несколько резидентных программ. Вначале запускается программа lsl.com. Эта программа реализует так называемую спецификацию открытого интерфейса связи (Open Link Interface - OLI) - стандартную спецификацию для одновременной работы в одной сети нескольких коммуникационных протоколов. Программа lsl.com служит связующим звеном между драйвером сетевого адаптера (в нашем случае драйвером является программа ne2000.com) и коммуникационным протоколом IPX.</p>
<p>После lsl.com загружается драйвер сетевого адаптера ne2000.com, затем программа ipxodi.com. Программа ipxodi.com реализует коммуникационный протокол IPX (параметр A указывает, что программа ipxodi.com должна загружать модули, отвечающие только за базовые возможности IPX).</p>
<p>Далее происходит запуск утилиты MS-DOS share.exe. Эта утилита нужна для безопасной работы с файлами в мультипользовательском режиме.</p>
<p>В конце файла startnet.bat запускаются программы server.exe и client.exe. Если рабочая станция должна выполнять только функции сервера, не запускайте программу client.exe, если только клиента - не запускайте программу server.exe.</p>
<p>Файл startnet.bat запускается, как правило, автоматически при загрузке операционной системы MS-DOS из файла autoexec.bat, однако пользователи могут запускать его вручную при необходимости.</p>
<p>Для того чтобы защитить рабочую станцию от нападения вирусов, полученых из сети, следует выделять дисковые ресурсы своей станции по возможности только для чтения. Особенно это относится к каталогам, в которых находятся загрузочные файлы программ.</p>
<p>Если пользователь зараженной рабочей станции имеет доступ к вашим дискам только на чтение, такой же доступ есть и у вирусов. Поэтому он не повредит ваши файлы.</p>
<p>Для выделения ресурсов рабочей станции в коллективное пользование и управления доступом других пользователей к этим ресурсам вы должны запустить программу net.exe, которая расположена в каталоге NWLITE. В ответ на сообщение следует ввести имя пользователя - SUPERVISOR.</p>
<p>При этом вы будете подключены к сети как системный администратор. На экране появится меню утилиты net.exe (рис. 4.4).</p>
<div align="center">
	<img src="img/aaf00/fig44.gif" alt="Рис. 4.4. Главное меню утилиты net.exe" />
	<p><strong>Рис. 4.4. Главное меню утилиты net.exe</strong></p>
</div>
<p>С помощью этого меню вы можете, в частности, создавать сетевые каталоги, подключать к сети новых пользователей и определять их права доступа.</p>
<p>Прежде всего надо создать пользователей и определить их права. Для этого выберите в меню строку Supervise the network (управление сетью). Появится меню Supervise the network (рис. 4.4), в котором вам надо выбрать строку Users.</p>
<div align="center">
	<img src="img/aaf00/fig44b.gif" alt="Рис. 4.4. Меню Supervise the network" />
	<p><strong>Рис. 4.4. Меню Supervise the network</strong></p>
</div>
<p>После этого на экране появится меню Users. В нем будет только один пользователь с именем SUPERVISOR. Нажмите клавишу &lt;Insert&gt; и введите имя нового пользователя. Имя должно состоять не более чем из 15 символов. Завершите ввод клавишей &lt;Enter&gt;.</p>
<p>Затем на экране появится диалоговая панель Account Information for User..., где вместо многоточия будет указано имя создаваемого пользователя. В поле User's full name задайте полное имя пользователя.</p>
<p>Содержимое поля Supervisor privileges определяет, обладает ли пользователь привилегиями супервизора сети. Если в этом поле находится значение Yes, пользователь обладает правами супервизора.</p>
<p>Обычно в небольшой сети, состоящей из нескольких компьютеров, для упрощения обслуживания сети всем пользователям предоставляются права права супервизора. Однако с точки зрения устойчивости сети к вирусам этого нельзя делать ни в коем случае. Помните - права пользователя автоматически переходят к вирусу.</p>
<div class="notel">
	<em>Предоставляйте пользователям минимально возможные права доступа</em>
</div>
<p>В поле Password вы сможете задать пароль для пользователя. Если пользователь забыл свой пароль, супервизор может его изменить, нажав в поле Password два раза клавишу &lt;Enter&gt;. Не пренебрегайте паролем, особенно для дисков и каталогов, доступных на запись. Несмотря на потенциальную возможность создания вирусов, &ldquo;подсматривающих&rdquo; или подбирающих пароль, большинство вирусов не умеют этого делать.</p>
<p>Подготовив все поля, нажмите клавишу &lt;Esc&gt; и подтвердите свое желание сохранить сделанные изменения. Для этого выберите строку Yes в появившемся меню Save changes.</p>
<p>Предоставляя доступ другим рабочим станциям к собственным каталогам и дискам, не забудьте указать минимально необходимые права доступа.</p>
<p>Для создания сетевых каталогов, доступных другим пользователям, вы должны запустить программу net.exe и войти в сеть как супервизор. В главном меню утилиты выберите строку Supervise the network. В появившемся меню выберите строку Network directories. Вы увидите список существующих сетевых каталогов Network Directory Server (рис. 4.5).</p>
<div align="center">
	<img src="img/aaf00/fig45.gif" alt="Рис. 4.5. Список существующих сетевых каталогов" />
	<p><strong>Рис. 4.5. Список существующих сетевых каталогов</strong></p>
</div>
<p>Для создания нового каталога нажмите клавишу &lt;Insert&gt;. Появится меню серверов NetWare Lite. Выберите нужный вам сервер и нажмите клавишу &lt;Enter&gt;. Вам будет предложено ввести имя сетевого которое должно состоять не более чем из 15 символов.</p>
<p>После ввода имени каталога вы окажетесь в диалоговой панели, с помощью которой нужно описать создаваемый сетевой каталог (рис. 4.6).</p>
<div align="center">
	<img src="img/aaf00/fig46.gif" alt="Рис. 4.6. Описание создаваемого сетевого каталога" />
	<p><strong>Рис. 4.6. Описание создаваемого сетевого каталога</strong></p>
</div>
<p>В поле Default access rights укажите права доступа к каталогу, присваиваемые пользователям по умолчанию. Вы можете указать ALL для предоставления полного доступа к каталогу (чтение и запись), READ для разрешения доступа на чтение и NONE для полного запрещения доступа к каталогу. По возможности избегайте предоставления полного доступа.</p>
<p>Если некоторые из пользователей должны иметь в данном каталоге права, отличные от прав, заданных по умолчанию, воспользуйтесь полем Users with nondefault rights.</p>
<h4>Microsoft AddOn for Workgroups</h4>
<p>Сеть Microsoft AddOn for Workgroups, так же как и сеть Novell NetWare Lite, позволяет объединить компьютеры с процессором i80286 и с объемом оперативной памяти 1 Мбайт. Дополнительно программное обечпечение Microsoft AddOn for Workgroups позволяет получить доступ рабочим станциям MS-DOS к серверам на базе Microsoft Windows for Workgroups и Windows NT. В силу этого сети Microsoft AddOn for Workgroups получили достаточно широкое распространение. Полное описание приемов работы в среде этой сети вы найдете приведена в 4 томе нашей серии книг &ldquo;Персональный компьютер. Шаг за шагом&rdquo;.</p>
<p>Методика защиты этой сети от вирусов полностью аналогична методике защиты сети Novell NetWare Lite. Рабочие станции сети должны быть защищены обычными несетевыми антивирусными средствами, такими, например, как антивирусный комплект АО &ldquo;ДиалогНаука&rdquo; или аппаратное устройство защиты Sheriff. Кроме того, необходимо ограничить доступ пользователей к сетевым каталогам, особенно на запись.</p>
<p>Отдавая в коллективное пользование локальный диск или каталог рабочей станции, вы должны запустить программу net.exe с параметром share:</p>
<pre>net share Name=Drive:[\Path]</pre>
<p>Параметр Name определяет имя, под которым пользователи сети увидят ваш каталог. Нужно также указать локальный диск Drive, на котором этот каталог расположен, и путь к каталогу Path.</p>
<p>Например, для того чтобы предоставить доступ к каталогу d:\src, можно использовать следующую команду:</p>
<pre>net share source=d:\src</pre>
<p>Полный формат параметров команды share для распределения дисков представлен ниже:</p>
<pre>net share ShareName=Drive:[Path][/remark:&rdquo;Text&rdquo;][/saveshare:no] [/read[:Pwd1]][/full[:Pwd2]]</pre>
<p>Здесь ShareName - сетевое имя, которое будет видно пользователям других рабочих станций.</p>
<p>Дополнительно при распределении диска или каталога вы можете указать параметры /remark, /saveshare:no, /read и /full.</p>
<p>Параметр /remark позволяет задать произвольный текстовый комментарий Text, описывающий ресурс. Если указать параметр /saveshare:no, каждый раз при запуске рабочей станции вам придется заново отдавать ее ресурсы в коллективное пользование запуском программы net.exe с параметром share.</p>
<p>Вы можете ограничить доступ пользователей (и, соответственно, вирусов) к дискам вашей рабочей станции, указав при распределении параметры /read и /full с паролем или без пароля.</p>
<p>По умолчанию предоставляется доступ только на чтение (которому соответствует параметр /read), причем без пароля. Для предоставления полного доступа к диску или каталогу вы должны указать параметр /full (с паролем или без).</p>
<p>Например, следующая команда предоставляет полный доступ к каталогу d:\src только после предъявления пароля:</p>
<pre>net share source=d:\src /remark:&rdquo;Source Code Lib&rdquo; /full:pwdfull</pre>
<h4>Microsoft Windows for Workgroups версии 3.11</h4>
<p>Одноранговая сеть Microsoft Windows for Workgroups версии 3.11 также получила широкое распространение, так как она обеспечивает удобные средства интеграции рабочих групп пользователей, встроенные непосредственно в графическую среду Windows.</p>
<p>Приложение File Manager, которое поставляется в составе дистрибутива Microsoft Windows for Workgroups, позволяет выделять ресурсы рабочей станции в коллективное пользование и подключаться к сетевым ресурсам. Для этого достаточно просто нажать нужную кнопку на полосе инструментальных средств Toolbar (рис. 4.7).</p>
<div align="center">
	<img src="img/aaf00/fig47.gif" alt="Рис. 4.7. Главное окно приложения File Manager операционной системы Microsoft Windows for Workgroups версии 3.11" />
	<p><strong>Рис. 4.7. Главное окно приложения File Manager операционной системы Microsoft Windows for Workgroups версии 3.11</strong></p>
</div>
<p>Ниже мы перечислили назначение некторых кнопок, имеющих в основном отношение к дисковым сетевым ресурсам.</p>
<table summary="" border="1">
<tr><th>Кнопка</th><th>Описание</th></tr>
<tr><td><img src="img/aaf00/fig4m1.gif" alt="" /></td><td>Подключение к сетевому диску (т. е. к диску, расположенному на другой рабочей станции сети)</td></tr>
<tr><td><img src="img/aaf00/fig4m2.gif" alt="" /></td><td>Отключение от сетевого диска</td></tr>
<tr><td><img src="img/aaf00/fig4m3.gif" alt="" /></td><td>Предоставление локального диска рабочей станции в коллективное пользование. Диск будет доступен для всех пользователей сети (возможно, после предъявления пароля)</td></tr>
<tr><td><img src="img/aaf00/fig4m4.gif" alt="" /></td><td>Отмена коллективного доступа к диску</td></tr>
<tr><td><img src="img/aaf00/fig4m5.gif" alt="" /></td><td>Запуск приложения Microsoft Antivirus for Windows</td></tr>
</table>
<p>Обратите внимание, что среди других кнопок есть кнопка для запуска антивирусного приложения Microsoft Antivirus for Windows. Это приложение поставляется в составе MS-DOS.</p>
<div>
	<img src="img/aaf00/fig4m3.gif" alt="" align="left" />
	<p>Для предоставления локального диска или каталога в коллективное пользование нажмите соответсвующую кнопку.</p>
</div>
<p>После этого на экране появится диалоговая панель Share Directory (рис. 4.8).</p>
<div align="center">
	<img src="img/aaf00/fig48.gif" alt="Рис. 4.8. Диалоговая панель Share Directory, предназначенная для выделения диска или каталога в коллективное пользование" />
	<p><strong>Рис. 4.8. Диалоговая панель Share Directory, предназначенная для выделения диска или каталога в коллективное пользование</strong></p>
</div>
<p>В поле Share Name следует задать произвольное имя, под которым этот каталог будет виден другим пользователям.</p>
<p>Группа переключателей Access Type позволит вам определить права доступа к создаваемому сетевому ресурсу.</p>
<p>Если включить переключатель Read-Only, пользователи получат доступ только на чтение. Включив переключатель Full, вы можете предоставить полный доступ (на чтение и на запись). И, наконец, если включить переключатель Depends on Password, вы сможете задать два пароля: один для доступа только на чтение, другой - для полного доступа. Те пользователи, которые знают только пароль на чтение (а также вирусы, не умеющие подбирать пароль), не смогут использовать сетевой диск для записи.</p>
<div class="notel">
	<em>Не следует предоставлять пользователям права доступа в сетевые каталоги, соедржащие исполнимые файлы или дистрибутивы программных продуктов</em>
</div>
<p>Пароль указывается в группе полей Passwords. В зависимости от установки переключателей Access Type в этой группе может быть одно или два поля для ввода, соответственно, пароля на чтение и на запись. После ввода следует подтвердить пароли, указав их еще раз в диалоговой панели Confirm New Password (рис. 4.9).</p>
<div align="center">
	<img src="img/aaf00/fig49.gif" alt="Рис. 4.9. Повторный ввод пароля для проверки" />
	<p><strong>Рис. 4.9. Повторный ввод пароля для проверки</strong></p>
</div>
<h4>Microsoft Windows 95</h4>
<p>Новая операционная система Microsoft Windows 95 предназначена для замены операционных систем Microsoft Windows версии 3.1 и Microsoft Windows for Workgroup версии 3.11. В нее встроены средства организации одноранговой сети, поэтому любой пользователь может выделить ресурсы своей станции в коллективное пользование.</p>
<p>Способ такого выделения очень прост - достаточно сделать щелчок правой клавишей мыши по пиктограмме ресурса и в появившемся контекстном меню выбрать строку Sharing.</p>
<p>На экране появится блокнот, в котором нас будет интересовать страница Sharing, показанная (для диска C:) на рис. 4.10.</p>
<div align="center">
	<img src="img/aaf00/fig4a.gif" alt="Рис. 4.10. Страница Sharing, с помощью которой можно задать атрибуты доступа для сетевого каталога или диска" />
	<p><strong>Рис. 4.10. Страница Sharing, с помощью которой можно задать атрибуты доступа для сетевого каталога или диска</strong></p>
</div>
<p>Для ограничения доступа к диску следует воспользоваться переключателями из группы Access Type. Вы можете предоставить полный доступ к ресурсу (включив переключатель Full), только на чтение (при помощи переключателя Read-Only) или в зависимости от пароля (Depends on Password). Перечисленные варианты доступа полностью соответствуют тем, что используются в Microsoft Windows for Workgroups.</p>
<p>Если вы собираетесь разрешить доступ к своему диску на запись, укажите в поле Full Access Password пароль. В противном случае вирусы смогут беспрепятственно проникнуть на ваш диск с любой рабочей станции.</p>
<p>Заметим, что если пользователь получил доступ к вашему диску на запись, предоставив необходимый пароль, а затем запустил зараженную программу, вирус &ldquo;перескочит&rdquo; на ваши диски. Поэтому чисто административные меры борьбы с вирусами необходимо комбинировать с использованием специального антивирусного программного обеспечения, установленного на все рабочие станции одноранговой сети.</p>
<h3>Защита централизованных сетей</h3>
<p>В централизованных сетях с файл-серверами Novell NetWare или IBM Lan Server необходимо защищать от проникновения вирусов, с одной стороны, рабочие станции, с другой - файл-серверы.</p>
<p>Что касается методов защиты рабочих станций, то они уже были нами описаны. Здесь вы можете использовать ту же методику, что и для защиты персональных компьютеров, не объединенных в сеть.</p>
<div class="notes">
	<p><em>Novell-708</em></p>
	<p><em>Резидентный вирус.</em></p>
	<p><em>Заражает только программы с расширением имени COM. Пытается обращаться к программному интерфейсу Novell NetWare.</em></p>
</div>
<p>Защита файл-сервера может выполняться как административными мерами, так и с помощью специальных антивирусных программ, работающих в среде сетевой операционной системы.</p>
<p>Административные меры подразумевают правильное распределение прав доступа пользователей к сетевым каталогам, расположенным на дисках сервера. Необходимо также принимать специальные меры предосторожности при подключении к сети пользователей с правами администратора. Последнее особенно важно из-за того что администраторы имеют права на запись в любые каталоги, поэтому если на рабочей станции администратора находится активный вирус, он может заразить все программные файлы, расположенные на сервере.</p>
<p>В настоящее время несколько производителей предлагают специальные антивирусные программы, которые запускаются на файл-сервере и работают, как правило, в фоновом режиме, постоянно проверяя сетевые каталоги. Дополнительно такие программы могут сканировать все файлы, которые записываются на диски сервера или читаются с них, однако такой режим работы, очевидно, уменьшает производительность системы. Используя программные средства защиты от вирусов, необходимо постоянно пополнять базу данных вирусов или получать новые версии антивирусных средств. В противном случае возможно поражение сервера новым вирусом, информация о котором раньше отсутствовала у разработчика антивирусных средств.</p>
<div class="notes">
	<p><em>Novell-3120</em></p>
	<p><em>Резидентный вирус с элементами стелс-технологии.</em></p>
	<p><em>Заражает программы с расширением имени COM и EXE. Пытается обращаться к программному интерфейсу Novell NetWare.</em></p>
</div>
<p>Аппаратные средства защиты (и только они) помогут вам в том случае, если вирус сумел &ldquo;подсмотреть&rdquo; или подобрать пароль системного администратора. Например, вы можете защитить аппаратно тома сервера от записи. Если в этом случае вирус (или системный администратор) попытается изменить содержимое какого-либо файла на таком томе, защита сработает и сервер будет заблокирован.</p>
<p>Далее мы рассмотрим особенности защиты от вирусов сетей Novell NetWare и серей с серверами IBM LAN Server.</p>
<h4>Защита сети Novell NetWare версии 3.12</h4>
<p>Сеть Novell NetWare версии 3.12 очень распространена в России благодаря ее высокой надежности и быстродействию, а также удобстве в администировании. В 3 томе серии книг &ldquo;Персональный компьютер. Шаг за шагом&rdquo; мы подробно рассмотрели процесс ее установки, настройки и использования, поэтому здесь мы ограничимся только самыми минимальными сведениями, нужными для организации защиты серверов Novell NetWare и всей сети в целом от вирусов.</p>
<h5>Пользователи сети Novell NetWare и их права</h5>
<p>Пользователей сети Novell NetWare можно разделить на обычных, администраторов групп и системных администраторов (супервизоров).</p>
<p>Системный администратор обладает неограниченными правами, в то время как администратор групп может подключать к серверу новых пользователей (или создавать новые группы пользователей). Администратор групп может наделять правами созданные им группы пользователей и отдельных пользователей в рамках прав, предоставленных ему системным администратором. Группы могут объединять любых пользователей, имеющих сходные права доступа к тем или иным сетевым ресурсам.</p>
<p>Именно системный администратор должен определять стратегию распределения прав в сети. При этом, если в сети много пользователей и групп, он может делегировать часть своих прав администраторам групп. На системном администраторе должна лежать и работа по организации защиты сети от вирусов.</p>
<h5>Предоставление доступа к сетевым каталогам</h5>
<p>Основной принцип, которому должен следовать системный администратор, вырабатывая стратегию предоставления доступа заключается в том, что пользователям не следует предоставлять прав, которые не нужны им для работы. Если следовать этому принципу, можно избежать многих неприятностей, связаных с потерей или искажением данных, хранящихся на сервере. В том числе, с потерями или искажениями, вызванными вирусами.</p>
<p>Кроме этого, следует убедиться в том, что те права, которые запрашиваются пользователями, действительно им нужны. Вполне возможно, что в ряде случаев хватило бы и меньших прав.</p>
<p>Наиболее грубая ошибка системного администратора заключается в предоставлении кому бы то ни было прав на запись в системные каталоги LOGIN, PUBLIC, SYSTEM. К каталогу SYSTEM никто, кроме системного администратора, не должен иметь доступ ни на чтение, ни тем более на запись.</p>
<div class="notel">
	<em>Никогда не предоставляйте пользователям права доступа на запись в каталоги LOGIN, PUBLIC, SYSTEM. Обычный пользователь не должен также иметь никаких прав на доступ к каталогу SYSTEM</em>
</div>
<p>Представьте себе, что системный администратор предоставил всем пользователям право записи в каталог LOGIN. Если на одной из рабочих станций появится активный вирус, он заразит файл LOGIN.EXE, который используется для подключения пользователей к сети. Теперь когда любой другой пользователь подключится к сети или просто просмотрит список серверов при помощи программы SLIST.EXE, расположенной в том же каталоге, вирус заразит его рабочую станцию. Через некоторое (очень небольшое) время вирусная эпидемия охватит всю сеть.</p>
<p>Если же к сети подключится системный администратор, имеющий права на запись во все сетевые каталоги, вирус моментально проникнет на все диски файл-сервера.</p>
<div class="notel">
	<em>Системный администратор должен подключаться к сети только с проверенной на отсутствие вирусов рабочей станции, иначе вирус проникнет во все сетевые каталоги</em>
</div>
<p>Описанная выше ситуация не является гипотетической. Мы столкнулись с ней в одной фирме, которая вызывала нас для антивирусной профилактики через службу &ldquo;Компьютерной скорой помощи&rdquo;&reg;, которая создана в АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>Случай с каталогом LOGIN можно обобщить. Любой программный файл, доступный для записи, служит потенциальным средством распространения вируса в сети. Поэтому мы настоятельно рекомендуем защищать от записи все каталоги, содержащие программные файлы.</p>
<p>Лучше всего если системный администратор выделит для данных, которые изменяются пользователями (например, для файлов баз данных) отдельные каталоги. В этих каталогах пользователи могут иметь права доступа на запись. Системный администратор должен следить за тем, чтобы в таких каталогах не появлялись программные файлы, так как они могут оказаться зараженными вирусами.</p>
<p>В последнее время появились вирусы, поражающие файлы документов, например, doc-файлы, создаваемые текстовым процессором Microsoft Word for Windows. По большей части системный администратор не может хранить такие файлы в защищенных от записи каталогах, так как пользователи постоянно редактируют свои документы. В этом случае необходимо применять специальные антивирусные средства на рабочих станциях, например, Doctor Web for WinWord.</p>
<div class="notes">
	<p><em>Novell-528</em></p>
	<p><em>Резидентный вирус.</em></p>
	<p><em>Заражает только программы с расширением имени COM.</em></p>
	<p><em>При завершении программы дважды исполняется функция программного интерфейса Novell NetWare "Add Trustee to directory" с именами "WORK:" и "SYS:". Эта функция предназначена для добавления прав доступа к сетевым каталогам.</em></p>
</div>
<p>Для предоставления прав доступа к сетевым каталогам системный администратор должен запустить программу SYSCON.EXE, которая находится в каталоге PUBLIC. Детальное описание этого процесса выходит за рамки нашей книги, однако мы сделаем некоторые замечания. При необходимости вы можете обратится к 3 тому нашей серии книг &ldquo;Персональный компьютер. Шаг за шагом&rdquo;.</p>
<p>Полный список прав доступа к каталогам и файлам, которые системный администратор может предоставить пользователям, показан на рис. 4.11.</p>
<div align="center">
	<img src="img/aaf00/fig4b.gif" alt="Рис. 4.11. Права доступа к сетевым каталогам и файлам" />
	<p><strong>Рис. 4.11. Права доступа к сетевым каталогам и файлам</strong></p>
</div>
<p>Ниже мы приведем обозначение и краткое описание видов доступа к файлам и каталогам.</p>
<table summary="" border="1">	
<tr><th>Вид доступа</th><th>Обозначение</th><th>Что разрешено</th></tr>
<tr><td>Access Control</td><td>A</td><td>Изменение прав доступа к каталогу или файлу</td></tr>
<tr><td>File Scan</td><td>F</td><td>Просмотр содержимого каталога</td></tr>
<tr><td>Create</td><td>C</td><td>Создание каталогов или файлов в данном каталоге</td></tr>
<tr><td>Erase</td><td>E</td><td>Удаление каталогов или файлов из данного каталога</td></tr>
<tr><td>Modify</td><td>M</td><td>Изменение содержимого файлов (перезапись)</td></tr>
<tr><td>Supervisory</td><td>S</td><td>Права супервизора (можно делать любые операции над файлами, расположенными в каталоге)</td></tr>
<tr><td>Write</td><td>W</td><td>Запись в файл</td></tr>
</table>
<p>Для обычных пользователей достаточно указывать следующие виды доступа: File Scan, Create, Erase, Modify, Write. Для администраторов групп дополнительно можно указать права Access Control.</p>
<p>Если каталог содержит программные файлы, для него не следует разрешать доступ Write, Modify, Erase, Create.</p>
<h5>Предоставление доступа к отдельным файлам</h5>
<p>Программа FILER.EXE, расположенная в каталоге PUBLIC, позволяет системному администратору устанавливать права доступа к отдельным файлам (рис. 4.12).</p>
<div align="center">
	<img src="img/aaf00/fig4c.gif" alt="Рис. 4.12. Просмотр и изменение атрибута файла" />
	<p><strong>Рис. 4.12. Просмотр и изменение атрибута файла</strong></p>
</div>
<p>В частности, для защиты файла от нападения вирусов вы можете установить для него атрибут Read Only.</p>
<p>Системные администраторы знают о существовании очень интересного атрибута Execute Only, который можно установить, но нельзя снять (во всяком случае, нет никаких документированных средств для снятия этого атрибута). Напомним, что файл, отмеченный атрибутом Execute Only, можно запустить, но нельзя прочитать как обычный файл.</p>
<p>Было бы очень заманчиво использовать атрибут Execute Only для защиты файлов от нападения вирусов, однако мы должны отметить два момента.</p>
<p>Во-первых, атрибут Execute Only можно устанавливать только для программ DOS, не использующих оверлейную структуру и не выполняющих прямое чтение загрузочного файла. В то же время многие программы дописывают к концу exe-файла данные, которые они затем читают в процессе своей работы.</p>
<div class="notes">
	<p><em>Kkyyzz.1413</em></p>
	<p><em>При старте программы, имя которой заканчивается на LI.EXE, вирус Kkyyzz.1413 обращается к программному интерфейсу Novell Netware. Когда вводится слово "kkyyzz" с использованием буферизованного ввода (функция 0Ah прерывания Int 21h), вирус удаляет свой код из памяти.</em></p>
</div>
<p>Как следствие вы не можете защитить атрибутом Execute Only загрузочные файлы приложений и библиотек динамической компоновки операционных систем Microsoft Windows и OS/2. Эти файлы содержат специальные данные (ресурсы) которые читаются из файла при необходимости при выполнении приложений. Для доступа к ресурсам используются команды прямого чтения, которые не будут работать при установленном атрибуте Execute Only.</p>
<div class="notel">
	<em>Используйте атрибут доступа Execute Only только вместе с атрибутом Read Only</em>
</div>
<p>Во-вторых, атрибут можно использовать только в паре с атрибутом Read Only, так как иначе вирус сможет &ldquo;снять&rdquo; атрибут Execute Only, просто уничтожив файл и записав на его место новый, но уже без атрибута Execute Only.</p>
<p>Вы можете спросить: как вирус запишет файл, ведь он не сможет его прочитать?</p>
<p>Дело в том, что вирусу не нужно читать программный файл. Во многих случаях он сможет восстановить этот файл, пользуясь, например, его образом в оперативной памяти. Когда операционная система DOS запускает файл с атрибутом Execute Only, она &ldquo;читает&rdquo; его в оперативную память. А там этот файл уже поджидает вирус. Сделав реконструкцию файла по образу в памяти, он может записать такой файл на место защищенного. Именно поэтому атрибуты Execute Only и Read Only необходимо использовать вместе.</p>
<h5>Проверка паролей и прав пользователей</h5>
<p>Периодически системный администратор должен проверять целостность защиты серверов. При этом следует выполнить анализ прав доступа на избыточность, а также проверить, для всех ли пользователей задан пароль.</p>
<p>Проще всего выполнить такую проверку, запустив программу SECURITY.EXE из каталога SYSTEM. Параметры указывать не нужно.</p>
<div class="notel">
	<em>Периодически проверяйте права пользователей сети на избыточность</em>
</div>
<p>Программа SECURITY.EXE проверит права всех пользователей и выведет на экран рабочей станции замечания. Подробное описание этих замечаний вы найдете на стр. 258 в 3 томе библиотеки &ldquo;Персональный компьютер. Шаг за шагом&rdquo;. На все замечания следует обязательно отреагировать, так как их появление говорит о потенциальном снижении устойчиости системы защиты сервера Novell NetWare к преднамеренным или непреднамеренным действиям пользователя или к нападению вирусов.</p>
<h5>Вход системного администратора</h5>
<p>Как мы уже говорили, вход системного администратора в сервер сопряжен с риском заражения расположенных на этом сервере сетевых каталогов, так как использованная для входа рабочая станция может быть заражена вирусом.</p>
<p>По возможности следует избегать входить в сеть с именем пользователя, для которого не существует никаких ограничений для записи в сетевые каталоги. Поэтому при нормальной каждодневной работе пользователь, отвечающий за сеть, не должен подключаться к серверам как системный администратор. Для выполнения таких работ, как подключение других пользователей и управления доступом вполне достаточно привилегий администратора групп. К тому же, вы можете разрешить администратору групп читать содержимое всех сетевых каталогов, предоставив доступ на чтение к корневым каталогам сетевых томов.</p>
<p>Однако рано или поздно системному администратору придется подключаться к сети как супервизору. В этом случае мы рекомендуем сделать следующее.</p>
<ul>
	<li>Проверьте рабочую станцию, которая будет использована для подключения, на присутствие вирусов. Для этого можно использовать, например, антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;</li>
	<li>Подготовьте чистую системную дискету, с которой можно выполнить загрузку DOS. Запишите на эту дискету все файлы, необходимые для получения доступа к серверу (программы LSL.COM, IPXODI.COM, NETX.EXE и драйвер сетевого адаптера). Запишите на эту же дискету несколько антивирусных программ, например, Aidstest и Doctor Web. Используйте самые последние версии указанных программ. Вы можете также записать на эту дискету программу LOGIN.EXE</li>
	<li>Загрузите рабочую станцию с дискеты, подготовленной указанным выше образом, и войдите в сеть пользователем с правами системного администратора</li>
	<li>Выполните поиск вирусов в сетевых каталогах сервера, используя перечисленные выше антивирусные программы</li>
</ul>
<p>Такая процедура защитит диски сервера от нападения вирусов, которое будет особенно опасным, если рабочая станция системного администратора окажется зараженной.</p>
<h5>Сетевые антивирусные программы для Novell NetWare</h5>
<p>Разными фирмами были созданы многочисленные антивирусные программы, специально предназначенные для работы в среде сетевой операционной системы Novell NetWare. Эти програмы представляют собой NLM-модули, загружаемые оператором с консоли Novell NetWare или через файл startup.ncf (играющий ту же самую роль, что и файл autoexec.bat в операционной системе DOS).</p>
<p>В чем удобство таких антивирусных программ?</p>
<p>Мы уже говорили, что сканирование сетевых каталогов можно с успехом выполнять при помощи обычных антивирусных программ, предназначенных для отдельных компьютеров, не объединенных в сеть, и рабочих станций, например, при помощи программы Doctor Web. Однако такое сканирование приходится выполнять вручную. Кроме того, для получения доступа ко всем сетевым томам и каталогом в процессе сканирования приходится подключаться к сети с именем высокопривилегированного пользователя (что опасно само по себе).</p>
<div class="notes">
	<p><em>WorkNet.708</em></p>
	<p><em>Резидентный вирус.</em></p>
	<p><em>Пытается обращаться к программному интерфейсу Novell NetWare.</em></p>
	<p><em>Содержит строку "WORK:NET:".</em></p>
</div>
<p>В то же время специальная сетевая антивирусная программа работает в среде сетевой операционной системы как фоновый процесс, имеющий доступ к любым сетевым ресурсам сервера, на котором она была запущена. Поэтому проверка сетевых каталогов выполняется в автоматическом режиме без вмешательства системного администратора.</p>
<p>Дополнительно все современные сетевые антивирусные программы, предназначенные для запуска в среде сетевой операционной системы, способны автоматически проверять файлы, которые записываются пользователями в сетевые каталоги или читаются с них. В этом случае будут пресекаться попытки пользователей записать на диски файл-сервера программы, зараженные вирусами. Если же окажется, что зараженная программа была записана на сервер раньше (до установки и запуска антивирусной программы), она будет обнаружена при попытке ее запуска или копирования на диск рабочей станции или в другой сетевой каталог.</p>
<p>Результаты сканирования записываются в журнал, который доступен для просмотра системному администратору или другому лицу с аналогичными правами доступа.</p>
<p>Как только вирус будет обнаружен, системный администратор (или другой пользователь, идентификатор которого указывается при настройке антивирусной программы) получает сообщение. Одновременно делается запись в журнале. Доступ к зараженному файлу блокируется, что предотвращает распространение вируса по сети. Дополнительно все зараженные программы могут автоматически переписываться в отдельный каталог для последующего анализа (например, для поиска источника заражения).</p>
<p>Эффективность обнаружения вирусов в значительной степени зависит от актуальности вирусной базы данных, входящих в состав антивирусных средств, а также от способности обнаруживать полиморфные вирусы. Простое сканирование с поиском вирусов по набору сигнатур обычно дает плохие результаты, поэтому современные сетевые антивирусные программы используют эвристические методы обнаружения вирусов.</p>
<div class="notel">
	<em>Постоянно обновляйте версии антивирусных программ (не реже одного ража в неделю или в месяц). Помните, что каждый день появляется несколько новых вирусов</em>
</div>
<p>Среди наиболее известных антивирусных программ для Novell NetWare можно назвать следующие: Norton AntiVirus for NetWare, NetShield for NetWare, Central Point AntiVirus for NetWare, LANDesk Virus Protect, Dr. Solomon&rsquo;s Toolkit for NetWare, SWEEP for Novell NetWare. В самом ближайшем будущем появится антивирусная программа Doctor Web for Novell NetWare, которая войдет в антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>Выбор велик, хотя можно ожидать, что программа Doctor Web for Novell NetWare будет у нас более эффективна, так как ее вирусная база постоянно обновляется и значительную часть этой базы составляют &ldquo;отечественные&rdquo; вирусы.</p>
<p>Как правило, все сетевые антивирусные программы для Novell NetWare состоят из двух компонент: NLM-модуля, который запускается на сервере, и набора программ для рабочей станции, рассчитанных на использование в среде DOS или Microsoft Windows.</p>
<p>Для примера мы расскажем вам о двух сетевых антивирусных программах: Norton AntiVirus for NetWare и NetShield for NetWare.</p>
<p>На рис. 4.13 показана работа NLM-модуля программы Norton AntiVirus for NetWare версии 2.01.</p>
<div align="center">
	<img src="img/aaf00/fig4d.gif" alt="Рис. 4.13. Работа NLM-модуля программы версии 2.01" />
	<p><strong>Рис. 4.13. Работа NLM-модуля программы версии 2.01</strong></p>
</div>
<p>Запустив этот модуль на сервере (например, с помощью программы удаленного доступа к консоли RCONSOLE.EXE) вы можете управлять ее работой с помощью клавиш &lt;F2&gt;, &lt;F3&gt;, &lt;F4&gt;, &lt;F5&gt; и &lt;F10&gt;.</p>
<p>Клавиши &lt;F2&gt; и &lt;F3&gt; предназначены, соответственно, для разрешения и блокирования работы NLM-модуля. Нажав клавишу &lt;F4&gt;, можно запустить процесс сканирования, который будет выполняться в автоматическом режиме. Клавиша &lt;F5&gt; позволяет остановить сканирование, а клавиша &lt;F10&gt; - выгрузить NLM-модуль антивирусной программы из памяти.</p>
<p>Заметим, что для выполнения любых действий с NLM-модулем антивирусной программы Norton AntiVirus for NetWare тербуется указать имя пользователя, запустившего этот модуль и пароль. Таким образом, если программа была запущена системным администратором, никто другой не сможет ее заблокировать или выгрузить из памяти, отключив таким образом антивирусную защиту файл-сервера.</p>
<p>Окно NLM-модуля антивирусной программы Norton AntiVirus for NetWare разделено на три части.</p>
<p>В области NLM Status отображается текущее состояние модуля (разблокирован или заблокирован, процент загрузки центрального процессора сервера, общее количество проверенных файлов и&nbsp;т. д.</p>
<p>В области Real-time Status отображаются текущие параметры модуля.</p>
<p>И, наконец, в области Last Infected File приведены сведения о последнем обнаруженным зараженном файле. Здесь вы можете увидеть название найденного вируса, идентификатор пользователя, который сделал попытку записать зараженный файл на сервер, дату этого события и путь к зараженной программе, а также действия, выполненные антивирусной программой.</p>
<p>Для управления NLM-модулем антивирусной программы Norton AntiVirus for NetWare системный администратор может использовать специальное приложение, предназначенное для работы в среде Microsoft Windows версии 3.1, главное окно которого показано на рис. 4.14.</p>
<div align="center">
	<img src="img/aaf00/fig4e.gif" alt="Рис. 4.14. Главное окно приложения, предназначенного для управления антивирусной программой Norton AntiVirus for NetWare версии 2.01" />
	<p><strong>Рис. 4.14. Главное окно приложения, предназначенного для управления антивирусной программой Norton AntiVirus for NetWare версии 2.01</strong></p>
</div>
<p>Доступ к самым нужным функциям приложения можно выполнять при помощи меню а также органа управления Toolbar, содержащего четыре кнопки Options, Virus List, Console и Activity Log.</p>
<p>Нажав кнопку Console, системный администратор может определить текущее состояние NLM-модуля антивирусной программы, не прибегая к услугам программы RCONSOLE.EXE (рис. 4.15).</p>
<div align="center">
	<img src="img/aaf00/fig4f.gif" alt="Рис. 4.15. Просмотр текущего состояния NLM-модуля антивирусной программы Norton AntiVirus for NetWare" />
	<p><strong>Рис. 4.15. Просмотр текущего состояния NLM-модуля антивирусной программы Norton AntiVirus for NetWare</strong></p>
</div>
<p>Нажав в главном окне приложения кнопку Activity Log, можно просмотреть содержимое журнала на предмет обнаружения вирусов (рис. 4.16).</p>
<div align="center">
	<img src="img/aaf00/fig4g.gif" alt="Рис. 4.16. Просмотр журнала" />
	<p><strong>Рис. 4.16. Просмотр журнала</strong></p>
</div>
<p>Управляющее приложение позволяет указать для NLM-модуля антивирусной программы Norton AntiVirus for NetWare многочисленные параметры, определяющие режимы ее работы (рис. 4.17).</p>
<div align="center">
	<img src="img/aaf00/fig4h.gif" alt="Рис. 4.17. Блокнот настройки параметров NLM-модуля антивирусной программы Norton AntiVirus for NetWare" />
	<p><strong>Рис. 4.17. Блокнот настройки параметров NLM-модуля антивирусной программы Norton AntiVirus for NetWare</strong></p>
</div>
<p>Выбрав страницу Real-Time Scan, вы можете указать, какие файлы должны сканироваться (файлы программ DOS, прораммные файлы или все файлы, файлы, которые пользователи записывают в сетевые каталоги или переписывают на диски рабочих станций из сетевых каталогов и т. д.). Дополнительно можно сканировать на предмет наличия вирусов память сервера, в которую загружаются NLM-модули, а также память, выделенную операционной системе DOS.</p>
<div class="notes">
	<p><em>NetBIOS-4340</em></p>
	<p><em>Резидентный вирус.</em></p>
	<p><em>Заражает программы с расширением имени COM и EXE.</em></p>
	<p><em>При определенных обстоятельствах пытается разместить в  памяти дополнительный резидентный модуль, который должен что-то делать в локальной сети с использованием программного интерфейса NetBIOS. Содержит довольно много ошибок. После 1 августа старается вылечить все зараженные файлы.</em></p>
</div>
<p>Страница Default Alerts позволяет указать, кому должно направляться извещение при обнаружении вируса (рис. 4.18).</p>
<div align="center">
	<img src="img/aaf00/fig4i.gif" alt="Рис. 4.18. Выбор действий при обнаружении вируса" />
	<p><strong>Рис. 4.18. Выбор действий при обнаружении вируса</strong></p>
</div>
<p>Такое извещение может быть направлено всем или только некоторым пользователям, владельцу файла, пользователю, выполняющему обновление файла или системному администратору. Сообщение о том, что в сетевых каталогах обнаружен вирус, может быть выведено на системную консоль сервера Novell NetWare, отправлено по почте MHS или даже передано на пейджер.</p>
<p>Кнопка Virus List в главном окне управляющей программы Norton AntiVirus for NetWare предоставляет доступ к базе данных, содержащей описания вирусов и, что очень важно, рекомендуемые действия при обнаружении вирусов (рис. 4.19).</p>
<div align="center">
	<img src="img/aaf00/fig4j.gif" alt="Рис. 4.19. База данных с информацией о вирусах" />
	<p><strong>Рис. 4.19. База данных с информацией о вирусах</strong></p>
</div>
<p>Для получения подробной информации о каком-либо вирусе вы должны найти его имя в этом списке и нажать кнопку Info. При этом на экране появится диалоговая панель Virus Information, показанная на рис. 4.20.</p>
<div align="center">
	<img src="img/aaf00/fig4k.gif" alt="Рис. 4.20. Диалоговая панель Virus Information, содержащая описание вируса и рекомендуемые при его обнаружении действия" />
	<p><strong>Рис. 4.20. Диалоговая панель Virus Information, содержащая описание вируса и рекомендуемые при его обнаружении действия</strong></p>
</div>
<p>С помощью группы переключателей Characteristics вы можете узнать, является ли данный вирус резидентным вирусом, стелс-вирусом, использует ли он технологию шифрования и полиморфизм, способен ли он выполнять вредоносные действия при наступлении какого-либо события.</p>
<p>В поле Comments находятся более подробная информация и дополнительные рекомендации. Заметим, что антивирусная программа Norton AntiVirus for NetWare не может вылечить опасный полиморфный вирус One Half (в отличие от программы Doctor Web, входящей в комплект антивирусных средств АО &ldquo;ДиалогНаука&rdquo;). Если вы обнаружили такой вирус, вам рекомендуется обратиться в группу технического сопровождения.</p>
<div class="notel">
	<em>Если вы сомневаетесь в успехе лечения, обращайтесь в &ldquo;Компьютерную скорою помощь&rdquo;&reg; АО &ldquo;ДиалогНаука&rdquo;. В результате неправильного лечения могут быть потеряны важные данные и программы.</em>
</div>
<p>Антивирусная программа (рис. 4.21) также имеет в своем составе NLM-модуль, запускаемый в среде сетевой операционной системы Novell NetWare.</p>
<div align="center">
	<img src="img/aaf00/fig4l.gif" alt="Рис. 4.21. Главное окно антивирусной программы McAfee Virus Scanner for NetWare" />
	<p><strong>Рис. 4.21. Главное окно антивирусной программы McAfee Virus Scanner for NetWare</strong></p>
</div>
<p>По своим возможностям эта программа аналогична предыдущей. Ее интерфейс, выполненный в стиле утилит Novell NetWare, привычен и удобен для системных администраторов. С помощью системы вложенных меню можно управлять работой антивирусной программы как непосредственно с консоли файл-сервера, так и с рабочей станции (через программу RCONSOLE.EXE).</p>
<p>На рис. 4.22 показано меню Configuration, с помощью которого вы можете выполнить настройку режимов работы программы McAfee Virus Scanner for NetWare.</p>
<div align="center">
	<img src="img/aaf00/fig4m.gif" alt="Рис. 4.22. Меню настройки режимов работы антивирусной программы McAfee Virus Scanner for NetWare" />
	<p><strong>Рис. 4.22. Меню настройки режимов работы антивирусной программы McAfee Virus Scanner for NetWare</strong></p>
</div>
<p>С помощью строк On-access scanning options и Period-scanning options помимо всего прочего вы можете заставить антивирусную программу проверять файлы, которые пользователи записывают на диски сервера или переписывают из сетевых каталогов на диски своих рабочих станций (рис. 4.23).</p>
<div align="center">
	<img src="img/aaf00/fig4n.gif" alt="Рис. 4.23. Можно использовать автоматическое сканирование файлов, попадающих на диски файл-сервера или читаемых пользователями из сетевых каталогов" />
	<p><strong>Рис. 4.23. Можно использовать автоматическое сканирование файлов, попадающих на диски файл-сервера или читаемых пользователями из сетевых каталогов</strong></p>
</div>
<p>Выбрав строку Action when virus found, вы сможете определить действия, которые должна выполнить антивирусная программа при обнаружении вируса (рис. 4.24).</p>
<div align="center">
	<img src="img/aaf00/fig4o.gif" alt="Рис. 4.24. Выбор действий при обнаружении вируса" />
	<p><strong>Рис. 4.24. Выбор действий при обнаружении вируса</strong></p>
</div>
<p>Зараженный файл может быть удален, перемещен в другой сетевой каталог (недоступный пользователям), или оставлен на месте нетронутым.</p>
<p>С помощью меню Whom to contact (рис. 4.25), которое появляется на экране при выборе строки Contact Options, можно указать список пользователей, которым посылается сообщение о том, что на сервере был обнаружен вирус.</p>
<div align="center">
	<img src="img/aaf00/fig4p.gif" alt="Рис. 4.25. Меню Whom to contact" />
	<p><strong>Рис. 4.25. Меню Whom to contact</strong></p>
</div>
<p>С помощью строки можно задать список расширений файлов, подвергаемых сканированию (рис. 4.26).</p>
<div align="center">
	<img src="img/aaf00/fig4q.gif" alt="Рис. 4.26. Меню Change extensions scanned, которое появляется при выборе одноименной строки из главного меню программы" />
	<p><strong>Рис. 4.26. Меню Change extensions scanned, которое появляется при выборе одноименной строки из главного меню программы</strong></p>
</div>
<p>Меню Report Option позволяет управлять процессом протоколирования результата сканирования (рис. 4.27).</p>
<div align="center">
	<img src="img/aaf00/fig4r.gif" alt="Рис. 4.27. Меню Report Option" />
	<p><strong>Рис. 4.27. Меню Report Option</strong></p>
</div>
<p>Выбрав из этого меню строку View log file вы сможете просмотреть файл протокола сканирования на экране (рис. 4.28).</p>
<div align="center">
	<img src="img/aaf00/fig4s.gif" alt="Рис. 4.28. Просмотр протокола сканирования сетевых каталогов" />
	<p><strong>Рис. 4.28. Просмотр протокола сканирования сетевых каталогов</strong></p>
</div>
<h4>Защита сети на базе сервера IBM LAN Server для OS/2</h4>
<p>Методика защиты сети, созданной на базе серверов IBM LAN Server во многом аналогична методике защиты сети Novell NetWare. Если вы - системный администатор такой сети, вам прежде всего необходимо правильно распределить права доступа. Кроме того, вы можете использовать для защиты сервера специально разработанные программные и аппаратные антивирусные средства.</p>
<p>В отличие от сети Novell NetWare, все сетевое программное обеспечение, необходимое для доступа к файл-серверу IBM LAN Server, хранится на рабочих станциях. Рабочие станции DOS и Windows нужно защищать от вирусов точно также, как и отдельные компьютеры, не подключенные к сети. Более подробно об установке, настройке и использовании сервера IBM LAN Server 4.0 Advanced вы можете прочитать в 20 томе нашей серии книг &ldquo;Библиотека системного программиста&rdquo;, которая называется &ldquo;Операционная система IBM OS/2 Warp&rdquo;.</p>
<div class="notes">
	<p><em>ComeOut-3624</em></p>
	<p><em>Резидентный вирус.</em></p>
	<p><em>Заражает только программы с расширением имени EXE.</em></p>
	<p><em>&ldquo;Нападает&rdquo; прежде всего на файлы, расположенные в текущем каталоге. Резидентный модуль остается в памяти видеоконтроллера EGA или VGA (но не CGA). Не активизируется, если в корневом каталоге диска C: имеется файл с именем COME.OUT.</em></p>
	<p><em>Содержит заготовки для дальнейшего развития и глобальные идеи по взлому локальной сети. Сочетание глубины идей и не очень высокого класса программирования приводит к быстрому &ldquo;повисанию&rdquo; системы.</em></p>
</div>
<p>Системный администратор перед подключением к сети должен тщательно проверить свою рабочую станцию, убедившись в отсутствии вирусов.</p>
<h5>Административные меры защиты</h5>
<p>Системный администратор сети на базе сервера IBM LAN Server может создавать группы пользователей, так же как и администратор сети Novell NetWare. Однако способ присваивания прав доступа отличается от использованного в Novell NetWare. В сети Novell NetWare права доступа назначаются пользователям и группам пользователей с помощью программы SYSCON.EXE. Что же касается сервера IBM LAN Server, то права доступа определяются с помощью блокнота свойств сетевого ресурса, который отображается на экране в ответ на щелчок правой клавишей мыши по соответствующей пиктограмме.</p>
<p>Для определения списка пользователей и групп пользователей, имеющих права доступа к ресурсу, а также для определения самих этих прав необходимо выбрать страницу &ldquo;Permissions&rdquo; (рис. 4.29).</p>
<div align="center">
	<img src="img/aaf00/fig4t.gif" alt="Рис. 4.29. Страница &ldquo;Permissions&rdquo;, позволяющая определить права доступа к ресурсу для групп пользователей и отдельных пользователей" />
	<p><strong>Рис. 4.29. Страница &ldquo;Permissions&rdquo;, позволяющая определить права доступа к ресурсу для групп пользователей и отдельных пользователей</strong></p>
</div>
<p>Вы можете указать следующие права доступа:</p>
<table summary="" border="1">	
<tr><th>Права доступа</th><th>Описание</th></tr>
<tr><td>Attributes</td><td>Изменение атрибутов файлов</td></tr>
<tr><td>Create</td><td>Создание файлов и каталогов</td></tr>
<tr><td>Delete</td><td>Удаление файлов и каталогов</td></tr>
<tr><td>Permissions</td><td>Изменение прав доступа</td></tr>
<tr><td>Read</td><td>Чтение</td></tr>
<tr><td>Write</td><td>Запись</td></tr>
<tr><td>Execute</td><td>Запуск программ на выполнение</td></tr>
</table>
<p>Для предотвращения заражения программных файлов вирусами вы можете указать права доступа Read и Execute для обычных пользователей. По возможности никогда не предоставляйте пользователям права доступа Write, Delete, Attributes, Permissions и Create к каталогам, содержащим программные файлы.</p>
<div class="notel">
	<em>Не используйте для программных файлов комбинацию прав доступа Execute, Write и Delete. Если вам нужно защитить файл от вирусов, укажите для него только одно право доступа - Execute</em>
</div>
<p>Если вы указываете для программного файла права доступа Execute, надеясь защитить его таким образом от вирусной атаки, проследите за тем, чтобы для этого файла не были указаны права доступа Write и Delete. В противном случае вирус может удалить такой файл, создав на его месте новый, для которого разрешено выполнение операции записи. Мы уже рассказывали об этой возможности при описании атрибута Execute Only, который используется в операционной системе Novell NetWare.</p>
<h5>Антивирусные программы для защиты сети на базе IBM LAN Server</h5>
<p>Программная защита серверов сети на базе IBM LAN Server для OS/2 может выполняться с использованием тех же средств, что и защита рабочих станций OS/2. Прежде всего это такая антивирусная программа, как IBM AntiVirus for OS/2, обладающая способностью выполнять сканирование сетевых дисков и каталогов в фоновом режиме.</p>
<p>Существуют и другие антивирусные программы, способные работать в среде OS/2. Это Armour/FireBreak, Dr. Solomon's AntiVirus Toolkit, LanDesk Virus Protect и т. д.</p>
<p>Заметим, что пока не наблюдается широкого потока вирусов, специально ориентированных на операционную систему OS/2, однако такие вирусы могут быть созданы. К тому же, в среде виртуальной машины DOS, работающей под управлением OS/2, могут распространяться и обычные вирусы, ориентированные на операционную систему DOS.</p>
<h2>5 Работа с BBS АО &ldquo;ДиалогНаука&rdquo;</h2>
<p>На протяжении всей книги мы настойчиво повторяем, что для увеличения эффективности борьбы с вирусами необходимо постоянно обновлять версии антивирусных программ. Для облегчения этой задачи многие фирмы, занимающиеся разработкой антивирусных средств, предоставляют своим подписчикам возможность получения новых версий программ через электронные доски объявлений BBS, FTP-серверы, предназначенные в основном для файлового обмена, или страницы глобальной гипертекстовой системы WWW. В этом случае вам не нужно каждый раз приезжать в представительство фирмы или пользоваться услугами курьера, так как вы сможете загружать новые версии антивирусных программ через модем.</p>
<p>Модем представляет собой устройство, которое может быть конструктивно выполнено в виде платы расширения, вставляемой в корпус компьютера, либо в виде отдельного устройства, которое подключается кабелем к последовательному порту компьютера. В первом случае модем является внутренним, во втором - внешним.</p>
<p>Как внутренний, так и внешний модем подключается к телефонной линии, для чего на его корпусе имеется стандартный телефонный разъем. Исчерпывающие сведения о выборе и подключении модема вы найдете в 16 томе нашей серии книг &ldquo;Библиотека системного программиста&rdquo;, которая называется &ldquo;Модемы и факс-модемы&rdquo;.</p>
<p>Одной из основных характеристик модема является скорость передачи данных. Так как размеры файлов антивирусных программ может достигать сотен Кбайт, при использовании низкоскоростных модемов время загрузки новой версии программы может оказаться значительным.</p>
<p>Если вы можете позволить себе потратить на приобретение модема 200-300 долларов США, мы можем порекомендовать модемы фирмы USRobotics (модели Sportster или Courier со скоростью передачи данных не менее 14400 bps), или модемы ZyXEL, которые также обладают неплохими характеристиками.</p>
<p>Для работы с модемом используется специальное программное обеспечение, которое, как правило, продается вместе с модемом. Однако в составе таких операционных систем, как Microsoft Windows версии 3.1, Microsoft Windows 95, IBM OS/2 Warp версии 3.0 имеются достаточно удобные встроенные средства.</p>
<p>Для работы с электронными досками объявлений BBS (в том числе для работы с электронной доской объявлений АО &ldquo;ДиалогНаука&rdquo;) вам потребуется простейшая терминальная программа. Вы можете использовать терминальные программы, разработанные для операционной системы DOS, такие как MTE, Telix, Comit или Bitcom, терминальное приложение Terminal, предназначенное для работы в среде Microsoft Windows версии 3.1, приложение HyperTerminal фирмы Hilgraeve Inc., которое поставляется вместе с операционной системой Microsoft Windows 95 и IBM OS/2 и т. д. Выбор достаточно велик.</p>
<div class="notel">
	<em>Электронная доска объявлений BBS АО &ldquo;ДиалогНаука&rdquo; открывает вам доступ к самым последним версиям наиболее популярных антивирусных программ</em>
</div>
<p>На чем же остановиться?</p>
<p>Если у вас старый модем со скоростью передачи данных 2400 bps, который не способен выполнять аппаратную коррекцию ошибок по протоколу MNP (о чем вы можете узнать из документации к модему), лучшим выбором будет терминальная программа MTE, созданная фирмой Magic Soft.</p>
<p>Если же вы владеете современным высокоскоростным модемом, лучше всего работать с приложением HyperTerminal или использовать средства, которые поставляются вместе с модемом, например, QuickLink II FAX (поставляется вместе с модемом USRobotics Sportster 33600).</p>
<p>Выбирая терминальную программу, убедитесь, что она способна передавать данные с использованием протокола ZMODEM. На сегодняшний день это наиболее удобный и устойчивый протокол, способный динамически адаптироваться к качеству телефонной линии, изменяя размер блока передаваемых данных. Все современные терминальные программы работают с протоколом ZMODEM.</p>
<h3>Сеанс связи с BBS АО &ldquo;ДиалогНаука&rdquo;</h3>
<p>Запустите терминальную программу и позвоните с ее помощью по телефону (095)938-28-56 (это телефон линии общего доступа BBS &ldquo;ДиалогНаука&rdquo;). Если вам повезло и линия оказалась свободной, через некоторое время вы увидите на экране следующее приглашение:</p>
<pre>
Address 2:<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="281d181a18071e11684e414c47464d5c">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> Using BinkleyTerm-OS/2 2.50 EE Beta 
E3-32 ISDN


DialogueScience
BBS, Line 2

Press &lt;ESC&gt; once for Maximus
</pre>
<p>Линия общего доступа используется достаточно интенсивно, поэтому с первого раза вы скорее всего обнаружите, что она занята. Для подписчиков на антивирусный комплект АО &ldquo;ДиалогНаука&rdquo; имеются еще несколько линий (соответствующие этим линиям номера телефонов есть в документации, которая поставляется вместе с антивирусным комплектом, а также в заставке BBS, приведенной ниже).</p>
<div class="notel">
	<em>Подписчики АО &ldquo;ДиалогНаука&rdquo; могут пользоваться привилегированными линиями доступа</em>
</div>
<p>Нажмите один раз клавишу &lt;Esc&gt;. На экране появится строка:</p>
<pre>Thank you.  Please wait...</pre>
<p>Через некоторое время вы увидите заставку BBS (рис. 5.1).</p>
<div align="center">
	<img src="img/aaf00/fig51.gif" alt="Рис. 5.1. Заставка электронной доски объявлений BBS АО &ldquo;ДиалогНаука&rdquo;" />
	<p><strong>Рис. 5.1. Заставка электронной доски объявлений BBS АО &ldquo;ДиалогНаука&rdquo;</strong></p>
</div>
<p>В ответ на запрос What is your name вы должны ввести свое имя. После этого вам будет предложено ввести фамилию (What is your LAST name). Если вы работаете с этой BBS в первый раз, можно выбрать любое имя. В следующий раз при подключении вы будете указывать выбранные вами при первом подлючении имя и фамилию. Имеет смысл использовать только настоящие имена, о чем предупреждается в заставке BBS.</p>
<p>Если вы не зарегистрированы, то на экран будет выведено следующее сообщение:</p>
<pre>
Your name was not found in my user records.  If you are indeed a new user,
then answer `Y' to the following prompt, and proceed to log on.
Otherwise, type `N' and enter your name correctly.

NOTE! Please make sure that your name, as shown below, is capitalized
correctly!  Maximus will try to properly capitalize names, if
possible, but you must manually enter the correct version of names
such as "McDonald".  This is only necessary on your first
logon; subsequent logons will use the capitalization which you
specify here.

Please, DON'T USE digits and russian letters in your name;
        DON'T USE name of company you works for registration;
        DON'T USE name as `Mike Mike' or `V. Ivanov';
        DON'T USE aliases.

Alexandr Frolov [Y,n]?
</pre>
<p>В этом сообщении говорится, что ваше имя не найдено в списке пользователей BBS. Возможно, вы ошиблись при вводе имени. Поэтому вам предоставляется возможность еще раз проверить введенное имя.</p>
<p>В имени нельзя использовать цифры и русские буквы. Не следует также указывать название фирмы, сокращения и псевдонимы.</p>
<p>Далее новый пользователь должен выбрать язык, на котором он будет общаться с BBS (английский или русский):</p>
<pre>
Select a language:

  1) ENGLISH
  2) RUSSIAN

Select:
</pre>
<p>В наших примерах мы будем пользоваться английским языком. Если вы собираетесь поступить так же, в ответ на приглашение Select введите число 1. Вы увидите сообщение о том, что выбран английский язык:</p>
<pre>
English language (proper) selected.
Press ENTER to continue
</pre>
<p>Для продолжения работы нажмите клавишу &lt;Enter&gt;. Вам будет предложено зарегистрироваться:</p>
<pre>
Welcome to DialogueScience BBS!

 Since you are a new user, you will be asked to enter your city and
province, your password, and to select several configuration options.
 Keep in mind that these choices are not permanent; you can modify
all of these settings from the C)hange menu after you've registered
as a new user.

Your SysOp,
Boris Chernivetsky

Please enter your city and state/province: Moscow, Ruusia
Please enter your phone number [(xxx) yyy-zzzz]: (095) ХХХ-ХХХХ
</pre>
<p>Вы должны ввести название города и свой телефонный номер.</p>
<p>Затем система попросит вас выбрать пароль:</p>
<pre>
Now, you must choose your password.

A password is one word (with no spaces).  Passwords can be anywhere
from 4 to 15 characters long, and can include letters or numbers.
Uppercase and lowercase letters are treated identically.

Tips:

1) Write down your password somewhere (or store it in your terminal
program's dialing directory), so you'll remember it for next time.

2) Don't use the same password on more than one system.  Since the
SysOp of each system you call has access to your password,
there's nothing from stopping them from logging in as you on
someone else's system.

3) For better security, use a long password (at least 6 characters).

Please enter the password you wish to use:
</pre>
<p>Вы можете выбрать любой пароль длиной от 4 до 15 символов, однако не следует выбирать слишком короткий пароль, а также использовать вместо пароля свое имя, фамилию или год рождения. Лучше всего, если пароль будет содержать смесь букв и цифр. Пароль лучше запомнить и нигде не записывать.</p>
<p>После ввода пароля система попросит вас ввести пароль еще раз для проверки:</p>
<pre>Please re-enter your password for verification: ....</pre>
<p>Затем вы должны ответить, способна ли ваша терминальная программа работать с ANSI-символами. Эти символы используются для раскрашивания изображения на экране терминала в различные цвета.</p>
<p>Посмотрите внимательно на следующее сообщение, которое появится на экране:</p>
<pre>
Maximus can optionally send "ANSI codes" to your terminal program. 
If your terminal does support ANSI, then you'll be able to use colour
in the menu prompts, cursor movement, and other niceties. However,
your terminal program must have support for these codes, or else
you'll only see a lot of garbage.
If your terminal program has a terminal emulation mode of either "ANSI"
or "VT-100", then you should switch to it now.

Here's what ANSI codes look like:

       AAAAA        BBBBB        CCCCC

If you can see a bunch of numbers and square brackets, then your
terminal program does NOT support ANSI graphics, and you should
answer "N" at the prompt

If there were three blocks of letters, with no intervening numbers, then
your terminal program DOES support ANSI, and you should answer "Y"
at the prompt.

   To turn *on* ANSI codes, enter........... Y
   To turn *off* ANSI codes, enter.......... N

Does your system support ANSI screen colors [y,n]?
</pre>
<p>Если строка AAAAA BBBBB CCCCC изображена разными цветами, можете считать, что ваша терминальная программа работает с управляющими символами ANSI. В этом случае вы можете ответить на приведенный выше запрос утвердительно, нажав клавишу &lt;Y&gt;. В противном случае (если вы видите последовательность символов &ldquo;[-&gt;34&hellip;&rdquo;) нажимайте клавишу &lt;N&gt;.</p>
<p>После этого вы увидите следующее приглашение:</p>
<pre>
  Welcome to DialogueScience BBS, Alexandr Froloff!

  DialogueScience BBS

  We design, distribute, and support  the anti-virus programs Aidstest by
Dmitry Lozinsky, Doctor Web by Igor
Daniloff, ADinf (Advanced Diskinfoscope)
by Dmitry Mostovoy, and ADinf Cure Module by Vitaly Ladygin and Denis
Zujev (see Area I.2 for terms and
conditions of distribution).

  To access the lines 938-2969, 939-3705, 939-5239,
938-2867 please inform your registration number and other
subscriber details to our system operator.

  Press ENTER to continue
</pre>
<p>Затем проверяется почта. Если вы впервые работаете с BBS АО &ldquo;ДиалогНаука&rdquo;, почты для вас скорее всего нет, о чем вы можете узнать из следующего сообщения:</p>
<pre>
Sorry, but you have no mail waiting.
Press ENTER to continue
</pre>
<p>Если вы впервые работаете с этой BBS и вас пока нет в списке пользователей, но пытаетесь позвонить по линиям, выделенным специально для подписчиков, вы получите следующее сообщение:</p>
<pre>
Please, excuse us.  You cannot access this line as it is
exclusively reserved for our subscribers and partners.

In the course of next five minutes you can leave your message with
SysOp (system operator), if you have any complaints about the line.

If you are our BBS subscriber, please inform:
  1) Your organization or your name (for individual users),
  2) Subscriber number or date, and subscription sum paid.
After checking up these data, SysOp will either open the line
to you, or return a refusal message.

To access the public BBS, please call: 938-2856, Fido 2:5020/69.1

Press ENTER to continue
</pre>
<p>В этом сообщении говорится, что если вы являетесь подписчиком, то вам нужно оставить сообщение системному оператору BBS, в котором следует указать название вашей фирмы или фамилию (для индивидуальных пользователей), номер или дату, когда была сделана подписка, сумму, указанную в платежном поручении. Только после этого вам будет предоставлен доступ к привилегированным линиям доступа для получения последних версий антивирусных программ АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>Если вы желаете оставить сообщение системному оператору, ответьте утвердительно на следующий вопрос:</p>
<pre>Would you like to leave a message for us [y,N]?</pre>
<p>Вслед за этим вам будет предоставлена возможность ввести и отредактировать сообщение. Сообщение нужно обязательно сохранить. Для этого в ответ на только что приведенный вопрос необходимо нажать клавишу &lt;Y&gt;.</p>
<p>Если же вы откажетесь от посылки сообщения, на экране появится девиз дня (эта фраза изменяется каждый день):</p>
<pre>
Quote for the day:

Whenever I feel like exercise, I lie down until the feeling passes.

Bye, Alexandr.  Please call again!
</pre>
<p>Вслед за этим модем BBS повесит трубку и сеанс связи будет окончен.</p>
<p>В следующий раз, когда вы вновь позвоните на BBS АО &ldquo;ДиалогНаука, система &ldquo;узнает&rdquo; вас и встретит следующим сообщением:</p>
<pre>
Thank you for calling DialogueScience BBS, Alexandr.
You are the 6261st caller, and this is your 6th call.
You have uploaded 0K.  You have downloaded 2395K. (UL:DL=0:2395.)
Press ENTER to continue
</pre>
<p>Среди всего прочего в этом сообщении подводится баланс объемов данных, полученных вами из BBS и записанных в BBS. На некоторых BBS это соотношение определяет уровень и права пользователя, однако в случае BBS АО &ldquo;ДиалогНаука&rdquo; оно не играет никакой роли. Вам всегда выделяется 35 минут на один сеанс, но не более 60 минут в сутки.</p>
<p>После ввода имени и пароля у вас запрашивается подтверждение (имя и фамилия, разумеется, будут другие):</p>
<pre>Alexandr Frolov [Y,n]?</pre>
<p>Если вы все ввели правильно, нажмите клавишу &lt;Y&gt;, а если ошиблись - клавишу &lt;N&gt;. В последнем случае вам будет предоставлена возможность ввести имя и фамилию повторно.</p>
<p>После ввода имени и фамилии у вас запрашивается пароль:</p>
<pre>Password:</pre>
<p>В процессе ввода символы пароля заменяются точками.</p>
<p>Далее выполняется поиск почты:</p>
<pre>
Searching: L1
Searching: L2
Searching: L3

Sorry, but you have no mail waiting.
Press ENTER to continue
</pre>
<p>Затем вам предлагается выбрать область файлов, из которой вы будете загружать данные:</p>
<pre>File area [Area, "["=Prior, "]"=Next, "?"=List]:</pre>
<p>Для того чтобы просмотреть список доступных вам областей, введите символ &ldquo;?&rdquo;. На экране появится следующее меню (количество и состав строк может быть другим):</p>
<pre>
File Areas 

I                   ... Information
A                   ... Antiviruses
Comm                ... Communications
UL                  ... Unchecked Users Upload
NV                  ... New Viruses

File area [Area, "["=Prior, "]"=Next, "?"=List]:
</pre>
<p>Для того чтобы выбрать область, введите ее обозначение, расположенное слева, и нажмите клавишу &lt;Enter&gt;.</p>
<p>В следующем разделе мы расскажем о содержимом перечисленных в этом меню файловых областей.</p>
<h3>Файловые области BBS АО &ldquo;ДиалогНаука&rdquo;</h3>
<p>Содержимое файловых областей постоянно меняется, однако их назначение остается тем же самым. Посещая BBS, вы можете посмотреть список расположенных там файлов. Для того чтобы вам было легче ориентироваться и не тратить зря время (которое при работе с BBS всегда ограничено), мы расскажем о том, что вы можете найти в самых важных файловых областях.</p>
<h4>Область I</h4>
<p>Область I содержит различные информационные файлы, которые могут помочь вам в работе с BBS. Эта область делится на три области. При выборе области I на экране появится следующее меню:</p>
<pre>
File Areas 

I.1                 ... Information: General
I.2                 ... Information: DialogueScience
I.3                 ... Information: Demo Versions

For more areas, type ".." to go up one level or "/" for top level areas.

File area [Area, "["=Prior, "]"=Next, "?"=List]:
</pre>
<p>Для выбора области достаточно ввести только младшее имя (в данном случае 1, 2 или 3).</p>
<p>В области I.1 находятся наиболее важные файлы:</p>
<pre>
JVDS.ZIP      131295 03-12-95* 000 JV DS BBS File list
-
CHAINIK.ZIP   34117 26-03-92  000 Для начинающих: 
                                  FIDO, BBS, модемы...
CHAINIKW.ZIP  39291 22-12-93  000 CHAINIK.TXT in WinWord format
FIDOFAQ.ZIP   29342 16-02-95  000 FidoNet FAQ
</pre>
<p>Файл JVDS.ZIP содержит полный список файлов, расположенных на BBS АО &ldquo;ДиалогНаука&rdquo;. Во время первого сеанса связи имеет смысл загрузить этот файл, так как в нем перечислены файлы, расположенные во всех файловых областях. Для каждого файла в списке приводится его длина в байтах и краткое однострочное описание.</p>
<p>Просмотрев полный список файлов, вы можете выбрать интересные для вас. Так как сеанс связи с BBS ограничен по времени, лучше сначала получить файл JVDS.ZIP и отключиться от BBS. Затем следует найти нужные вам файлы, просмотрев содержимое файла JVDS.TXT (который находится в архиве JVDS.ZIP), и позвонить на BBS еще раз. Поиск файлов в режиме On-Line отнимает слишком много времени.</p>
<div class="notel">
	<em>Не следует просматривать содержимое файловых областей во время сеанса с BBS, так как время сеанса ограничено. Лучше предварительно загрузить список файлов, которые есть на BBS, и выбрать из него нужные вам файлы. Этот список, который находится в файле JVDS.ZIP, содержит полный список файлов, расположенных на BBS, но вы, возможно, не будете иметь доступ во все перечисленные в нем области</em>
</div>
<p>Начинающие найдут для себя много интересного в файле CHAINIK.ZIP или CHAINIKW.ZIP. Эти файлы содержат базовые сведения о работе с модемами и BBS. Файл CHAINIK.ZIP содержит текстовый файл, который вы можете просмотреть в среде MS-DOS, файл CHAINIKW.ZIP содержит файл, предназначенный для просмотра в среде Microsoft Windows.</p>
<p>В файловой области I.2 находится рекламная информация о деятельности АО &ldquo;ДиалогНаука&rdquo;, образцы договоров, сведения о &ldquo;Компьютерной скорой помощи&rdquo;, руководство по антивирусному комплекту АО &ldquo;ДиалогНаука&rdquo;, а также фотографии известных авторов антивирусных программ, составляющих этот комплект.</p>
<p>В области I.3 вы найдете программу, демонстрирующую работу операционной системы Microsoft Windows 95.</p>
<h4>Область A</h4>
<p>Если вы подписчик, то область A для вас самая важная, потому что в ней вы найдете самые последние коммерческие версии антивирусных программ, входящие в комплект АО &ldquo;ДиалогНаука&rdquo;. Для остальных будут интересны некоммерческие версии антивирусных средств, распространяемых в соответствии с принципом SHAREWARE.</p>
<p>Область A имеет внутреннее иерархическое деление:</p>
<pre>
File Areas 

A.G                 ... Antiviruses: General
A.MC                ... Antiviruses: McAfee
A.X                 ... Antiviruses: Dr.Web virus base add-on
A.AI                ... Aidstest (V-Hunter), commercial
A.AW                ... Dr.Web, commercial
A.AD                ... ADinf, commercial
A.AE                ... ADinfExt, commercial

For more areas, type ".." to go up one level or "/" for top level areas.

File area [Area, "["=Prior, "]"=Next, "?"=List]:
</pre>
<p>Область A.G содержит некоммерческие версии антивирусных программ ADinf, Doctor Web и Aidstest, доступные всем. Кроме того, в этой области находятся другие антивирусные программы, распространяемые на принципе SHAREWARE, различная документация, имеющая отношение к борьбе с вирусами, программы демонстрации работы вирусов. Есть здесь и коллекционные вещи - две самые первые версии известной антивирусной программы Aidstest.</p>
<div class="notel">
	<em>Некоммерческие версии антивирусных программ доступны по линии общего доступа для всех</em>
</div>
<p>В области A.MC находятся антивирусные средства, разработанные фирмой McAfee Associatesи распространяемые на принципе SHAREWARE. Здесь вы найдете версии программ VirusScan для операционных систем DOS, Microsoft Windows и IBM OS/2, программу NetShield для Novell NetWare версий 3.х и 4.х и другие интересные вещи. Смотрите сами!</p>
<p>Область A.X содержит обновления вирусной базы данных для программы Doctor Web. Вы должны периодически заглядывать сюда и загружать самые последние дополнения. Эта область не является коммерческой и доступна всем желающим.</p>
<p>В области A.AI, которая делится на области A.AI.R, A.AI.E и A.AI.G, находятся, соответственно, русская, английская и немецкая версии антивирусной программы Aidstest с описанием вирусов и документацией. Причем, заметьте, это самые свежие версии.</p>
<p>Аналогично, в областях A.AW, A.AD и A.AE вы найдете самые свежие версии программ Doctor Web, ADinf и ADinfExt (русская, английская и немецкая версии). Файлы из этих областей доступны только подписчикам.</p>
<h4>Область Comm</h4>
<p>В файловой области Comm вы найдете самое разное телекоммуникационное программное обеспечение, от простейших терминальных программ, до средств работы с электронной почтой и создания электронных досок объявлений BBS. При необходимости вы сможете загрузить из этой области всю документацию, необходимую для работы с телекоммуникационными программами.</p>
<h4>Область UL</h4>
<p>Область UL предназначена для загрузки новых файлов. Если у вас есть доступ к этой области, вы сможете загружать сюда те файлы, которые по вашему мнению могут представлять интерес для других. После проверки загруженных файлов системный оператор BBS запишет их в другие области, доступные для чтения. Однако не следует загружать сюда файлы, зараженные вирусами, которые вы хотите передать в АО &ldquo;ДиалогНаука&rdquo; на исследование. Для этого предназначена область NV.</p>
<h4>Область NV</h4>
<p>Как мы только что сказали, область NV предназначена для передачи новых вирусов на исследование в АО &ldquo;ДиалогНаука&rdquo;. Вы можете записать в эту область файл, но не можете из нее ничего прочитать. Это понятно - ведь в противном случае кто-нибудь другой смог бы прочитать ваш зараженный файл и получить вместе с ним новый (или старый) вирус.</p>
<h3>Как получить новые версии антивирусных программ</h3>
<p>В этом разделе мы расскажем, как вы можете получить из BBS АО &ldquo;ДиалогНаука&rdquo; новые версии антивирусных программ, как коммерческие, так и некоммерческие, распространяемые на принципе SHAREWARE.</p>
<h4>Коммерческая версия программы Aidstest</h4>
<p>В этом разделе мы научим вас принимать новые версии антивирусных программ на примере программы Aidstest.</p>
<p>Итак, подключитесь к BBS &ldquo;ДиалогНаука&rdquo;, как это было описано раньше. Вы окажетесь в меню выбора области файлов, показанном ниже:</p>
<pre>
File Areas 

I                   ... Information
A                   ... Antiviruses
Comm                ... Communications
UL                  ... Unchecked Users Upload
NV                  ... New Viruses

File area [Area, "["=Prior, "]"=Next, "?"=List]:A
</pre>
<p>В ответ на приглашение введите символ A. Так как области файлов имеют иерархическую структуру, вы увидите содержимое области файлов A как список областей, представленный ниже:</p>
<pre>
File Areas 

A.G                 ... Antiviruses: General
A.MC                ... Antiviruses: McAfee
A.X                 ... Antiviruses: Dr.Web virus base add-on
A.AI                ... Aidstest (V-Hunter), commercial
A.AW                ... Dr.Web, commercial
A.AD                ... ADinf, commercial
A.AE                ... ADinfExt, commercial

For more areas, type ".." to go up one level or "/" for top level areas.

File area [Area, "["=Prior, "]"=Next, "?"=List]:AI
</pre>
<p>Если вам будет нужно вернуться в главное (корневое) меню области файлов, введите в ответ на приглашение символ &ldquo;/&rdquo; или &ldquo;..&rdquo;.</p>
<p>Для получения самой последней коммерческой версии программы Aidstest войдите в область A.AI. Вы увидите содержимое этой области:</p>
<pre>
File Areas 

A.AI.R              ... Antiviruses: Aidstest, russian
A.AI.E              ... Antiviruses: Aidstest (V-Hunter), english
A.AI.G              ... Antiviruses: Aidstest (V-Hunter), german

For more areas, type ".." to go up one level or "/" for top level areas.

File area [Area, "["=Prior, "]"=Next, "?"=List]:r
</pre>
<p>Теперь вы можете вернуться на один уровень иерархии выше, если введете в ответ на приглашение символ &ldquo;..&rdquo;. Для того чтобы попасть в корневое меню области файлов, следует ввести символ &ldquo;/&rdquo;.</p>
<p>В области A.AI вы можете выбрать три области, которые называются A.AI.R, A.AI.E и A.AI.G. В них расположены, соответственно, русская, английская и немецкая версии программы Aidstest.</p>
<p>Для получения русской версии войдите в область A.AI.R. Вы окажетесь в главном меню BBS АО &ldquo;ДиалогНаука&rdquo;:</p>
<pre>
MAIN (34 mins):
Message areas    File areas      Change setup        Bulletins
Yell for SysOp   Statistics      Goodbye (log off)   ?help
Select:f
</pre>
<p>Обратите внимание на первую строку этого меню. В скобках указано время в минутах, которое осталось до завершения сеанса связи с BBS. Это время постоянно уменьшается, так что не теряйте его даром!</p>
<p>В ответ на приглашение введите символ &ldquo;f&rdquo;. Вы окажетесь в меню FILE, предназначенном для работы с файлами из выбранной вами ранее области:</p>
<pre>
File area A.AI.R ... Antiviruses: Aidstest, russian

FILE (32 mins):
Area change         Locate a file  File titles  View text file
Download (receive)  Upload (send)  Statistics   Contents (archive)
Tag (queue) files   New files scan Main menu    Jump to msg. areas
Goodbye (log off)   ?help
Select:f
</pre>
<p>Найдите в этом меню строку Download (receive). Если ее нет, вы не имеете прав для получения файлов из этой области. В этом случае если вы являетесь подписчиком на антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;, оставьте сообщение системному оператору BBS.</p>
<p>Перед тем как загружать новую версию программы, просмотрите список файлов, которые есть в выбранной вами области. Для этого из приведенного выше меню выберите строку File titles. Чтобы это сделать, достаточно ввести в приглашении символ &ldquo;f&rdquo;.</p>
<p>Далее у вас появится возможность выбора - просмотреть все файлы или только новые, либо указать шаблон для поиска файлов:</p>
<pre>Files: ["*"=new, &lt;enter&gt;=all, or type a partial filename]:</pre>
<p>Для того чтобы просмотреть весь список файлов, нажмите клавишу &lt;Enter&gt;. Вы увидите примерно следующее:</p>
<pre>
DOC_VIR.LZH   134631 11-03-96  000 Краткое описание вирусов
DOC_LIST.LZH   24769 11-03-96  000 Информация о текущей версии
AIDS.LZH      161669 11-03-96  000 Aidstest.exe v 1447

File area A.AI.R ... Antiviruses: Aidstest, russian

FILE (31 mins):
Area change        Locate a file  File titles View text file
Download (receive) Upload (send)  Statistics  Contents (archive)
Tag (queue) files  New files scan Main menu   Jump to msg. areas
Goodbye (log off)  ?help
Select:d
</pre>
<p>Файл AIDS.LZH содержит самую последнюю версию антивирусной программы Aidstest. Именно его нам и нужно получить в первую очередь.</p>
<p>Для получения этого или любого другого файла, расположенного в выбранной области файлов, в ответ на приглашение из меню FILE введите символ &ldquo;d&rdquo;, выбрав строку Download. На экране появится список протоколов передачи данных, доступных на BBS АО &ldquo;ДиалогНаука&rdquo;:</p>
<pre>
Available protocols:

 +------------+
 | X)modem    |
 | 1)K-Xmodem |
 | Z)modem    |
 | S)EAlink   |
 | Y)modem    |
 | G)Ymodem-G |
 | Q)uit      |
 +------------+

Select:z
</pre>
<p>В этом списке вы должны выбрать протокол передачи данных, с которым способна работать ваша терминальная программа. Лучше всего выбрать протокол Zmodem, так как он обеспечивает высокую скорость передачи данных и динамически изменяет размер передаваемого блока в зависимости от качества линии связи. Кроме того, при обрыве связи он позволяет возобновить передачу файла с прерванного места (если включен соответствующий режим в вашей терминальной программе).</p>
<p>Если ваша терминальная программа не работает с протоколом Zmodem, попробуйте протоколы Ymodem или Xmodem. Более подробную информацию об использовании протоколов передачи данных вы найдете в 16 томе нашей серии книг &ldquo;Библиотека системного программиста&rdquo;.</p>
<p>Если вы выбрали протокол Zmodem, вам будет предложено ввести список файлов для загрузки:</p>
<pre>
Type "/q" on a blank line to abort download. Type "/e" to edit the
download list. Type "/g" to start the download and log off
afterwards.
For a normal download, simply press &lt;enter&gt;.

File(s) to download (#1): aids.lzh
(1) AIDS.LZH     (00:58, 161669 bytes)
File(s) to download (#2):
</pre>
<p>Вы должны вводить имена нужных вам файлов по одному, нажимая после ввода каждого имени клавишу &lt;Enter&gt;. Чтобы завершить процедуру ввода имен файлов, в ответ на очередное приглашение просто нажмите клавишу &lt;Enter&gt;. Если из одной области вам нужно получить несколько файлов, имеет смысл сделать это сразу.</p>
<p>После ввода имен всех файлов начнется процесс передачи данных. Вы увидите на экране следующее сообщение:</p>
<pre>
File: AIDS.LZH
Size: 161669 bytes (1264 Xmodem blocks)
Time: 0 minutes and 58 seconds (estimated)
Mode: Zmodem

Begin your download now, or hit &lt;Ctrl-X&gt; several times to cancel.

&lt;00000000000&gt;
</pre>
<p>В этом сообщении указано имя файла, его длина в байтах и блоках, приблизительное время передачи и протокол передачи данных. Время передачи зависит от скорости передачи данных, которая в конечном счете определяется модемом и качеством телефонной линии.</p>
<p>Когда передача будет закончена, на экране появится соответствующее сообщение и вы вернетесь в меню FILE:</p>
<pre>
Transfer completed.  (CPS=2426, 91%)

File area A.AI.R ... Antiviruses: Aidstest, russian

FILE (29 mins):
Area change        Locate a file  File titles  View text file
Download (receive) Upload (send)  Statistics   Contents (archive)
Tag (queue) files  New files scan Main menu    Jump to msg. areas
Goodbye (log off)  ?help
Select:m
</pre>
<p>Если вам больше ничего не нужно на BBS, выберите строку Goodbye (log off), для чего в приглашении введите символ &ldquo;g&rdquo;.</p>
<p>Для того чтобы перейти в другую файловую область (например, для того чтобы получить последнюю версию программы Doctor Web, выберите из этого меню строку Area change. Это можно сделать, если в ответ на приглашение ввести символ &ldquo;a&rdquo;.</p>
<p>Можно также вернуться в главное меню, выбрав строку Main menu. Для этого в приглашении нужно ввести символ m. Вы увидите следующее:</p>
<pre>
MAIN (1 mins):
Message areas   File areas     Change setup        Bulletins
Yell for SysOp  Statistics     Goodbye (log off)   ?help
Select:
</pre>
<h4>Коммерческая версия программы Doctor Web</h4>
<p>Получение последней коммерческой версии программы Doctor Web доступно для подписчиков и выполняется аналогично тому, как это было описано в предыдущем разделе.</p>
<p>Войдите в область файлов A.AW. Напомним, что для перемещения в иерархической системе вложенных областей файлов вы можете использовать команды &ldquo;..&rdquo; и &ldquo;/&rdquo;. Первая из них перемещает вас в корневую область, вторая - поднимает вверх на одну иерархическую ступень.</p>
<p>Ниже мы привели содержимое области файлов A.AW:</p>
<pre>
File Areas 

A.AW.R              ... Antiviruses: Dr.Web, russian
A.AW.E              ... Antiviruses: Dr.Web, english
A.AW.G              ... Antiviruses: Dr.Web, german

For more areas, type ".." to go up one level or "/" for top level areas.

File area [Area, "["=Prior, "]"=Next, "?"=List]:R
</pre>
<p>В областях A.AW.R, A.AW.E и A.AW.G находятся, соответственно, русская, английская и немецкая версии антивирусной программы Doctor Web.</p>
<p>Вот что вы увидите, если просмотрите список файлов в области A.AW.R:</p>
<pre>
-
-
Please check area AX for new virus base add-ons
-
WEB.LZH      176266 09-02-96  000 Dr.Web 3.09b, russian
WEB_DOC.LZH  239228 09-02-96  000 Dr.Web 3.09b, russian doc
DRWEBWW.LZH   19321 20-09-95  000 Dr.Web for Winword v 1.00
</pre>
<p>Файл WEB.LZH содержит последнюю версию программы Doctor Web. Документацию к ней вы найдете в файле WEB_DOC.LZH. В файле DRWEBWW.LZH находится антивирусное средство Doctor Web for Winword, предназначенное для текстового процессора Microsoft Word for Windows, способное обнаруживать и уничтожать макрокомандные вирусы в файлах документов.</p>
<p>Загрузив новую версию программы Doctor Web, просмотрите содержимое области файлов A.X, в которой лежат добавления к вирусной базе данных.</p>
<p>Ниже мы показали, как выглядит список файлов с добавлениями:</p>
<pre>
-
-
 ymmdd.ver, please read documentation !!!
-
WEB51008.305   1825 08-10-95  000
WEB51016.305   2009 16-10-95  000
WEB51026.305   2758 26-10-95  000
WEB51109.306   2087 09-11-95  000
WEB51226.307   4720 26-12-95  000
WEB60109.308   4662 09-01-96  000
WEB60118.308   4289 18-01-96  000
WEB60206.308   8103 06-02-96  000
WEB60213.309   2511 13-02-96  000
WEB60225.309   2442 25-02-96  000
</pre>
<p>В имени файла закодирована дата добавления. Например, файл WEB51109.306 был создан 9 сентября 1995 года. О том, как пользоваться добавлениями, вы можете прочитать в документации на программу Doctor Web.</p>
<p>Заметим, что переписывать дополнения к более ранним версиям программы Doctor Web нет смысла, так как они включены в состав последующих версий и не будут подключаться.</p>
<h4>Коммерческие версии программ ADinf и ADinfExt</h4>
<p>Последнюю версию программы ADinf подписчики смогут найти в области файлов A.AD, содержимое которой приведено ниже:</p>
<pre>
A.AD.R              ... Antiviruses: ADinf, russian
A.AD.E              ... Antiviruses: ADinf, english
A.AD.G              ... Antiviruses: ADinf, german
</pre>
<p>Для получения русской версии программы ADinf вы должны переписать файлы ADINF_1.LZH и ADINF_2.LZH из области A.AD.R:</p>
<pre>
-
-
Attention ! You need both files to install ADinf
-
Внимание! Для установки ADinf'а&nbsp; необходимы оба файла
-
ADINF_1.LZH  116276 03-03-96  000 ADinf 10.06, part 1 of 2
ADINF_2.LZH  206934 03-03-96  000 ADinf 10.06, part 2 of 2
</pre>
<p>Самая последняя версия лечащего модуля ADinfExt находится в области файлов A.AE:</p>
<pre>
A.AE.R              ... Antiviruses: ADinfExt, russian
A.AE.E              ... Antiviruses: ADinfExt, english
A.AE.G              ... Antiviruses: ADinfExt, germany
</pre>
<p>Содержимое области A.AE.R (русская версия программы ADinfExt) представлено ниже:</p>
<pre>
-
-
Attention ! You need both files to install ADinfExt
-
Внимание! Для установки ADinfExt'а&nbsp;необходимы оба файла
-
ADINFX_1.LZH 120081 03-03-96  000 ADinfExt 3.04, part 1 of 2
ADINFX_2.LZH  58642 03-03-96  000 ADinfExt 3.04, part 2 of 2
</pre>
<p>Вам нужно загрузить из этой области файлы ADINFX_1.LZH и ADINFX_2.LZH.</p>
<h4>Некоммерческие версии антивирусных программ</h4>
<p>Если вы не являетесь подписчиком на антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;, это не значит, что вам нечего делать на BBS. Позвоните по линии общего доступа и войдите в область файлов A.G. Здесь вы найдете немало интересного.</p>
<p>Для примера приведем сокращенный список файлов, которые вы можете загрузить из этой области:</p>
<pre>
ADINFNCR.ZIP 310556 25-02-96  000 ADinf 10.06, noncommercial
                                  version, russian
ADINFNCE.ZIP 278476 28-02-96  000 ADinf 10.06, noncommercial
                                  version, english
ADINFNCG.ZIP 283533 28-02-96  000 ADinf 10.06, noncommercial
                                  version, german
AIDSR.ZIP    279977 30-10-95  000 Aidstest (V-Hunter) 1369,
                                  russian, noncommercial version
AIDSG.ZIP    156150 04-03-96  000 Aidstest (V-Hunter) 1369,
                                  german, noncommercial version
AIDSE.ZIP    159102 04-03-96  000 Aidstest (V-Hunter) 1369,
                                  english, noncommercial version
-
-
Please check area AX for Dr.Web virus base add-on
-
WEB.LZH      368699 05-12-95  000 Dr.Web 3.07b, noncommercial
                                  version, russian
WEBE.LZH     191186 05-12-95  000 Dr.Web 3.07b, noncommercial 
                                  version, english
WEBG.LZH     198813 05-12-95  000 Dr.Web 3.07b, noncommercial
                                  version, german
DRWEBWW.LZH   19321 20-09-95  000 Dr.Web for WinWord v 1.00
-
BOOTCHK.ZIP   36221 15-09-95  000 Анализатор дискет 
                                  BootChecker 3.11
-
AVL100.ZIP   173719 20-03-93  000 Antiviral Researcher's Toolkit
FP-218A.ZIP  564540 08-06-95  000 F-prot 2.18a antivirus package
SDSCAN.ZIP   360331 05-04-94  000 SDscan antivirus
SOS947.ZIP    43884 31-01-94  000 SOS by Sen v.9.47
TBAV632.ZIP  278846 23-02-95  000 Thunderbyte antivirus v 6.32
TBAVW632.ZIP 206740 23-02-95  000 Thunderbyte antivirus
                                  for Win v 6.32
TBAVX632.ZIP  90264 23-02-95  000 Thunderbyte antivirus 
                                  v6.32, optimized *.exe
TRAP4VIR.ZIP   4867 05-03-90  000 Traps for viruses
VACCINE.ZIP   14764 14-10-95  000 Вакцина для *.exe файлов
-
-
Boot Sector Antiviruses
-
VITAMINB.ZIP  16734 30-06-92  000 Boot sector virus protector 2.0
                                  by A.Sessa.
VFORMAT.ZIP   20786 04-11-91  000 Format &amp; boot sector virus
                                  protect 1.9 by A.Sessa
-
-
Documentation
-
ADINFQ&amp;A.ZIP  20168 02-09-95  000 ADinf. Часто задаваемые вопросы
ADINFQAE.ZIP   6242 02-09-95  000 ADinf. QUESTIONS AND ANSWERS 
ADINFEXT.ZIP   9889 02-09-95  000 ADinf Cure Module (ADinfExt)
-
MVDEMO.ZIP    12498 16-09-91  000 MARTINs Virus Demonstrator.
VIRUS.ZIP     21534 12-02-90  000 Virus simulators (not virulent)
VBOOK.ZIP    160176 20-09-89  000 Virus Presentation (McAfee)
AIDS001.ZIP    9151 17-11-88  000 Для коллекционеров: самая
                                  первая версия AIDSTEST'a
                                  (подтверждено автором)
AIDS002.ZIP    9821 16-12-88  000 Для коллекционеров:
                                  вторая версия Aidstest'a
</pre>
<p>Обратите внимание на файлы ADINFNCR.ZIP, AIDSR.ZIP, WEB.LZH и DRWEBWW.LZH. В них находятся некоммерческие версии всех основных антивирусных программ, входящих в антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;. Эти версии вы можете использовать бесплатно, однако по времени выпуска они всегда отстают от коммерческих примерно на два месяца. Не забывайте об этом, так как каждый день появляются новые вирусы. Кроме того, в этой области находится только некоммерческая версия программы ADinf.</p>
<p>Обратите также внимание на анализатор дискет BOOTCHK.ZIP а также на раздел документации, в котором есть информация по программе ADinf и лечебному модулю ADinfExt.</p>
<h3>Просмотр сообщений</h3>
<p>Пользуясь электронной доской BBS АО &ldquo;ДиалогНаука&rdquo;, вы можете кроме всего прочего послать сообщение авторам антивирусных программ Дмитрию Лозинскому (автор программы Aidstest) и Игорю Данилову (автор программы Doctor Web).</p>
<p>Прежде всего войдите в главное меню BBS:</p>
<pre>
MAIN (35 mins):
Message areas   File areas     Change setup        Bulletins
Yell for SysOp  Statistics     Goodbye (log off)   ?help
Select:m
</pre>
<p>В приглашении введите символ &ldquo;m&rdquo;. После этого вы окажетесь в разделе сообщений:</p>
<pre>
The MESSAGE Section
There are 117 messages in this area.  The highest is #117
You haven't read any of these.

[0 / 117]  Msg.area L1 ... Comments to the SysOp
           Press &lt;enter&gt; for the NEXT message.

MESSAGE (35 mins):
Area change        Next message       Previous message   
Enter message      Reply to a message 
Change current msg =ReadNonStop       -ReadOriginal 
+ReadReply         *ReadCurrent       List (brief)
Tag areas          Main menu          Jump to file areas  
Goodbye (log off)  Kill (delete) msg  Upload a message 
Forward (copy)     $Reply Elsewhere
^Download Attaches ?help
Select:a
</pre>
<p>Из меню MESSAGE выберите строку Area change. Для этого введите в приглашении символ &ldquo;a&rdquo;.</p>
<p>На экране появится список доступных вам областей сообщений:</p>
<pre>
Message Areas 

*L1         ... Comments to the SysOp
*L2         ... Local Messages
 L3         ... Messages to Dmitry Lozinsky &amp; Igor Daniloff

Message area [Area, "["=Prior, "]"=Next, "?"=List]:
</pre>
<p>Область L1 предназначена для передачи сообщений системному оператору BBS АО &ldquo;ДиалогНаука&rdquo;. В области L2 происходит свободный обмен сообщениями между пользователями, зарегистрированными на BBS. Что же касается области L3, то она предназначена для передачи сообщений авторам антивирусных программ.</p>
<p>Вы можете просмотреть список пользователей BBS АО &ldquo;ДиалогНаука&rdquo;, если выберете из меню Main menu строку Statistics и затем строку UserList. При этом на экране появится следующее сообщение:</p>
<pre>
Press &lt;enter&gt; to list all, or
type a partial name to match:
</pre>
<p>Если ввести в ответ на него начальные буквы имени пользователя, она покажет всех пользователей, в имени или фамилии которых встречаются введенные вами буквы. Можно нажать клавишу &lt;Enter&gt; и просмотреть полный список пользователей, однако эта процедура может отнять много времени - список довольно длинный.</p>
<p>Для перехода к нужной вам области достаточно ввести обозначение этой области в приглашении Message area.</p>
<p>Для просмотра списка сообщений, находящихся в области, выберите строку List (brief). Для более детального просмотра сообщений используйте строку Browse messages.</p>
<p>Вы можете записать свое сообщение, выбрав строку Enter message, или ответить на сообщение другого пользователя, выбрав строку Reply to a message.</p>
<p>С помощью строки Main menu можно вернуться в главное меню BBS. Выбрав строку Jump to file areas, можно перейти в область файлов.</p>
<h2>6 Восстановление файловой системы</h2>
<p>Как правило, опасные вирусы полностью или частично разрушают файловую систему, после чего пользователи теряют доступ ко всем или только некоторым файлам, причем не только программным, но и к файлам данных. Именно такое воздействие вирусов наносит максимальный ущерб, так как файлы документов могут соедржать чрезвычайно ценную информацию, ущерб от потери которой может превышать стоимость компьютера во много раз.</p>
<p>Поэтому когда вы приступаете к лечению компьютера, зараженного вирусами, или имеющего поврежденную файловую систему, в первую очередь необходимо выгрузить с его дисков все нужные вам файлы данных. Если в процессе лечения вы потеряете программные файлы, то скорее всего сможете их восстановить без особых проблем, воспользовавшись дистрибутивами или обратившись в фирму, где вы приобретали программы. Потеря же ваших данных невосполнима, и если вы регулярно не выполняете резервное копирование, последствия вирусной атаки могут быть очень неприятными.</p>
<p>Как правило, антивирусные программы, такие как Doctor Web или Aidstest, вылечивают компьютер и автоматически восстанавливают поврежденную файловую систему. Однако бывают случаи, когда и эти программы оказываются бессильными. Например, вирус может уничтожить таблицу размещения файлов или элемент каталога, соответствующий файлу, при этом данные могут оставаться на диске и вы еще сможете их восстановить.</p>
<p>Скажем сразу, что &ldquo;ручное&rdquo; восстановление файловой системы доступно только опытным пользователям. Если вы не знакомы в деталях со структурой файловой системы, для восстановления потерянных в результате вирусной атаки данных лучше всего обратиться к специалистам из компьютерной скорой помощи АО &ldquo;ДиалогНаука&rdquo;. В крайнем случае можно попробовать восстановить файловую систему такими средствами, как программа SCANDISK.EXE, входящей в комплект поставки современных версий MS-DOS, или программой Norton Disk Doctor. Однако результаты такого восстановления могут быть неудовлетворительными.</p>
<p>В этой главе мы поможем опытным пользователям выполнить самые важные действия по проверке и восстановлению файловой системы MS-DOS с использованием различных программных средств, в первую очередь с использованием программы Norton Disk Editor. Эта программа позволяет просматривать и редактировать содержимое отдельных секторов диска и очень удобна для проведения восстановительных работ.</p>
<p>Восстановление файловой системы необходимо начинать с проверки ее состояния. Именно об этом мы и будем говорить в этой главе.</p>
<h3>Проверка файловой системы</h3>
<p>Перед тем как начинать восстановление файловой системы, необходимо определить масштаб повреждений. Для этого вы должны тщательно проверить содержимое всех структур данных файловой системы.</p>
<p>С чего лучше начинать проверку файловой системы?</p>
<p>Прежде всего следует проверить установку параметров BIOS, среди которых есть такие ключевые параметры, как типы установленных в компьютере жестких дисков, количество дорожек и секторов на одной дорожке. Если эти параметры установлены неправильно, загрузка операционной системы скорее всего будет невозможна.</p>
<p>Далее необходимо проверить содержимое так называемой главной загрузочной записи MBR (Master Boot Record). В этой записи есть программа начальной загрузки и таблица разделов диска Partition Table. Программа начальной загрузки является объектом атаки загрузочных и файлово-загрузочных вирусов, которые записывают сюда свое тело. При повреждении таблицы разделов диска некоторые или все логические диски будут недоступны для DOS.</p>
<p>На следующем этапе вы должны проверить загрузочную запись Boot Record, которая располагается в самом начале логического диска (не путайте ее с главной загрузочной записью MBR). В загрузочной записи располагается программа начальной загрузки операционной системы, расположенной на логическом диске, а также блок параметров BIOS, который называется BPB (BIOS Parameter Block). Блок BPB содержит важную информацию о логическом диске, такую, например, как размер кластера. Вирус может записать свое тело на место загрузочной записи и повредить блок BPB.</p>
<div class="notes">
	<p><em>3nop</em></p>
	<p><em>Очень опасный загрузочный вирус. Заражает главную загрузочную запись MBR на жестком диске и загрузочную запись дискет.</em></p>
	<p><em>Если первый байт на загрузочном секторе имеет значение 0E9h,  то  вирус записывает на место загрузочной программы свой  код, способный заразить главную загрузочную запись MBR жесткого диска и загрузочные секторы дискет</em></p>
</div>
<p>После выполнения проверки загрузочной записи следует заняться таблицей размещения файлов FAT. В этой таблице находится критически важная информация о расположении отдельных кластеров для всех записанных на данном логическом диске файлов. На диске находится две копии таблицы FAT. Вы можете использовать вторую копию FAT для восстановления.</p>
<p>На следующем этапе нужно проверить корневые каталоги логических дисков, а также все нужные вам вложенные каталоги. При необходимости вы должны восстановить испорченные элементы каталогов, описывающие нужные вам файлы.</p>
<p>Ниже мы подробно рассмотрим все эти действия. Попутно мы приведем всю необходимую информацию о важнейших структурах данных файловой системы.</p>
<h4>Проверка параметров BIOS</h4>
<p>Когда вы первый раз подходите к компьютеру, возможно зараженному вирусом, необходимо вначале проверить параметры BIOS, которые хранятся в CMOS. Для просмотра и изменения параметров BIOS предназначена специальная программа, которая называется BIOS Setup.</p>
<p>Способ запуска программы BIOS Setup зависит от ее изготовителя и версии, однако обычно запуск выполняется, если во время начального теста оперативной памяти нажать клавиши &lt;Delete&gt;, &lt;F2&gt; или комбинацию клавиш &lt;Alt+Ctrl+Esc&gt;. Более точную информацию вы можете получить из документации, которая прилагается к системной плате компьютера.</p>
<p>Выключите питание компьютера, если оно было включено, и через 20-30 секунд включите его опять. Такая процедура гарантированно &ldquo;убивает&rdquo; резидентные вирусы, &ldquo;выживающие&rdquo; после теплой перезагрузки с помощью комбинации клавиш &lt;Ctrl+Alt+Del&gt;. Когда начнется тест памяти, нажмите одну из перечисленных выше клавиш для запуска программы BIOS Setup.</p>
<p>Через некоторое время на экране появится окно программы BIOS Setup, внешний вид которого зависит от изготовителя и версии программы. На рис. 6.1 мы показали внешний вид такого окна для программы BIOS Setup, созданной фирмой AMI.</p>
<div align="center">
	<img src="img/aaf00/fig61.gif" alt="Рис. 6.1. Окно программы BIOS Setup, созданной фирмой AMI" />
	<p><strong>Рис. 6.1. Окно программы BIOS Setup, созданной фирмой AMI</strong></p>
</div>
<p>Прежде всего вам нужно выбрать в меню программы строку STANDARD CMOS SETUP и проверить установку стандартных параметров BIOS. Обратите особое внимание на типы и параметры установленных жестких дисков (Hard disk), типы накопителей на гибких магнитных дисках (Floppy Drive) и дату. Примерный вид таблицы, в которой отображаются стандартные параметры, показан на рис. 6.2.</p>
<div align="center">
	<img src="img/aaf00/fig62.gif" alt="Рис. 6.2. Просмотра стандартных параметров BIOS" />
	<p><strong>Рис. 6.2. Просмотра стандартных параметров BIOS</strong></p>
</div>
<p>Перепишите параметры жестких дисков, такие как тип, количество цилиндров, головок и секторов на одной дорожке. Сравните эти значения с паспортными данными, взятыми из документации на жесткий диск. Вирусы могут уменьшать количество дорожек, записывая свое тело в конец диска. Поэтому если значения не совпадают с паспортными, это выглядит очень подозрительно.</p>
<p>Напомним, что тип диска представляет собой число, которое обычно лежит в диапазоне значений от 1 до 47. При этом типам от 1 до 46 соответствуют стандартные наборы параметров.</p>
<p>Как правило, для современных устройств IDE указывается тип 47, который позволяет выполнять ручную установку количества цилиндров, головок и секторов на одной дорожке, а также других. Если в параметрах BIOS установлен 47 тип диска, обязательно проверьте параметры по документации, которая поставляется вместе с диском.</p>
<p>В некоторых случаях может быть указан тип диска с номером 1, хотя в компьютере установлен жесткий диск очень большого размера (типу 1 соответсвует размер диска 10 Мбайт). Это означает, что диск полключен через контроллер, имеющий собственные программы обслуживания в постоянном запоминающем устройстве (ПЗУ).</p>
<p>Иногда оба диска отмечены в параметрах BIOS как Not Installed, однако компьютер нормально работает и операционная система загружается с диска C: (примером может служить портативный компьютер B-300 фирмы Bondwell). В этом случае контроллер диска также имеет собственные программы обслуживания.</p>
<div class="notes">
	<p><em>Vlad</em></p>
	<p><em>Неопасный загрузочный вирус. Записывает свой код в перепрограммируемое ПЗУ Flash BIOS, если оно имеется в компьютере.</em></p>
</div>
<p>Если операционная система не загружается с жесткого диска, прежде всего следует проверить параметры BIOS. Эти параметры могут быть установлены неправильно в результате разряда аккумуляторной батареи, расположенной на основной плате компьтера или в результате вирусной атаки.</p>
<p>Обратите также внимание на тип накопителя на гибких магнитных дисках (НГМД). Если НГМД с обозначением A: отмечен как Not Installed, вы не сможете загрузить операционную систему с чистой дискеты, свободной от вирусов.</p>
<p>Некоторые вирусы специально отключают устройство A: для того чтобы затруднить процедуру лечения. Когда какая-нибудь программа обращается к устройству A:, вирус перехватывает такое обращение и временно подключает устройство, а затем, после выполнения операции, подключает его снова. Смысл такой процедуры заключается в том, что при отключенном устройстве A: операционная система загружается с диска C: (к счастью, это верно не для всех компьютеров). При этом вирус получает управление первым и контролирует загрузку операционной системы с чистой дискеты.</p>
<div class="notes">
	<p><em>SMEG.Pathogen.3732</em></p>
	<p><em>Очень  опасный полиморфный вирус, использующий довольно сложный алгоритм шифровки.</em></p>
	<p><em>В понедельник может записать в байт CMOS с номером 10h значение 0 (тип используемых НГМД). Это означает, что устройства НГМД не установлены. После этого вирус корректирует контрольную сумму CMOS (ячейки 2Eh-2Fh), чтобы при инициализации системы BIOS "не заподозрил" неладное. После  данных манипуляций компьютер "не видит" устройства НГМД.</em></p>
	<p><em>Также при определенных условиях в понедельник в 11 часов вирус может вывести на экран следующий текст:</em></p>
	<blockquote>
		<p><em>Your hard-disk is being corrupted, courtesy of PATHOGEN!</em></p>
		<p><em>Programmed in the U.K. (Yes, NOT Bulgaria!) [C] The Black Baron 1993-4. Featuring SMEG v0.1: Simulated Metamorphic Encryption Generator!</em></p>
		<p><em>'Smoke me a kipper, I'll be back for breakfast.....'</em></p>
		<p><em>Unfortunately some of your data won't!!!!!</em></p>
	</blockquote>
	<p><em>После этого вирус перехватывает обработчик  прерывания от клавиатуры INT 09h и уничтожает информацию в случайных секторах первого жесткого диска. Если в этот момент не перегрузить компьютер кнопкой "RESET" или не выключить питание, то содержимое диска может быть полностью уничтожено (комбинация клавиш &lt;Ctrl+Alt+Del&gt; не поможет)</em></p>
</div>
<p>В завершении процедуры проверки параметров BIOS выберите из главного меню программы BIOS Setup строку ADVANCED CMOS SETUP. На экране появится меню настройки расширенных параметров BIOS (рис. 6.3).</p>
<div align="center">
	<img src="img/aaf00/fig63.gif" alt="Рис. 6.3. Меню настройки расширенных параметров BIOS" />
	<p><strong>Рис. 6.3. Меню настройки расширенных параметров BIOS</strong></p>
</div>
<p>В этом меню обратите внимание на строку System Boot Up Sequence, в которой определяется порядок загрузки операционной системы. Если в этой строке указан порядок загрузки C:, A:, вы не сможете загрузить операционную систему с дискеты. Так как для поиска вирусов вы <em>обязательно</em> должны загрузить DOS с чистой дискеты, измените порядок загрузки на A:, C:.</p>
<p>После завершения всех работ с компьютером верните установку C:, A: или C: Only (если такое значение есть в данной версии BIOS). В этом случае компьютер будет надежно защищен от заражения загрузочным вирусом через накопитель на гибких магнитных дисках.</p>
<p>Перед тем как перейти к следующему этапу анализа состояния файловой системы компьютера, убедитесь в том, что в стандартных параметрах BIOS установлен правильный тип диска, что НГМД с обозначением A: подключен и его тип также указан правильно. Кроме этого, в расширенных параметрах BIOS установите порядок загрузки A:, C:.</p>
<p>В некоторых случаях содержимое памяти CMOS разрушается. Это может произойти, например, при выходе из строя аккумуляторной батареи, которая питает память CMOS, или в результате воздействия вируса.</p>
<p>Если это произошло, вы должны восстановить параметры BIOS, воспользовавшись для этого программой BIOS Setup. Как правило, эта программа предоставляет вам возможность установить параметры BIOS, принятые по умолчанию.</p>
<p>Программа BIOS Setup, созданная фирмой AMI, позволяет вам загрузить два набора параметров BIOS.</p>
<p>Первый из них загружается при выборе в главном меню программы (рис. 6.1) строки AUTO CONFIGURATION WITH BIOS DEFAULTS. Этот набор параметров предназначен для нормальной работы системной платы и может быть оптимизирован вручную (при помощи строки ADVANCED CMOS SETUP).</p>
<p>Второй набор параметров соответствует строке AUTO CONFIGURATION WITH POWER-ON DEFAULTS и используется главным образом в тех случаях, когда с первым набором компьютер не запускается. Во втором наборе устанавливаются более консервативные параметры (например, отключается кэширование основной оперативной памяти), что иногда позволяет запустить даже частично неисправный компьютер.</p>
<h4>Анализ главной загрузочной записи MBR и таблицы разделов</h4>
<p>Когда программа FDISK.EXE впервые создает разделы на жестком диске, она записывает в начало самого первого сектора жесткого диска (сектор 1, дорожка 0, головка 0) главную загрузочную запись MBR.</p>
<p>Главная загрузочная запись является программой, которая во время начальной загрузки операционной системы с жесткого диска помещается по адресу 7C00h:0000h, после чего ей передается управление. Загрузочная запись продолжает процесс загрузки операционной системы.</p>
<p>Заметим, что указанный механизм работает и в том случае, если на диске компьютера вместо DOS установлена какая-нибудь другая операционная система, например, Microsoft Windows 95, Microsoft Windows NT, IBM OS/2 Warp или UNIX.</p>
<p>Если вирус заражает главную загрузочную запись, он получает управление до загрузки операционной системы и может противодействовать даже самым современным антивирусным средствам, применяя стелс-технологию.</p>
<p>Визуально отличить нормальный главный загрузочный сектор от зараженного бывает не всегда просто. Иногда вирус изменяет только несколько байт, в которых записан адрес загрузочного сектора операционной системы, оставляя программу загрузки нетронутой. Такие изменения можно обнаружить только дизассемблированием и последующим анализом восстановленного исходного текста программы загрузки. В некоторых случаях изменения настолько заметны, что их можно обнаружить &ldquo;невооруженным глазом&rdquo;, просто взглянув на дамп самого первого сектора диска.</p>
<div class="notes">
	<p><em>BootCom.Peanut.445</em></p>
	<p><em>Опасный резидентный вирус с элементами стелс-технологии.</em></p>
	<p><em>Заражает главную загрузочную запись MBR жесткого диска, загрузочные секторы дискет, а также COM-файлы в момент их запуска. Если запустить инфицированный COM-файл или загрузить операционную систему с зараженной дискеты, вирус поражает главную загрузочную запись диска.</em></p>
	<p><em>При загрузке с инфицированного жесткого диска вирус размещает свою резидентную копию в верхних адресах памяти и перехватывает прерывание INT 13h. После запуска первой EXE-программы вирус перехватывает прерывание INT 21h.</em></p>
	<p><em>Вирус не сохраняет оригинальный загрузочный сектор дискеты.</em></p>
	<p><em>Когда программа или операционная система пытается прочитать содержимое главного загрузочного сектора MBR с помощью прерывания INT 21h, вирус подставляет на место зараженного оригинальный сектор MBR</em></p>
</div>
<p>Другая важнейшая часть первого сектора диска - таблица разделов диска Partition Table.</p>
<p>В ней имеется четыре элемента, которые описывают до четырех разделов диска. В последних двух байтах сектора находится значение 55AAh. Это признак таблицы разделов (сигнатура таблицы разделов).</p>
<p>В разделах диска располагаются логические диски. Обычно создается один первичный раздел для диска C: и один вторичный раздел, в котором создаются логические диски D:, E: и т. д.</p>
<h5>Описание формата таблицы разделов</h5>
<p>Формат самого первого сектора жесткого диска можно представить следующим образом:</p>
<table summary="" border="1">
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>1BEh</td><td>Главная загрузочная запись</td></tr>
<tr><td>1BEh</td><td>10h</td><td>Элемент таблицы разделов диска</td></tr>
<tr><td>1CEh</td><td>10h</td><td>Элемент таблицы разделов диска</td></tr>
<tr><td>1DEh</td><td>10h</td><td>Элемент таблицы разделов диска</td></tr>
<tr><td>1EEh</td><td>10h</td><td>Элемент таблицы разделов диска</td></tr>
<tr><td>1FEh</td><td>2</td><td>Признак таблицы разделов - значение 0AA55h</td></tr>
</table>
<p>Как видно из этой таблицы, байты со смещением от 0 до 1BEh (шестнадцатиричное значение) занимает главная загрузочная запись, то есть программа. Далее идут четыре элемента талицы разделов, причем каждый элемент занимает 10h байт. После таблицы располагаются два байта признака таблицы разделов.</p>
<p>В элементе таблицы раздела записана информация о расположении и размере раздела в секторах, а также о назначении раздела. Формат элемента таблицы раздела представлен ниже:</p>
<table summary="" border="1">
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>1</td><td>Признак активного раздела:
	<p>0 раздел неактивный;</p>
	<p>80h раздел активный</p></td></tr>
<tr><td>1</td><td>1</td><td>Номер головки для начального сектора раздела</td></tr>
<tr><td>2</td><td>2</td><td>Номер сектора и дорожки для начального сектора раздела</td></tr>
<tr><td>4</td><td>1</td><td>Код операционной системы, которой принадлежит данный раздел:
	<p>0 неизвестная система или свободный элемент таблицы разделов;</p>
	<p>1, 4 MS-DOS;</p>
	<p>5 расширенный раздел MS-DOS</p></td></tr>
<tr><td>5</td><td>1</td><td>Номер головки для последнего сектора раздела</td></tr>
<tr><td>6</td><td>2</td><td>Номер сектора и дорожки для последнего сектора раздела</td></tr>
<tr><td>8</td><td>4</td><td>Относительный номер сектора начала раздела</td></tr>
<tr><td>0Ch</td><td>4</td><td>Размер раздела в секторах</td></tr>
</table>
<p>Первый байт элемента таблицы раздела содержит признак активного раздела. Если раздел активный, из него будет выполняться загрузка операционной системы. Диск может содержать одновременно несколько активных разделов, которые могут принадлежать разным операционным системам.</p>
<p>Следующие три байта определяют физический адрес на диске начального сектора раздела (который описывает данный элемент раздела).</p>
<p>В байте со смещением 1 записан номер головки начального сектора раздела. В двухбайтовом поле со смещением 2 закодированы номера сектора и дорожки самого первого сектора раздела. При этом биты 0...5 этого поля задают номер сектора, а биты 6...15 - номер дорожки (рис. 6.4).</p>
<div align="center">
	<img src="img/aaf00/fig64.gif" alt="Рис. 6.4. Формат слова, содержащего номер сектора и номер дорожки" />
	<p><strong>Рис. 6.4. Формат слова, содержащего номер сектора и номер дорожки</strong></p>
</div>
<p>Байт со смещением 4 содержит код операционной системы, создавшей раздел. Операционная система MS-DOS отмечает первичный раздел кодом 1 или 4, расширенный - кодом 5. Для разделов, созданных другими операционными системами, в этом поле будут находиться другие значения.</p>
<p>В байте со смещением 5 и двухбайтовом слове со смещением 6 записаны номер головки, сектора и дорожки последнего раздела. Номер сектора и дорожки хранится в формате, показанном на рис. 6.4.</p>
<p>Последние два поля элемента таблицы разделов имеют длину 4 байта и содержат, соответственно, относительный номер самого первого сектора в разделе (т. е. относительный номер сектора начала раздела) и количество секторов, имеющихся в разделе.</p>
<p>Остановимся подробнее на относительном номере самого первого сектора в разделе.</p>
<p>Значение относительного номера, равное 0, соответствует дорожке 0, головке 0, сектору 1. При увеличении относительного номера сектора вначале увеличивается номер сектора на дорожке, затем номер головки, и, наконец, номер дорожки. Зная номер дорожки, номер сектора на дорожке и номер головки, можно вычислить относительный номер сектора по следующей формуле:</p>
<pre>RelSect = (Cyl * Sect * Head) + (Head * Sect) + (Sect - 1)</pre>
<p>Здесь Cyl  обозначает номер дорожки, Sect - номер сектора на дорожке, Head - номер головки.</p>
<p>Обычно разделы диска начинаются с четных номеров дорожек, за исключением самого первого раздела. Этот раздел может начинаться с сектора 2 нулевой дорожки (головка 0), так как самый первый сектор диска занят главной загрузочной записью.</p>
<p>Для наглядности мы воспроизвели из 19 тома нашей серии книг &ldquo;Библиотека системного программиста&rdquo; пример схемы разеделения жесткого диска на разделы (рис. 6.5).</p>
<div align="center">
	<img src="img/aaf00/fig65.gif" alt="Рис. 6.5. Пример разделения диска на разделы" />
	<p><strong>Рис. 6.5. Пример разделения диска на разделы</strong></p>
</div>
<p>Как вы знаете, для создания первичного и расширенного разделов диска используется программа FDISK.EXE, входящая в состав дистрибутива MS-DOS.</p>
<p>Первичный раздел должен быть единственным и активным, он используется как диск С: и из него выполняется загрузка операционной системы. В расширенном разделе программа FDISK.EXE создает логические диски D:, E: и т. д. Расширенный раздел не может быть активным, следовательно, из логических дисков, расположенных в этом разделе, невозможно выполнить загрузку операционной системы.</p>
<p>Если байт кода операционной системы системы имеет значение 5, то в начале соответствующего раздела располагается сектор, содержащий таблицу логических дисков. Эта таблица является расширением таблицы разделов диска, расположенной в самом первом секторе физического диска.</p>
<p>Таблица логических дисков имеет формат, аналогичный таблице разделов диска, но содержит только два элемента. Один из них указывает на первый сектор логического диска MS-DOS, он имеет код системы 1 или 4. Второй элемент может иметь код системы 5 или 0. Если этот код равен 5, то элемент указывает на следующую таблицу логических дисков. Если код системы равен 0, то соответствующий элемент не используется.</p>
<p>Таким образом, таблицы логических дисков связаны в список. Элемент таблицы разделов диска с кодом системы, равным 5, указывает на начало этого списка.</p>
<p>Для таблицы логических дисков имеется отличие в использовании полей границ логических дисков.</p>
<p>Если код системы равен 1 или 4, эти границы вычисляются относительно начала расширенного раздела. Для элемента с кодом системы 5 используется абсолютная адресация (относительно физического начала диска).</p>
<h5>Проверка таблицы разделов при помощи программы DISKEDIT.EXE</h5>
<p>Наиболее удобное, на наш взгляд, средство анализа логических структур файловой системы - редактор диска DISKEDIT.EXE, который входит в пакет Norton Utilities. Лучше всего записать эту программу на системную дискету, так как только при загрузке с такой дискеты вы сможете исследовать файловую систему, зараженную вирусами или разрушенную файловую систему, когда DOS не загружается с жесткого диска.</p>
<p>Меню Object предоставляет вам широкие возможности выбора структуры для просмотра (рис. 6.6).</p>
<div align="center">
	<img src="img/aaf00/fig66.gif" alt="Рис. 6.6. Меню Object программы DISKEDIT.EXE из пакета Norton Utilities" />
	<p><strong>Рис. 6.6. Меню Object программы DISKEDIT.EXE из пакета Norton Utilities</strong></p>
</div>
<p>Для начала выберите из этого меню строку Drive. Если на физическом жестком диске имеются исправные разделы с определенными в них логическими дисками, вы увидите список логических дисков, показанный на рис. 6.7.</p>
<div align="center">
	<img src="img/aaf00/fig67.gif" alt="Рис. 6.7. Просмотра списка логических дисков" />
	<p><strong>Рис. 6.7. Просмотра списка логических дисков</strong></p>
</div>
<p>В данном случае для просмотра доступны логические диски C: и D:, расположенные, соответственно, в основном и расширенном разделах.</p>
<p>Если файловая система компьютера разрушена до такой степени, что невозможно выполнить загрузку операционной системы с диска C:, а при ее загрузке с устройства A: не видно ни одного логического диска, при выборе строки Drive вам будет показан список физических дисков (рис. 6.8).</p>
<div align="center">
	<img src="img/aaf00/fig68.gif" alt="Рис. 6.8. Просмотр списка физических дисков, установленных в компьютере" />
	<p><strong>Рис. 6.8. Просмотр списка физических дисков, установленных в компьютере</strong></p>
</div>
<p>Для просмотра самого первого сектора физического диска, содержащего главную загрузочную запись и таблицу разделов, выберите физический диск Hard Disk 1 и нажмите кнопку OK. После этого на экране появится содержимое искомого сектора в виде дампа (рис. 6.9).</p>
<div align="center">
	<img src="img/aaf00/fig69.gif" alt="Рис. 6.9. Просмотр содержимого первого сектора первого физического диска" />
	<p><strong>Рис. 6.9. Просмотр содержимого первого сектора первого физического диска</strong></p>
</div>
<p>Сектор имеет размер 512 байт, поэтому на одном экране его содержимое не помещается. Вы можете нажать клавишу &lt;PgDn&gt; и посмотреть вторую часть сектора (рис. 6.10).</p>
<div align="center">
	<img src="img/aaf00/fig6a.gif" alt="Рис. 6.10. Прсомотр второй части первого сектора" />
	<p><strong>Рис. 6.10. Прсомотр второй части первого сектора</strong></p>
</div>
<p>На что здесь нужно обратить внимание?</p>
<p>В начале сектора (рис. 6.9) находится главная загрузочная запись, которая, как мы уже говорили, является программой. При наличии достаточного опыта вы можете ее дизассемблировать и исследовать. В любом случае следует проверить ее длину (программа загрузки не очень большая). После программы загрузки до начала таблицы разделов должны располагаться нулевые байты. Кроме того, внутри программы загрузки должны быть сообщения Invalid Partition table, Error loading operating system и Missing operating system.</p>
<p>Несмотря на то что существуют загрузочные вирусы, лишь слегка изменяющие главную загрузочную запись, во многих случаях вы сможете заметить следы нападения, просто взглянув на дамп первого сектора жесткого диска и сравнив его визуально с изображенным на рис. 6.9. Особенно подозрительно, если помимо перечисленных выше текстовых сообщений в теле программы загрузки присутствуют какие-либо еще сообщения.</p>
<p>Что же касается второй части самого первого сектора жесткого диска, в ней должна находиться таблица разделов диска.</p>
<p>Последние два байта должны содержать признак таблицы разделов (сигнатуру) - значение 0AA55h. Обратите внимание, что байты сигнатуры привдедны в обратном порядке - байт с младшим значением находится по младшему адресу. Это особенность архитектуры процессоров фирмы Intel.</p>
<p>Вы можете выполнить анализ таблицы разделов диска, пользуясь приведенной выше информацией о ее формате. Напомним, что таблица располагается в первом секторе диска со смещением 1BEh. Однако намного удобнее воспользоваться для анализа этой таблицы форматным просмотром редактора DISKEDIT.EXE.</p>
<p>Установите курсор (мышью или клавишами перемещения курсора) на байт со смещением 1BEh, который соответствует началу таблицы разделов. Затем из меню View выберите строку as Partition Table (рис. 6.11).</p>
<div align="center">
	<img src="img/aaf00/fig6b.gif" alt="Рис. 6.11. Меню View программы DISKEDIT.EXE из пакета Norton Utilities" />
	<p><strong>Рис. 6.11. Меню View программы DISKEDIT.EXE из пакета Norton Utilities</strong></p>
</div>
<p>На экране появится таблица разделов диска в отформатированном виде (рис. 6.12).</p>
<div align="center">
	<img src="img/aaf00/fig6c.gif" alt="Рис. 6.12. Просмотр таблицы разделов диска в отформатированном виде" />
	<p><strong>Рис. 6.12. Просмотр таблицы разделов диска в отформатированном виде</strong></p>
</div>
<p>В столбце System отображается информация об операционной системе, которая строится на основе анализа поля кода операционной системы элемента раздела. Если раздел активен, в столбце Boot для него указана строка Yes, если нет - строка No.</p>
<p>Столбцы Starting Location и Ending Location в полях Side, Cylinder и Sector, содержат в расшифрованном виде информацию, соответственно, о расположении самого первого и самого последнего секторов раздела.</p>
<p>Номер относительного сектора, с которого начинается раздел, вы можете узнать из столбца Relative Sectors, а общее количество секторов - в столбце Number of Sectors.</p>
<p>Полученную информацию о границах разделов имеет смысл сравнить с параметрами жесткого диска, полученными с помощью программы BIOS Setup, так как вирусы могут прятать свое тело в секторах диска, которые находятся в конце диска и не распределены ни одному разделу. Однако при этом следует учитывать, что современные дисковые контроллеры способны выполнять так называемую трансляцию дорожек и головок, которая может исказить полученную картину.</p>
<p>Поясним сказанное на примере.</p>
<p>В одном из наших компьютеров установлен диск, имеющий 1057 дорожек и 16 головок. На каждой дорожке расположено 63 сектора размером 512 байт. При этом общий объем диска составляет 520 Мбайт. Именно эти параметры нам сообщила программа BIOS Setup.</p>
<p>Программа FDISK.EXE определила, что на диске имеется два раздела, размером 300 и 219 Мбайт, а диск используется на 100 процентов (рис. 6.13).</p>
<div align="center">
	<img src="img/aaf00/fig6d.gif" alt="Рис. 6.13. Просмотр параметров разделов диска программой FDISK.EXE" />
	<p><strong>Рис. 6.13. Просмотр параметров разделов диска программой FDISK.EXE</strong></p>
</div>
<p>В то же время, как видно из рис. 6.12, программа DISKEDIT.EXE для этого диска показывает, что последний сектор последнего раздела расположен на дорожке с номером 526.</p>
<p>На первый взгляд, тут что-то не так: программа BIOS Setup сообщает нам, что на диске имеется 1057 дорожек и 16 головок, а в таблице разделов для последнего сектора последнего раздела мы видим совсем другие значения: этот сектор расположен на 526 дорожке, а номер головки равен 31!</p>
<p>Причина такого несоответствия заключается в том, что наш контроллер типа Enchanced IDE (другое название - Fast ATA), расположенный непосредственно на основной плате компьютера, выполняет трансляцию дорожек и головок, предоставляя программам диск, в котором по сравнению с действительным состоянием меньше дорожек, но больше головок.</p>
<p>Зачем это нужно?</p>
<p>Из-за внутренних ограничений операционная система DOS не может работать с дорожками, номер которых превышает значение 1023. Однако современные дисковые накопители обладают значительной емкостью (порядка 1 - 4 Гбайт и даже больше), поэтому в них приходится делать очень много дорожек. Другие операционные системы, такие как IBM OS/2, Microsoft Windows NT, UNIX или Novell NetWare, не имеют ограничений на количество адресуемых дорожек диска. Что же касается DOS, то без дополнительных мер максимальный размер раздела диска не будет превышать примерно 500 Мбайт.</p>
<p>Логическая трансляция, выполняемая контроллером диска, позволяет операционной системе DOS работать с разделами очень большого размера, поэтому вы можете с ней столкнуться при исследовании большинства современных компьютеров.</p>
<h5>Сохранение параметров диска и таблицы разделов диска</h5>
<p>Прежде чем продолжить исследование файловой системы, мы настоятельно рекомендуем вам записать параметры диска, определенные с помощью программы BIOS Setup, и содержимое таблицы разделов диска. Просто перепишите полученные значения на лист бумаги. Если в ходе ремонта вы случайно разрушите область данных BIOS или главный загрузочный сектор, вы сможете легко восстановить критичные данные.</p>
<h5>Исследование расширенного раздела диска</h5>
<p>Если на диске создан только первичный раздел, можно переходить к анализу логического диска C: (соответствующая процедура будет описана ниже). Если же есть расширенный раздел, необходимо проверить сектор таблицы логических дисков. Это самый первый сектор в расширенном разделе (рис.&nbsp;6.5).</p>
<p>Давайте посмотрим на этот сектор.</p>
<p>Запустите программу DISKEDIT.EXE, определите с ее помощью расположение расширенного раздела (дорожка, головка и номер сектора). Затем из меню Object выберите строку Physical Sector. На экране появится диалоговая панель Select physical sector range, с помощью которой можно выбрать для просмотра один или несколько секторов (рис. 6.14).</p>
<div align="center">
	<img src="img/aaf00/fig6e.gif" alt="Рис. 6.14. Просмотр сектора по его физическому расположению на диске" />
	<p><strong>Рис. 6.14. Просмотр сектора по его физическому расположению на диске</strong></p>
</div>
<p>В нашем случае согласно рис. 6.12 первый сектор расширенного раздела рсполгается на 305 дорожке, головка 0, сектор 1. Укажите нужные значения и нажмите кнопку OK.</p>
<p>Сектор таблицы логических дисков, в отличие от сектора главной загрузочной записи, практически пуст (рис. 6.15).</p>
<div align="center">
	<img src="img/aaf00/fig6f.gif" alt="Рис. 6.15. Просмотр сектора таблицы логических дисков" />
	<p><strong>Рис. 6.15. Просмотр сектора таблицы логических дисков</strong></p>
</div>
<p>Все байты в нем от начала и до смещения 1BDh включительно должны содержать нулевой значение. Далее со смещения 1BEh располагается таблица логических дисков, состоящая из двух элементов. В конце сектора располагается уже знакомая вам сигнатура - значение 0AA55h.</p>
<p>Формат элементов полностью аналогичен формату элементов таблицы разделов, поэтому вы можете использовать форматный просмотр (рис. 6.16). Для этого установите курсор на байт со смещением 1BEh и затем из меню View выберите строку as Partition Table.</p>
<div align="center">
	<img src="img/aaf00/fig6g.gif" alt="Рис. 6.16. Форматный просмотр таблицы логических дисков" />
	<p><strong>Рис. 6.16. Форматный просмотр таблицы логических дисков</strong></p>
</div>
<p>Первая строка таблицы логических дисков описывает логический диск D:, вторая содержит нулевые значения. Если бы в расширенном разделе были созданы несколько логических дисков, второй элемент таблицы таблицы логических дисков указывал на следующий сектор таблицы логических дисков, расположенный непосредственно перед логическим диском E:.</p>
<p>Последняя в списке таблица логических дисков всегда состоит из одной строки, которая описывает последний логический диск.</p>
<h5>Сохранение содержимого таблиц логических дисков</h5>
<p>На том же листе бумаги, где вы записывали параметры диска и сведения из таблицы разделов диска, запишите информацию о всех логических дисках, полученную из таблиц логических дисков. Если содержимое таблиц логических дисков будет случайно разрушено, вы потеряете доступ к логическим дискам.</p>
<h4>Исследование логических дисков</h4>
<p>Формат логических дисков, расположенных в разделах жесткого диска, полностью идентичен формату дискет, поэтому многое из того, о чем вы узнаете в этом разделе, будет справедливо и для дискет.</p>
<p>Схематически структура логического диска (или дискеты) изображена на рис. 6.17.</p>
<div align="center">
	<img src="img/aaf00/fig6h.gif" alt="Рис. 6.17. Структура логического диска" />
	<p><strong>Рис. 6.17. Структура логического диска</strong></p>
</div>
<p>В самом начале логического диска располагается сектор загрузочной записи Boot Record (не путайте его с сектором главной загрузочной записи, который является самым первым на физическом диске), а также, возможно, зарезервированные секторы.</p>
<p>Вслед за этим сектором находятся две копии таблицы размещения файлов (о которой мы еще будем говорить) и корневой каталог. Область данных, занимающая оставшуюся часть логического диска, содержит файлы и остальные каталоги.</p>
<h5>Проверка загрузочного сектора</h5>
<p>Адрес загрузочного сектора логического диска нетрудно найти в таблице логических дисков (рис. 6.16). В загрузочном секторе логического диска находится программа начальной загрузки операционной системы. Эта программа загружается в оперативную память загрузчиком, расположенным в главной загрузочной записи MBR.</p>
<p>Назначение программы, расположенной в загрузочном секторе логического диска - загрузка операционной системы, находящейся на этом логическом диске.</p>
<p>Таким образом, при включении питания после выполнения процедуры тестирования BIOS загружает в оперативную память содержимое главной загрузочной записи и передает ей управление. Главная загрузочная запись просматривает таблицу разделов диска и находит активный раздел. Затем она считывает загрузочный сектор логического диска, расположенного в активном разделе, и передает управление находящейся в этом секторе программе загрузки операционной системы. Эта программа, в свою очередь, выполняет всю работу по загрузке операционной системы в память компьютера.</p>
<p>Программа начальной загрузки операционной системы, расположенная в загрузочной записи, является излюбленным объектом нападения загрузочных и файлово-загрузочных вирусов, записывающих в нее свое тело (точно также, как и программа загрузки, расположенная в главной загрузочной записи MBR).</p>
<p>Формат загрузочного сектора зависит от операционной системы и даже от версии операционной системы. Мы рассмотрим формат этого сектора для версий MS-DOS, более ранних, чем 4.0, и для современных версий, таких как 6.22.</p>
<div class="notes">
	<p><em>Tchechen.1909, 1912, 1914, 3604</em></p>
	<p><em>Очень опасные резидентные шифрованные вирусы (вирус Tchechen.3604 - полиморфный).</em></p>
	<p><em>При старте вирусы данной группы (кроме вируса Tchechen.3604) считывают  второй сектор жесткого диска и записывают в него слово "МИР:" и число 4, которое будет являться счетчиком запусков инфицированных программ.</em></p>
	<p><em>Потом вирусы пытаются найти в ПЗУ BIOS текстовые строки Megatrends, AWARD. Если это им удается, то вирусы выключают в CMOS-памяти параметр Virus Warning on Boot (контроль записи в загрузочный сектор). Но следует отметить, что при поиске этих двух слов вирусы никогда не смогут найти слово AWARD.</em></p>
	<p><em>При достижении счетчиком во втором секторе нулевого значения вирусы заменяют слово "МИР:" и помещают в главную загрузочную запись MBR жесткого диска "троянский" код.</em></p>
	<p><em>Этот код при загрузке операционной системы самостоятельно передает управление активному загрузочному сектору жестого диска, но примерно через месяц (10 дней для вируса Tchechen.3604) после записи данного кода в MBR уничтожает содержимое всего первого жесткого диска. После чего автором вируса планировался вывод на экран текста, который мы здесь не приводим.</em></p>
	<p><em>Вирус Tchechen.3604 не заражает программы, имя которых начинается с символов WE, AD, AI, CO, DR, AV, TB, CH. Вирусы Tchechen.1914, 3604 неработоспособны на процессоре Pentium</em></p>
</div>
<p>Для любой версии MS-DOS помимо программы начальной загрузки операционной системы загрузочная запись содержит параметры, описывающие характеристики данного логического диска. Все эти параметры располагаются в самом начале сектора, в его так называемой форматированной области. Последние два байта загрузочного сектора содержат уже знакомую вам сигнатуру 0AA55h.</p>
<p>Перед исследованием загрузочной записи вы должны при помощи команды VER определить версию операционной системы MS-DOS, установленной в компьютере. Для версий MS-DOS, более ранних чем 4.0, формат загрузочной записи приведен ниже:</p>
<table summary="" border="1">
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>3</td><td>Команда JMP xxxx (переход на программу начальной загрузки)</td></tr>
<tr><td>3</td><td>8</td><td>Название фирмы-изготовителя операционной системы и версия, например: IBM 4.0</td></tr>
<tr><td>0Bh</td><td>13</td><td>Блок параметров BIOS (BPB)</td></tr>
<tr><td>18h</td><td>2</td><td>Количество секторов на дорожке</td></tr>
<tr><td>1Ah</td><td>2</td><td>Количество головок</td></tr>
<tr><td>1Ch</td><td>2</td><td>Количество скрытых секторов (эти секторы могут использоваться для схемы разделения физического диска на разделы и логические диски)</td></tr>
</table>
<p>В самом начале загрузочного сектора располагается команда внутрисегментного перехода JMP. Она нужна для обхода форматированной зоны сектора и передачи управления загрузочной программе, располагающейся со смещением 1Eh.</p>
<p>Название фирмы-изготовителя не используется операционной системой и представляет из себя текстовую строку длиной 8 байт.</p>
<p>Со смещением 0Bh располагается блок параметров BIOS, который обычно обозначается как BPB. Этот блок содержит некоторые характеристики логического диска, такие как количество секторов в одном кластере, общее количество секторов и т. д. Формат блока BPB будет описан позже.</p>
<p>Поля загрузочного сектора со смещениями 18h и 1Ah содержат, соответственно, количество секторов на дорожке и количество головок. Поле со смещением 1Ch содержит количество "скрытых" секторов, которые не принадлежат ни одному логическому диску. Эти секторы могут содержать таблицу разделов диска или таблицы логических дисков.</p>
<p>Для современных версий MS-DOS загрузочный сектор имеет другой формат:</p>
<table summary="" border="1">	
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>3</td><td>Команда JMP xxxx (переход на программу начальной загрузки)</td></tr>
<tr><td>3</td><td>8</td><td>Название фирмы-изготовителя операционной системы и версия</td></tr>
<tr><td>0Bh</td><td>25</td><td>Extended BPB - расширенный блок параметров BIOS</td></tr>
<tr><td>24h</td><td>1</td><td>Физический номер устройства (0 - накопитель на гибком магнитном диске НГМД, 80h - жесткий диск)</td></tr>
<tr><td>25h</td><td>1</td><td>Зарезервировано</td></tr>
<tr><td>26h</td><td>1</td><td>Символ ')' - признак расширенной загрузочной записи Extended BPB</td></tr>
<tr><td>27h</td><td>4</td><td>Серийный номер диска (Volume Serial Number), создается во время форматирования диска</td></tr>
<tr><td>2Bh</td><td>11</td><td>Метка диска (Volume Label)</td></tr>
<tr><td>36h</td><td>8</td><td>Текстовая строка 'FAT12   ' или 'FAT16   ', которая указывает на формат таблицы размещения файлов FAT</td></tr>
</table>
<p>Первые два поля имеют то же назначение, что и в загрузочной записи старых версий MS-DOS.</p>
<p>Поле со смещением 26h содержит символ ')'. Этот символ означает, что используется формат расширенной загрузочной записи и, соответственно, расширенный блок параметров BIOS Extended BPB.</p>
<p>Серийный номер диска формируется во время форматирования диска на основе даты и времени форматирования. Поэтому можно считать, что все диски и дискеты имеют разные серийные номера.</p>
<p>Метка диска формируется при форматировании и может быть изменена командой LABEL операционной системы MS-DOS. Одновременно метка диска помещается в корневой каталог в виде специального дескриптора. О формате каталогов и дескрипторов, а также о формате таблицы размещения файлов FAT мы расскажем позже.</p>
<p>Теперь о блоке параметров BIOS BPB и расширенном блоке параметров BIOS Extended BPB.</p>
<p>Для версий MS-DOS, более ранних чем 4.0, блок BPB имеет следующий формат:</p>
<table summary="" border="1">
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>2</td><td>Количество байт в одном секторе диска</td></tr>
<tr><td>2</td><td>1</td><td>Количество секторов в одном кластере</td></tr>
<tr><td>3</td><td>2</td><td>Количество зарезервированных секторов</td></tr>
<tr><td>5</td><td>1</td><td>Количество таблиц FAT</td></tr>
<tr><td>6</td><td>2</td><td>Максимальное количество дескрипторов файлов в корневом каталоге диска</td></tr>
<tr><td>8</td><td>2</td><td>Общее количество секторов на носителе данных (в разделе MS-DOS)</td></tr>
<tr><td>0Ah</td><td>1</td><td>Байт-описатель среды носителя данных</td></tr>
<tr><td>0Bh</td><td>2</td><td>Количество секторов, занимаемых одной копией FAT</td></tr>
</table>
<p>Расширенный блок параметров BIOS состоит из обычного блока BPB и дополнительного расширения:</p>
<table summary="" border="1">	
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>2</td><td>Количество байт в одном секторе диска</td></tr>
<tr><td>2</td><td>1</td><td>Количество секторов в одном кластере</td></tr>
<tr><td>3</td><td>2</td><td>Количество зарезервированных секторов</td></tr>
<tr><td>5</td><td>1</td><td>Количество таблиц FAT</td></tr>
<tr><td>6</td><td>2</td><td>Максимальное количество дескрипторов файлов в корневом каталоге диска</td></tr>
<tr><td>8</td><td>2</td><td>Общее количество секторов на носителе данных (в разделе MS-DOS)</td></tr>
<tr><td>0Ah</td><td>1</td><td>Байт-описатель среды носителя данных</td></tr>
<tr><td>0Bh</td><td>2</td><td>Количество секторов, занимаемых одной копией FAT</td></tr>
<tr><td>0Dh</td><td>2</td><td>Количество секторов на дорожке</td></tr>
<tr><td>0Fh</td><td>2</td><td>Количество магнитных головок</td></tr>
<tr><td>11h</td><td>2</td><td>Количество скрытых секторов для раздела, который по размеру меньше 32 Мбайт</td></tr>
<tr><td>13h</td><td>2</td><td>Количество скрытых секторов для раздела, превышающего по размеру 32 Мбайт</td></tr>
<tr><td>15h</td><td>4</td><td>Общее количество секторов на логическом диске для раздела, превышающего по размеру 32 Мбайт</td></tr>
</table>
<p>Байт-описатель среды может содержать следующие значения, характеризующие носитель данных:</p>
<table summary="" border="1">
<tr><td>Значение</td><td>Количество сторон</td><td>Количество секторов</td><td>Диаметр, дюймы</td><td>Емкость, Кбайт</td></tr>
<tr><td>0F0h</td><td>2</td><td>18</td><td>3,5</td><td>1440</td></tr>
<tr><td>-"-</td><td>2</td><td>36</td><td>3,5</td><td>2880</td></tr>
<tr><td>-"-</td><td>2</td><td>15</td><td>5,25</td><td>1200</td></tr>
<tr><td>0F8h</td><td>-</td><td>-</td><td>&nbsp;</td><td>Жесткий диск любой емкости</td></tr>
<tr><td>0F9h</td><td>2</td><td>9</td><td>3,5</td><td>720</td></tr>
<tr><td>-"-</td><td>2</td><td>15</td><td>5,25</td><td>1200</td></tr>
<tr><td>0FAh</td><td>1</td><td>8</td><td>5,25</td><td>320</td></tr>
<tr><td>0FBh</td><td>2</td><td>8</td><td>3,5</td><td>640</td></tr>
<tr><td>0FCh</td><td>1</td><td>9</td><td>5,25</td><td>180</td></tr>
<tr><td>0FDh</td><td>2</td><td>9</td><td>5,25</td><td>360</td></tr>
<tr><td>0FEh</td><td>1</td><td>8</td><td>5,25</td><td>160</td></tr>
<tr><td>0FFh</td><td>2</td><td>8</td><td>5,25</td><td>320</td></tr>
</table>
<p>В этой таблице мы привели данные для дискет и жесткого диска.</p>
<p>Для форматного просмотра блока параметов BPB (или расширенного блока параметров Extended BPB, в зависимости от версии MS-DOS) удобно использовать программу DISKEDIT.EXE. При этом вы можете найти загрузочную запись двумя способами.</p>
<p>Во-первых, можно выбрать из меню Object строку Boot Record (выбрав предварительно нужный логический диск при помощи строки Drive того же меню). При этом вы сразу же окажитесь в режиме форматного просмотра блока параметров BIOS выбранного вами диска (рис. 6.18).</p>
<div align="center">
	<img src="img/aaf00/fig6i.gif" alt="Рис. 6.18. Режим форматного просмотра загрузочной записи" />
	<p><strong>Рис. 6.18. Режим форматного просмотра загрузочной записи</strong></p>
</div>
<p>Во-вторых, если логические диски недоступны, но вам удалось считать таблицу разделов или таблицу логических дисков, вы можете перейти к просмотру загрузочной записи, указав ее физический адрес. Для этого из меню Object надо выбрать строку Physical Address (как это было описано раньше). На экране появится дамп первой части загрузочного сектора (рис. 6.19).</p>
<div align="center">
	<img src="img/aaf00/fig6j.gif" alt="Рис. 6.19. Первая часть дампа загрузочной записи" />
	<p><strong>Рис. 6.19. Первая часть дампа загрузочной записи</strong></p>
</div>
<p>Нажав клавишу &lt;PgDn&gt;, вы можете перейти к просмотру второй части загрузочного сектора (рис. 6.20).</p>
<div align="center">
	<img src="img/aaf00/fig6k.gif" alt="ис. 6.20 Вторая часть дампа загрузочной записи" />
	<p><strong>ис. 6.20 Вторая часть дампа загрузочной записи</strong></p>
</div>
<p>При помощи строк as Boot Record и as Hex меню View вы можете перейти, соответственно, к форматному и неформатному режиму просмотра загрузочного сектора.</p>
<p>Формирование загрузочной записи и блока параметров BIOS роисходит при форматировании логического диска (например, командой FORMAT). Если с помощью программы FDISK удалить логический диск, а потом создать на его месте новый такого же размера, блок BPB окажется разрушенным. При этом вам придется отформатировать логический диск заново.</p>
<p>Блок параметров BIOS содержит критичную информацию, при разрушении которой становится 	невозможным нормальный доступ к файлам и каталогам, расположенным на логическом диске. Неосторожное обращение с загрузочным сектором жесткого диска может привести к необходимости переформатирования соответствующего логического диска с полной потерей хранившихся там данных.</p>
<p>Детальный анализ изменений, внесенных вирусом в загрузочную запись, предполагает дизассемблирование загрузочной записи и потому доступно только опытным программистам. Тем не менее можно проверить параметры, записанные в блоке BPB и выполнить визуальную проверку загрузочной программы. В теле этой программы не должно быть, например, никаких посторонних текстовых строк.</p>
<p>Перед тем как продолжить дальнейший анализ файловой системы, полезно сделать распечатку содержимого загрузочных секторов всех имеющихся логических дисков в форматном и неформатном виде, так как блок параметров BIOS содержит сведения, необходимые для поиска и анализа других логических структур файловой системы.</p>
<p>Для распечатки выберите из меню Tools строку Print Object as и в появившейся на экране диалоговой панели выберите строку Boot Record (рис. 6.21). Затем нажмите кнопку OK.</p>
<div align="center">
	<img src="img/aaf00/fig6l.gif" alt="Рис. 6.21. Форматная печать содержимого загрузочного сектора" />
	<p><strong>Рис. 6.21. Форматная печать содержимого загрузочного сектора</strong></p>
</div>
<p>Аналогичным образом вы можете распечатать содержимое других логических структур файловой системы, например, содержимое таблицы разделов диска.</p>
<h5>Анализ зарезервированных секторов</h5>
<p>Между загрузочным сектором и таблицей размещения файлов FAT могут находиться зарезервированные секторы, которые являются служебными для файловой системы или не используются.</p>
<p>Количество секторов, зарезервированных на логическом диске, можно узнать из блока параметров BIOS (BPB или Extended BPB, в зависимости от версии операционной системы MS-DOS). Искомое значение находится в поле этого блока со смещением 3. При форматном просмотре количество зарезервированных секторов указано в строке Reserved sectors at beginning (рис. 6.18).</p>
<p>Если зарезервирован только один сектор, то первая копия таблицы размещения файлов FAT располагается сразу вслед за загрузочным сектором. Именно загрузочный сектор в данном случае является зарезервированным.</p>
<p>Когда зарезервировано несколько секторов, между загрузочным сектором и первой копией таблицы FAT может находиться еще несколько секторов, содержащих нулевые значения. В этих секторах может быть спрятано тело вируса или копия оригинальной загрузочной записи, замещенной вирусом.</p>
<h5>Таблицы размещения файлов FAT</h5>
<p>Операционная система MS-DOS объединяет отдельные секторы диска в так называемые кластеры. При создании новых каталогов и непустых файлов для них выделяется один или несколько кластеров. Если размер файла увеличивается, для него выделяются дополнительные кластеры.</p>
<p>Размер кластера в секторах (т. е. количество секторов в одном кластере) вы можете узнать из поля блока параметров BIOS BPB со смещением 2. При форматном просмотре содержимого загрузочного сектора размер кластера отображается в строке Sectors per cluster (рис. 6.18).</p>
<p>Для экономии дискового пространства файлам и каталогам распределяются кластеры, которые не обязательно расположены рядом. Таким образом, отдельные кластеры, принадлежащие одному и тому же файлу, могут находиться в разных местах логического диска. За такую экономию приходится платить производительностью, так как считывание фрагментированного файла связано с многочисленными перемещениями магнитных головок, а это самая медленная дисковая операция.</p>
<p>Другая проблема, связанная с фрагментацией файлов, заключается в необходимости хранения списка кластеров, выделенных каждому файлу. Очевидно, для того чтобы прочитать файл, операционная система MS-DOS должна последовательно прочитать все кластеры, распределенные этому файлу.</p>
<p>Где же хранятся списки кластеров?</p>
<p>Эти списки хранятся в таблице размещения файлов FAT, к анализу которой мы скоро приступим.</p>
<p>Таблицу размещения файлов можно представить себе как массив, содержащий информацию о кластерах. Размер этого массива определяется общим количеством кластеров на логическом диске. В элементах этого массива находятся списки кластеров, распределенных файлам. Элементы массива, соответствующие свободным кластерам, содержат нулевые значения.</p>
<p>Если файл занимает несколько кластеров, то эти кластеры связаны в список. При этом элементы таблицы FAT содержат номера следующих используемых данным файлом кластеров. Конец списка отмечен в таблице специальным значением. Номер первого кластера, распределенного файлу, хранится в элементе каталога, описывающего данный файл.</p>
<p>Таким образом, зная имя файла и каталог, в котором этот файл расположен, операционная система MS-DOS может определить номер первого кластера, распределенного файлу, а затем, проследив список кластеров по таблице FAT, определить и номер остальных кластеров, занятых этим файлом.</p>
<p>Программа FORMAT.COM, предназначенная для форматирования диска и некоторые специальные программы аналогичного назначения проверяют логический диск на предмет наличия дефектных областей. Кластеры, которые находятся в этих дефектных областях, отмечаются в FAT как плохие и не используются операционной системой.</p>
<p>Для примера на рис. 6.22 показаны упрощенные дескрипторы корневого каталога диска C:, в которых описаны файлы MYFILE1.DOC и MYLETTER.DOC, а также элементы таблицы размещения файлов FAT, выделенные для этих файлов.</p>
<div align="center">
	<img src="img/aaf00/fig6m.gif" alt="Рис. 6.22. Пример распределения кластеров для файлов autoexec.bat и config.sys" />
	<p><strong>Рис. 6.22. Пример распределения кластеров для файлов autoexec.bat и config.sys</strong></p>
</div>
<p>Файл MYFILE1.DOC занимает три кластера с номерами 11, 17 и 18, а файл MYLETTER.DOC - два кластера с номерами 12 и 13. В каталоге указаны номера первых кластеров, распределенных этим файлам (соответственно 11 и 12). Последние ячейки, которые соответствуют последним кластерам, распределенным файлам, содержат специальное значение - 0FFFFh (признак конца цепочки кластеров).</p>
<h5>Формат таблицы FAT</h5>
<p>Остановимся подробнее на формате таблицы FAT.</p>
<p>Таблица FAT может иметь 12- или 16-разрядный формат. При этом в таблице для хранения информации об одном кластере диска используется, соответственно, 12 или 16 бит.</p>
<p>Первый из этих двух форматов (12-разрядный) применяется для дискет с небольшим количеством секторов. При этом вся таблица размещения файлов помещается в одном секторе.</p>
<p>Если размер диска слишком большой, для представления всех кластеров двенадцати разрядов будет недостаточно. В этом случае используется 16-разрядный формат FAT. При этом операционная система MS-DOS может работать с диском, который имеет размер более 32 Мбайт. Поэтому для жестких дисков используется именно 16-разрядный формат таблицы FAT.</p>
<p>Как узнать формат FAT?</p>
<p>Проще всего прочитать его в текстовой строке, расположенной в загрузочном секторе со смещением 36h. При форматном отображении содержимого загрузочного сектора тип таблицы FAT отображается в строке File System ID (рис. 6.18).</p>
<p>Кроме того, если разделы жесткого диска создавались программой FDISK.EXE, формат FAT можно определить, анализируя содержимое поля кода системы соответствующего элемента таблицы разделов, расположенной в главной загрузочной записи MBR. Если это поле содержит значение 1, используется 12-разрядный формат, если 4, то 16-разрядный.</p>
<p>Первый элемент таблицы FAT имеет особый формат.</p>
<p>Самый первый байт таблицы FAT называется "Описатель среды" (Media Descriptor). Он имеет такое же значение, как и байт-описатель среды, загрузочного сектора логического диска.</p>
<p>Следующие 5 байт для 12-разрядного формата или 7 байт для 16-разрядного формата всегда содержат значение 0FFh.</p>
<p>Вся остальная часть таблицы FAT состоит из 12- или 16-разрядных ячеек. Каждая ячейка соответствует одному кластеру диска. Эти ячейки для разных форматов таблицы FAT могут содержать следующие значения:</p>
<table summary="" border="1">
<tr><th>FAT12</th><th>FAT16</th><th>Описание</th></tr>
<tr><td>000h</td><td>0000h</td><td>Свободный кластер</td></tr>
<tr><td>0FF0h - 0FF6h</td><td>0FFF0h - 0FFF6h</td><td>Зарезервированный кластер	</td></tr>
<tr><td>0FF7h</td><td>0FFF7h</td><td>Плохой кластер</td></tr>
<tr><td>0FF8h - 0FFFh</td><td>0FFF8h - 0FFFFh</td><td>Последний кластер в списке</td></tr>
<tr><td>002h - 0FEFh</td><td>0002h - 0FFEFh</td><td>Номер следующего кластера в списке</td></tr>
</table>
<h5>Просмотр таблицы FAT</h5>
<p>Для просмотра таблицы размещения файлов FAT мы воспользуемся программой DISKEDIT.EXE. Из меню Object выберите строку Drive и укажите интересующий вас диск. Если файловая система находится в более или менее исправном состоянии, вы сможете выбрать нужный вам логический диск.</p>
<p>Затем из меню Object выберите одну из двух строк - 1st FAT или 2nd FAT. На экране появится, соответственно, содержимое первой или второй копии таблицы FAT в отформатированном виде (рис. 6.23).</p>
<div align="center">
	<img src="img/aaf00/fig6n.gif" alt="Рис. 6.23. Просмотр первой копии таблицы размещения FAT в отформатированном виде" />
	<p><strong>Рис. 6.23. Просмотр первой копии таблицы размещения FAT в отформатированном виде</strong></p>
</div>
<p>Вы также можете найти первую или вторую копию таблицы FAT, зная физический адрес загрузочной записи логического диска. Напомним, что загрузочная запись располагается в самом первом секторе дискеты. Расположение загрузочной записи для логических дисков, созданных в разделах жесткого диска, можно определить из таблицы разделов (для логического диска C:) или таблицы логических дисков (для логических дисков, созданных в расширенном разделе).</p>
<div class="notes">
	<p><em>BadSectors.3422, 3428</em></p>
	<p><em>Опасные резидентные вирусы.</em></p>
	<p><em>Перехватывают прерывания INT 8h, INT 16h, INT 21h, INT 25h, INT 26h.</em></p>
	<p><em>Иногда  отмечают кластеры диска как плохие посредством манипуляций с таблицами размещения файлов FAT. Не заражают  антивирусную программу  SCAN.</em></p>
	<p><em>Содержат текстовые строки:</em></p>
	<p><em>COMEXE</em></p>
	<p><em>SCAN</em></p>
	<p><em>BadSectors.3422: BadSectors 1.1</em></p>
	<p><em>BadSectors.3428: BadSectors 1.2</em></p>
</div>
<p>Далее, в рамках логического диска существует своя последовательная нумерация секторов. При этом порядок нумерации выбран таким, что при последовательном увеличении номера сектора вначале увеличивается номер головки, затем номер дорожки.</p>
<p>Поясним это на примере.</p>
<p>Пусть, например, у нас есть дискета с девятью секторами на дорожке. Сектор с логическим номером, равным 1, расположен на нулевой дорожке и для обращения к нему используется нулевая головка. Это самый первый сектор на дорожке, он имеет номер 1. Следующий сектор на нулевой дорожке имеет логический номер 2, последний сектор на нулевой дорожке имеет логический номер 9. Сектор с логическим номером 10 расположен также на нулевой дорожке. Это тоже самый первый сектор на дорожке, но теперь для доступа к нему используется головка с номером 1. И так далее, по мере увеличения логического номера сектора изменяются номера головок и дорожек.</p>
<p>Согласно такой нумерации, сектор с последовательным номером 0 - это загрузочный сектор. Для того чтобы просмотреть содержимое загрузочного сектора при помощи программы DISKEDIT.EXE, вы можете выбрать из меню Object строку Sector и в появившейся диалоговой панели указать номер сектора, равный нулю (рис. 6.24).</p>
<div align="center">
	<img src="img/aaf00/fig6o.gif" alt="Рис. 6.24. Просмотр сектора логического диска по его последовательному номеру" />
	<p><strong>Рис. 6.24. Просмотр сектора логического диска по его последовательному номеру</strong></p>
</div>
<p>Заметьте, что в этой диалоговой панели в рамке, озаглавленной Sector Usage, показано распределение секторов. Пользуясь этим распределением, вы легко сможете определить последовательный номер сектора загрузочной записи, начало и границы обеих копий FAT, а также начало и границы корневого каталога и области данных, содержащих файлы и другие каталоги.</p>
<p>С помощью меню View вы можете просмотреть содержимое таблицы FAT в виде дампа (рис. 6.25).</p>
<div align="center">
	<img src="img/aaf00/fig6p.gif" alt="Рис. 6.25. Просмотр первой копии таблицы размещения файлов FAT в виде дампа" />
	<p><strong>Рис. 6.25. Просмотр первой копии таблицы размещения файлов FAT в виде дампа</strong></p>
</div>
<p>Визуально таблица размещения файлов должна содержать в основном монотонно изменяющиеся последовательности номеров кластеров, нулевые занчения, соответствующие свободным кластерам, а также значение 0FFFFh, которое является признаком конца цепочки кластеров.</p>
<p>Вслед за первой копией таблицы FAT должна находиться вторая копия FAT (рис. 6.26).</p>
<div align="center">
	<img src="img/aaf00/fig6q.gif" alt="Рис. 6.26. Вторая копия таблицы FAT должна располагаться сразу вслед за первой копией этой таблицы" />
	<p><strong>Рис. 6.26. Вторая копия таблицы FAT должна располагаться сразу вслед за первой копией этой таблицы</strong></p>
</div>
<p>Размер таблицы FAT вы можете определить, зная содержимое поля блока параметров BIOS BPB со смещением 0Bh (количество секторов, занимаемых одной копией FAT).</p>
<p>Вирусы могут либо полностью разрушать таблицу FAT, либо изменять записанные в ней значения, зашифровывая их или просто уничтожая. Если цепочка кластеров для нужного вам файла разрушена частично или полностью, восстановление такого файла может стать непростой задачей. О том как выполнять такое восстановление, мы расскажем позже в этой главе.</p>
<p>Некоторые вирусы пользуются тем фактом, что конец цепочки кластеров может отмечаться любым значением в диапазоне 0FFF8h - 0FFFFh (для 16-разрядной таблицы FAT). Операционная система MS-DOS использует значение 0FFFFh. Вирус может выделять для себя зараженные файлы (чтобы избежать повторного заражения), отмечая последний распределенный этим файлам кластер любым другим значением, например, 0FFF9h. При этом операционная система будет продолжать работать нормально, как будто ничего не произошло.</p>
<p>Несмотря на то что вторая копия таблицы FAT создавалась как резервная для облегчения процедуры восстановления в случае разрушения первой копии, не стоит особенно надеяться на то, что в случае вирусной атаки вы сможете просто скопировать вторую копию FAT на место первой. Вторая копия FAT также может оказаться разрушенной или зашифрованной.</p>
<h5>Формат корневого каталога</h5>
<p>Непосредственно после второй копии таблицы размещения файлов следует корневой каталог. Размер корневого каталога в секторах вы можете определить из блока параметров BIOS BPB. Поле со смещением 6 содержит максимальное количество дескрипторов файлов в корневом каталоге диска (этому полю соответствует строка Root directory entries при форматном просмотре содержимого загрузочного сектора программой DISKEDIT.EXE).</p>
<p>Размер одного дескриптора составляет 32 байта, поэтому умножив максимальное количество дескрипторов на это число мы получим размер корневого каталога в байтах. Зная размер сектора (512 байт), нетрудно определить количество секторов, занимаемых корневым каталогом.</p>
<div class="notes">
	<p><em>Abs_4</em></p>
	<p><em>Заражает загрузочный сектор. Старый сектор прячет на гибком диске в последнем секторе корневого каталога, а на жестком диске - в шестом секторе</em></p>
</div>
<p>Теперь поговорим о дескрипторах файлов.</p>
<p>Любой каталог (и корневой в том числе) содержит 32-байтовые элементы - дескрипторы, описывающие файлы и другие каталоги. Приведем формат дескриптора:</p>
<table summary="" border="1">
<tr><td>Смещение, байт</td><td>Размер, байт</td><td>Описание</td></tr>
<tr><td>0</td><td>8</td><td>Имя файла или каталога, выравненное на левую границу и дополненное пробелами</td></tr>
<tr><td>8</td><td>3</td><td>Расширение имени файла, выравненное на левую границу и дополненное пробелами</td></tr>
<tr><td>0Bh</td><td>1</td><td>Байт атрибутов файла</td></tr>
<tr><td>0Ch</td><td>10</td><td>Зарезервировано</td></tr>
<tr><td>16h</td><td>2</td><td>Время создания файла или время его последней модификации</td></tr>
<tr><td>18h</td><td>2</td><td>Дата создания файла или дата его последней модификации</td></tr>
<tr><td>1Ah</td><td>2</td><td>Номер первого кластера, распределенного файлу</td></tr>
<tr><td>1Ch</td><td>4</td><td>Размер файла в байтах</td></tr>
</table>
<p>Обратите внимание на поле со смещением 1Ah. Это номер первого кластера, распределенного файлу или каталогу (если дескриптор описывает каталог более низкого уровня). Пользуясь этим значением, вы сможете проследить по таблице размещения файлов FAT всю цепочку кластеров, распределенных данному файлу или каталогу. Таким образом, у нас имеется способ отыскать начало цепочки кластеров для любого файла - нужно лишь найти соответствующий дескриптор.</p>
<p>В любом каталоге, кроме корневого, два первых дескриптора имеют специальное назначение. Первый дескриптор содержит в поле имени строку:</p>
<pre>".      "</pre>
<p>Этот дескриптор указывает на содержащий его каталог. То есть каталог имеет ссылку сам на себя. Второй специальный дескриптор содержит в поле имени строку:</p>
<pre>"..     "</pre>
<p>Этот дескриптор указывает на каталог более высокого уровня.</p>
<p>Если в поле номера первого занимаемого кластера для дескриптора с именем "..      " находится нулевое значение, это означает, что данный каталог содержится в корневом каталоге.</p>
<p>В древовидной структуре каталогов имеются ссылки как в прямом, так и в обратном направлении. Эти ссылки можно использовать для проверки сохранности структуры каталогов файловой системы.</p>
<p>Байт атрибутов является принадлежностью каждого файла. Биты байта атрибутов имеют следующие значения:</p>
<table summary="" border="1">
<tr><th>Бит</th><th>Описание</th></tr>
<tr><td>0</td><td>Файл предназначен только для чтения.<p>В этот файл нельзя писать и его нельзя стирать</p></td></tr>
<tr><td>1</td><td>Скрытый файл.<p>Этот файл не будет появляться в списке файлов, который отображается командой DIR</p></td></tr>
<tr><td>2</td><td>Системный файл.<p>Этот бит обычно установлен для файлов, которые являются составной частью операционной системы</p></td></tr>
<tr><td>3</td><td>Данный дескриптор описывает метку диска.<p>Для этого дескриптора поле имени файла и поле расширения имени файла должны рассматриваться как одно поле длиной 11 байт. Это поле содержит метку диска</p></td></tr>
<tr><td>4</td><td>Дескриптор описывает файл, являющийся подкаталогом данного каталога</td></tr>
<tr><td>5</td><td>Флаг архивации.<p>Если этот бит установлен в 1, то данный файл не был выгружен утилитой архивации</p></td></tr>
<tr><td>6-7</td><td>Зарезервированы</td></tr>
</table>
<p>Обычно файлы имеют следующие атрибуты:</p>
<table summary="" border="1">
<tr><th>Атрибут</th><th>Описание</th></tr>
<tr><td>0</td><td>Обычные файлы (тексты программ, загрузочные модули, пакетные файлы)</td></tr>
<tr><td>7</td><td>Только читаемые, скрытые, системные файлы. Такая комбинация битов байта атрибутов используется для файлов операционной системы IO.SYS, MSDOS.SYS</td></tr>
<tr><td>8</td><td>Метка тома. Дескриптор метки тома может находиться только в корневом каталоге логического диска</td></tr>
<tr><td>10h</td><td>Дескриптор, описывающий каталог</td></tr>
<tr><td>20h</td><td>Обычный файл, который не был выгружен программами BACKUP.EXE или XCOPY.EXE</td></tr>
</table>
<p>При удалении файла первый байт его имени заменяется на байт E5h (символ &ldquo;х&rdquo;). Все кластеры, распределенные удаленному файлу, отмечаются в таблице  FAT как свободные.</p>
<p>Если вы только что удалили файл, его еще можно восстановить, так как в дескрипторе сохранились все поля, кроме первого байта имени файла. Но если на диск записать новые файлы, то содержимое кластеров удаленного файла будет изменено и восстановление станет невозможным.</p>
<p>Теперь о полях времени и даты.</p>
<p>Формат поля времени показан на рис. 6.27.</p>
<div align="center">
	<img src="img/aaf00/fig6r.gif" alt="Рис. 6.27. Формат поля времени" />
	<p><strong>Рис. 6.27. Формат поля времени</strong></p>
</div>
<p>Старшие пять бит содержат значение часа модификации файла, шесть бит с номерами 5 - 10 хранят значение минут модификации файла, и, наконец, в младших 5 битах находится значение секунд, деленное на 2. Для того, чтобы время обновления файла уместилось в шестнадцати битах, пришлось пойти на снижение точности времени до двух секунд. В подавляющем большинстве случаев такое снижение точности не играет никакой роли.</p>
<p>Формат даты обновления файла напоминает формат времени и показан на рис. 6.28.</p>
<div align="center">
	<img src="img/aaf00/fig6s.gif" alt="Рис. 6.28. Формат поля даты" />
	<p><strong>Рис. 6.28. Формат поля даты</strong></p>
</div>
<p>Для того чтобы получить значение года обновления файла, необходимо прибавить к величине, хранимой в старших семи битах, значение 1980.</p>
<p>Некоторые вирусы используют поля времени и даты для отметки зараженных файлов. Такая отметка нужна для того чтобы избежать повторного заражения. Однако такой примитивный способ используется только простейшими вирусами.</p>
<p>Поле длины в дескрипторе содержит точную длину файла в байтах. Для каталогов в поле длины записано нулевое значение.</p>
<p>Когда вирус заражает файл, его длина, как правило, увеличивается. Тем не менее стелс-вирусы эффективно маскируют такое увеличение, поэтому его можно заметить только при загрузке операционной системы с чистой дискеты.</p>
<h5>Просмотр каталогов</h5>
<p>Для просмотра каталогов с целью проверки их структуры мы воспользуемся программой DISKEDIT.EXE.</p>
<p>Запустите эту программу и из меню Object выберите строку Directory. На экране появится диалоговая панель Change Directory, показанная на рис. 6.29.</p>
<div align="center">
	<img src="img/aaf00/fig6t.gif" alt="Рис. 6.29. Диалоговая панель Change Directory, предназначенная для выбора каталога" />
	<p><strong>Рис. 6.29. Диалоговая панель Change Directory, предназначенная для выбора каталога</strong></p>
</div>
<p>В левой части диалоговой панели отображается дерево каталогов текущего диска. Выберите в нем корневой каталог C:\ и нажмите кнопку OK. После этого на экране появится содержимое корневого каталога в форматированном виде (рис. 6.30).</p>
<div align="center">
	<img src="img/aaf00/fig6u.gif" alt="Рис. 6.30. Просмотр содержимого корневого каталога диска C: в форматированном виде" />
	<p><strong>Рис. 6.30. Просмотр содержимого корневого каталога диска C: в форматированном виде</strong></p>
</div>
<p>Анализируя полученную информацию, вы можете обнаружить подозрительные изменения в полях размера файла, даты и времени. Кроме того, для каждого файла в столбце Cluster отображается номер распределенного ему первого кластера.</p>
<p>С помощью меню View можно переключиться в режим неформатированного просмотра, когда содержимое каталога отображается в виде дампа (рис. 6.31).</p>
<div align="center">
	<img src="img/aaf00/fig6v.gif" alt="Рис. 6.31. Просмотр содержимого корневого каталога диска C: в виде дампа" />
	<p><strong>Рис. 6.31. Просмотр содержимого корневого каталога диска C: в виде дампа</strong></p>
</div>
<p>Обратите внимание на меню Link. С помощью этого меню вы можете переходить к просмотру логически связанных между собой структур файловой системы (рис. 6.32).</p>
<div align="center">
	<img src="img/aaf00/fig6w.gif" alt="Рис. 6.32. Меню Link позволяет просматривать логически связанные стркутуры файловой системы" />
	<p><strong>Рис. 6.32. Меню Link позволяет просматривать логически связанные стркутуры файловой системы</strong></p>
</div>
<p>Выделите в корневом каталоге диска C: файл IO.SYS, как это показано на рис. 6.32, и затем выберите из меню Link строку Cluster chain (FAT). Вы окажитесь в режиме просмотра первой копии таблицы размещения файлов FAT, причем цепочка кластеров, выделенная файлу IO.SYS, будет выделена (рис. 6.33).</p>
<div align="center">
	<img src="img/aaf00/fig6x.gif" alt="Рис. 6.33. Просмотр цепочки кластеров, выделенный файлу IO.SYS" />
	<p><strong>Рис. 6.33. Просмотр цепочки кластеров, выделенный файлу IO.SYS</strong></p>
</div>
<p>С помощью строки File меню Link вы можете перейти в режим просмотра содержимого файла IO.SYS (рис. 6.34).</p>
<div align="center">
	<img src="img/aaf00/fig6y.gif" alt="Рис. 6.34. Просмотр содержимого файла IO.SYS в виде дампа" />
	<p><strong>Рис. 6.34. Просмотр содержимого файла IO.SYS в виде дампа</strong></p>
</div>
<p>Отметим, что во многих случаях можно выполнять переходы между логически связанными структурами данных двойным щелчком левой клавиши мыши по изображению этих структур, что очень удобно. Подробности вы найдете в документации к пакету Norton Utilities.</p>
<p>На что следует обратить внимание при проверке структуры каталогов?</p>
<p>Кроме визуальной проверки полей расположенных там дескрипторов следует просмотреть весь каталог до конца. Необходимо убедиться, что в каталоге отсутствуют посторонние данные, которые могут быть записаны туда вирусом.</p>
<p>На рис. 6.35 вы видите удаленный файл с именем хONFIG.SYS (бывший CONFIG.SYS) и свободные элементы каталога, отмеченные строкой Unused directory entry.</p>
<div align="center">
	<img src="img/aaf00/fig6z.gif" alt="Рис. 6.35. Удаленный файл и свободные элементы каталога" />
	<p><strong>Рис. 6.35. Удаленный файл и свободные элементы каталога</strong></p>
</div>
<p>Если перейти в режим неформатированного просмотра, то можно убедиться, что свободные элементы каталога содержат нулевые значения. Если же после свободных элементов находятся какие-либо данные, существует очень большая вероятность того, что они записаны туда вирусом или системой защиты программ от несанкционированного копирования (если исследуемый каталог содержит такие программы).</p>
<p>Если каталог поврежден полностью или частично, ссылки на описанные в нем файлы будут потеряны. Если вы найдете тем или иным способом секторы, содержащие нужный вам файл, для которого разрушен дескриптор, пользуясь описанной ниже методикой вы сможете восстановить дескриптор и получить доступ к файлу.</p>
<h5>Область данных</h5>
<p>Вслед за корневым каталогом начинается область данных, которая простирается до конца логического диска (рис. 6.17). Область данных разбита на кластеры, причем нумерация кластеров начинается с числа 2. Кластеру с номером 2 соответствуют первые секторы области данных.</p>
<p>Приведем формулу, которая связвает номер кластера с номерами секторов, занимаемых им на логическом диске:</p>
<p>SectNumber = DataStart + ((ClustNumber - 2) * ClustSize)</p>
<p>В этой формуле использованы следующие обозначения:</p>
<table summary="" border="1">	
<tr><th>Переменная</th><th>Описание</th></tr>
<tr><td>SectNumber</td><td>Номер первого сектора, распределенного кластеру с номером ClustNumber</td></tr>
<tr><td>DataStart</td><td>Начальный сектор области данных</td></tr>
<tr><td>ClustNumber</td><td>Номер кластера, для которого необходимо определить номер первого сектора</td></tr>
<tr><td>ClustSize</td><td>Количество секторов, занимаемых одним кластером</td></tr>
</table>
<p>Эта формула может вам пригодиться при ручном восстановлении файловой системы.</p>
<h3>Поиск и восстановление файлов</h3>
<p>В этом разделе мы приведем некоторые рекомендации, направленные на восстановление файлов, доступ к которым стал невозможен из-за вредоносного действия вирусов или в результате разрушения файловой системы по любой другой причине. В любом случае перед началом восстановительных работ следует провести полное исследование файловой системы с использованием методики, изложенной в предыдущей части этой главы.</p>
<p>Необходимо также убедиться, что вы хорошо владеете структурой файловой системы и знаете форматы всех ее компонент, таких как таблица разделов, таблица логических дисков, таблица размещения файлов FAT и т. д. В тяжелых случаях мы рекомендуем обращаться к специалистам, например, из скорой компьютерной помощи АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>Многие повреждения файловой системы можно восстановить в автоматическом режиме при помощи программы Norton Disk Doctor. Однако эта весьма неплохая программа в некоторых случаях не сможет оказать вам существенной помощи. Поэтому вы должны владеть хотя бы основными приемами ручного восстановления файловой системы.</p>
<p>Если в процессе исследования файловой системы вы обнаружили, что некоторые структуры оказались полностью разрушены (например, главная загрузочная запись с таблицей разделов, таблица логических дисков, каталоги и т. д.), еще не все потеряно. Многое можно восстановить с помощью таких программ, как Norton Disk Doctor или Norton Disk Editor.</p>
<p>Основная идея поиска потерянных файлов и структур данных заключается в том, что вы знаете (хотя бы приблизительно) их содержимое.</p>
<p>Например, секторы, содержащие таблицу разделов, таблицу логических дисков и загрузочную запись имеют сигнатуру 0AA55h. Из предыдущих разделов этой главы вы знаете, что программы начальной загрузки содержат в своем теле текстовые строки, которые также можно использовать для поиска. В теле расширенного блока параметров BIOS Extended PBP имеются текстовые строки FAT12 или FAT16, которые также можно использовать для поиска.</p>
<p>Если вы знаете характерные слова или последовательности байт, встречающиеся в потерянных файлах данных, их тоже можно использовать для восстановления.</p>
<p>Секторы, содержащие дескрипторы каталогов, можно обнаружить, зная имена описанных в нем файлов.</p>
<h4>Поиск с помощью программы File Find</h4>
<p>Наиболее распространенное повреждение файловой системы возникает при внезапном отключении питания и заключается в появлении так называемых потерянных кластеров. Это повреждение также бывает следствием аппаратного сброса компьютера кнопкой Reset при работающей операционной системе Microsoft Windows.</p>
<p>Потерянные кластеры называются так потому, что на них нет ссылок ни в одном каталоге файловой системы. Например потому, что соответствующий каталог был просто уничтожен и, следовательно, ссылки на описанные в нем файлы исчезли.</p>
<p>Чаще всего для ремонта повреждений такого рода пользователи применяют программу SCANDISK.EXE, входящую в состав операционной системы MS-DOS, или программу NDD.EXE из пакетf Norton Utilities (программа Norton Disk Doctor).</p>
<p>После восстановления файловой системы программой Norton Disk Doctor или SCANDISK.EXE на диске может образоваться громадное количество файлов со специфическим расширением имени (каждая программа восстановления использует свое имя), составленные из цепочек потерянных кластеров. Таких файлов в зависимости от серьезности повреждений файловой системы может быть очень много, до нескольких тысяч.</p>
<p>Если после сбоя или вирусной атаки вы проверили диск одной из перечисленных выше программ, и в результате нужные вам файлы исчезли, существует большая вероятность того что они оказались среди восстановленных. Однако как их найти среди сотен и тысяч других?</p>
<p>Проще всего это сделать, например, с помощью програмы Find File, которую можно запустить из популярной оболочки Norton Commander при помощи комбинации клавиш &lt;Alt+F7&gt; (рис. 6.36).</p>
<div align="center">
	<img src="img/aaf00/fig6aa.gif" alt="Рис. 6.36. Поиск файлов по контексту при помощи программы Find File, запущенной из оболочки Norton Commander" />
	<p><strong>Рис. 6.36. Поиск файлов по контексту при помощи программы Find File, запущенной из оболочки Norton Commander</strong></p>
</div>
<p>В поле File(s) to find вы должны задать шаблон для имени файла и расширения имени, например, *.ndd. Поиск будет выполняться только среди файлов, имя которых удовлетворяет указанному шаблону.</p>
<p>Необходимо также в поле Containing указать шаблон для поиска, т. е. какую-либо текстовую строку, присутствующую в файле. Например, для того чтобы найти все файлы, созданные текстовым процессором Microsoft Word for Windows, вы можете указать шаблон Microsoft Word, а для того чтобы найти все файлы, подготовленные в среде процессора электронных таблиц Microsoft Excel, укажите шаблон Microsoft Excel.</p>
<p>Список путей к найденным файлам отобразится в верхней части окна программы Find File (рис. 6.37).</p>
<div align="center">
	<img src="img/aaf00/fig6ab.gif" alt="Рис. 6.37. Программа Find File нашла несколько файлов, содержащих указанный контекст" />
	<p><strong>Рис. 6.37. Программа Find File нашла несколько файлов, содержащих указанный контекст</strong></p>
</div>
<p>В дальнейшем, если найденных файлов будет все еще очень много, вы можете переписать их в отдельный каталог и переименовать, а затем продолжить поиск, используя другие строки в качестве контекста.</p>
<p>Описанную процедеру контекстного поиска вы можете использовать и для поиска в файлах документов изсестных вирусов, таких, например, как WinWord.Concept.</p>
<h4>Поиск с помощью программы DISKEDIT</h4>
<p>По сревнению с описанной в предыдущем разделе программой Find File программа DISKEDIT.EXE предоставляет намного больше возможностей для поиска файлов, а также различных структур файловой системы.</p>
<p>Обратите внимание на меню Tools программы DISKEDIT.EXE (рис. 6.38).</p>
<div align="center">
	<img src="img/aaf00/fig6ac.gif" alt="Рис. 6.38. Меню Tools программы DISKEDIT.EXE открывает доступ к набору инструментальных средств для работы с файловой системой" />
	<p><strong>Рис. 6.38. Меню Tools программы DISKEDIT.EXE открывает доступ к набору инструментальных средств для работы с файловой системой</strong></p>
</div>
<p>Если выбрать из этого меню строку Find, на экране появится диалоговая панель, показанная на рис. 6.39.</p>
<div align="center">
	<img src="img/aaf00/fig6ad.gif" alt="Рис. 6.39. Диалоговая панель Enter search text, предоставляющая широкие возможности контекстного поиск" />
	<p><strong>Рис. 6.39. Диалоговая панель Enter search text, предоставляющая широкие возможности контекстного поиск</strong></p>
</div>
<p>С помощью этой диалоговой панели вы сможете выполнять контекстный поиск строк, заданных как смивольным, так и шестнадцатиричным представлением. Дополнительно можно указать смещение сектора и выбрать режим Ignore Case, при котором сравнение с образцом будет выполняться без учета строчных или прописных букв.</p>
<p>Строка Find Object позволяет выполнить поиск различных структур файловой системы. Если выбрать эту строку, на экране появится меню второго уровня, показанное на рис. 6.40.</p>
<div align="center">
	<img src="img/aaf00/fig6ae.gif" alt="Рис. 6.40. Меню, с помощью которого можно выполнить поиск служебных структур файловой системы" />
	<p><strong>Рис. 6.40. Меню, с помощью которого можно выполнить поиск служебных структур файловой системы</strong></p>
</div>
<p>Попробуйте все это в действии. Для этого откройте меню Object и выберите из него строку Physical Sector. Затем укажите самый первый сектор, расположенный на нулевой дорожке. Этот сектор должен содержать главную загрузочную запись MBR. Перейдите в режим неформатированного просмотра, выбрав из меню View строку as Hex.</p>
<p>Теперь выберите из меню Tools строку Find Object и затем строку FAT. Программа DISKEDIT.EXE выполнит поиск первой копии таблицы размещения файлов FAT и отображит ее дамп, выделив в этом дампе первые три байта, как это показано на рис. 6.41.</p>
<div align="center">
	<img src="img/aaf00/fig6af.gif" alt="Рис. 6.41. Программа DISKEDIT.EXE нашла первую копию таблицы размещения файлов FAT" />
	<p><strong>Рис. 6.41. Программа DISKEDIT.EXE нашла первую копию таблицы размещения файлов FAT</strong></p>
</div>
<p>Если теперь сместить текстовый курсор вниз или нажать клавишу &lt;PgDn&gt;, а затем выбрать из меню Tools/Find Object строку FAT еще раз, будет найдена вторая копия таблицы размещения файлов FAT.</p>
<p>Учтите, что поиск таблиц FAT в данном случае сводится к поиску последовательности байт F8 FF FF, поэтому выполнив поиск в третий раз, вы сможете найти еще одну, ненастоящую &ldquo;таблицу FAT&rdquo;. Дело в том, что наверняка на диске найдется какой-нибудь файл, содержащий указанную выше последовательность байт, поэтому будьте внимательны.</p>
<p>Если взглянув на главную загрузочную запись вы увидели, что таблица разделов разрушена или зашифрована, можно выполнить контекстный поиск секторов загрузочных записей, содержащих блоки параметров BIOS BPB. Проще всего это сделать, если после просмотра главной загрузочной записи по ее физическому адресу и перехода к следующему сектору диска выбрать из меню Tools/Find Object строку Partition/Boot.</p>
<p>Программа DISKEDIT.EXE найдет сектор, содержащий в конце последовательность байт 55 AA, которая соответствует сигнатуре загрузочного сектора 0AA55h (рис. 6.42).</p>
<div align="center">
	<img src="img/aaf00/fig6ag.gif" alt="Рис. 6.42. Найден загрузочный сектор" />
	<p><strong>Рис. 6.42. Найден загрузочный сектор</strong></p>
</div>
<p>После того как вы нашли загрузочный сектор, его физический адрес можно вручную подставить в таблицу разделов, отредактировав ее программой DISKEDIT.EXE. О том как выполнить редактирование, вы можете узнать из документации, которая поставляется с набором утилит Нортона.</p>
<p>Так как структура разделов диска в процессе эксплуатации последнего может многократно изменяться, не исключено что вы найдете слишком много загрузочных секторов. Некоторые из них принадлежали старым разделам и не были уничтожены при изменении структуры разделов, некоторые вообще могут принадлежать другим операционным системам. В любом случае проверяйте расположение найденного загрузочного сектора относительно других найденных вами логических структур файловой системы. Например, вы можете использовать для &ldquo;опознания&rdquo; тот факт, что сразу после загрузочного сектора должна следовать таблица размещения файлов.</p>
<p>Так как в процессе поиска программа DISKEDIT.EXE проверяет только последние два байта сектора, возможны ложные срабатывания. На рис. 6.43 показана как раз такая ситуация.</p>
<div align="center">
	<img src="img/aaf00/fig6ah.gif" alt="Рис. 6.43. При поиске загрузочного сектора найден сектор, содержащий нужную сигнатуру, который однако, не является загрузочным" />
	<p><strong>Рис. 6.43. При поиске загрузочного сектора найден сектор, содержащий нужную сигнатуру, который однако, не является загрузочным</strong></p>
</div>
<p>Нетрудно заметить, что вслед за найденным располагается сектор, содержимое которого мало похоже на таблицу размещения файлов.</p>
<p>Теперь займамся поиском каталогов, на которые нет ссылок из других каталогов (т. е. потерянных каталогов).</p>
<p>Для поиска вы можете воспользоваться строкой Subdirectory меню Tools/Find Object. Программа DISKEDIT.EXE просматривает секторы диска в поисках такого, в начале которого находится последовательность байт 2E 20 20 20 20 20 20 20 20 20 20 (рис. 6.44). Эта последовательность соответствует дескриптору, который содержит ссылку каталога на себя самого.</p>
<div align="center">
	<img src="img/aaf00/fig6ai.gif" alt="Рис. 6.44. Найден сектор, принадлежащий каталогу" />
	<p><strong>Рис. 6.44. Найден сектор, принадлежащий каталогу</strong></p>
</div>
<p>Нажимая комбинацию клавиш &lt;Control+G&gt;, вы можете продолжить поиск нужного вам каталога, пока не найдете тот, что содержит интересующие вас файлы. Можно выполнять поиск и по имени файла, если вы его знаете.</p>
<p>Как только нужный каталог найден, вы должны записать физический адрес соответствующего сектора диска и найти либо вычислить номер кластера, соответвтующего каталогу.</p>
<p>Для поиска номера кластера, соответсвующего найденному каталогу, перейдите в режим форматированного просмотра каталога, выбрав из меню View строку as Directory. Затем из меню Link выберите стоку Cluster chain (fat). На экране появится содержимое таблицы FAT в режиме форматированного просмотра, при этом искомый номер кластера будет выделен.</p>
<p>Зная номер кластера потерянного каталога, вы можете создать новый дескриптор каталога, например, в корневом каталоге диска, и сделать в этом дескрипторе ссылку на найденный каталог. После этого потерянный каталог вновь станет доступным.</p>
<p>Аналогично можно вручную восстановить ссылки на потерянные файлы и даже собрать файлы из отдельных кластеров.</p>
<p>Можно предложить следующий алгоритм восстановления файла:</p>
<ol>
	<li>выполнить контекстный поиск секторов файла с помощью строки Files из меню Tools, а также последовательным просмотром секторов диска;</li>
	<li>определить номер кластеров, соответствующего найденным секторам, пользуясь приведенной выше формулой или средствами программы DISKEDIT.EXE;</li>
	<li>восстановить цепочку номеров кластеров для файла в таблице размещения файлов FAT, отметив в ней последний кластер значением 0FFFFh;</li>
	<li>создать в любом каталоге (например, в корневом) дескриптор, который описывает файл, указав в нем ссылку на первый кластер восстановленного файла, а также размер этого файла.</li>
</ol>
<p>Если вы восстанавили файл документа, созданный текстовым процессором Microsoft Word for Windows или процессором таблиц Microsoft Excel, загрузите его в соответсвующее приложение и затем сохраните его под другим именем. При этом будет восстановлена правильная длина файла.</p>
<p>Простой текстовый файл можно загрузить в текстовый редактор и &ldquo;отрезать&rdquo; лишние данные в конце файла. Затем сохраните файл под другим именем.</p>
<h3>Особенности файловой системы Microsoft Windows 95</h3>
<p>Восстанавливая файловую систему компьютера, на котором установлена операционная система Microsoft Windows 95, следует соблюдать осторожность, так как структура каталогов в ней отличается от структуры каталогов в MS-DOS.</p>
<p>Как вы, возможно, знаете, пользователи Microsoft Windows 95 не скованы ограничениями на длину имен файлов и каталогов. И хотя такое ограничение существует (255 символов), оно не имеет существенного значения.</p>
<p>Создавая новую операционную систему, программисты из Microsoft нашли остроумное решение проблемы совместимости с программами MS-DOS, использующими имена в &ldquo;формате 8.3&rdquo; (8 символов - имя файла или кталога, 3 - расширение имени).</p>
<p>Это решение заключается в том, что в каталогах наряду с обычными дескрипторами располагаются дескрипторы специального вида, количество которых зависит от длины имени файла или каталога. В этих дескрипторах и хранится длинное имя. Специально для программ MS-DOS создается обычный дескриптор, содержащий альтернативное имя, отвечающее стандартам MS-DOS.</p>
<p>Взгляните на рис. 6.45. На этом рисунке показана структура каталога, созданного в файловой системе Microsoft Windows 95, причем просмотр выполнялся программой DISKEDIT.EXE из пакетf Norton Utilities версии 8.0, предназначенной для MS-DOS.</p>
<div align="center">
	<img src="img/aaf00/fig6aj.gif" alt="Рис. 6.45. Просмотр структуры каталогов программой DISKEDIT.EXE, предназначенной для работы в среде MS-DOS" />
	<p><strong>Рис. 6.45. Просмотр структуры каталогов программой DISKEDIT.EXE, предназначенной для работы в среде MS-DOS</strong></p>
</div>
<p>Обратите внимание на дескрипторы, расположенный над дескрипторами каталога SYSTEM, дескрипторами файлов README.TXT, INSTALL.INF и SETUP.EXE. Это и есть специальные дескрипторы, хранящие информацию о длинных именах в кодировке UNICODE (в этой кодировке каждый символ представлен двумя байтами).</p>
<p>Для того чтобы специальные дескрипторы не мешали работе программ MS-DOS, в них установлены атрибуты Read Only, System, Hidden и Volume Label. Элементы каталога с таким экзотическим набором игнорируются всеми обычными программами MS-DOS.</p>
<p>Если просматривать содержимое каталога программой DISKEDIT.EXE из пакета Norton Utilities для Microsoft Windows 95, специальные дескрипторы будут отображаться в форматированном виде, доступном для исследования (рис. 6.46).</p>
<div align="center">
	<img src="img/aaf00/fig6ak.gif" alt="Рис. 6.46. Просмотра структуры каталогов новой версией программы DISKEDIT.EXE, предназначенной для Microsoft Windows 95" />
	<p><strong>Рис. 6.46. Просмотра структуры каталогов новой версией программы DISKEDIT.EXE, предназначенной для Microsoft Windows 95</strong></p>
</div>
<p>Специальный дескриптор отмечается новой версией программы DISKEDIT.EXE как LFN (Long File Name) и ссылается на кластер с номером 0. Настоящий номер первого кластера, распределенного файлу или каталогу, находится в стандартном дескрипторе, расположенным непосредственно вслед за специальным. Например, каталог с именем System отмечен в стандартном дескрипторе как SYSTEM и расположен в кластере с номером 32227.</p>
<p>Если имя файла или каталога превышает 8 символов, стандартный дескриптор, расположенный после специальных, содержит алиасное имя, состоящее из начальных символов имени, символа &ldquo;~&rdquo; (тильда) и десятичного числа. Этот дескриптор называется алиасным.</p>
<p>В главном меню программы DISKEDIT.EXE появилось новая строка More, выбрав которую, вы сможете просмотреть или отдредактировать остальные поля специальных дескрипторов (рис. 6.47 и 6.48).</p>
<div align="center">
	<img src="img/aaf00/fig6al.gif" alt="Рис. 6.47. Просмотр остальных полей спеециальных дескрипторов" />
	<p><strong>Рис. 6.47. Просмотр остальных полей спеециальных дескрипторов</strong></p>
</div>
<div align="center">
	<img src="img/aaf00/fig6am.gif" alt="Рис. 6.48. Просмотр остальных полей спеециальных дескрипторов (продолжение)" />
	<p><strong>Рис. 6.48. Просмотр остальных полей спеециальных дескрипторов (продолжение)</strong></p>
</div>
<p>Например, дата и время создания файла находятся, соответственно, в полях Create Date и Create Time. Дополнительно операционная система Microsoft Windows 95 фиксирует дату последнего обращения к файлу. Эту дату вы можете увидеть в поле Accessed.</p>
<p>Поле EA содержит признак расширенных атрибутов и имеет нулевое значение для стандартных атрибутов.</p>
<p>Если имя настолько длинное, что не помещается в одном специальном дескрипторе, создается несколько таких дескрипторов, расположенных друг за другом. Следом за ними идет алиасный дескриптор. В поле Ordinal находится порядковый номер специального дескриптора. Для последнего специального дескриптора в поле Last? находится отметка Yes.</p>
<p>Что же касается таблицы размещения файлов FAT, то хотя в операционной системе Microsoft Windows 95 она и называется виртуальной таблицей размещения файлов VFAT, ее формат остался прежним. Это сделано для совместимости с программами MS-DOS. Сохранились форматы и других логических блоков файловой системы, таких как таблица разделов диска, таблица логических дисков, загрузочная запись и расширенный блок параметров BIOS Extended BPB.</p>
<p>Для восстановления файловой системы Microsoft Windows 95 нельзя использовать старые версии пакета Norton Utilities. Вы должны выполнять автоматическое восстановление либо приложением ScanDisk, которое входит в состав этой операционной системы, либо программой NDD.EXE из пакета Norton Utilities для Microsoft Windows 95. Полуавтоматическое восстановление можно выполнять только новой версией программы DISKEDIT.EXE для Microsoft Windows 95, но не в коем случае не старой, которая ничего не знает о специальных дескрипторах.</p>
<h2>7 Ахиллесова пята операционной системы</h2>
<p>В этой главе мы попытаемся сделать анализ устойчивости различных операционных систем к &ldquo;нашествию&rdquo; вирусов, чтобы помочь системным  администраторам и обычным пользователям выбрать наиболее защищенную от вирусов операционную систему.</p>
<p>Не секрет, что надежность многих современных операционных систем оставляет желать лучшего. Это можно сказать и про устойчивость ко всякого рода внешним воздействиям, таким, например, как поптыки несанкционированного доступа или вирусные атаки. Причина этого лежит в неполном использовании возможности аппаратуры, в необходимости обеспечения совместимости новых операционных систем со старым программным обеспечением, а также, вероятно и в том, что при разработке операционных систем для персональных компьютеров вопросам защищенности не уделялось достаточно внимания.</p>
<p>Наиболее беззащитной является операционная система MS-DOS и все совместимые с ней, такие как Novell DOS, IBM DOS и т. д. Основная причина заключается в том, что эта операционная система использует реальный режим работы процессора и предоставляет запущенным программам полный и бесконтрольный доступ ко всем системным ресурсам компьютера (в том числе и к модулям самой операционной системы).</p>
<p>Операционная система Microsoft Windows версии 3.1 (а также Microsoft Windows for Workgroups версии 3.11) запускается из MS-DOS. Хотя она использует защищенный режим работы процессора, ее устойчивость к вирусным воздействиям также невысока.</p>
<p>С точки зрения полноты использования возможностей защищенного режима одно из первых мест принадлежит такой операционной системе, как IBM OS/2. Если системный администратор (или пользователь) запретит запуск в ее среде программ MS-DOS (а также приложений Windows), эта операционная система будет работать очень стабильно. Однако файловая система рабочей станции OS/2 может оказаться баззащитной перед нашествием вирусов. Тем не менее создание вируса для OS/2 - непростая задача. Возможно поэтому нигде в мире не наблюдается лавинообразного роста вирусов, ориентированных на OS/2, что говорит в пользу этой операционной системы.</p>
<p>Операционная система Microsoft Windows 95 может подвергнуться нападению со стороны вирусов, предназначенных для DOS, так как из соображений совместимости она предоставляет таким программам полный доступ к файловой системе и стартует из среды MS-DOS версии 7.0. Последний факт нигде особенно не афишируется, однако на диске C: по-прежнему существуют файлы AUTOEXEC.BAT и CONFIG.SYS, которые не изменили своего назначения. Следовательно, для вируса есть возможнсоть остаться резидентным в памяти до загрузки Windows 95.</p>
<p>Такая операционная система, как Novell NetWare, заслуживает всяческих похвал и потому широко распространена. Ее файловая система хорошо защищена и сама по себе может выдержать вирусную атаку. Однако вирус не обязательно будет пытаться обойти защиту Novell NetWare (что весьма и весьма непросто). Вместо этого он может, например, подсмотреть пароль системного администратора на рабочей станции и таким образом получить неограниченные привилегии. К счастью, работоспособных вирусов подобного типа не так много.</p>
<p>В операционной системе Microsoft Windows NT предусмотрены специальные меры, исключающие возможность выманить у пользователя его пароль. Файловая система NTFS, которая используется в Microsoft Windows NT, содержит мощные встроенные средства защиты от несанкционированного доступа. На сегодняшний день нам не известен ни один вирус, специально разработанный для этой операционной системы.</p>
<h3>Операционная система MS-DOS</h3>
<p>Подавляющее большинство вирусов было создано для операционной системы MS-DOS, которая и до сегодняшнего дня является наиболее популярной. Популярность MS-DOS и ее &ldquo;доверчивость&rdquo; к программам способствуют появлению все новых и новых вирусов.</p>
<p>В этом разделе мы расскажем вам о некоторых уязвимых местах операционной системы MS-DOS, которые активно используются вирусами для своего закрепления и распространения, а также для того чтобы скрыть свое существование (как это делают стелс-вирусы).</p>
<p>Вы увидите, что вирус в MS-DOS имеет полный доступ к любому байту оперативной памяти и к любому сектору любого диска. Поистине трудно найти более беззащитную операционную систему, чем MS-DOS.</p>
<h4>Использование реального режима работы процессора</h4>
<p>Как мы уже говорили, использование реального режима работы процессора значительно ухудшает защищенность и стабильность операционной системы MS-DOS.</p>
<p>Напомним, как выполняется адресация памяти в реальном режиме (рис. 7.1).</p>
<div align="center">
	<img src="img/aaf00/fig71.gif" alt="Рис. 7.1. Адресация памяти в реальном режиме работы процессора" />
	<p><strong>Рис. 7.1. Адресация памяти в реальном режиме работы процессора</strong></p>
</div>
<p>Программы (как системные, так и программы, запускаемые пользователем) работают с адресом, состоящим из двух 16-разрядных компонент, которые называются сегментом и смещением.</p>
<p>Для вычисления физического адреса памяти (который попадает на системную шину компьютера) значение сегмента сдвигается влево на четыре бита и складывается со значением смещения, расширенного до 20 разрядов. Задавая различные значения для компонент адреса, любая программа может получить доступ к любой области памяти (в границах первого Мбайта адресного пространства).</p>
<p>В результате программы, которые запускают пользователи, а также, разумеется, вирусы, могут изменить любую область оперативной памяти, распределенную операционной системе MS-DOS или другой программе, обычной или резидентной. Поэтому вирусу не составляет никакого труда встроить себя, например, в цепочку драйверов устройств, перехватить программное или аппаратное прерывание, или сделать что-нибудь еще.</p>
<p>Другой недостаток реального режима работы процессора заключается в том, что программы могут бесконтрольно обращаться к портам периферийных устройств.</p>
<h4>Изменение вирусами структуры памяти</h4>
<p>Система управления памятью, встроенная в MS-DOS, является чисто символической, так как ее нормальная работа зависит от того, будут ли программы выполнять заранее оговоренные соглашения, или нет. Однако ничто не помешает программе стать &ldquo;нарушителем&rdquo;, полностью разрушив всю операционную систему или внеся в нее те или иные &ldquo;незаконные&rdquo; изменения.</p>
<p>Например, программа может запросить у MS-DOS блок памяти размером 10 Кбайт. В ответ соответствующая функция MS-DOS предоставит программе сегментный адрес выделенного блока. Используя полученный адрес как указатель на массив, программа может записать в этот массив не 10, а 20 или 30 Кбайт данных, и ничто не помешает ей в этом, так как MS-DOS&nbsp;не будет проверять значение указателя на предмет выхода за пределы массива.</p>
<p>Какие же изменения могут внести вирусы в структуру памяти?</p>
<p>Вспомним, как распределен первый мегабайт оперативной памяти в операционной системе MS-DOS:</p>
<table summary="" border="1">	
<tr><th>Диапазон адресов</th><th>Описание</th></tr>
<tr><td>0000h:0000h</td><td>Векторы прерываний</td></tr>
<tr><td>0000h:0400h</td><td>Область данных BIOS</td></tr>
<tr><td>0000h:0500h</td><td>Область данных MS-DOS</td></tr>
<tr><td>xxxx:0000h</td><td>Область программ MS-DOS.
	<p>Здесь располагаются обработчики прерываний MS-DOS, буферы, внутренние структуры данных MS-DOS, встроенные и загружаемые драйверы устройств</p></td></tr>
<tr><td>xxxx:0000h</td><td>Резидентная часть командного процессора COMMAND.COM</td></tr>
<tr><td>xxxx:0000h</td><td>Резидентные программы (если загружены)</td></tr>
<tr><td>xxxx:0000h</td><td>Запущенные прикладные программы</td></tr>
<tr><td>xxxx:0000h</td><td>Транзитная часть командного процессора COMMAND.COM</td></tr>
<tr><td>0A000h:0000h</td><td>Память видеоадаптера EGA</td></tr>
<tr><td>0B000h:0000h</td><td>Память монохромного видеоадаптера</td></tr>
<tr><td>0B800h:0000h</td><td>Память видеоадаптера CGA</td></tr>
<tr><td>0C800h:0000h</td><td>Внешнее ПЗУ или адреса периферийных устройств, отображаемые на память</td></tr>
<tr><td>0F600h:0000h</td><td>ПЗУ интерпретатора BASIC или адреса периферийных устройств, отображаемые на память</td></tr>
<tr><td>0FE00h:0000h</td><td>ПЗУ BIOS</td></tr>
</table>
<p>Первый килобайт памяти занимает таблица векторов прерываний. Она содержит 256 элементов, имеющих размер 4 байта. Таблица содержит адреса обработчиков прерываний, состоящие из компонент сегмента и смещения.</p>
<p>Таблица векторов прерываний - любимый объект для нападения вирусов. Вирусы могут изменять содержимое этой таблицы прерываний напрямую или с помощью соответствующего сервиса, предоставляемого операционной системой MS-DOS.</p>
<p>Цель изменений заключатеся в том, чтобы подключить обработчики прерываний, расположенные в теле вируса, вместо стандартных. При этом вирус получает доступ к важнейшим функциям MS-DOS и BIOS, полностью контролируя их. Подменяя обработчики аппаратных прерываний, вирус может держать под контролем работу периферийных устройств, например, жесткого диска или накопителя на гибких магнитных дисках.</p>
<p>Так как современные антивирусные программы проверяют целостность таблицы векторов прерываний, некоторые вирусы используют для внедрения в обработчики прерываний другие технологии. Например, вирус изменяет несколько первых команд стандартного обработчика прерывания, сохраняя оригинальные команды в своем теле. На место этих команд он записывает другие, передающие управление вирусу. Таким образом, хотя таблица векторов прерываний не изменяется, вирус полностью контролирует ситуацию.</p>
<p>Область памяти с адресами 0000h:0400h - 0000h:04FFh занимает область данных BIOS. Это внутренние переменные BIOS. Здесь хранится важная информация, например, параметры жеских дисков, накопителей на гибких магнитных дисках, текущие параметры операционной системы и т. д. В некоторых случаях вирусы намеренно изменяют некоторые параметры, расположенные в этой области, нарушая нормальную работу операционной системы, или хранят собственные параметры и флаги. Например, вирусы могут отключать накопитель на гибком магнитном диске с целью затруднения загрузки MS-DOS с чистой дискеты.</p>
<p>В области памяти, которая начинается с адреса 0000h:0500h, располагается область данных MS-DOS. Здесь MS-DOS  хранит свои внутренние таблицы, переменные и структуры данных. Вслед за областью данных находятся модули системы ввода/вывода MS-DOS, обработчики прерываний MS-DOS, внутренние буферы и внутренние структуры данных, а также загружаемые драйверы. После драйверов располагается резидентная часть командного процессора COMMAND.COM.</p>
<p>И драйверы, и командный процессор могут быть подвергнуты вирусной атаке. В частности, вирусы могут встраивать себя в тело драйвера, перехватывая поступающие в него команды.</p>
<p>Далее в оперативной памяти располагаются резидентные программы и программа, которая выполняется в текущий момент времени.</p>
<p>В нижней части адресного пространства (до адреса 0A000h:0000h) находится транзитная часть командного процессора COMMAND.COM, которая может перекрываться выполняющейся программой.</p>
<p>Область адресов от 0A000h:0000h до 0C800h:0000h используется видеоадаптерами. Так как в этом диапазоне адресов может располагаться оперативная память (которая физически установлена в видеоадаптере), здесь тоже могут &ldquo;жить&rdquo; вирусы.</p>
<p>Вся оперативная память, принадлежащая MS-DOS, разделена на фрагменты, перед которыми расположены блоки управления памятью MCB (Memory Control Block). Внутри блока MCB хранится длина описываемого данным MCB фрагмента памяти. Следующий фрагмент памяти начинается сразу за предыдущим. При этом все блоки MCB связаны в список.</p>
<p>В ранних версиях MS-DOS формат блока MCB не был документирован, что, тем не менее, не останавливало разработчиков вирусов от попыток изменения структуры памяти на уровне этих блоков. Теперь же сведения о формате блока MCB можно почерпнуть из руководства программиста, полученного в Microsoft:</p>
<table summary="" border="1">
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>1</td><td>Тип блока MCB (M или Z)</td></tr>
<tr><td>1</td><td>2</td><td>Сегментная компонента адреса владельца блока или 0, если блок описывает сам себя</td></tr>
<tr><td>3</td><td>2</td><td>Число параграфов в этом блоке (размер параграфа равен 16 байт)</td></tr>
<tr><td>5</td><td>11</td><td>Зарезервировано</td></tr>
</table>
<p>Блоки MCB бывают двух типов - M и Z. M-блоки - это промежуточные блоки. Блок типа Z является последним блоком в списке и может быть только один.</p>
<p>Так как любой программе, запущенной под управлением MS-DOS, доступна для записи вся оперативная память, вирус может изменить количество и расположение фрагментов памяти, создав для себя новый фрагмент и, соответственно, новый блок MCB. При этом вирус остается резидентным в памяти, не обращаясь для этого к соответствующим функциям операционной системы. Таким образом вирус предпринимает простейшую попытку скрыть тот факт, что он пытается стать резидентным в оперативной памяти.</p>
<div class="notes">
	<p><em>Sayha.DieHard</em></p>
	<p><em>Опасный резидентный шифрованный вирус. Перехватывает прерывания INT 10h, 13h, 21h. Вирус трассирует данные прерывания для выяснения адресов оригинальных обработчиков и для попытки "внедрения" в цепочки обработчиков прерываний.</em></p>
	<p><em>Когда происходит открывание ASM-файлов, вирус записывает в них следующий текст:</em></p>
	<blockquote>
		<p><em>.model small</em></p>
		<p><em>.code</em></p>
		<p><em>org 256</em></p>
		<p><em>s:      push    cs</em></p>
		<p><em>pop     ds</em></p>
		<p><em>call    t</em></p>
		<p><em>db      'Tе$'</em></p>
		<p><em>t:      pop     dx</em></p>
		<p><em>mov     ah,9</em></p>
		<p><em>int     33</em></p>
		<p><em>mov     ah,76</em></p>
		<p><em>int     33</em></p>
		<p><em>end s</em></p>
	</blockquote>
	<p><em>Аналогично, при открывании файлов с расширением имени PAS в них записывается такой текст:</em></p>
	<blockquote>
		<p><em>begin</em></p>
		<p><em>write('Tе');</em></p>
		<p><em>end.</em></p>
	</blockquote>
	<p><em>При установке графического режима с номером 13h (разрешение 320x200, 256 цветов) вирус рисует в центре экрана буквы "SW".</em></p>
	<p><em>Если возникают ошибки при попытке записи на диск (переход за границу 64 Kбайт при работе с DMA или если данные были скорректированы с использованием ECC), вирус пытается их исправить!</em></p>
	<p><em>В своем теле вирус одержит текстовые строки "SW Error", "SW DIE HARD 2"</em></p>
</div>
<p>Тщательно изучая структуру блоков MCB (например, при помощи программы MEM.EXE, которая входит в состав MS-DOS), при наличии достаточного опыта вы сможете обнаружить фрагменты памяти, созданные вирусами. Для этого вы должны знать, какие резидентные программы и драйверы загружаются через файлы AUTOEXEC.BAT и CONFIG.SYS, какие они создают блоки, а также понимать назначение блоков памяти, принадлежащих MS-DOS. Более полную информацию об этом вы можете получить из 18 тома нашей серии книг &ldquo;Библиотека системного программиста&rdquo;, которая называется &ldquo;MS-DOS для программиста&rdquo;.</p>
<h4>Внесение изменений в файловую систему</h4>
<p>Для того чтобы &ldquo;закрепиться&rdquo; в компьютере, вирус, как правило, вносит те или иные изменения в файловую систему.</p>
<p>Файловая система MS-DOS не содержит абсолютно никаких защитных механизмов, которые могли бы воспрепятствовать проникновению в ее логические структуры вирусов. Более того, системные прерывания BIOS и MS-DOS предоставляют вирусам весь инструментарий, необходимый для такого проникновения. Эти прерывания хорошо описаны как в документации, поставляемой Microsoft, так и в различной компьютерной литературе (например, в 18 и 19 томах &ldquo;Библиотеки системного программиста&rdquo;).</p>
<p>Для обеспечения совместимости с периферийными устройствами, выпускаемыми различными фирмами, операционная система MS-DOS выполняет операции ввода/вывода не самостоятельно, а с помощью базовой системы ввода вывода BIOS. При этом любая программа (в том числе вирусная), также может обращаться к прерываниям BIOS.</p>
<h5>Прерывание INT 13h</h5>
<p>Прерывание INT 13h, обработчик которого находится в BIOS, позволяет любой программе беспрепятственно читать и записывать любые секторы жесткого или гибкого диска. Зная логическую структуру файловой системы MS-DOS (частично описанную в предыдущей главе), разработчик вируса при помощи этого прерывания может встроить вирусный код в загрузочную запись или в любое другое подходящее с его точки зрения место.</p>
<p>Разумеется, о прерывании INT 13h знают не только разработчики вирусов, но и авторы антивирусных программ. И те и другие борятся за получение &ldquo;настоящей&rdquo; точки входа в обработчик этого прерывания, который должен быть расположен в постоянном запоминающем устройстве. Целью вируса является перехват прерывания INT 13h, а целью антивирусной программы - обнаружение такого перехвата.</p>
<p>Тем не менее, даже надежно защитив точку входа в обработчик прерывания INT 13h, нельзя гарантировать полную защиту от вирусной атаки.</p>
<p>Как вы, возможно, знаете, в реальном режиме работы процессора программе разрешается выполнять операции обмена данными с любыми портами периферийных устройств. В том числе и с портами контроллера жесткого диска или накопителя на гибком магнитном диске. В 19 томе &ldquo;Библиотеки системного программиста&rdquo; мы привели пример программы, которая работает именно таким образом, читая сектор дискеты без обращения к прерыванию INT 13h.</p>
<p>Для того чтобы у вас было некоторое представление о том, что может сделать вирус при помощи прерывания INT 13h, приведем краткое описание функций этого прерывания:</p>
<table summary="" border="1">
<tr><th>Номер функции</th><th>Описание</th></tr>
<tr><td>00h</td><td>Сброс дисковой системы</td></tr>
<tr><td>01h</td><td>Определение состояния дисковой системы</td></tr>
<tr><td>02h</td><td>Чтение сектора</td></tr>
<tr><td>03h</td><td>Запись сектора</td></tr>
<tr><td>04h</td><td>Проверка сектора</td></tr>
<tr><td>05h</td><td>Форматирование дорожки</td></tr>
<tr><td>06h</td><td>Форматирование дорожки НМД</td></tr>
<tr><td>07h</td><td>Форматирование НМД</td></tr>
<tr><td>08h</td><td>Получить текущие параметры НГМД или НМД</td></tr>
<tr><td>09h</td><td>Инициализация таблиц параметров НМД</td></tr>
<tr><td>0Ah</td><td>Чтение длинное (только для НМД)</td></tr>
<tr><td>0Bh</td><td>Запись длинная (только для НМД)</td></tr>
<tr><td>0Ch</td><td>Поиск цилиндра (только для НМД)</td></tr>
<tr><td>0Dh</td><td>Альтернативный сброс НМД</td></tr>
<tr><td>0Eh</td><td>Чтение буфера (только для НМД)</td></tr>
<tr><td>0Fh</td><td>Запись буфера (только для НМД)</td></tr>
<tr><td>10h</td><td>Проверка готовности НМД</td></tr>
<tr><td>11h</td><td>Рекалибровка НМД</td></tr>
<tr><td>12h</td><td>Проверка памяти контроллера НМД</td></tr>
<tr><td>13h</td><td>Проверка НМД</td></tr>
<tr><td>14h</td><td>Проверка контроллера НМД</td></tr>
<tr><td>15h</td><td>Получить тип НМД или НГМД</td></tr>
<tr><td>16h</td><td>Проверка замены диска</td></tr>
<tr><td>17h</td><td>Установка типа дискеты</td></tr>
<tr><td>18h</td><td>Установка среды носителя данных для форматирования</td></tr>
<tr><td>19h</td><td>Парковка головок (только для НМД)</td></tr>
<tr><td>1Ah</td><td>Форматирование НМД с интерфейсом ESDI</td></tr>
</table>	
<p>Как видите, вирус может прочитать, записать и отформатировать дорожку диска. Используя команды 0Ah и 0Bh, разработанные для диагностических целей, вирус может изменить контрльные суммы секторов данных, которые обычно подсчитываются, записываются и проверяются автоматически.</p>
<div class="notes">
	<p><em>SillyRE.666</em></p>
	<p><em>Опасный шифрованный вирус.</em></p>
	<p><em>После загрузки в память своей резидентной копии вирус записывает "мусор" в 11 сектор нулевой дорожки (головка с номером 1), пользуясь для этого операцией длинной записи. Обычно на этом месте диска находится первая копия таблицы размещения файлов FAT</em></p>
</div>
<p>С помощью функций прерывания INT 13h вирус может получить доступ к внутреннему буферу, расположенному непосредственно в дисковом накопителе.</p>
<p>Другой &ldquo;лакомый кусочек&rdquo; для вирусов - прерывание INT 76h, которое вырабатывается при завершении операции в контроллере жесткого диска. Вирус может перехватывать это прерывание для реализации стелс-технологии.</p>
<h5>Прерывания INT 25h и INT 26h</h5>
<p>Операционная система MS-DOS предоставляет для работы с файловой системой и логическими дисками свои средства. Это прерывания INT 25h, INT 26h, а также ряд функций прерывания INT 21h. Кроме того, программа может работать с дисковыми устройствами через соответствующий драйвер, обращаясь к нему косвенно с помощью функций интерфейса IOCTL. Все эти средства были нами подробно описаны в 19 томе &ldquo;Библиотеки системного программиста&rdquo;.</p>
<p>С помощью прерываний INT 25h и INT 26h любая программа (а также вирус) может, соответственно, прочитать и записать любой сектор логического диска. Используя эти прерывания, вирусу ничего не стоит, например, подменить загрузочный сектор логического диска, выполнив таким образом заражение этого диска.</p>
<p>Так как эти два прерывания используются MS-DOS для выполнения операций с логическими дисками, многие вирусы пытаются их перехватить, чтобы получить контроль над операциями ввода/вывода (например, для реализации стелс-механизма).</p>
<div class="notes">
	<p><em>MIREA.4156</em></p>
	<p><em>Полиморфный вирус.</em></p>
	<p><em>Выполняет поиск EXE-файлов, чтение из файла и запись в файл через прерывания INT 25h и INT 26h. Файлы могут быть поражены в любом подкаталоге текущего диска.</em></p>
	<p><em>Содержит ошибки, из-за которых неработоспособен на диске с 12-разрядной таблицей размещения файлов FAT.</em></p>
	<p><em>Иногда по окончании своей работы, может выдать текст:</em></p>
	<blockquote>
		<p><em>Заранее прошу извинения.</em></p>
		<p><em>Чистая случайность, что ЭТО попало к Вам.</em></p>
		<p><em>По классификации Е.Касперского это типичная  "студенческая" программа, причем в наихудшем ее исполнении:</em></p>
		<p><em>- портит оверлеи (если не повезет, то и резиденты тоже),</em></p>
		<p><em>- портит забитый до отказа диск,</em></p>
		<p><em>- содержит большое число ошибок,</em></p>
		<p><em>- имеет большой размер,</em></p>
		<p><em>и т.д.</em></p>
		<p><em>Чего еще можно ожидать от студента МИРЭА.</em></p>
		<p><em>Ничего гадкого, кроме распространения программа не делает (я на это надеюсь, хотя от "студенческой" можно ожидать всего из-за ее крайней примитивности и большого числа ошибок ).</em></p>
		<p><em>МИРЭА - хороший ВУЗ!!!</em></p>
		<p><em>МИРЭА - это звучит гордо!!!</em></p>
		<p><em>МИРЭАзм не объяснить, в нем надо жить!!!</em></p>
	</blockquote>
</div>
<p>Перехват прерываний можно выполнить разными способами. Можно напрямую отредактировать таблицу векторов прерываний. Можно также воспользоваться услугами функций 25h и 35h прерывания INT 21h, предназначенных, соответственно, для установки нового вектора прерывания и получения текущего вектора прерывания.</p>
<p>Однако антивирусные программы тщательно проверяют таблицу векторов прерываний, поэтому для их изменения вирусы используют различные изощренные приемы. Например, вирус может подменить первые несколько команд обработчика прерывания, сохранив эти команды в своем теле. При этом, несмотря на то что таблица векторов прерываний остается нетронутой, прерывание оказывается перехваченным. Такая методика, разумеется, может быть использована для перехвата любых прерываний, а не только прерываний INT 25h и INT 26h.</p>
<h5>Функции прерывания INT 21h</h5>
<p>Что касается функций прерывания INT 21h, предназначенных для работы с файловой системой, то их набор является полным и позволяет выполнять практически любые операции над файлами и каталогами.</p>
<p>Пользуясь этими функциями, вирусы могут беспрепятственно изменять загрузочные файлы программ, дописывая к ним новый код и редактируя заголовок файла. При этом стелс-вирусы маскируют внесенные изменения, перехватывая многие функции прерывания INT 21h и возвращая ложную информацию, например, о размере файла.</p>
<h5>Интерфейс GENERIC IOCTL</h5>
<p>Еще одно средство, которое может быть использовано вирусами для внесение изменений в файловую систему, это интерфейс общего управления вводом/выводом GENERIC IOCTL.</p>
<p>Этот интерфейс реализован в рамках функции 44h прерывания INT 21h (операция с кодом 0Dh), которая обеспечивает механизм взаимодействия между прикладным программным обеспечением и драйверами блочных устройств.</p>
<p>Указанная функция позволяет программам (и вирусам) читать и изменять параметры устройств, выполнять чтение, запись, форматирование и проверку дорожек диска на низком уровне с помощью драйвера устройства.</p>
<p>При вызове функции регистры процессора загружаются следующим образом:</p>
<table summary="" border="1">
<tr><th>Регистр</th><th>Описание содержимого</th></tr>
<tr><td>AH</td><td>44h</td></tr>
<tr><td>AL</td><td>0Dh</td></tr>
<tr><td>BL</td><td>Номер устройства НМД или НГМД</td></tr>
<tr><td>CH</td><td>Код категории устройства: 08h - дисковое устройство</td></tr>
<tr><td>CL</td><td>Операция: 
	<p>40h - установить параметры устройства;</p>
	<p>60h - получить параметры устройства;</p>
	<p>41h - записать дорожку;</p>
	<p>61h - прочитать дорожку;</p>
	<p>42h - форматировать дорожку;</p>
	<p>62h - проверить дорожку</p>
			</td></tr>
<tr><td>DS:DX</td><td>Указатель на блок параметров</td></tr>
</table>
<p>Через регистры DS:DX функции передается адрес подготовленного блока параметров, формат которого зависит от выполняемой операции. Из приведенного выше описания видно, что набор выполняемых функцией операций более чем достаточен для того чтобы с его помощью вирусы могли сделать любые изменения логических структур файловой системы.</p>
<h4>Вирусы в загружаемых драйверах</h4>
<p>Драйвер является расширением операционной системы, предназначенным, как правило, для работы с тем или иным периферийным устройством. Обычно в составе любой операционной системы имеется набор драйверов, предназначенных для разных устройств.</p>
<p>Что касается операционной системы MS-DOS, то для нее все драйверы можно разделить на встроенные в ядро и подгружаемые через файл CONFIG.SYS.</p>
<p>Встроенные и подгружаемые драйверы после загрузки объединяются в цепочку, адрес которой можно найти с использованием недокументированных средств, описанных нами в 18 томе &ldquo;Библиотеки системного программиста&rdquo;.</p>
<p>Для того чтобы понять, каким образом вирус может заразить драйвер, вспомним, что в самом начале драйвера находится заголовок следующего формата:</p>
<table summary="" border="1">
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>4</td><td>Указатель на заголовок драйвера, следующего в цепочке. Если смещение адреса следующего драйвера равно 0FFFFh, это последний драйвер в цепочке</td></tr>
<tr><td>4</td><td>2</td><td>Атрибуты драйвера</td></tr>
<tr><td>6</td><td>2</td><td>Смещение программы стратегии драйвера</td></tr>
<tr><td>8</td><td>2</td><td>Смещение программы обработки прерывания для драйвера</td></tr>
<tr><td>0Ah</td><td>8</td><td>Имя устройства для символьных устройств или количество обслуживаемых устройств для блочных устройств</td></tr>
</table>
<p>Обратите внимание на поля смещений программы стратегии и обработки прерывания драйвера. Эти поля используются операционной системой MS-DOS для вызова драйвера.</p>
<p>Вызов драйвера представляет собой двухступенчатый процесс.</p>
<p>Вначале операционная система вызывает программу стратегии, пользуясь смещением, полученным из заголовка драйвера (поле со смещением 6). Перед этим она формирует в своей области данных запрос, передавая программе стратегии адрес соответствующего блока данных в регистрах ES:BX. Программа стратегии обычно очень проста, так как ее задача заключается в запоминании адреса блока данных, содержащего запрос, в области памяти, принадлежащей драйверу.</p>
<p>Запрос операционной системы к драйверу содержит заголовок, имеющий фиксированный формат и длину 13 байт, а также структуру переменного размера и формата, которые зависят от выполняемой функции (переменная область запроса). Формат первой области запроса приведен ниже:</p>
<table summary="" border="1">
<tr><th>Смещение, байт</th><th>Размер, байт</th><th>Описание</th></tr>
<tr><td>0</td><td>1</td><td>Общий размер блока запроса в байтах</td></tr>
<tr><td>1</td><td>1</td><td>Номер устройства. Используется для блочных устройств; указывает, с каким именно устройством (из числа обслуживаемых данным драйвером) будет работать операционная система</td></tr>
<tr><td>2</td><td>1</td><td>Код	команды, которую требуется выполнить</td></tr>
<tr><td>3</td><td>2</td><td>Слово состояния устройства. Заполняется драйвером перед возвращением управления операционной системе</td></tr>
<tr><td>5</td><td>8</td><td>Зарезервировано</td></tr>
</table>
<p>На втором этапе операционная система MS-DOS вызывает программу обработки прерывания, взяв ее смещение из заголовка драйвера (поле со смещением 8). Программа обработки прерывания анализирует код команды, расположенный в фиксированной области запроса (поле со смещением 2) и выполняет ее.</p>
<p>Заражение драйвера, загруженного в оперативную память, выполняется достаточно просто. Вирус находит в цепочке драйверов жертву и изменяет заголовок драйвера, либо подменяет несколько команд, расположенных в начале программ стратегии и обработки прерывания. После этого вирус становится способен контролировать выполнение всех команд, поступающих в драйвер.</p>
<div class="notes">
	<p><em>Dir-II (1,2)</em></p>
	<p><em>Неопасные резидентные вирусы, встраивающиеся в цепочку дисковых драйверов.</em></p>
	<p><em>Вирусы записывают свой код в последний кластер диска. Для файлов с расширениями имени COM и EXE устанавливают указатели первого кластера данных на последний кластер диска, содержащий вирусный код</em></p>
</div>
<p>Заражение файла с драйвером выполняется примерно также, как и заражение файла обычной исполнимой программы с расширением имени EXE. Для определения смещения программ стратегии и прерывания вирус должен проанализировать заголовок драйвера, который находится в самом начале файла, содержащего драйвер. Дальнейшие действия вируса очевидны - замена нескольких начальных команд и дописывание в конец файла вирусного кода.</p>
<div class="notes">
	<p><em>ExeHeader.Dragon</em></p>
	<p><em>Инсталлируется в память и внедряется в цепочку дисковых драйверов.</em></p>
	<p><em>Содержит в своем теле строку "DRAGON-2 Anti"</em></p>
</div>
<h3>Операционная система Microsoft Windows версии 3.1</h3>
<p>Первые версии операционной системы Microsoft Windows представляли из себя не более чем надстройку над MS-DOS и потому воспринимались как красивые, но не слишком нужные оболочки для работы с файловой системой. Однако версия 3.1 этой операционной системы, в которой впервые была применена технология масштабируемых шрифтов True Type, получила громадную, ни с чем не сравнимую популярность. В большой степени это произошло еще и потому, что многие ведущие производители программных средств создали для Microsoft Windows очень хорошие приложения, ставшие в последнее время просто незаменимыми.</p>
<p>Однако многие согласятся с тем, что надежность операционной системы Microsoft Windows версии 3.1 (и ее более поздняя модификация Microsoft Windows for Workgroups весрии 3.11) не слишком высока. Некорректно написанная программа может полностью нарушить работоспособность всей системы, что приведет к необходимости перезагрузки компьютера.</p>
<p>Как устроена операционная система Microsoft Windows версии 3.1?</p>
<p>Полный ответ на этот вопрос займет очень много места. Интересующихся подробностями мы отсылаем к томам с 11 по 17 включительно нашей &ldquo;Библиотеки системного программиста&rdquo;, в которых мы рассмотрели различные аспекты программирования для Microsoft Windows.</p>
<p>Если же сказать кратко, то Microsoft Windows создает одну системную виртульную машину для запуска всех приложений Microsoft Windows, и по одной виртульаной машине для каждой программы MS-DOS. Каждая такая виртульная машина имеет собственное виртуальное адресное пространоство, что позволяет (теоретически) исключить их взаимное влияние друг на друга. Однако на практике такое влияние все же есть. Именно оно приводит к такой ситуации, когда аварийное завершение одной из программ приводит к аварийному завершению всей операционной системы.</p>
<p>Вы можете спросить - а при чем тут вирусы?</p>
<p>Но ведь вирус - это программа, а раз обычная программа может влиять на все остальные и даже на операционную систему в целом, то и вирус тоже сможет. И еще как.</p>
<h4>Нелегкий груз совместимости</h4>
<p>Мы не сделаем открытия, если скажем, что успех новой операционной системы в большой степени определяется ее способностью выполнять старые программы. Операционная система никому не нужна сама по себе - она используется только как рабочая среда для запуска прикладных программ. И если пользователи, установив новую операционную систему, обнаружат что все их любимые программы перестали работать, они едва ли будут довольны.</p>
<p>Осознавая этот факт, Microsoft при создании операционной системы Microsoft Windows приложила много усилий для обеспечения совместимости с программами MS-DOS. При этом вольно или невольно она обеспечила прекрасную совместимость почти со всеми вирусами, разработанными в свое время для MS-DOS.</p>
<p>Как сделать, чтобы программы MS-DOS хорошо чувствовали себя в среде виртуальной машины, создаваемой для них операционной системой Microsoft Windows?</p>
<p>В лучшем случае виртуальная машина должна быть сделана так, чтобы работающая в ее среде программа и не подозревала, что машина на самом деле &ldquo;не настоящая&rdquo;. Для этого программам должно быть позволено все, что и раньше. И хотя теперь программы несколько ограничены в правах, так как имеют доступ только к своему виртуальному пространству оперативной памяти, диски и файловая система для них доступны как и раньше. Аналогично, программы (и вирусы) могут напрямую работать с портами периферийных устройств, что также не повышает устойчивости системы к вирусам.</p>
<h4>Отыщи всему начало...</h4>
<p>Строго говоря, операционная система Microsoft Windows версии 3.1 не является... операционной системой. Скорее это очень большая программа MS-DOS, которая составлена с использованием расширителя DOS (нам кажется, что это был DOS Extender фирмы Phar Lap). О расширителях DOS вы можете узнать из 6 тома &ldquo;Библиотеки системного программиста&rdquo;, который называется &ldquo;Защищенный режим работы процессоров Intel 80286/80386/80486&rdquo;).</p>
<p>Расширитель DOS при запуске программы переводит процессор в защищенный режим работы, обеспечивая при этом интерфейс с обработчиками прерываний, функциями BIOS и DOS, рассчитанные на реальный режим работы процессора. При этом программа получает, с одной стороны, возможность воспользоваться преимуществами защищенного режима работы процессора (такими, например, как прямая адресация расширенной памяти), с другой стороны - возможность работы с файловой системой средствами прерываний MS-DOS. Удобно и практично.</p>
<p>Так как Microsoft Windows версии 3.1 не может работать без MS-DOS, то вирусы могут сделать многое еще до старта этой операционной системы. Например, вирусы могут удобно расположиться в главной загрузочной записи MBR или загрузочной записи Boot Record, перехватить и взять под свой контроль ключевые прерывания BIOS и MS-DOS.</p>
<p>Поэтому операционная система Microsoft Windows весрии 3.1 по своей &ldquo;питательности&rdquo; для вирусов ни в чем не уступает MS-DOS. И хотя на сегодняшний день мы не наблюдаем лавинообразного роста вирусов, специально ориентированных на операционную систему Microsoft Windows весрии 3.1, вы не должны расслабляться. Даже если вы давно забыли команды MS-DOS и работаете только с приложениями Microsoft Windows, вам по-прежнему угрожают несколько тысяч старых вирусов, созданных &ldquo;в стиле&rdquo; MS-DOS.</p>
<h4>Откуда не ждали</h4>
<p>В начале этой книги мы рассказали вам о макрокомандных вирусах, которые являются последним &ldquo;достижением&rdquo; в этой области. Хотя эти вирусы родились в среде Microsoft Windows версии 3.1, они не пользуются (пока) &ldquo;слабостями&rdquo; этой операционной системы. Потенциально такие вирусы могут существовать в среде любой операционной системы, если для нее созданы приложения, работающие с объектными документами, содержащими наряду с обычными данными последовательности макрокоманд.</p>
<p>Можно даже сказать, что макрокомандные вирусы живут не в среде операционной системы, а в среде прикладных программ, работающих с докумантами. Так как в последнее время разрабатываются кросс-платформные операционные системы и приложения, потенциально любая операционная среда может оказаться подвержена заражению макрокомандными вирусами.</p>
<h3>Операционная система Microsoft Windows 95</h3>
<p>Несмотря на значительный прогресс в области пользовательского интерфейса, более устойчивую работу за счет разделения виртульных адресных пространств отдельных приложений и реальной мультизадачности, операционная система Microsoft Windows 95 устойчива к вирусам не более, чем Microsoft Windows версии 3.1.</p>
<p>Причина все та же - эта операционная система очень хорошо совместима с программами MS-DOS, &ldquo;привыкшим&rdquo; к бесконтрольному владению компьютером.</p>
<p>Несмотря на то что Microsoft хорошо спрятала MS-DOS версии 7.0 от пользователя, вирусы найдут ее функции и логические структуры данных без особого труда, точно также как и привычные вам файлы CONFIG.SYS и AUTOEXEC.BAT. Заразив главную загрузочную запись и резидентные программы, запускаемые через файл AUTOEXEC.BAT, вирусы смогут доставить вам немало хлопот, повредив, например, другие программные файлы, файлы данных или даже всю файловую систему.</p>
<p>К сожалению, файловая система Microsoft Windows 95 по-прежнему не имеет никакой защиты, поэтому вирусные программы, работающие, например, в среде виртуальной машины MS-DOS, смогут повредить ее без особого труда, воспользовавшись, например, вполне &ldquo;легальными&rdquo; функциями прерывания INT 21h.</p>
<p>Добавьте к сказанному выше возможность заражения макрокомандными вирусами, и вы поймете, что единственная гарантия предохранения компьютера с операционной системой Microsoft Windows 95 от вирусов - это грамотное использование антивирусных программ.</p>
<h3>Операционная система IBM OS/2</h3>
<p>Операционная система IBM OS/2 защищена от вирусов намного лучше всех других описанных выше операционных систем. В самом деле, на настоящий момент не существует вирусов, разработанных специально для IBM OS/2. В отличие от Microsoft Windows и Microsoft Windows 95 эта операционная система является полнофункциональной и работает, разумеется, без всякой помощи со стороны MS-DOS, которой может даже не быть на диске.</p>
<p>Все программы, запускаемые в среде OS/2, работают в отдельных адресных пространствах, и потому не могут повлиять друг на друга. Подробнее о том как устроена и работает операционная система IBM OS/2 Warp версии 3.0, а также о том как ее установить и настроить, вы можете узнать из 20 тома нашей серии &ldquo;Библиотека системного программиста&rdquo;, который называется &ldquo;Операционная система IBM OS/2 Warp&rdquo;.</p>
<p>А как же, спросите вы, совместимость с программами MS-DOS?</p>
<p>Эта совместимость имеется, хотя в наиболее отвественных случаях ее можно отключить.</p>
<p>Операционная система способна работать с различными файловыми системами, самыми важными из которых является файловая система FAT и HPFS. Первая из них используется операционной системой MS-DOS и нужна главным образом как раз для совместимости. Вторая является высокопроизводительной файловой системой HPFS (High Performance File System), специально разработанной для OS/2.</p>
<p>В ответственных случаях вы можете работать только с файловой системой HPFS, запретив пользователю запускать программы MS-DOS. Для этого в файле CONFIG.SYS необходимо указать следующую строку:</p>
<pre>PROTECTONLY=YES</pre>
<p>В этом случае оперативная память в пределах первого мегабайта адресного пространства будет использоваться для запуска программ OS/2.</p>
<p>Учтите, что если вы запретите запуск программ MS-DOS, вы не сможете запускать в среде IBM OS/2 и приложения Microsoft Windows.</p>
<p>Дополнительно можно усилить защиту, указав в файле CONFIG.SYS такую строку:</p>
<pre>IOPL=NO</pre>
<p>При этом обычные (несистемные) программы не будут иметь доступ к портам периферийных устройств.</p>
<p>В том случае, если вы работаете в среде IBM OS/2 с программами MS-DOS или приложениями Microsoft Windows, существует опасность поражения программных файлов вирусами, разработанными для операционной системы MS-DOS. Такие вирусы могут оставаться резидентными в памяти во время работы сеанса DOS и способны повредить программные файлы, расположенные на диске. Хотя, разумеется, возможностей для повреждения файловой системы у них будет намного меньше, чем в среде MS-DOS. В частности, вирусы не смогут воспользоваться прерыванием INT 13h для перезаписи главной загрузочной записи и не смогут повредить системные области файловой системы HPFS.</p>
<p>Если компьютер с операционной системой IBM OS/2 используется в качестве файл-сервера IBM LAN Server, загружается драйвер 386 HPFS, который дополнительно повышает защищенность файловой системы HPFS, позволяя указывать права доступа к каталогам и файлам. Вы можете защитить каталоги, содержащие программные файлы, от записи, и при этом вирусы не смогут их повредить.</p>
<h3>Операционная система Microsoft Windows NT</h3>
<p>Операционная система Microsoft Windows NT предназначена для высокопроизводительных файл-серверов (в варианте Microsoft Windows NT Advanced Server),&nbsp;а также для элитных рабочих станций класса High End (вариант Microsoft Windows NT Workstation).</p>
<p>Оба варианта снабжены надежной системой защиты, непреодолимой для вирусов и злоумышленников, поэтому операционная система Microsoft Windows NT сертифицирована для использования в государственных и правительственных учреждениях.</p>
<p>Если объем оперативной памяти в вашем компьютере равен или превышает 16 Мбайт, а объем диска - 500 Мбайт, вам нужна высокая надежность, совместимость с программами MS-DOS и приложениями Microsoft Windows, прекрасные средства работы в локальных или глобальных сетях, подумайте об операционной системе Microsoft Windows NT версии 3.51 или более новой.</p>
<p>Файловая система NTFS, примененная в Microsoft Windows NT, позволяет вам управлять доступом к программным файлам и файлам данных. Защитив каталоги с прогрфаммными файлами от записи, вы надежно защитите их от нападения вирусов, в том числе и от тех, что разработаны для MS-DOS.</p>
<p>В отличие от своих предшественников, операционная система Microsoft Windows NT является полнофункциональной и не нуждается в услугах MS-DOS. В корневом каталоге нет файлов AUTOEXEC.BAT и CONFIG.SYS. Нет также резидентных программ, получающих управление на этапе загрузки операционной системы.</p>
<p>Несмотря на то что Microsoft Windows NT может работать с файловой системой FAT, в ответственных случаях мы советуем вам ограничиться файловой системой NTFS, которая на сегодняшний день является наиболее развитой и защищенной.</p>
<h3>Операционная система Novell NetWare</h3>
<p>Мы уже рассказывали вам о том, как следует организовывать антивирусную защиту локальных сетей, в частности, созданных на базе операционной системы Novell NetWare.</p>
<p>В этом разделе мы еще раз напомним вам об одном уязвимом месте этой весьма и весьма хорошо защищенной операционной системы.</p>
<p>Речь идет о том, что вирусы могут подсмотреть пароль супервизора, когда тот вводит его на рабочей станции.</p>
<p>Как это можно сделать?</p>
<p>Напомним, что для входа в сеть супервизор (как и любой другой пользователь) запускает с сетевого диска программу LOGIN.EXE и вводит в ответ на приглашение свое имя и пароль.</p>
<p>Процесс ввода пароля таит в себе опасность, так как коды введенных символов имени и пароля проходят через буфер клавиатуры, расположенных в области данных BIOS. Вирус, загруженный резидентно в оперативную память, может организовать сканирование этого буфера с целью обнаружения имени и пароля. В этом нет ничего трудного.</p>
<p>Затем, пользуясь программным интерфейсом сетевой оболочки рабочей станции MS-DOS, вирус может попытаться определить привилегии пользователя. И если пользователь ввел пароль супервизора, вирус может получить полный доступ над файл-сервером. Заметим, что подобную процедуру вирусы могут проделать не только с файл-сервером Novell NetWare, но и с файл-серверами, созданными на базе других сетевых операционных систем.</p>
<p>Например, он может записать новую nlm-программу в системный каталог и включить ее имя в файл STARTUP.NCF, который интерпретируется на этапе загрузки операционной системы Novell NetWare. Такая программа может иметь права на чтение или запись в любой каталог файл-сервера.</p>
<p>Более подробную информацию о процессе подключения пользователя к файл-серверу Novell NetWare вы можете получить из 9 тома нашей серии книг &ldquo;Библиотека системного программиста&rdquo;, который называется &ldquo;Локальные сети персональных компьютеров. Работа с сервером Novell NetWare&rdquo;.</p>
<p>Для того чтобы избежать подобной неприятности, супервизор должен входить в сеть, только загрузив свою рабочую станцию с чистой заклееной системной дискеты, свободной от вирусов. На эту же дискету нужно переписать программу LOGIN.EXE, предварительно убедившись, что она сама не заражена. Это можно сделать, например, при помощи программ Doctor Web и Aidstest из антивирусного комплекта АО &ldquo;ДиалогНаука&rdquo;.</p>
<p>Ни при каких обстоятельсвах не следует входить в сеть пользователем с правами супервизора, если нет полной уверенности, что рабочая станция не заражена вирусами.</p>
<h2>Литература</h2>
<ol>
	<li><em>Фролов А.В., Фролов Г.В. Библиотека системного программиста. М.: ДИАЛОГ-МИФИ, 1991-1996</em>
	<ul>
		<li><em>Т.16. Модемы и факс-модемы. Программирование для MS-DOS и Windows.</em></li>
		<li><em>Т.18, 19.&nbsp;MS-DOS для программиста.</em></li>
		<li><em>Т.20. Операционная система IBM OS/2 Warp.</em></li>
	</ul></li>
	<li><em>Фролов А.В., Фролов Г.В. Персональный компьютер. Шаг за шагом. М.: ДИАЛОГ-МИФИ, 1994-1996</em>
	<ul>
		<li><em>Т.1. Введение в MS-DOS, MS Windows, MS Word for Windows.</em></li>
		<li><em>Т.2. Операционная система Microsoft Windows. Руководство пользователя.</em></li>
		<li><em>Т.3. Сети компьютеров в вашем офисе.</em></li>
		<li><em>Т.4. Что вы должны знать о своем компьютере.</em></li>
	</ul></li>
	<li><em>Д.Н. Лозинский, Д.Ю. Мостовой, И.А. Данилов, В.С. Ладыгин, Д.Г. Зуев, Ю.Н. Фомин. Антивирусный комплект АО &ldquo;ДиалогНаука&rdquo;. Руководство пользователя. М.: ДИАЛОГ-МИФИ, 1995-1996</em></li>
	<li><em>Survivor&rsquo;s Guide to Computer Viruses. Virus Bulletin, 21 The Quadrant, Abingdon, OX14 3YS, England, 1993</em></li>
	<li><em>Безруков Н.Н. Компьютерные вирусы. - М.: Наука, 1991</em></li>
	<li><em>Безруков Н.Н. <a href="/lib/anb00.html">Компьютерная вирусология: справочное руководство</a>. - Киев: Укр. сов. энцикл., 1991</em></li>
</ol>
[<a style="" href="/lib/?lang=RU&amp;index=AV#aaf00">Вернуться к списку</a>] [<a href="/lib/aaf00.html#disqus_thread">Комментарии</a>]<br />    <div id="disqus_thread"></div>
    <script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>



</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=aaf00">de</a><a href="/lib/index.php?lang=en&amp;id=aaf00">en</a><a href="/lib/index.php?lang=es&amp;id=aaf00">es</a><a href="/lib/index.php?lang=it&amp;id=aaf00">it</a><a href="/lib/index.php?lang=fr&amp;id=aaf00">fr</a><a href="/lib/index.php?lang=pl&amp;id=aaf00">pl</a><a href="/lib/index.php?lang=ru&amp;id=aaf00">ru</a><a href="/lib/index.php?lang=ua&amp;id=aaf00">ua</a></div>
</body>
</html>
