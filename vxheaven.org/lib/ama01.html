<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>William Mahoney, Craig Pokorny 'Do-It-Yourself Guide to Cell Phone Malware' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="William Mahoney, Craig Pokorny"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Mahoney, William; Pokorny, Craig,Do-It-Yourself Guide to Cell Phone Malware, microsoft, message, devices, simple, cell, studio, visual, mobile, contact, phones, outlook, content, default, mechanisms, transport"/>
<meta name="Description" content="The authors present recent research they have conducted to determine the simplicity of constructing malicious code for cell phones. The results are quite surprising, due to the straight-forwardness of the programming interface and the availability of tools. Our paper recounts the results of a simplistic search for off-the-shelf code which can be utilized for the creation of malicious software for cell phones. Our search yielded a self-replicating phone virus which we simulated in a contained environment."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"52c8b1ac7c0864b275d30023ac24c37c9eab5500-1498756113-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/ama01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Do-It-Yourself Guide to Cell Phone Malware</h1><p><a href="/lib/?lang=en&amp;author=Mahoney%2C%20William">William Mahoney</a>, <a href="/lib/?lang=en&amp;author=Pokorny%2C%20Craig">Craig Pokorny</a><br/> <em>IJCSNS International Journal of Computer Science and Network Security, VOL.9 No.1, pp.248-252</em><br/> <em>ISSN 1738-7906</em><br/> <em>January 2009</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/ama01.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Do-It-Yourself%20Guide%20to%20Cell%20Phone%20Malware.pdf">Download</a> PDF (188.35Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=VT#ama01">Back to index</a>] [<a href="/lib/ama01.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
William R. Mahoney and Craig A. Pokorny,<br/>
University of Nebraska at Omaha, Omaha Nebraska USA
</address>
<ul>
<li><a href="#c0">Summary</a></li>
<li><a href="#c1">1. Introduction</a></li>
<li><a href="#c2">2. Background</a>
<ul>
<li><a href="#c21">2.1 Available Transport Mechanisms</a></li>
<li><a href="#c22">2.2 The Rise of e-Mail</a></li>
</ul></li>
<li><a href="#c3">3. Locating and Utilizing Software Tools</a></li>
<li><a href="#c4">4. Our Malicious Application</a></li>
<li><a href="#c5">5. Conclusions</a></li>
<li><a href="#c6">References</a></li>
</ul>
<p><em>Manuscript received January 5, 2009, Manuscript revised January 20, 2009</em></p>
<h2><a name="c0"></a>Summary</h2>
<p>The authors present recent research they have conducted to determine the simplicity of constructing malicious code for cell phones. The results are quite surprising, due to the straight-forwardness of the programming interface and the availability of tools. Our paper recounts the results of a simplistic search for off-the-shelf code which can be utilized for the creation of malicious software for cell phones. Our search yielded a self-replicating phone virus which we simulated in a contained environment.</p>
<p><strong>Key words:</strong> Cell phone, malware, outlook, contact propagation.</p>
<h2><a name="c1"></a>1. Introduction</h2>
<p>With the advent of web-enabled cell telephones, handling email, web pages, and rich content, there is a definite potential for misuse. This has been an emerging problem for some time; in fact the first cell phone hacker references appeared over 20 years ago[1]. As cell phones subsume additional capabilities and are used by an increasing number of people, the possibilities for a cell phone virus or other malware impacting the global economy is getting larger. It is estimated that fully one quarter of the inhabitants of the planet currently use mobile phones[2]; in Europe there are currently more cell phones than people[3]. And cell phone viruses such as Phage and Liberty Crack were already appearing back in 2000 [4,5]. The use of smart phones, which are the aim of our study and which incorporate email and web browsing, was increasing at a rate of 156% in 2007 [6].</p>
<p>Over the course of the development of the internet, meanwhile, simple tools for hackers have become available and so-called “script kiddies” use these easy tools to attack web servers. The knowledge required is not extensive. Without a tremendous amount of information concerning the actual technical aspects of the attack, a “script kiddy” can download the available software and start right in as a nefarious user. Is the same now true for cell phone usage? Our research encompassed a simple goal: determine what tools are openly available for some type of cell phone attack, download the necessary items, verify that they can be used in a bad manner, and report on the results. This paper represents the last of these aims. Our research was thus to create a cell phone virus such as Cabir[7] – a virus that does no harm other than self-replicate, and in the process determine whether the tools and skills are readily available and simple.</p>
<p>In section two of the paper we present a few of the techniques used for data delivery to cell phones, including brief overviews of SMS, MMS, and email applications typical for currently existing cell phones. Section three describes the tools we located and used for the project, and the following section describes the effort required to create a “cruel” application. Our conclusions are in section five.</p>
<h2><a name="c2"></a>2. Background</h2>
<p>Although it is normal to think of cell phones simply as phones, they generally have other communications methods available which are more easily utilized for delivering malware. These include the SMS system, MMS, e-Mail, and others. These methods may or may not be capable of transmitting a payload containing the troublesome software.</p>
<p>Cell phone manufacturers and providers are gradually becoming aware that these techniques can be used for malicious intent. A 2004 document by Microsoft[8] sated that “Although Microsoft Windows Mobile-based devices have yet to become a significant target for malicious code, one may argue that it is only a matter of time before such threats occur. Also, even if the devices themselves are not affected by such code, when they connect to a network they can serve as transport mechanisms for passing destructive software on to other computing systems.” Presumably the normal “transport mechanisms” such as SMS, MMS, email, etc. are used for this “destructive software”</p>
<h3><a name="c21"></a>2.1 Available Transport Mechanisms</h3>
<p>The Short Message Service, popularly referred to as “texting”, allows one to send a message of up to 160 (7-bit) bytes of message content to mobile devices, including cell phones, Personal Digital Assistants (PDAs), and smart phones. The SMS system is similar to paging systems used prior to the popularization of cell technology. A key difference is that the SMS messages are queued at the server until the cell phone is within range and powered on.
 
It is not necessary to be ready to receive the message from the cellular provider at the moment that it is sent. SMS payloads can also be sent to the destination phone from web applications, instant messaging clients, Voice over IP services, and other services including email[9]. Because of the short nature of the message it is probably difficult to use SMS for the delivery of malware.</p>
<p>Contrasting with SMS is the Multimedia Messaging Service, or MMS. MMS is a variation of SMS which is used specifically to get past the length restriction of SMS and thus deliver rich content. This content can include photos, videos, and web content in general. The encoding scheme is similar to Multipurpose Internet Mail Extensions (MIME) and the contents are saved as a web page on a server. An SMS “control message” is then sent to the recipient; this message contains the URL of the content, and this triggers the receiver's web browser to open and receive the content from the embedded URL. In this way, the contents of the message can be of arbitrary length.</p>
<p>Obviously the restrictions imposed by size within SMS are not present in MMS. Also the contents of the payload coming from the web server can just as easily hold software as well as photos. Thus, MMS is a candidate for malware.</p>
<h3><a name="c22"></a>2.2 The Rise of e-Mail</h3>
<p>Ever since the internet became a household norm, e-mail has been everywhere. E-mail was originally the best way to propagate a virus, and is still, unfortunately, used in this manner. With the rise of cell phones along with the availability of internet on cell phones, the ability to check e-mail via cell phone became another norm.</p>
<p>On the popular Microsoft Windows platform the default email client of Outlook Express is immensely popular, despite it being the default target for malware. The Outlook client also runs on a variety of embedded applications on top of what once was called Windows CE but is now referred to as Windows Mobile. Since the particular cell phone we were working with supported Microsoft Windows Mobile[10] and the particular phone also contained Outlook, we specifically focused on email malware delivery. Note that this is not currently the most popular cell phone platform; “in the third quarter of 2008, Nokia had 47 percent worldwide smart phone market share; Apple, 17 percent; RIM 15 percent and Microsoft Windows Mobile phones, 14 percent”[11]. However it was favored simply because one of the authors owns a Microsoft Mobile phone, and the previously mentioned propensity for Outlook security issues.</p>
<h2><a name="c3"></a>3. Locating and Utilizing Software Tools</h2>
<p>Since the cell phone we planned to attack was Windows Mobile based, we initially made a determination as to how to go about creating software for this platform. Obviously the place to start is the Microsoft Windows Mobile web site, which indicated that application development for these phones is generally accomplished using Visual Studio. We simply downloaded a copy of Visual Studio via the Microsoft Developer Network (MSDN) Academic Alliance[12]. One can easily find a trial version of Visual Studio from the MSDN without any login. Also necessary is the Windows Mobile 6 Cell Phone Emulator package and the pertinent software development kit (SDK) for this emulator. This SDK can be found on the Microsoft download center [13].</p>
<p>We used the HTC Mogul[14] as the sample phone for development purposes, as one of us happened to own this particular unit. A quick search of the internet also indicated the availability of a considerable amount of open source knowledge and software for this platform, which also influenced our decision.</p>
<p>After installing Visual Studio, we brought up our source code (described next), which is based on C#. We chose this language as it is near enough to C and C++, and that most programmers can do basic manipulations of the source code. After writing sample software and manipulating the code, one can subsequently test it on the cell phone emulator. This is done by running the cellular emulator located in the Windows Mobile 6 SDK package, resetting the connection, and then starting the phone emulator in the Visual Studio environment. The only configuration issued we encountered were setting the Peripherals to the correct communications ports; in our case Serial port 0 needs to be set to COM4, as in Figure 1:</p>
<div align="center">
<img src="img/ama01/fig1.gif" alt="Fig. 1 Windows Mobile 6 SDK Configuration for Phone Emulator."/>
<p><strong>Fig. 1 Windows Mobile 6 SDK Configuration for Phone Emulator.</strong></p>
</div>
<p>In Visual Studio, we debug and deploy the program into the Windows Mobile 6 Professional Emulator. The
 
end result is a cell phone within a window (Figure 2), which accurately mimics the real hand held unit.</p>
<p>Even the simplest malware needs one aspect in order to be malicious: the ability to propagate. Based on this requirement we searched for open source code which would allow us to view the contents of the address book on the phone. Once we understand the methods for accessing this data, we can replicate our malware via SMS messages, email messages, or some other means. Obtaining this source and adding it to our application is as simple as cut and paste once you locate the necessary code; we discovered what we needed at a site managed by Craft[15]. The original use for this code was simply to broadcast an SMS message to different contact groups. Of course in order to do this it must have access to all of the contacts listed in the phone, which was exactly the software we wanted. We obtained this source, integrated it into our application by having it automatically pull up all contacts and send an SMS message. Using the phone emulator we verified that it did obtain the correct list and could send the message.</p>
<div align="center">
<img src="img/ama01/fig2.gif" alt="Fig. 2 Phone Emulator Running in Development Kit."/>
<p><strong>Fig. 2 Phone Emulator Running in Development Kit.</strong></p>
</div>
<h2><a name="c4"></a>4. Our Malicious Application</h2>
<p>We next created our malicious program and included the open source contact list software. The actual application creates an internal SMS message instead of the original version, which sent a user generated message to groups of contacts. In our version, when the software is launched on the phone, it sends the generated message to everyone in the contact list and then immediately exits. Because of this behavior the program window never actually becomes visible on the phone at all, possibly causing the phone user to run the application again.</p>
<p>There are different approaches to propagating the malware via the SMS message. Presumably one can create a control message which causes the recipient cell phone to automatically launch the browser application, for example. We instead selected a method with is low-tech and simple, but likely would be almost as effective: the content of the message is designed to deceive the recipient in some way so that they will install the program. Thus, a simple text message: “Hi! Hey, I located a nice phone add-on at www.malicious.com/...”. The receiver of the message knows the sender, presumably, and as a result often times will also simply trust the content. They click the link, select “download”, and run the application. This then propagates the malware to <em>their</em> contact list.</p>
<p>Our idea is that a malicious virus would then exploit the security loop holes in Windows. There are a wide range of possibilities. A simple attack could delete necessary files to run the operating system, and thus crash the phone. This would cause many phones to need service at the local phone store.</p>
<p>Of course we did not actually launch the application in the “real world”. Rather we tested it on the emulation package, using various contact lists and web links, including the web link necessary to cause the propagation as outlined above. In all cases the message came back to the emulator when the phone itself was in the contact list, and did not come back when the phone itself was not in the contact list. Shown in figure 3 below are several messages of this type as received by the phone emulator. We have, of course, replaced the message with a simple link to a well known URL instead of our message:</p>
<div align="center">
<img src="img/ama01/fig3.gif" alt="Fig. 3 Incoming Messages on Phone Emulator."/>
<p><strong>Fig. 3 Incoming Messages on Phone Emulator.</strong></p>
</div>
<p>In this manner we determined that the software was successfully propagating the message, and that following
 
the link resulted in another download of the malicious software.</p>
<h2><a name="c5"></a>5. Conclusions</h2>
<p>We were quite surprised with the ease that nefarious software can be created using off-the-shelf tools.</p>
<p>First and foremost, the necessary software tools for creating phone applications are easily available and often free for a trial period. As stated above, Visual Studio can be downloaded as a trial version, and the Windows Mobile 6 SDK is currently free as well.</p>
<p>Secondly, the propagation problem is easily solved by the available facility within the SMS messages to fool the recipient into following the embedded link. Obviously if one were to include a SMS control message instead of a simple (manually clickable) link, this would be a better route for reproduction of the malware; however our simple approach works as well and supports our suspicions about the simplicity and availability of the software creation.</p>
<p>Thirdly, locating the off-the-shelf software was very simple via searching the internet with obvious terms. Although the software was not targeted per-se with hackers in mind, a very small amount of “reading between the lines” is necessary in order to understand how the available software can be utilized for other exploits.</p>
<p>Finally, an experienced software engineering team, working into the wee hours of the night, is exactly the opposite of what is necessary. A reasonable background in computer programming, the ability to read the “help” system within the software tools, and a knowledge of how to fix the odd syntax error are sufficient skills for malware creation on cell phones.</p>
<p>Obviously we performed these experiments on a certain platform because of its availability and because we knew that the email client would have plenty of associated free software. However, our future work includes looking into some of the newer technologies, in particular applications which run on more popular phones such as the iPhone. Also future work includes what we call a “medium scale test” where a small group of actual phones, instead of the emulator, are used to test the malware in a larger, but still controlled, environment.</p>
<p>We predict that the “script kiddies” of the cell phone world are right around the corner.</p>
<h2><a name="c6"></a>References</h2>
<ol>
<li>Bruce Alston, <em>“Cellular Telephones – How They Work”</em>, 2600 Magazine, December 1986.</li>
<li>Steven Furnell, <em>“Handheld hazards: The rise of malware on mobile devices”</em>, Computer Fraud &amp; Security, Volume 2005, Issue 5, May 2005, Pages 4-8.</li>
<li>“Cell phone popularity growing in Europe” http://www.usatoday.com/tech/products/2008-09-25-518457659_x.htm</li>
<li>Neal Leavitt, <em>“Malicious Code Moves to Mobile Devices”</em>, Computer, vol. 33, no. 12, pp. 16-19, Dec., 2000.</li>
<li>Neal Leavitt, <em>“Mobile Phones: The Next Frontier for Hackers?”</em> Computer, April 2005, http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=14326&amp;isnumber=30759</li>
<li>Jerry Cheng1, Starsky H.Y. Wong1, Hao Yang and Songwu Lu, <em>“SmartSiren: Virus Detection and Alert for Smartphones”</em> http://www.usenix.org/events/mobisys07/full_papers/p258.pdf</li>
<li>29A lab: <a href="http://vxheaven.org/29a/">http://vx.netlux.org/29a/</a> however this web site is currently “retiring”.</li>
<li>Douglas Dedo, <em>“Windows Mobile-Based Devices and Security: Protecting Sensitive Business Information”</em> http://download.microsoft.com/download/4/7/c/47c9d8ec-94d4-472b-887d-4a9ccf194160/6.%20WM_Security_Final_print.pdf</li>
<li>Dylan F. Tweney, <em>“Everything you need to know about text messaging with your mobile phone”</em>, http://www.sms411.net/</li>
<li>http://www.microsoft.com/windowsmobile/en-us/default.mspx</li>
<li>Mary-Jo Foley, “Microsoft starts rolling out IE 6 for Windows Mobile”, ZDNet, November 12th, 2008 http://blogs.zdnet.com/microsoft/?p=1711</li>
<li>http://msdn.microsoft.com/en-us/academic/default.aspx</li>
<li>http://www.microsoft.com/downloads/details.aspx?familyid=06111A3A-A651-4745-88EF-3D48091A390B&amp;displaylang=en</li>
<li>Mogul™ by HTC (Sprint) at http://www.htc.com/us/faq_detail.aspx?p_id=75&amp;act=um</li>
<li>Chris Craft, <em>“30 Days of .NET [Windows Mobile Applications] - Day 14: Mobile SMS Contact”</em> at http://www.cjcraft.com/blog/2008/06/15/30DaysOfNETWindowsMobileApplicationsDay14MobileSMSContact.aspx</li>
</ol>
 
[<a style="" href="/lib/?lang=EN&amp;index=VT#ama01">Back to index</a>] [<a href="/lib/ama01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=ama01">de</a><a href="/lib/index.php?lang=en&amp;id=ama01">en</a><a href="/lib/index.php?lang=es&amp;id=ama01">es</a><a href="/lib/index.php?lang=it&amp;id=ama01">it</a><a href="/lib/index.php?lang=fr&amp;id=ama01">fr</a><a href="/lib/index.php?lang=pl&amp;id=ama01">pl</a><a href="/lib/index.php?lang=ru&amp;id=ama01">ru</a><a href="/lib/index.php?lang=ua&amp;id=ama01">ua</a></div>
</body>
</html>
