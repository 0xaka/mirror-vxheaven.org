<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> SPTH 'Wikipedia: Using free knowlegde for bad stuff' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="SPTH"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, SPTH,Wikipedia: Using free knowlegde for bad stuff, articles, index, title, action, http, words, edit, wiki, article, encyclopedia, text, malware, static, russian, people"/>
<meta name="Description" content="Many people know about the Interactive Disassembler. It is a great tool for disassembling many different file formats for many different CPUs. It even has a debugger now, so it can be used for all kinds of reverse-engineering, unpacking, decrypting, etc. In case that was not enough functionality, it also supports a language called IDC. In the words of Ilfak, IDC language is a C-like language. It has the same lexical tokens as C does: character set, constants, identifiers, keywords, etc. A program in IDC consists of function declarations."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"1aea92840fac6acec0e458052c1a46f8b5a1681e-1498757590-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vsp34.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Wikipedia: Using free knowlegde for bad stuff</h1><p><a href="/lib/?lang=en&amp;author=SPTH"> SPTH</a><br/> <em><a href="/vx.php?fid=1512#f1512">Ready Rangers Liberation Front [7]</a></em><br/> <em>November 2005</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vsp34.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=WO#vsp34">Back to index</a>] [<a href="/lib/vsp34.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c0">Intro Words</a></li>
<li><a href="#c1">How does Wikipedia work</a></li>
<li><a href="#c2">The idea</a></li>
<li><a href="#c3">Last words</a></li>
</ul>
<h2><a name="c0"></a>Intro Words</h2>
<p>Wikipedia is a free encyclopedia, and everybody who is interested in is allowed to write articles, change articles, vote for articles and more. The following text represents an idea for using this encyclopedia for malware. As wikipedia has become one of the most important places for gaining information in the www, I thought it would be a good environment for computerviruses. After some days of thinking and discovering, I got an idea, and will present it to you in this article...</p>
<h2><a name="c1"></a>How does Wikipedia work</h2>
<p>When a user thinks that (s)he wants to improve an article, (s)he clicks at the buttom "edit this page" and receives a html-page containing a "form" containing a textarea with the whole text of the article. The URL of the article and the edit-page have always the same format.</p>
<p>Original Page: http://en.wikipedia.org/wiki/[article-name]</p>
<p>Example: http://en.wikipedia.org/wiki/Peter_Kropotkin</p>
<p>Edit Page: http://en.wikipedia.org/w/index.php?title=[article-name]&amp;action=edit</p>
<p>Example: http://en.wikipedia.org/w/index.php?title=Peter_Kropotkin&amp;action=edit</p>
<p>Every header souce code of an Edit-Page has exactly the same format - first there are 3.663 static bytes - then the start of the form-tag, which is static again, but contains the article-name - which could have different length:</p>
<div class="html" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;<br/>
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;<br/>
&nbsp; &lt;head&gt;<br/>
&nbsp; &nbsp; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;<br/>
&nbsp; &nbsp; &lt;meta name=&quot;robots&quot; content=&quot;noindex,nofollow&quot; /&gt;<br/>
&lt;link rel=&quot;shortcut icon&quot; href=&quot;/favicon.ico&quot; /&gt;<br/>
&lt;link rel=&quot;copyright&quot; href=&quot;http://www.gnu.org/copyleft/fdl.html&quot; /&gt;<br/>
&nbsp; &nbsp; &lt;title&gt;Editing Intermediate technology - Edit this page - Wikipedia, the free encyclopedia&lt;/title&gt;<br/>
&nbsp; &nbsp; &lt;style type=&quot;text/css&quot; media=&quot;screen,projection&quot;&gt;/*&lt;![CDATA[*/ @import &quot;/skins-1.5/monobook/main.css?1&quot;; /*]]&gt;*/&lt;/style&gt;<br/>
&nbsp; &nbsp; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;print&quot; href=&quot;/skins-1.5/common/commonPrint.css&quot; /&gt;<br/>
<br/>
&nbsp; &nbsp; &lt;!--[if lt IE 5.5000]&gt;&lt;style type=&quot;text/css&quot;&gt;@import &quot;/skins-1.5/monobook/IE50Fixes.css&quot;;&lt;/style&gt;&lt;![endif]--&gt;<br/>
&nbsp; &nbsp; &lt;!--[if IE 5.5000]&gt;&lt;style type=&quot;text/css&quot;&gt;@import &quot;/skins-1.5/monobook/IE55Fixes.css&quot;;&lt;/style&gt;&lt;![endif]--&gt;<br/>
&nbsp; &nbsp; &lt;!--[if gte IE 6]&gt;&lt;style type=&quot;text/css&quot;&gt;@import &quot;/skins-1.5/monobook/IE60Fixes.css&quot;;&lt;/style&gt;&lt;![endif]--&gt;<br/>
&nbsp; &nbsp; &lt;!--[if IE]&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/skins-1.5/common/IEFixes.js&quot;&gt;&lt;/script&gt;<br/>
&nbsp; &nbsp; &lt;meta http-equiv=&quot;imagetoolbar&quot; content=&quot;no&quot; /&gt;&lt;![endif]--&gt;<br/>
&nbsp; &nbsp; &lt;script type=&quot;text/javascript&quot; src=&quot;/w/index.php?title=-&amp;action=raw&amp;gen=js&quot;&gt;&lt;/script&gt; &nbsp; &nbsp;&lt;script type=&quot;text/javascript&quot; src=&quot;/skins-1.5/common/wikibits.js&quot;&gt;&lt;/script&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;style type=&quot;text/css&quot;&gt;/*&lt;![CDATA[*/<br/>
@import &quot;/w/index.php?title=MediaWiki:Common.css&amp;action=raw&amp;ctype=text/css&amp;smaxage=2678400&quot;;<br/>
@import &quot;/w/index.php?title=MediaWiki:Monobook.css&amp;action=raw&amp;ctype=text/css&amp;smaxage=2678400&quot;;<br/>
@import &quot;/w/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=2678400&quot;;<br/>
/*]]&gt;*/&lt;/style&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/head&gt;<br/>
<br/>
&nbsp; &lt;body &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; class=&quot;ns-0&quot;&gt;<br/>
&nbsp; &nbsp; &lt;div id=&quot;globalWrapper&quot;&gt;<br/>
&nbsp; &nbsp; &nbsp; &lt;div id=&quot;column-content&quot;&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;div id=&quot;content&quot;&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a name=&quot;top&quot; id=&quot;top&quot;&gt;&lt;/a&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h1 class=&quot;firstHeading&quot;&gt;Editing Intermediate technology&lt;/h1&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div id=&quot;bodyContent&quot;&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h3 id=&quot;siteSub&quot;&gt;From Wikipedia, the free encyclopedia.&lt;/h3&gt;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div id=&quot;contentSub&quot;&gt;&lt;/div&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div id=&quot;jump-to-nav&quot;&gt;Jump to: &lt;a href=&quot;#column-one&quot;&gt;navigation&lt;/a&gt;, &lt;a href=&quot;#searchput&quot;&gt;search&lt;/a&gt;&lt;/div&gt;&nbsp; &nbsp; &nbsp; &lt;!-- start content --&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;script type='text/javascript'&gt;<br/>
/*&lt;![CDATA[*/<br/>
document.writeln(&quot;&lt;div id='toolbar'&gt;&quot;);<br/>
addButton('/skins-1.5/common/images/button_bold.png','Bold text','\'\'\'','\'\'\'','Bold text');<br/>
addButton('/skins-1.5/common/images/button_italic.png','Italic text','\'\'','\'\'','Italic text');<br/>
addButton('/skins-1.5/common/images/button_link.png','Internal link','[[',']]','Link title');<br/>
addButton('/skins-1.5/common/images/button_extlink.png','External link (remember http:// prefix)','[',']','http://www.example.com link title');<br/>
addButton('/skins-1.5/common/images/button_headline.png','Level 2 headline','\n== ',' ==\n','Headline text');<br/>
addButton('/skins-1.5/common/images/button_image.png','Embedded image','[[Image:',']]','Example.jpg');<br/>
addButton('/skins-1.5/common/images/button_media.png','Media file link','[[Media:',']]','Example.ogg');<br/>
addButton('/skins-1.5/common/images/button_math.png','Mathematical formula (LaTeX)','\&lt;math\&gt;','\&lt;/math\&gt;','Insert formula here');<br/>
addButton('/skins-1.5/common/images/button_nowiki.png','Ignore wiki formatting','\&lt;nowiki\&gt;','\&lt;/nowiki\&gt;','Insert non-formatted text here');<br/>
addButton('/skins-1.5/common/images/button_sig.png','Your signature with timestamp','--~~~~','','');<br/>
addButton('/skins-1.5/common/images/button_hr.png','Horizontal line (use sparingly)','\n----\n','','');<br/>
document.writeln(&quot;&lt;/div&gt;&quot;);<br/>
/*]]&gt;*/<br/>
&lt;/script&gt;<br/>
&lt;form id=&quot;editform&quot; name=&quot;editform&quot; method=&quot;post&quot; action=&quot;/w/index.php?title=Peter_Kropotkin&amp;action=submit&quot;<br/>
enctype=&quot;multipart/form-data&quot;&gt;<br/>
<br/>
&lt;textarea tabindex='1' accesskey=&quot;,&quot; name=&quot;wpTextbox1&quot; id=&quot;wpTextbox1&quot; rows='25'<br/>
cols='80' &gt;<br/>
&nbsp;</div>
<p>Next comes the whole text of the article in plain text containing wikipedia commands (explained later), and some more html and javascript code. Most of the code is unimportant for the idea, beside of these lines:</p>
<div class="html" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&lt;input tabindex='5' id='wpSave' type='submit' value=&quot;Save page&quot; name=&quot;wpSave&quot; accesskey=&quot;s&quot; title=&quot;Save your changes [alt-s]&quot;/&gt;<br/>
&nbsp;</div>
<p>By clicking this buttom, you can save the text you have written in the textarea-tag - it is submitted to "http:/en.wikipedia.org/w/index.php?title=Peter_Kropotkin&amp;action=submit". The PHP script on the server rewrites the html-page then (by using databases or something like that I guess) and everything is done. That's how it <strong>should</strong> work.</p>
<h2><a name="c2"></a>The idea</h2>
<p>Everything a user can do, a code also can do. That means, we can change a wikipedia article by a computer code automatically.</p>
<p>First of all, we have to download a edit-page (for example with 'URLDownloadToFile' API).</p>
<p>Then we have to edit the downloaded file. We want to change the text in the textarea-tag - and what is most important: We have to do something that automatically submits the form. About the first thing later (changing the text); how can we submit the form by itself? We have to include an "onload" to the body:</p>
<div class="html" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&lt;body ONLOAD=&quot;window.setTimeout('document.editform.submit()', 1 );&quot;&gt;<br/>
&nbsp;</div>
<p>This body-tag submits the "editform" (see above in the Header of wikipedia) automatically after 1 millisecond. Theoretically we would just need the form-part now, but when we just use the form, wikipedia recognizes that something smells fishy, and gives following page: "Someone else has changed this page since you started editing it." Well, we do not want that, so just let's use the original page.</p>
<p>Now something about the wikipedia-commands, and how to use them, and some other secrets. The idea is to change 100s of pages at wikipedia (what we could do later). How do we get 100s of pages? The main idea of wikipedia seems to be connected information. Therefore inside the edit-form we can use the command "[[...]]" for making a internal link to another wikipedia article.</p>
<p>We could search in the textarea for any [[...]] and download the next page. An example:</p>
<pre>
Prince '''Peter Alexeevich Kropotkin''' (In [[Russian language|Russian]] Петр Алексеевич Кропоткин)
([[December 9]], [[1842]] - [[February 8]], [[1921]]) was one of [[Russia]]'s foremost [[anarchism|anarchist]]s
and one of the first advocates of what he called "[[anarchist communism]]"
</pre>
<p>In this shourt sentence we have found 8 more links to wikipedia-articles. All we have to do is to replace all spaces (" ") to underlines ("_") and copy the part before a potential "|" to the edit-page URL, and we have the direct link to all 8 articles:</p>
<ul>
<li>http://en.wikipedia.org/w/index.php?title=Russian_language&amp;action=edit</li>
<li>http://en.wikipedia.org/w/index.php?title=December_9&amp;action=edit</li>
<li>http://en.wikipedia.org/w/index.php?title=1842&amp;action=edit</li>
<li>http://en.wikipedia.org/w/index.php?title=February 8&amp;action=edit</li>
<li>http://en.wikipedia.org/w/index.php?title=1921&amp;action=edit</li>
<li>http://en.wikipedia.org/w/index.php?title=Russia&amp;action=edit</li>
<li>http://en.wikipedia.org/w/index.php?title=anarchism&amp;action=edit</li>
<li>http://en.wikipedia.org/w/index.php?title=anarchist_communism&amp;action=edit</li>
</ul>
<p>A good page for starting a search for internal link is the page of "featured articles". (http://en.wikipedia.org/wiki/Wikipedia:Featured_articles). There we could find a lot of very long articles, which are often very good connected to other articles - and have many external links in it.</p>
<p>Another way to find new articles is the wikipedia-feature called "Random article". Downloading "http://en.wikipedia.org/wiki/Special:Random", wikipedia returns a random article. First we have to get the name of the article (static place in the html-source) and insert the name into the edit-page URL.</p>
<p>Well, now we know how to auto-submit text and how to find articles. What is missing is the way how to use it.</p>
<p><strong>1: The dump way - destruction</strong></p>
<p>It would be possible to replace all text in the textarea with nonsense. This would be of course worst case, and real destruction. Hope this never comes true!</p>
<p><strong>2: Political messages</strong></p>
<p>Of course, beside of nonsense, you could also spread real messages (like commenting on GWB's dump behaviour - whatever) - the good thing: As wikipedia is very popular, a lot of people will read your message. You can change something!</p>
<p><strong>3: Usage for malware</strong></p>
<p>I've mainy written and discovered the idea because this could also be used in malware. Wikipedia also uses external links. The syntax for such links:</p>
<pre>
   [URL text]
   [http://www.spth.de.vu/ Second Part To Hell]
</pre>
<p>Imagine you have a webserver (or in best case: a worm installs a webserver on the host's computer), you could search for all external links in the textarea-tag - and replace the URL:</p>
<pre>
[http://www.blackcrayon.com/people/kropotkin/ BlackCrayon.com: People: Peter Kropotkin]
</pre>
<p>And after rewriting it becomes the following text:</p>
<pre>
[http://213.239.195.143/worm.exe BlackCrayon.com: People: Peter Kropotkin]
</pre>
<p>Most people trust wikipedia-links (yes, it is serios) - and I think this could be a good way for spreading.</p>
<h2><a name="c3"></a>Last words</h2>
<p>Wikipedia is a great environment for information, which means that many people view and trust it. This is a perfect victim for new kind of viruses. The only way to prevent would be registered-only entrys or pictures with codes before every edit. But this would lead wikipedia to become a more closed environment than now.</p>
<p>PS: We need new heros! Read this: http://vx.netlux.org/29a/29a-6/29a-6.111</p>
[<a style="" href="/lib/?lang=EN&amp;index=WO#vsp34">Back to index</a>] [<a href="/lib/vsp34.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vsp34">de</a><a href="/lib/index.php?lang=en&amp;id=vsp34">en</a><a href="/lib/index.php?lang=es&amp;id=vsp34">es</a><a href="/lib/index.php?lang=it&amp;id=vsp34">it</a><a href="/lib/index.php?lang=fr&amp;id=vsp34">fr</a><a href="/lib/index.php?lang=pl&amp;id=vsp34">pl</a><a href="/lib/index.php?lang=ru&amp;id=vsp34">ru</a><a href="/lib/index.php?lang=ua&amp;id=vsp34">ua</a></div>
</body>
</html>
