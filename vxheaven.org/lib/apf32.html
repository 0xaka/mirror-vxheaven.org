<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Peter Ferrie 'Something smells fishy' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Peter Ferrie"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Ferrie, Peter,Something smells fishy, platform, systems, multi, msil, mono, unix, windows, impanate, inside, exists, server, smtp, infector, running, virus"/>
<meta name="Description" content="Multi-platform malware is nothing new. In 1999 we saw the W32/W97M infector Coke and W32/HLP infectors SK and Babylonia. In 2000 we saw W32/HLP infectors Dream and Pluma; in 2001 we saw W32/Linux infector Peelf, followed by Simile in 2002 and Bi in 2006. In 2003 and 2004 we saw W32/W64 infectors MSIL/Impanate and Chiton. Three new multi-platform scripting viruses were seen in 2005 (see VB, November 2005, p.4) â and of course, there was the Morris worm in 1988."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"4a194c460b41a48c051b1e3cf39fde0358f8ecb3-1498757174-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/apf32.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Something smells fishy</h1><p><a href="/lib/?lang=en&amp;author=Ferrie%2C%20Peter">Peter Ferrie</a><br/> <em>Virus Bulletin, November 2007, pp. 7</em><br/> <em>ISSN 0956-9979</em><br/> <em>November 2007</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/apf32.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Something%20smells%20fishy.pdf">Download</a> PDF (38.54Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=AN#apf32">Back to index</a>] [<a href="/lib/apf32.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
Peter Ferrie<br/>
Symantec, USA
</address>
<p>Multi-platform malware is nothing new. In 1999 we saw the W32/W97M infector Coke and W32/HLP infectors SK and Babylonia. In 2000 we saw W32/HLP infectors Dream and Pluma; in 2001 we saw W32/Linux infector Peelf, followed by Simile in 2002 and Bi in 2006. In 2003 and 2004 we saw W32/W64 infectors MSIL/Impanate and Chiton. Three new multi-platform scripting viruses were seen in 2005 (see <em>VB</em>, November 2005, p.4) â and of course, there was the Morris worm in 1988.</p>
<p>These points are apparently lost on Paul Sebastian Ziegler, the author of MSIL/Yakizake. The virus author wanted to call his virus âAkikazeâ(Japanese for âAutumn windâ), but I went with the Japanese word for grilled salmon. The virus author claims that âvery few implementations of multi-platform malware exist up until nowâ(despite the dozen that Iâve just listed), so he went ahead and wrote a âmulti-platformâ virus and presented it at the DEFCON 15 conference.</p>
<h2>Multi-what?</h2>
<p>Itâs unclear why Mr Ziegler thinks that his virus is multi-platform, because the platform is the environment in which the application runs. Itâs not the CPU on which it is running, because it needs to interact with other hardware to survive. Itâs not the operating system, either, if the environment is a virtual machine of some kind, or the virus exists outside of the operating system itself (for example, a boot sector virus).</p>
<p>In this case, the virus runs on a particular platform that has multiple implementations â which include <em>Microsoft.NET Framework, Novell Mono</em>, and <em>DotGNU Portable.NET</em>. The platform is a hardware-independent virtual machine. The platform has been ported to several CPU architectures, but thatâs irrelevant, and since itâs hardware-independent, the applications running inside it canât see the CPU anyway. So itâs really just the one platform. The virus is aware of the operating system, but thatâs also irrelevant. Itâs still just the one platform.</p>
<p>There can be exceptions, of course, such as MSIL/Impanate (see <em>VB</em>, November 2004, p.6). Impanate is a file infector that understands both the 32-bit and 64-bit MSIL file formats. Itâs an MSIL virus, so itâs not multi-platform, but it is multi-platform-<em>aware</em>. Yakizake is neither of these things.</p>
<h2>The virus</h2>
<p>The virus begins by looking for the <em>Thunderbird</em> address book. There is code to deal with Unix systems, <em>Macintosh</em> systems, and <em>Windows</em> systems, however due to a bug, only the Unix and <em>Windows</em> code works. The bug is that the code to check for the <em>Macintosh</em> system is identical to the code to check for all other Unix systems. As a result, the <em>Macintosh</em> code can never be reached. This means that the virus cannot replicate from <em>Macintosh</em> systems.</p>
<p>In the case of <em>Windows</em> systems, the virus will attempt to terminate all instances of the <em>Thunderbird</em> executable, in order to gain control over the address book.</p>
<p>The virus creates a list of all addresses that it can find. The first version of the virus accepts addresses in â*@*.*â format, where â*â can be any character. The second version of the virus restricts this to one or more case-insensitive alphanumeric characters before and after the <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="07c4a5c587c59f47c4a5c587c59e">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>, and no longer checks for the â.â character.</p>
<p>The virus also looks inside âprefs.jsâ for the SMTP server information, and inside âsignons.txtâ for the SMTP server password.</p>
<p>The virus creates different email messages, depending on certain characteristics. If the virus is sending from a German system to a German user, the subject will be âProgrammierungâ and the message will be in German (an almost exact translation of the English message), otherwise the subject will be âProgrammingâ and the message will be in English. The virus chooses an âadvancedâ message body if it is running on a Unix system, and the string â/gccâ exists in %path% or if it is running on a non-Unix system, and âVisual Studioâ exists in the %ProgramFiles% directory.</p>
<p>The âadvancedâ message body is:</p>
<pre>
Hi,
I wrote this program using a new approach. Please
tell me what you think of it.
</pre>
<p>The âaverageâ message body is:</p>
<pre>
Hi,
I have recently started to try out programming!
This is one of my first programms. What do you think
of it?
</pre>
<p>On Unix systems, both messages continue with:</p>
<pre>
If the programm should not work instantly on your
non-windows-system you probably need to execute it
using mono. (mono-project.com)
</pre>
<p>After constructing the message, the virus sends it to each recipient in turn, using the host SMTP server and credentials, with the virus executable as an attachment. When the mailing is finished, the virus exits. There is no payload.</p>
<h2>Dumb and dumber</h2>
<p>To create a virus because one did not exist before is just dumb. To incorrectly call it multi-platform is even dumber.</p>
 
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=apf32">de</a><a href="/lib/index.php?lang=en&amp;id=apf32">en</a><a href="/lib/index.php?lang=es&amp;id=apf32">es</a><a href="/lib/index.php?lang=it&amp;id=apf32">it</a><a href="/lib/index.php?lang=fr&amp;id=apf32">fr</a><a href="/lib/index.php?lang=pl&amp;id=apf32">pl</a><a href="/lib/index.php?lang=ru&amp;id=apf32">ru</a><a href="/lib/index.php?lang=ua&amp;id=apf32">ua</a></div>
</body>
</html>
