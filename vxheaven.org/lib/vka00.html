<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Kalkin/EViL 'A few ideas for viruses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Kalkin/EViL"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Kalkin/EViL,few ideas for viruses, anti, part, viruses, program, pentium, infection, disk, display, parts, demo, simulating, speaker, procedure, intro, copy"/>
<meta name="Description" content="These are difficult times for us, virus writers. No, I don't mean the cops, society or the press. I mean the process of writing a virus. Yes, there are tons of materials about this subject and quite some people who can help, but that's usually by a technical problems. What if you want to do something radically new? It's actually not so easy coz everything has already been done: polymorphic macroviruses, access infection, LINUX-viruses. You can realize some parts of the virus in a never-seen-before way, but these parts are mainly only some solutions to some x technical problems. But you want to do something new and interesting, something like the spying virus from CodeBreakers or the payload of CIH. Maybe this article will help you."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"778945aa7c6a5e995a5b90ff00aba58467227cb6-1498756257-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vka00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>A few ideas for viruses</h1><p><a href="/lib/?lang=en&amp;author=Kalkin%2FEViL"> Kalkin/EViL</a><br/> <em><a href="/vx.php?fid=177#f177">Coderz [1]</a></em><br/> <em>June 2000</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vka00.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=VT#vka00">Back to index</a>] [<a href="/lib/vka00.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c0">.LNK and/or .PIF infection</a></li>
<li><a href="#c1">Alias "infection"</a></li>
<li><a href="#c2">Name changing</a></li>
<li><a href="#c3">Infection of format programs</a></li>
<li><a href="#c4">Intel Pentium Pro fucking</a></li>
<li><a href="#c5">"Collection" viruses</a></li>
<li><a href="#c6">"Part-upgrading" viruses</a></li>
<li><a href="#c7">Quotating viruses</a></li>
<li><a href="#c8">Intro/demo viruses</a></li>
<li><a href="#c9">Simulating anti anti-virus viruses</a></li>
<li><a href="#ca">Simulating viruses</a></li>
<li><a href="#cb">"Expensive" viruses</a></li>
<li><a href="#cc">Destroying the PC-speaker</a></li>
</ul>
<p>These are difficult times for us, virus writers. No, I don't mean the cops, society or the press. I mean the process of writing a virus. Yes, there are tons of materials about this subject and quite some people who can help, but that's usually by a technical problems. What if you want to do something radically new? It's actually not so easy coz everything has already been done: polymorphic macroviruses, <strong>access</strong> infection, LINUX-viruses. You can realize some parts of the virus in a never-seen-before way, but these parts are mainly only some solutions to some x technical problems. But you want to do something <strong>new</strong> and <strong>interesting</strong>, something like the spying virus from CodeBreakers or the payload of CIH. Maybe this article will help you.</p>
<h2><a name="c0"></a>.LNK and/or .PIF infection</h2>
<p>Maybe this has already been done, but I haven't heard about it (on the other hand, I'm not too informed about what goes on in the scene). Anyway, if it's so then the credit goes to the one who had this idea.</p>
<p>Like you all know .LNKs are small link files, so called shortcuts, that were presented with Windows 95 (in Microsoft's OS world) and should eliminate the need to copy one program into several folders. .PIFs are basically the same, just they also contain usefull loading information and are for DOS programs. Both formats contain the path of the original program. It wouldn't be hard to replace this path with the path to our infected file, which would execute after it's actions the real program. This would be like some kind of companion virus. It would be even better, coz how many AV programs check for changes in .LNK/.PIF files? Another plus is that this infecting method basically works on every OS where are .LNKs (LINUX for example). The only problem is that a virus which uses just this method of infecting won't spread to any other computer (it will "travel" only if somebody for some x reason copys our file to another PC). But this method can be used to increase the change of executing the virus, especially in the case of runtime viruses.</p>
<h2><a name="c1"></a>Alias "infection"</h2>
<p>This idea is based on the previous one and works on DOS (under 4DOS and NDOS) and *NIX systems (I think). A virus could set some aliases to itself and after infecting some files execute the original program.</p>
<h2><a name="c2"></a>Name changing</h2>
<p>What if a DOS virus hooks INT 21h, saves and then changes the name (set by exec, found by findfirstfile) to the name of an infected file (in memory)? The infected file would be executed, copied to disk, included in a ZIP archive. If the proper code is included then this viralized item wouldn'd be opend for editing (the real one would). The same could do a WIN virus. And this method is better for spreading than the above two.</p>
<h2><a name="c3"></a>Infection of format programs</h2>
<p>This idea was originally by MiKE The Hacker/TPT Gang and describes a hybrid virus, that infects formatting programs and modifies them so that they put the same virus on the bootsector of formatted disk. This would be better then just a bootsector-infector, coz you can't get rid of the virus by re-formatting the disk (atleast with this formatter). Reboot won't help eighter. This idea can be enhanced: infecting of CD writing programs, so that an AUTORUN.INF and an infected file would be written to CD. It should be a little bit easier (no need for a hybrid virus) and also better, coz there's no way you can get rid of the virus on CD (unless you're burning CD-RWs). Disadvanages: not too few formatting/CD-burning programs exist.</p>
<h2><a name="c4"></a>Intel Pentium Pro fucking</h2>
<p>I came to this idea when I was surfing through Ralf Browns Interrupt List. There's written, that by using interrupt 15h and seting AX to D042h it's possible to install a microcode patch into the Pentium Pro processor. I haven't checked this and have no idea how much can the patch effect the CPU, so I don't know if the proper code will really fuck the processor or will it do nothing. It's too bad that there aren't so many Pentium Pros around, coz there seems to be CIH potetial.</p>
<h2><a name="c5"></a>"Collection" viruses</h2>
<p>This idea was inspired by GriYo/29A's SIMBIOSIS project. If you don't know what it is then: it outputted a polymorphing virus on an Internet worm that contained SMTP engine. A so called collection-virus is a virus (or worm) that contains several (let's say 5) viruses which will be released in a random order.</p>
<h2><a name="c6"></a>"Part-upgrading" viruses</h2>
<p>Those viruses would have a "serial number" about every part of itself: the procedure of finding files, polymorphing engine, infecting part. When now such a virus would "meet" another part-upgrading-virus, it would check all serial numbers and if some of them are newer than it's own, it would copy the updated procedure to itself. But when it finds a part that it doesn't have then the virus would copy the part to itself and add a call or jump to it. So basically those viruses expand themselves. A direct action COM infector could for example add to itself parts to go TSR and infect EXEs.</p>
<h2><a name="c7"></a>Quotating viruses</h2>
<p>It's a lame and not new idea. Such a virus would as payload display quotations of some famous person. For example Sokrates's. The good thing is that there are MANY people who have said something (I never said it should be something smart or meaningfull).</p>
<h2><a name="c8"></a>Intro/demo viruses</h2>
<p>I don't mean here product demos, but graphics demos like they are presented on demo-parties and compos (check http://www.hornet.org to get the picture). Intro-viruses would play such videoeffects as payload. Advantages: usually small size, nice, different (what do you think, will people remember better a lame textmode "Infecto-ViruZ" in black and white or a "IntroVirus" in 24 bit colours companioned by breath-taking-beautiful moving clouds?)</p>
<h2><a name="c9"></a>Simulating anti anti-virus viruses</h2>
<p>Most viruses today have retro abillities, but I'm talking about a virus, that is specially coded to destroy anti-virus programs. It would turn off resident AV monitors, install troyans in anti-viruses (*.AVC and TBSCAN.DEF infection). It would also overwrite part of AV programs by installing itself in them and then simulate that the AV scans. There are several viruses that patched the "File system" status on TbScan's output to hide the fact that it suddenly used DOS services to read the disk. A SAAV virus would for example execute the graphics procedure to display message "Scanning for known viruses in memory" by F-Prot/DOS but then just wait for some time. It would use the necessary procedure to bring up the scanning window, display filenames and instead of checking infect them. Or for example display "Checking partition table" by ThunderByte Partition (created by TbUtil) and check nothing. It could be like the real AIDS, which doesn't kill, it just destroys the immunity system and makes the way free for other deseases. It doesn't take much code to do so, just some small patches. The problem is how the virus finds what to patch coz AV companies would change the inner structure of the program with every new version. At this moment the fact, that most AV programs don't let to encrypt/compress themselves (coz of the CRC check), comes real handy.</p>
<h2><a name="ca"></a>Simulating viruses</h2>
<p>Based on the above idea these viruses would install themselves in some specific programs and then simulate. One example could be PGP (so that the signature is always GOOD, and goodbye to trustfull software). It could also be one virus that patches several products.</p>
<h2><a name="cb"></a>"Expensive" viruses</h2>
<p>It's actually a image of what happened here in Estonia: quite some Internet users recived a file called Estonia.Exe This was a SFX ZIP and contained a client program for some sex-server. Anyway, after executing the program did also some other things and as a result the PC began to connect to Net through a Malaysian (if I remember correctly) server, which had quite high prices. Nobody knew it and everyone was REALLY surprised when in the end of the month the telephone bill was HUGE. There were talks that this was a virus, but most (including specialists) don't think so. It seems that it was just a troyan. But, this idea can be used in viruses (a good way to compromize the lamest ISP near you).</p>
<h2><a name="cc"></a>Destroying the PC-speaker</h2>
<p>As last a destructive payload from KUTT/TPT Gang. The idea is based on the fact that speakers may get damaged when the music is too loud. KUTT though that it would be interesting if a virus did that to PC-speaker: generate a high and loud sound and play it quite some time. It's probably technically impossible to realize, but who knows? An enhanced version of this idea is to damage the speakers that are connected to the sound card. This should actually be more realistic, coz usually the hardware of a sound card is capable of that and the speakers aren't made for this situation.</p>
[<a style="" href="/lib/?lang=EN&amp;index=VT#vka00">Back to index</a>] [<a href="/lib/vka00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vka00">de</a><a href="/lib/index.php?lang=en&amp;id=vka00">en</a><a href="/lib/index.php?lang=es&amp;id=vka00">es</a><a href="/lib/index.php?lang=it&amp;id=vka00">it</a><a href="/lib/index.php?lang=fr&amp;id=vka00">fr</a><a href="/lib/index.php?lang=pl&amp;id=vka00">pl</a><a href="/lib/index.php?lang=ru&amp;id=vka00">ru</a><a href="/lib/index.php?lang=ua&amp;id=vka00">ua</a></div>
</body>
</html>
