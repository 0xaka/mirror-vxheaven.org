<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Jim Bates 'Mark A. Washburn - Walking the Research Tightrope' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Jim Bates"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Bates, Jim,Mark A. Washburn - Walking the Research Tightrope, files, viruses, infected, file, bytes, washburn, computer, profile, directory, bogus, produced, scanning, threat, undetectable, research"/>
<meta name="Description" content="The business of taking MS-DOS computer viruses apart so that they can be analysed and classified is done solely to provide information that will enable rapid identification and effective protection for computer users likely to be at risk from the malicious targeting of such code. Researchers worldwide are becoming far more accomplished in their dissections and analyses but all of them are still severely overworked trying to keep pace with new viruses as they are discovered."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"f4e9323656fc0317bd58894e9271c1a7149eb163-1498756741-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/ajb02.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Mark A. Washburn - Walking the Research Tightrope</h1><p><a href="/lib/?lang=en&amp;author=Bates%2C%20Jim">Jim Bates</a><br/> <em><a href="/vx.php?fid=1680#f1680">Virus Bulletin, April 1991</a>, pp. 19-20</em><br/> <em>ISSN 0956-9979</em><br/> <em>April 1991</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/ajb02.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=HI#ajb02">Back to index</a>] [<a href="/lib/ajb02.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<p><strong>SPECIAL FEATURE</strong></p>
<ul>
<li><a href="#c1">The Virus Writers’ Fallacy</a></li>
<li><a href="#c2">A Bogus Researcher</a></li>
<li><a href="#c3">V2P6 - The ‘‘Patternless Monster’’</a></li>
<li><a href="#c4">Self-Modifying Encryption</a></li>
<li><a href="#c5">Who Has Benefited?</a></li>
<li><a href="#c6">Virus Attribute Summary</a></li>
<li><a href="#c7">Washburn’s Legacy - The Threat of Randomised Code</a></li>
</ul>
<p>The business of taking MS-DOS computer viruses apart so that they can be analysed and classified is done solely to provide information that will enable rapid identification and effective protection for computer users likely to be at risk from the malicious targeting of such code. Researchers worldwide are becoming far more accomplished in their dissections and analyses but all of them are still severely overworked trying to keep pace with new viruses as they are discovered.</p>
<h2><a name="c1"></a>The Virus Writers’ Fallacy</h2>
<p>The whole research effort operates under the one over-riding premise that there is no such thing as a computer virus which cannot be taken apart. Since virus code (by definition) must be totally mobile, it must also be completely self-contained - including such tricks as self-modifying code, pre-fetch queue manipulation, anti-debugging code and direct hardware access.</p>
<p>The particular collection of selected “tricks” used, together with their respective order and location within the program provides a recognisably unique “profile” by which a virus may be identified and dealt with. Virus writers recognised this fact some time ago and in some cases have gone to extreme lengths to hide the details of this “profile” from prying eyes by introducing various layers of encryption and randomisation of their code, even varying these from infection to infection.</p>
<p><strong>The fact that virus code <u>must</u> be self-contained and therefore <u>must</u> be capable of decrypting itself before execution, seems to have escaped the restricted ‘intellects’ involved in virus production.</strong></p>
<p>Nevertheless, some of them still persist in attempting the impossible - a truly undetectable virus which will escape detection by virtue of its anonymity.</p>
<h2><a name="c2"></a>A Bogus Researcher</h2>
<p>One of the most stubborn of these individuals is known to researchers since he operates under the bogus guise of being a virus “researcher” and produces live virus code which contains his name and address!</p>
<p>I refer to Mr. Mark Washburn of the United States, who has produced V2P1 (1260) V2P2 and latterly the V2P6 virus.</p>
<p>That this man is allowed to write and distribute virus code with impunity is symptomatic of just how badly legislation against computer crime has fallen behind in various countries. By no stretch of the imagination can his “work” be classified as virus research since his code has produced nothing of which responsible researchers were not already aware.</p>
<p>What he <em>has</em> achieved is to distribute virus code of a most dangerous kind, through channels which lack any security and in such a way that there is no doubt that samples of his code are (or soon will be) in the hands of virus writers who will undoubtedly use his virus vehicles to deliver destructive trigger routines.</p>
<p>Reports of virus analyses produced for public information must necessarily be carefully examined before publication to ensure that they do not provide technical details which could be of use to virus writers.</p>
<p>(Editor’s note: the encryption methods used by V2P6 will not be analysed in detail here, but a discussion of the simple structure and infection method of this virus follows and will prove informative. Anti-virus software developers and bonafide researchers requiring information on the algorithmic methods to detect V2P6 should contact <em>VB, Bates Associates,</em> UK (0533 883490) or Fridrik Skulason at the <em>University of Iceland</em> (+35 4 1 694749).</p>
<h2><a name="c3"></a>V2P6 - The ‘‘Patternless Monster’’</h2>
<p>In the case of the V2P6 virus, the technical details are quite sparse and completely innocuous. In the original sample there is no trigger routine, the virus does <strong>not</strong> become memory-resident and only COM files are effected. The infective length is between 1801 and 2350 bytes and no attempt is made to hide the increase in length from normal DOS operations.</p>
<p>A single COM file is infected each time the virus code is executed (the ‘one-shot’ replication method), first in the current directory, and then by searching along the designated PATH as specified within the machine environment area.</p>
<p>Infected files are marked with the ubiquitous 62 second marker in the date/time field of the file’s directory entry and this is used as a recognition flag by the virus itself. There are several bugs within the code, some of which affect how the virus selects files to infect. For example, it is obvious that file lengths of 10 and 63746 respectively were intended to be minimum and maximum limits but careless coding has resulted in the virus infecting all COM files <em>except</em> these two file sizes.</p>
<p>The internal V2P6 code is unremarkable. From a researcher’s point of view, this virus must be classified as “armoured” because as well as primary encryption (and randomisation), it contains a primitive routine which is supposedly designed to make disassembly difficult.</p>
 
<p>This is a linked INT 03H/INT 01H handler which decrypts and recrypts certain sections of the virus code “on the fly”. Such routines have already been observed in other virus code and present only a minor irritation to experienced researchers.</p>
<h2><a name="c4"></a>Self-Modifying Encryption</h2>
<p>Washburn’s main effort (as in his other viruses) has been directed at randomising the primary decryption routine in such a way as to nullify the normal pattern recognition techniques used in most virus scanners.</p>
<p>More than half of the virus code is taken up with the convoluted calculations and bitmapping gymnastics needed to generate a randomised decryptor for each infection of the virus. This renders V2P6 capable of producing hundreds of millions of possible combinations for the decryption routine. All of the viruses that Washburn has produced seem designed to impress the researcher with just how “clever” he is at producing randomised encryption/decryption routines.</p>
<p>Unfortunately for him, simple pattern recognition is only a small part of the armoury of good scanning software. His approach produces a different kind of detection profile which is paradoxically even easier to recognise than a straightforward hex pattern.</p>
<h2><a name="c5"></a>Who Has Benefited?</h2>
<p>It is therefore apparent that Washburn’s efforts have added <strong>nothing</strong> to existing knowledge about MS-DOS computer viruses other than to increase the already heavy workload of dedicated researchers around the world who must necessarily disassemble his nonsense. Continued production of such “research” viruses can only be detrimental to the research effort and his masquerade should be stopped forthwith. If he had not already demonstrated his irresponsible attitude to the virus problem, he might be better employed in helping the rest of us in a positive way by analysing existing virus programs for the general benefit of computer users everywhere.</p>
<p>As it is, there can be little doubt that eventually one of his programs (or a recognisable derivative) will appear as a vehicle for a malicious trigger routine. As will be seen, evidence is accumulating which suggests that this has already happened - the destructive Casper virus (which <em>VB</em> has obtained as a source code listing and which includes Washburn’s name, address and copyright notice!) and the anonymous Violator virus reveal an uncanny resemblance to Washburn’s V2P1 (1260) program. (Mr. Washburn denies having developed the Casper virus and claims that this is a ‘hacked’ version of V2P1. Ed.)</p>
<p>In the United Kingdom, there is a substantial body of opinion which maintains that Mr. Washburn should be held personally responsible should his code (or, indeed, modified versions of it) infect personal computers in this country.</p>
<div align="left">
<h2><a name="c6"></a>Virus Attribute Summary</h2>
<p><strong>Name:</strong> V2P6</p>
<p><strong>Origin:</strong> U.S.A. (Mark Washburn)</p>
<p>This is a non-resident, ‘one-shot’ COM file infector (including COMMAND.COM) which uses multiple encryption and randomisation. No static code exists between generations of V2P6, therefore it is not possible to extract a hexadecimal search pattern for this virus. There is no trigger routine. All COM files, except those with lengths of 10 bytes and 63746 bytes, are infected. Infected files are marked with a 62 seconds marker in the directory entry Time field; this is the virus’ self-recognition signature.</p>
</div>
<div align="left">
<h2><a name="c7"></a>Washburn’s Legacy - The Threat of Randomised Code</h2>
<blockquote>
<p>Hello, all anti-virus "researchers" who are reading this message...</p>
<p>I am glad to inform you that my friends and I are developing a new virus, that will mutate in 1 of 4,000,000,000 different ways! It will not contain any constant information, so no virus scanner could be detecting it...</p>
<p>The virus will have many other new features that will make it completely undetectable and very destructive!</p>
<p>the Dark Avenger</p>
</blockquote>
<p>This typically infantile message, purportedly from the Bulgarian virus writer calling himself ‘Dark Avenger’ was uploaded to Bulgarian BBSs in March 1991. It subsequently appeared on <em>Fidonet</em> and we are grateful to Michael Weiner, the Austrian virus researcher, for forwarding this transcript.</p>
<p>Self-modifying encryption, first identified in Washburn’s 1260 virus, is now being adopted elsewhere and the threat that this method will be employed by the Bulgarian ‘virus factory’ should be taken seriously. Virus scanning software will be somewhat impeded by the appearance of such code - the development of search algorithms for each such specimen is both painstaking and time-consuming. However, <strong>no</strong> virus will ever be ‘undetectable’ - CRC and cryptographic checksums will remain effective long after virus-scanning has ceased to be practicable. Meanwhile, researchers are confident that virus-specific detection will remain viable for the foreseeable future.</p>
</div>
 
[<a style="" href="/lib/?lang=EN&amp;index=HI#ajb02">Back to index</a>] [<a href="/lib/ajb02.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=ajb02">de</a><a href="/lib/index.php?lang=en&amp;id=ajb02">en</a><a href="/lib/index.php?lang=es&amp;id=ajb02">es</a><a href="/lib/index.php?lang=it&amp;id=ajb02">it</a><a href="/lib/index.php?lang=fr&amp;id=ajb02">fr</a><a href="/lib/index.php?lang=pl&amp;id=ajb02">pl</a><a href="/lib/index.php?lang=ru&amp;id=ajb02">ru</a><a href="/lib/index.php?lang=ua&amp;id=ajb02">ua</a></div>
</body>
</html>
