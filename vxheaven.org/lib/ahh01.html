<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Harold Highland 'A History Of Computer Viruses: Three Special Viruses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Harold Highland"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Highland, Harold,History Of Computer Viruses: Three Special Viruses, values, virus, vienna, manual, hard, batch, drive, versions, original, disk, burger, line, book, program, data"/>
<meta name="Description" content="There are several computer viruses that we have in executable form but whose existence in the business world cannot be satisfactorily confirmed."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"97fad72987306eaf8887e31555021465e54d724a-1498757848-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/ahh01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>A History Of Computer Viruses: Three Special Viruses</h1><p><a href="/lib/?lang=en&amp;author=Highland%2C%20Harold">Harold Highland</a><br/> <em>Computers and Security, Vol. 16, No. 5, pp.430-438</em><br/> <em>ISSN 0167-4048</em><br/> <em> 1997</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/ahh01.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/A%20History%20Of%20Computer%20Viruses%3A%20Three%20Special%20Viruses.pdf">Download</a> PDF (790.07Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=HI#ahh01">Back to index</a>] [<a href="/lib/ahh01.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
Harold Joseph Highland, FICS, FACM<br/>
Editor-in-Chief Emeritus
</address>
<p>There are several computer viruses that we have in executable form but whose existence in the business world cannot be satisfactorily confirmed. Among these are:</p>
<ul>
<li>the Macro virus, a spreadsheet virus that attaches itself to a data file,</li>
<li>the Vienna virus, actually two versions although only one has appeared in print, and</li>
<li>the Batch virus, written in legal DOS batch commands.</li>
</ul>
<h2>The Macro Virus</h2>
<p>In the spring of 1988, following the rash of computer virus reports - The Pakistani Brain, Lehigh's COMMAND.COM, Friday the 13th, April lst, Alameda Boot - there were persistent reports about a virus that attacked spreadsheets. At that time we were unable to confirm its existence. We decided that it was part of the mass hysteria since so many so-called virus attacks turned out to be human error and/or a bug in a program.</p>
<p>Late in the summer of 1988 we learned from two European computer security specialists that they too had reports about a computer virus that attacked spreadsheets. We had the impression that they knew more than they said. From the details given about how the virus worked, it was more than likely that one or both of these virus hunters had encountered a live version of the virus.</p>
<p>Periodically during the year we had requests from reporters and writers from the States and Europe about what we knew of this particular virus. We noted that we had no information and that we follow a policy of not acknowledging the existence of any virus unless we had a copy in our hands. Over many months we had received copies of most of the viruses rampant at the time. We were aware that any abnormality in operations was immediately considered a possible virus; a conservative approach was therefore needed.</p>
<p>Even when we received telephone calls from security specialists from large organizations making similar inquiries, we maintained our no-knowledge position.</p>
 
<p>Again in speaking with some of the specialists we felt that their questions were based on more information than they were willing to admit having.</p>
<p>We could not envision a spreadsheet virus since it appeared obvious that any virus had to attach itself to an executable program. Obviously by attaching itself, it had to alter the program size. There was the possibility that a `hole', a stack, in a program might be used to hide; this is what the Lehigh COMMAND.COM virus did. There appeared to be no way in which a computer virus could attach itself to data.</p>
<p>Early in January 1989 we received a telephone call from a systems specialist from a large multinational corporation who had experience in mainframes and microcomputers. He sought our assistance in the company's development of anti-virus protective measures. He was particularly interested in the work we were doing in virus attacks against encrypted programs and data. The request about data seemed strange.</p>
<p>After considerable evasive discussion, he admitted that his organization had heard about the possibility of a spreadsheet virus many months earlier and they did some research in this area.They had created a conceptual model of a spreadsheet virus. From the way he spoke we were certain that his centre had gone beyond the theoretical model. Later in our conversation, when he mentioned that they had found data modified during a test, we were sure that they had either written the virus or discovered it somewhere within their company.</p>
<p>With this knowledge we again contacted several of our earlier sources and were able to ask more specific questions. Undoubtedly some of those with whom we spoke felt that we too knew more than we were willing to disclose. They were therefore willing to talk more freely hoping to exchange information.</p>
<ul>
<li>The macro virus, although part of a data file, is <strong>executable code</strong>. However it undoubtedly would not be detectable with most of the conventional anti-virus products now on the market.</li>
<li>Unless it is highly sophisticated, the macro virus is easily detected by any attentive and alert user.</li>
<li>Methods of detection are currently available. They require some time overhead but security is not free and unobtrusive.</li>
<li>Good backup policy is helpful in reducing the risk but is no guarantee. Backup procedures should be enforced.</li>
</ul>
<h2>Creating a Macro Virus</h2>
<p>Because we were to speak at association meetings of internal auditors and EDP auditors in March/April of 1989, we wanted a simple spreadsheet virus to use for a demonstration during our talk. We therefore decided to create a laboratory version of this type of virus. We consulted with a number of specialists familiar with spreadsheet languages, especially one of the most popular of the packages, Lotus 123. Because of their sensitive positions they asked not to be identified. Yet at this time we should like to thank them for their invaluable assistance.</p>
<p>We maintained, more or less, a security compartmentalization policy in the writing of the laboratory virus. Some were involved only with the replication code. Others helped in preparing code for destructive action by the virus. Some worked on the `routines to erase' the macro after it had performed its task. Others worked on a module to have the virus store itself in RAM memory and/or embed itself in other locations in the system.</p>
<p>Note that a macro virus is <strong>not limited</strong> to Lotus 123. We used that language to prepare a demonstration virus only because of the specialists available to us. In can be written in any spreadsheet language. Similar techniques can be used with any program that permits a user to write his/her own macros.This not only includes spreadsheets but also database programs. One researcher with whom we spoke believed that such viruses might even be created in some of the text editors that permit the writing of macros.</p>
 
<p>An auto-execute macro in Lotus 123 is created in the same way as any other macro. It is given a special name: \0 [zero]. It is loaded automatically as soon as a file is retrieved. It is normally used to backup files or to assure the performance of certain operations when other people use the worksheet.</p>
<ul>
<li>The original macro virus developed in our laboratory was designed to alter a single value in a specific column each time the worksheet was loaded.</li>
<li>Also the percentage change was restricted within a small range and that percentage did not vary.</li>
<li>Later we added a clock-depending variable so that the percentage change could be either added or subtracted from the value being changed.</li>
</ul>
<p>The virus is a `kindergarten' type in its simplicity of action. It could easily be made more sophisticated by having it:</p>
<ul>
<li>execute only once on any given day,</li>
<li>attack any cell in the worksheet,</li>
<li>copy itself into memory or another unrelated program so that it could be activated later,</li>
<li>be variable in its percentage change and/or,</li>
<li>erase itself after a single execution.</li>
</ul>
<h2>A Simple Demonstration</h2>
<p>As the macro virus is now designed any attentive and capable user can easily spot the virus at work. The original data are shown in Table 1. The values in the first two columns are identical. The values in the remaining columns were included to provide a spreadsheet atmosphere. Only the values in the second column were attacked by this version of the virus. We kept the original data in the first column so that the change would be easily seen.</p>
<p>Running the program once a day caused data corruption. In Table 2 the values in row 1 were changed when the worksheet was called for the first time.The 4,550.00 in the original values column was altered to 4,441.76. There was a decrease of slightly more than 2 percent. A special section within the virus determined the percentage change; another module determined if the change would be negative or positive.This latter module was time dependent. Calling the worksheet before 9:05 AM or after 5:00 PM would result in a negative change.</p>
<table summary="" style="border: solid thin black;">
<tr><th colspan="5">Table 1</th><th colspan="5">Table 2</th></tr>
<tr><th>&nbsp;</th><th>Original Values</th><th>Duplicate Values</th><th>Other Data</th><th>More Data </th><th>&nbsp; </th><th>Original Values</th><th>"Virused" Values</th><th>Other Data </th><th>More Data</th></tr>
<tr><td>1</td><td>4,550.00</td><td>4,550.00</td><td>1.793.50</td><td>250.00</td><td>1</td><td><strong>4,550.00</strong></td><td><strong>4,441,76</strong></td><td>1.793.50 </td><td>250.00</td></tr>
<tr><td>2</td><td>4,500.00</td><td>4,500.00</td><td>2,613.00</td><td>300.00</td><td>2</td><td>4,500.00</td><td>4,500.00</td><td>2,613.00</td><td>300.00</td></tr>
<tr><td>3</td><td>5,120.00</td><td>5,120.00</td><td>3,750.00</td><td>500.00</td><td>3</td><td>5,120.00</td><td>5,120.00</td><td>3,750.00</td><td>500.00</td></tr>
<tr><td>4</td><td>4,600.00</td><td>4,600.00</td><td>2,850.50</td><td>180.00</td><td>4</td><td>4,600.00</td><td>4,600.00</td><td>2,850.50</td><td>180.00</td></tr>
<tr><td>5</td><td>1,100.00</td><td>1,100.00</td><td>950.00</td><td>100.00</td><td>5</td><td>1,100.00</td><td>1,100.00</td><td>950.00</td><td>100.00</td></tr>
<tr><td>6</td><td>4,650.00</td><td>4,650.00</td><td>3,850.00</td><td>550.00</td><td>6</td><td>4,650.00</td><td>4,650.00</td><td>3,850.00</td><td>550.00</td></tr>
<tr><td>7</td><td>4,450.00</td><td>4.450.00</td><td>3,900.00</td><td>550.00</td><td>7</td><td>4,450.00</td><td>4.450.00</td><td>3,900.00</td><td>550.00</td></tr>
<tr><td>8</td><td>7,500.00</td><td>7,500.00</td><td>6,500.00</td><td>750.00</td><td>8</td><td>7,500.00</td><td>7,500.00</td><td>6,500.00</td><td>750.00</td></tr>
<tr><td>9</td><td>3,750.00</td><td>3.750.00</td><td>2,700.00</td><td>210.00</td><td>9</td><td>3,750.00</td><td>3.750.00</td><td>2,700.00</td><td>210.00</td></tr>
<tr><td colspan="10" style="border-bottom: dashed thin black;">&nbsp;</td></tr>
<tr><td>10</td><td>40,220.00</td><td>40,220.00 </td><td>28,907.00</td><td>3,390.00</td><td>10</td><td>40,220.00</td><td>40,111.76</td><td>28,907.00</td><td>3,390.00</td></tr>
</table><br/>
 
<table summary="" style="border: solid thin black;">
<tr><th colspan="5">Table 3</th><th colspan="5">Table 4</th></tr>
<tr><th>&nbsp;</th><th>Original Values</th><th>"Virused" Values</th><th>Other Data</th><th>More Data</th><th>&nbsp;</th><th>Original Values</th><th>"Virused" Values</th><th>Other Data </th><th>More Data</th></tr>
<tr><td>1</td><td>4,550.00</td><td>4,441.76</td><td>1.793.50</td><td>250.00</td><td>1</td><td>4,550.00</td><td>4,441,76 </td><td>1.793.50</td><td>250.00</td></tr>
<tr><td>2</td><td><strong>4,500.00</strong></td><td><strong>4,615.79</strong></td><td>2,613.00</td><td>300.00</td><td>2</td><td>4,500.00</td><td>4,615.79</td><td>2,613.00</td><td>300.00</td></tr>
<tr><td>3</td><td>5,120.00</td><td>5,120.00</td><td>3,750.00</td><td>500.00</td><td>3</td><td><strong>5,120.00</strong></td><td><strong>5,196.60</strong></td><td>3,750.00</td><td>500.00</td></tr>
<tr><td>4</td><td>4,600.00</td><td>4,600.00</td><td>2,850.50</td><td>180.00</td><td>4</td><td>4,600.00</td><td>4,600.00 </td><td>2,850.50</td><td>180.00</td></tr>
<tr><td>5</td><td>1,100.00</td><td>1,100.00</td><td>950.00</td><td>100.00</td><td>5</td><td>1,100.00</td><td>1,100.00</td><td>950.00</td><td>100.00</td></tr>
<tr><td>6</td><td>4,650.00</td><td>4,650.00</td><td>3,850.00</td><td>550.00</td><td>6</td><td>4,650.00</td><td>4,650.00 </td><td>3,850.00</td><td>550.00</td></tr>
<tr><td>7</td><td>4,450.00</td><td>4,450.00</td><td>3,900.00</td><td>550.00</td><td>7</td><td>4,450.00</td><td>4.450.00 </td><td>3,900.00</td><td>550.00</td></tr>
<tr><td>8</td><td>7,500.00</td><td>7,500.00</td><td>6,500.00</td><td>750.00</td><td>8</td><td>7,500.00</td><td>7,500.00 </td><td>6,500.00</td><td>750.00</td></tr>
<tr><td>9</td><td>3,750.00</td><td>3.750.00</td><td>2,700.00</td><td>210.00</td><td>9</td><td>3,750.00</td><td>3.750.00 </td><td>2,700.00</td><td>210.00</td></tr>
<tr><td colspan="10" style="border-bottom: dashed thin black;">&nbsp;</td></tr>
<tr><td>10</td><td>40,220.00</td><td>40,227.55</td><td>28,907.00</td><td>3,390.00</td><td>10</td><td>40,220.00</td><td>40,304.15</td><td>28,907.00</td><td>3,390.00</td></tr>
</table><br/>
<table summary="" style="border: solid thin black;">
<tr><th colspan="5">Table 5</th><th colspan="5">Table 6</th></tr>
<tr><th>&nbsp;</th><th>Original Values</th><th>"Virused" Values</th><th>Other Data</th><th>More Data</th><th>&nbsp;</th><th>Original Values</th><th>"Virused" Values</th><th>Other Data </th><th>More Data</th></tr>
<tr><td>1</td><td>4,550.00</td><td>4,441.76</td><td>1.793.50</td><td>250.00</td><td>1</td><td>4,550.00</td><td>4,441,76</td><td>1.793.50</td><td>250.00</td></tr>
<tr><td>2</td><td>4,500.00</td><td>4,615.79</td><td>2,613.00</td><td>300.00</td><td>2</td><td>4,500.00</td><td>4,615.79</td><td>2,613.00</td><td>300.00</td></tr>
<tr><td>3</td><td>5,120.00</td><td>5,196.60</td><td>3,750.00</td><td>500.00</td><td>3</td><td>5,120.00</td><td>5,196.60</td><td>3,750.00</td><td>500.00</td></tr>
<tr><td>4</td><td>4,600.00</td><td>4,586.51</td><td>2,850.50</td><td>180.00</td><td>4</td><td>4,600.00</td><td>4,586.51</td><td>2,850.50</td><td>180.00</td></tr>
<tr><td>5</td><td>1,100.00</td><td>1,100.00</td><td>950.00</td><td>100.00</td><td>5</td><td>1,100.00</td><td>1,100.00</td><td>950.00</td><td>100.00</td></tr>
<tr><td>6</td><td><strong>4,650.00</strong></td><td><strong>4,882.74</strong></td><td>3,850.00 </td><td>550.00</td><td>6</td><td>4,650.00</td><td>4,882.74</td><td>3,850.00</td><td>550.00</td></tr>
<tr><td>7</td><td>4,450.00</td><td>4,450.00</td><td>3,900.00</td><td>550.00</td><td>7</td><td><strong>4,450.00</strong></td><td><strong>4.698.14</strong></td><td>3,900.00</td><td>550.00</td></tr>
<tr><td>8</td><td>7,500.00</td><td>7,500.00</td><td>6,500.00</td><td>750.00</td><td>8</td><td>7,500.00</td><td>7,500.00</td><td>6,500.00</td><td>750.00</td></tr>
<tr><td>9</td><td>3,750.00</td><td>3.750.00</td><td>2,700.00</td><td>210.00</td><td>9</td><td>3,750.00</td><td>3.750.00</td><td>2,700.00</td><td>210.00</td></tr>
<tr><td colspan="10" style="border-bottom: dashed thin black;">&nbsp;</td></tr>
<tr><td>10</td><td>40,220.00</td><td>40,723.39</td><td>28,907.00</td><td>3,390.00</td><td>10</td><td>40,220.00</td><td>40,771.53</td><td>28,907.00</td><td>3,390.00</td></tr>
</table>
<p>When the program was run the second day, the original value of 4,500.00 in line 2 was modified to 4,615.79, a change of about 2.5 percent as shown in Table 3.The original total of the values changed from 40,220.00 to 40,227.55, a change of about 0.01
 
percent. The increase in the second value was offset by the decrease in the changed first value.Yet the data in two cells were corrupted.</p>
<p>Table 4 shows the change that took place on the third day. The original value of 5,120.00 in line 3 was altered by the virus to 5,196.60. Of course, the total was likewise modified by the spreadsheet program.</p>
<p>By the end of the first week, the virus had made five changes in the data. Note that the value in line 5 of 1,100 had not been altered because the virus was designed to attack values within a specific range. The total of the column had been increased by 503.39 during that period.</p>
<p>When the worksheet was called the next week the original value in line 7 of 4,450.00 was altered to 4,698.14 as shown inTable 6. Had we continued using the worksheet, the test virus would not have altered any other values in the column because they are out of range. The virus code could have been written so that once it found no more data to change in the column, it would have erased itself.</p>
<p>A more universal virus could be written to attack any cell and modify it by a varying percentage. That modification could be negative or positive set not by time but by odd or even dates, day of the week or any other algorithm.</p>
<h2>How to Detect a Macro Virus</h2>
<p>Many individuals and organizations exchange templates, especially the complicated ones. Some even download such templates from bulletin boards. Again it is the case of a trusted source. However in these days of possible viruses we are unwilling to accept any disk, program, utility or programming aid even when purchased from a reputable vendor in its original sealed package.</p>
<p>Because of this virus threat it will be necessary to evaluate existing templates and particularly any new ones that might be obtained. Each worksheet will have to be examined for the macros it contains. The Advanced Edition of The Norton Utilities offers a fast way to find the range labels and macros.</p>
<p>It is best to use a test microcomputer, a two floppy disk machine. If it is not available, a hard disk computer can be used with precautions:</p>
<ul>
<li>First, a full backup of the system should be available.</li>
<li>Second, if two floppy disk drives are available on the machine, boot the system with a write-protected disk in drive A with a CONFIG.SYS file that does not include drive C, the hard disk.</li>
<li>Third, if a second floppy drive is not available, it is essential to write-protect the hard disk.</li>
<li>Fourth, after the template has been examined, the system should be immediately shut down. Do not reboot the system for about five minutes.</li>
</ul>
<p>Here is the quick and simple test method using the Norton Utilities:</p>
<ol>
<li>Make a copy of the template or worksheet to a non-bootable floppy disk and place that disk in drive B if using a two floppy disk system.</li>
<li>Place a write-protected copy of The Norton Utilities in drive A or with a hard disk, make certain that The Norton Utilities are in the path of the hard disk, C.</li>
<li>With the system at the A or C drive, enter: NU B: at the system prompt.</li>
<li>Step through the menus - "Explore disk," "Choose item," "File."</li>
<li>The template should be the only file shown in the list on the screen; press the Enter key</li>
<li>At the next menu, select "Edit/Display item." "A View of a Template" in the accompanying box contains part of the screen showing the range labels and macros used with the worksheet.</li>
</ol>
 
<pre>
			A View of a Template
Cluster 2, Sectors 12-13				File offset 0, hex 0
000D0800 03000300 0D080003 0004000D 64002000 00000000	................d.......
00000000 00000000 00000000 00000000 00000000 00000000	........................
00000000 47001900 434F554E 54000000 00000000 00000000	....G...COUNT...........
10000500 10000500 00470019 00454E44 00000000 00000000	.........G...END........
00000000 00060017 00060017 00004700 19004E45 58540000	..............G...NEXT..
00000000 00000000 00000E00 11000E00 11000047 00190054	...................G...T
45535400 00000000 00000000 0000000F 0009000F 00090000	EST.....................
47001900 5C300000 00000000 00000000 00000000 0E001000	G...\0..................
0E001000 00470019 005C5600 00000000 00000000 00000000	.....G...\V.............
000E0010 000E0010 00001800 190000FF FF0000FF FF0000FF	........................
</pre>
<p>You now have the list of macros with the template to analyze. Still using a copy of the worksheet on the disk, load Lotus 123 and retrieve the file. At this point:</p>
<ol>
<li>Examine the worksheet to ascertain if there are any hidden columns, rows or cells. If there are any, unhide them for this examination of the template; you are using a copy.</li>
<li>Find and evaluate each macro that you have on the list you obtained by using The Norton Utilities.</li>
<li>Take a printout of the entire template. It will include all of the macros.Taking a printout of the worksheet with hidden cells, columns and/or rows is not sufficient since the hidden portions will not be printed.</li>
<li>Since this copy of the template will not be used again on your system, it is not necessary to hide the cells, columns and/or rows.</li>
<li>At this stage shut off the microcomputer. With many systems it is necessary to wait about five minutes to be certain that the system is safe to use again.</li>
</ol>
<p>It should be obvious that the procedure is not complex, but it is also obvious that evaluating a macro is not ajob for an amateur or a data entry clerk. It is necessary to assign a capable individual to do this evaluation.</p>
<p>Once a worksheet has been accepted there is no guarantee that some employee might not take off on his/her own to modify a macro. Therefore, the periodic use ofThe Norton Utilities to view of the range labels and macros would enable any auditor and/or security specialist to determine whether or not anyone has tampered with the worksheet. How often the review should be made depends on backup procedures and practices used by an organization as well as the critical nature of the data stored in the template.</p>
<h2>Other Macro Viruses</h2>
<p>When we had a working macro virus we spoke with several researchers and security specialists to alert them about this type of virus. A security specialist, experienced in Dbase, called with a few days to report that he had prepared a simple virus that altered database files. He also had another version that exited from the program and executed a DOS del *.* for any floppy disk on the system.</p>
 
<p>A virus researcher with whom we spoke earlier in the year called in April 1989. He informed us about his development of a virus using the macro instructions available in a popular text editor. His macro for print instructions included perfectly legal code and erased all text files on the disk.</p>
<h2>The Vienna Virus</h2>
<p>The Vienna Virus was reportedly found in Europe late in 1987 or early in 1988. We have not been able to confirm its existence nor find anyone who would admit seeing it in the real world.</p>
<p>Some time very early in 1988 an associate from Europe sent us a copy of a disk that contained the purported vienna virus. He reported that the code came from someone associated with the Chaos Computer Club in Hamburg, Federal Republic of Germany. Because the code "did not work properly" an associate of his modified the program to get it to run. Because at that time we had no reports of the virus attacking any organization in Europe and had our hands full with the Pakastani/Brain, Lehigh and a set of Israeli viruses, we set the disk aside for detailed analysis at a future date.</p>
<p>About one month later another European friend mailed us a copy of the original German version of Ralf Burger's "<a href="/lib/arb01.html">Computer Viruses: A High-Tech Disease</a>" that had been printed by Data Becker, GmbH of Dusseldorf. In that volume there was a write-up of the Vienna virus along with a pseudo-flowchart in assembly code. Burger noted that the code came from someone in Austria [definitely not our friend]. The Burger Vienna virus supposedly resets the seconds field of a file's time entries to 62 after it has infected the program. Attacking only .COM files in a defined path, it destroys the first five bytes of the infected program. Further Burger added that both he and Bernard Fix independently analyzed the code and that Mr. Fix prepared the flowchart that appears in the book.</p>
<p>Because we had not written in assembly language for several years, we did not attempt to compile the Burger program. However from the descriptive text in the book about the virus, we were aware that the book version was not identical to the one we received earlier on a disk.</p>
<p>Later in 1988 after the Burger book had been translated into English and published by Abacus of Grand Rapids, MI, we learned from Bill Kenny that he had assembled the Vienna virus from the coding in the book. He complained that Burger had been sloppy and/or careless in his coding and that the program would not work as published. He too found it necessary to make slight changes in the code.</p>
<h2>The Kenny Version</h2>
<p>The Kenny version of the Vienna virus according to Burger attaches itself in the first three bytes of a target program, placing a JMP bump] instruction there to the virus which is placed at the end of the original program. During the infection the virus checks the current time:</p>
<ul>
<li>if the seconds are a multiple of eight, it then writes five `garbage' bytes to the start of the file. The virus destroys the file instead of infecting it.</li>
<li>if the seconds are not a multiple of eight, the first three bytes of the infected program are restored and the program is executed.</li>
<li>a technical explanation of how this version works is included below.</li>
</ul>
<h2>How the Vienna Virus Operates</h2>
<p>The Vienna virus is a .COM 6le infector, which attaches itself in the first three bytes of the target program by placing a JMP instruction there. The remainder of the virus goes at the end of the original program.</p>
<p>The virus recognition signature is the seconds in the time field of the directory entry. Seconds are stored as seconds12, with legal values of 0 to lDH [0 to 29 corresponding to 0 to 58 seconds].The virus sets a value of lFH, 31, corresponding to 62 seconds in the time field.</p>
 
<p>Target programs are searched for at the start of execution of the infected program. The search consists of looking through the current directory for an uninfected .COM program. If that fails, all directories in the PATH are searched for an uninfected .COM file. If this too fails, the virus gives up trying to infect another program.</p>
<p>During an infection, a check is made on the current time:</p>
<ul>
<li>If the seconds is a multiple of 8 [i.e. 0, 8, 16, 24, 32,40,48,56], then five `garbage' bytes are written to the start of the file. This action effectively destroys the file instead of infecting it.</li>
<li>If the seconds is not a multiple of 8, the first three bytes of the infected program are restored, and the program is executed.</li>
</ul>
<h2>Known Bugs</h2>
<ul>
<li>The virus assumes that a PATH can be found in the environment. If no PATH exists, it can do a lot of searching before it finds `random' data that matches its criteria for the end-of-path marker.</li>
<li>When entering the infected program, AX is set to 0 rather than to the drive validity information passed by DOS. This will affect programs like FORMAT.COM, which use it. - <strong>Bill Kenny</strong></li>
</ul>
<h2>Two Versions Compared</h2>
<p>Both versions of thevienna virus are .COM file infectors. Both place a `jump' instruction in the first three bytes of a target file. In both the remainder of the virus code is attached at the end of that file. Both versions of the virus attack programs in the current directory as well as any of those listed in a defined PATH.</p>
<ol>
<li>In the version that closely follows that in this article, the virus makes a check of the current time when a program is called:
<ul>
<li>If the seconds are a multiple of 8, five `garbage' bytes are written to the start of the .COM file, effectively destroying it.</li>
<li>If the seconds are not a multiple of 8, the first three bytes of an infected program are replaced and the program executed.</li>
</ul></li>
<li>In the earlier disk version we received from Europe, the virus attack depends on the time-and-date stamp of the program that is called:
<ul>
<li>If the year modulus 4 equals zero and the month is less than 8, the virus trashes the program by filling the first five bytes with garbage.</li>
<li>If the year and month tests do not meet the trashing requirement, the infected program is executed after the first three bytes are replaced.</li>
</ul></li>
</ol>
<p>Both versions are relatively the same size. One used a time modulus to set its trigger; the other the time-and-date stamp of the program.When we telephoned Europe to speak with our friend, who cannot be acknowledged, he told us that he too had two versions now. Which one was the Burger `original' he did not know. He had not saved the original copy of the `source code' and his associate no longer worked for the organization. He believed that the original code came from a photocopy of a book or possibly from <em>Datenscheuder</em>, the Hamburg Computer Chaos Club newsletter.</p>
<h2>The Batch Virus</h2>
<p>It is possible to prepare a virus in legal batch language that is executable under DOS. This Batch virus can be incorporated as part of an AUTOEXEC.BAT file so that it is executed when the floppy disk is used to boot the system. One of the versions we have copies itself to other .BAT files on the disk.When any one of these is invoked, the virus is triggered. Another version of this virus copies itself to the hard disk's AUTOEXEC.BAT file. Later when the hard disk is booted the virus is triggered.</p>
 
<p>The replication portion of the virus is the more complex portion. To write it one must be well versed in the batch control language.The version we use in our lectures contains only 300 bytes and is 11 lines long. Three of the lines include "echo off' and two "routine labels. "Thus the actual executable code contains eight lines of code or only 271 bytes.</p>
<p>Some 10 bytes of this code consists of the action code as a single line. When demonstrating this program we confine its action to a floppy disk. The action code, del *.com, deletes all the .COM programs on the floppy disk. It would be simple using either DOS's text editor, EDLIN, or any other text editor to alter this line to read "del c:*.COM" or "del c:*.EXE" so that everything on the hard disk is erased. Entering "del c:*.*" would alert the user with the "are you sure?" display on the screen.</p>
<p>The potential danger of this virus can be demonstrated easily Normally when one receives a new disk he/she obtains a directory of the disk by using the DOS DIR command. Consider the case when the following directory is shown, (see below).</p>
<p>In most cases the individual would use the README.BAT file to read the lengthy manual by entering README followed by a carriage return. This would release the batch virus immediately The virus could also have been included within an INSTALL.BAT file.</p>
<pre>
COMMAND	COM	README	BAT	MANUAL	1	MANUAL	2	MANUAL	3
MANUAL	4	MANUAL	5	MANUAL	6	MANUAL	7	MANUAL	8
VARAO	EXE	VAROA	OVL	VAARA	EXE	VAARA	OVL	ELOTON	COM
</pre>
 
[<a style="" href="/lib/?lang=EN&amp;index=HI#ahh01">Back to index</a>] [<a href="/lib/ahh01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=ahh01">de</a><a href="/lib/index.php?lang=en&amp;id=ahh01">en</a><a href="/lib/index.php?lang=es&amp;id=ahh01">es</a><a href="/lib/index.php?lang=it&amp;id=ahh01">it</a><a href="/lib/index.php?lang=fr&amp;id=ahh01">fr</a><a href="/lib/index.php?lang=pl&amp;id=ahh01">pl</a><a href="/lib/index.php?lang=ru&amp;id=ahh01">ru</a><a href="/lib/index.php?lang=ua&amp;id=ahh01">ua</a></div>
</body>
</html>
