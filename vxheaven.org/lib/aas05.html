<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Alan Solomon 'Java, ActiveX and the Virus Threat' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Alan Solomon"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Solomon, Alan,Java, ActiveX and the Virus Threat, activex, browser, applets, application, trojan, control, horses, spread, local, read, infection, technologies, virus, microsoft, security"/>
<meta name="Description" content="[...] New technologies, such as Java and ActiveX, create fresh environments that hackers can potentially exploit. Luckily, while there has been a lot of press given to potential security problems with these and other Internet technologies, to date there are no documented &quot;in-the-wild&quot; attacks based on Java or ActiveX [...]"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"ebdd359b7a4730dc99fb9eb30e6903dd28332603-1498756643-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/aas05.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Java, ActiveX and the Virus Threat</h1><p><a href="/lib/?lang=en&amp;author=Solomon%2C%20Alan">Alan Solomon</a><br/></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/aas05.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=AV#aas05">Back to index</a>] [<a href="/lib/aas05.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#p1">Viruses vs. Trojans</a></li>
<li><a href="#p2">Java and the Security Model</a></li>
<li><a href="#p3">Java Applications</a></li>
<li><a href="#p4">Java Applets</a></li>
<li><a href="#p5">ActiveX</a></li>
<li><a href="#p6">Preventing Infection</a></li>
</ul>
<p>While the Internet has provided a great boon for businesses, it's also created a wealth of opportunity for the virus writer and other developers with malicious intent. New technologies, such as Java and ActiveX, create fresh environments that hackers can potentially exploit. Luckily, while there has been a lot of press given to potential security problems with these and other Internet technologies, to date there are no documented "in-the-wild" attacks based on Java or ActiveX. All the demonstrations have only been in the lab.</p>
<h2><a name="p1"></a>Viruses vs. Trojans</h2>
<p>To understand the Java and ActiveX threat, it's necessary to understand the distinction between a software virus and a software Trojan horse. The difference between viruses and Trojan horses is primarily in the way they are spread. Viruses contain code to replicate and spread themselves without the user being aware of the distribution. For example, a virus may rewrite a section of the boot sector so that each time a user boots their machine, the virus copies itself into memory to intercept certain actions such as reading from a diskette. Subsequently, each time a diskette is read from, the virus will copy itself onto the boot sector of the diskette, enabling it to be spread to the next machine.</p>
<p>Trojan horses, on the other hand, contain no specific code to replicate. They rely on the writer placing them somewhere and enticing the unsuspecting user to execute them.</p>
<p>Since virus replication creates the potential to cause widespread damage, companies are concerned about protecting their machines. Historically, while Trojan horses have the potential to cause damage, their lack of replication means that the damage will always be in a contained environment. However, the Internet has changed all that by enabling widespread, quick distribution of potentially dangerous Java or ActiveX Trojan horses.</p>
<h2><a name="p2"></a>Java and the Security Model</h2>
<p>Java and ActiveX are both technologies that are being touted as the best way to make Web pages interactive and more functional than existing technologies allow. Java, by virtue of the fact that it runs inside a virtual machine on the client desktop, contains its own security model that creates a relatively protected environment.</p>
<h2><a name="p3"></a>Java Applications</h2>
<p>Since Java is just a programming language, a developer can write any kind of stand-alone application in Java. As long as the user runs it within a Java interpreter, the application can do anything that one would normally expect out of an application written in any other language. The security comes from the fact that, as any other application, the user needs to invoke the application from his local machine and is in control of launching it.</p>
<h2><a name="p4"></a>Java Applets</h2>
<p>Applets are special types of Java applications that are designed to run within a browser, whether they are downloaded from the Internet or not. Downloaded applets have a different security policy to those that are run from the local machine, even if they are run within the same browser.</p>
<p>Each applet, viewer or browser has a Security Manager object built into it that enforces the security model for that particular browser. Netscape and Microsoft generally follow the same conventions for applets that Sun recommends, but they do vary in implementation since each security object is independently developed. It's very likely that these policies will change as more Java applets are developed and the security restrictions start to limit functionality that users really want. In fact, Sun's JDK 1.1 applet viewer allows applets to read and write external files in certain circumstances.</p>
<p>For now, downloaded applets have the following restrictions:</p>
<ul>
<li>Applets cannot start any program on the machine that's executing it. This means that applets can't start rogue processes on the client machine to get around the other restrictions, to write viruses to the hard disk or cause other damage.</li>
<li>Applets cannot load libraries or define native methods. Similarly, applets can use only their own Java code and that provided by the virtual machine. They can't load DLLs on the client machine.</li>
<li>Applets cannot read and write files on the machine that's executing it. This is the biggest security protection Java users have from virus writers since a rogue applet isn't allowed to write anything outside the Java sand-box on the client machine. Applets can read files specified by full URLs, however. Within the virtual machine, an applet can read and write, so theoretically in the future, viruses could spread within a distributed virtual machine that spans multiple computers.</li>
<li>Applets cannot make network connections except back to the original host. This prevents an applet from doing nasty things on a foreign host to which you've had no knowledge that you were sending information. However, an applet can send information out of your computer back to the host. While this is a potential privacy risk, viruses can't spread onto the client.</li>
<li>Applets can't read certain system properties. The Java virtual machine defines some system properties, some of which an applet can read and some of which are precluded.</li>
<li>Applet windows look different from applications'. By visually making the user aware that an applet is running, Java reduces the likelihood that programs like password stealers might be easily passed off as a legitimate application.</li>
</ul>
<p>Downloaded applets are loaded into the virtual machine via a class loader, which is responsible for isolating the applet and running it through a bytecode verifier. The verifier checks for purposeful violations of Java language rules that might cause the virtual machine to crash and thereby give a virus access to the local machine.</p>
<p>Applets that are loaded from the local file system from a directory in the user's CLASSPATH have none of the above restrictions! These applets have the implicit trust of the application that launched it. So there is a big difference between having an applet loaded as part of a Web page and downloading the applet as a file and running it locally. Running a downloaded applet locally is as dangerous as running any other random downloaded executable whose history isn't known.</p>
<h2><a name="p5"></a>ActiveX</h2>
<p>ActiveX is Microsoft's original response to the Java juggernaut. Essentially a slimmed down version of OLE, ActiveX provides developers a way to download small executable objects that can be invoked directly on the user's machine. ActiveX controls (OCXs) also allow rapid development of applications based on "reusable parts." Unlike Java, there is no inherent security model for ActiveX. OCXs are fully executable pieces of Windows code that have no restrictions placed on them once they reach the client machine, regardless of how they got there. This creates a potentially enormous hole for viruses to travel through as Web pages can cause the download and execution of an OCX with no interaction by the user.</p>
<p>Microsoft's Internet Explorer offers the option of blocking the download of ActiveX controls and/or prompting the user to allow the download of each control. Additionally, Microsoft has created an ActiveX signing initiative called Authenticode where each applet is digitally signed with a Verisign certificate to verify the author of the control. If an applet is signed, the browser informs the user who the author was and, if they trust the author, lets them download the control. Unfortunately, unless the browser is set to block OCXs, an unsigned control passes through unchecked. Microsoft is hoping that all legitimate authors will sign their controls and only nasty controls won't be signed.</p>
<h2><a name="p6"></a>Preventing Infection</h2>
<p>The most effective way to prevent infection or damage from unknown ActiveX or Java applets is to disable downloads in the browser. Many companies do block Java from coming through their firewall. Unfortunately, this also restricts some potentially useful applets as well. For users who are sophisticated enough to make intelligent decisions about the origins of applets, setting the browser to prompt on download is an alternative.</p>
<p>To date, no known Java or ActiveX viruses or Trojan horses exist in the wild. Dr. Solomon's is currently working on extending our technology to scan Java applets for viruses as the bytecodes are being downloaded. We are also altering our existing OLE scanning technology to recognize ActiveX controls as they are written so that when the first Java or ActiveX virus is found, Dr. Solomon's Anti-Virus Toolkit will be there to detect it.</p>
[<a style="" href="/lib/?lang=EN&amp;index=AV#aas05">Back to index</a>] [<a href="/lib/aas05.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=aas05">de</a><a href="/lib/index.php?lang=en&amp;id=aas05">en</a><a href="/lib/index.php?lang=es&amp;id=aas05">es</a><a href="/lib/index.php?lang=it&amp;id=aas05">it</a><a href="/lib/index.php?lang=fr&amp;id=aas05">fr</a><a href="/lib/index.php?lang=pl&amp;id=aas05">pl</a><a href="/lib/index.php?lang=ru&amp;id=aas05">ru</a><a href="/lib/index.php?lang=ua&amp;id=aas05">ua</a></div>
</body>
</html>
