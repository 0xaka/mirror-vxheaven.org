<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Michel Dubois 'Virus Bénéﬁques' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Michel Dubois"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Dubois, Michel,Virus Bénéﬁques, virus, vaccin, fonction, chiffrement, bénéﬁque, nous, critères, exécution, ﬁchier, simulation, isroot, disque, démarrage, ordinateurs, doit"/>
<meta name="Description" content="Le 22 mars 1991, le record mondial de vitesse de calcul par un ordinateur est battu par une société du Massachusetts spécalisée dans le calcul parallèle1. Le record précédent était détenu par un virus écrit et distribué sur l’Internet par Robert Morris, alors étudiant à l’université de Cornell.C’est par ce constat que Fred Cohen commence son article sur les virus bénéﬁques [1]. Il démontre par la suite, que les technologies virales peuvent être utilisées à des ﬁns bénéﬁques. En effet, si un virus exécute un certain nombre de calculs sur les ordinateurs qu’il infecte et qu’il peut ensuite coordonner les résultats de ces calculs, il met en place une grille d’ordinateurs effectuant des calculs en parallèle et ceci à l’échelle mondiale."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"a18934ce03fd15f0f33fe6d49d0dd0900e28c753-1498757808-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/amd01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Virus Bénéﬁques</h1><p><a href="/lib/?lang=fr&amp;author=Dubois%2C%20Michel">Michel Dubois</a><br/> <em>Aout 2006</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/amd01.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Virus%20B%C3%A9n%C3%A9%EF%AC%81ques.pdf">Download</a> PDF (401.83Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=FR&amp;index=GV#amd01">Back to index</a>] [<a href="/lib/amd01.html#disqus_thread">Comments</a>]<br/> 
<h2>Théorie et pratique</h2>
<address>
Michel Dubois<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="ddb0a4aeb5b8b1b1f3b9a8bfb2b4ae9db3b8a8bbf3bbaf">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script><br/>
http://vaccin.sourceforge.net
</address>
<ul>
<li><a href="#c1">1 Caractéristiques d’un virus bénéﬁque</a>
<ul>
<li><a href="#c11">1.1 Les critères techniques</a>
<ul>
<li><a href="#c111">1.1.1 Le contrôle</a></li>
<li><a href="#c112">1.1.2 L’identiﬁcation</a></li>
<li><a href="#c113">1.1.3 La gestion des ressources</a></li>
<li><a href="#c114">1.1.4 Les bogues</a></li>
</ul></li>
<li><a href="#c12">1.2 Les critères éthiques et légaux</a>
<ul>
<li><a href="#c121">1.2.1 Modiﬁcation des données</a></li>
<li><a href="#c122">1.2.2 Détournement du virus</a></li>
<li><a href="#c123">1.2.3 La responsabilité</a></li>
</ul></li>
<li><a href="#c13">1.3 Les critères psychologiques</a>
<ul>
<li><a href="#c131">1.3.1 La conﬁance</a></li>
<li><a href="#c132">1.3.2 La vision négative des virus</a></li>
</ul></li>
</ul></li>
<li><a href="#c2">2 Le virus KOH</a>
<ul>
<li><a href="#c21">2.1 Justiﬁcation</a>
<ul>
<li><a href="#c211">2.1.1 virus de démarrage résident</a></li>
<li><a href="#c212">2.1.2 Autoreproduction</a></li>
</ul></li>
<li><a href="#c22">2.2 Modes d’action</a>
<ul>
<li><a href="#c221">2.2.1 Colonisation</a></li>
<li><a href="#c222">2.2.2 Chiffrement</a></li>
<li><a href="#c223">2.2.3 Détournement d’interruption</a></li>
</ul></li>
<li><a href="#c23">2.3 KOH virus bénéﬁque?</a></li>
</ul></li>
<li><a href="#c3">3 Objectifs et code</a>
<ul>
<li><a href="#c31">3.1 Diagramme fonctionnel</a>
<ul>
<li><a href="#c311">3.1.1 Colonisation</a></li>
<li><a href="#c312">3.1.2 Collecte de données</a></li>
</ul></li>
<li><a href="#c32">3.2 Le code</a>
<ul>
<li><a href="#c321">3.2.1 Remarques préliminaires</a></li>
<li><a href="#c322">3.2.2 La fonction main</a></li>
<li><a href="#c323">3.2.3 La fonction isRoot</a></li>
<li><a href="#c324">3.2.4 La fonction isSourceHost</a></li>
<li><a href="#c325">3.2.5 La fonction scanNetwork</a></li>
<li><a href="#c326">3.2.6 La fonction colonise</a></li>
<li><a href="#c327">3.2.7 La fonction isAutorise</a></li>
<li><a href="#c328">3.2.8 La fonction effaceVaccin</a></li>
<li><a href="#c329">3.2.9 La fonction recupInfos</a></li>
</ul></li>
<li><a href="#c33">3.3 Analyse</a>
<ul>
<li><a href="#c331">3.3.1 Les critères techniques</a></li>
<li><a href="#c332">3.3.2 Les critères éthiques et légaux</a></li>
<li><a href="#c333">3.3.3 Les critères psychologiques</a></li>
</ul></li>
</ul></li>
<li><a href="#c4">4 Implémentation et tests</a>
<ul>
<li><a href="#c41">4.1 Conﬁguration de la simulation</a></li>
<li><a href="#c42">4.2 Lancement de la simulation</a>
<ul>
<li><a href="#c421">4.2.1 Exécution de VACCIN sur dauphin</a></li>
<li><a href="#c422">4.2.2 Exécution de VACCIN sur les ordinateurs du réseau</a></li>
</ul></li>
</ul></li>
<li><a href="#c5">Références</a></li>
</ul>
<p>Le 22 mars 1991, le record mondial de vitesse de calcul par un ordinateur est battu par une société du Massachusetts spécalisée dans le calcul parallèle<sup><a href="#f1" name="b1">1</a></sup>. Le record précédent était détenu par un virus écrit et distribué sur l’Internet par Robert Morris, alors étudiant à l’université de Cornell.</p>
<p>C’est par ce constat que Fred Cohen commence son article sur les virus bénéﬁques [1]. Il démontre par la suite, que les technologies virales peuvent être utilisées à des ﬁns bénéﬁques. En effet, si un virus exécute un certain nombre de calculs sur les ordinateurs qu’il infecte et qu’il peut ensuite coordonner les résultats de ces calculs, il met en place une grille d’ordinateurs effectuant des calculs en parallèle et ceci à l’échelle mondiale.</p>
<h2><a name="c1"></a>1 Caractéristiques d’un virus bénéﬁque</h2>
<p>Plusieurs spécialistes de la virologie informatique ont étudié la possibilité d’utiliser les virus à des ﬁns bénéﬁques. C’est à Vesselin Bontchev que revient le mérite d’avoir ﬁxé les critères permettant de différencier un virus bénéﬁque d’un autre virus [2].</p>
<p>Dans le cadre d’une enquête réalisée sur le forum de news <em>Virus-L/comp.virus</em>, Vesselin Bontchev a demandé aux internautes de décrire les critères qui, selon eux, faisaient que les virus étaient perçus comme nocifs. Il a ensuite rassemblé et classé les réponses et en a déduit les critères déﬁnissant un virus bénéﬁque.</p>
<h3><a name="c11"></a>1.1 Les critères techniques</h3>
<h4><a name="c111"></a>1.1.1 Le contrôle</h4>
<p>Le premier critère technique concerne le contrôle de la propagation du virus. Par défaut, un virus se propage d’ordinateurs en ordinateurs de façon aléatoire. Ainsi, il n’est à priori pas possible de déterminer à l’avance si un ordinateur va être infecté ou pas. Un virus bénéﬁque doit pouvoir être contrôlé et les ordinateurs cibles ﬁxés à l’avance.</p>
<p>Une solution consiste à mettre en place un système d’invitation. Avant d’infecter un ordinateur, le virus vériﬁe s’il y est invité et c’est seulement en cas de réponse positive qu’il s’installe sur l’ordinateur.</p>
<p>Vesselin Bontchev imagine alors le scénario suivant : soit une compagnie spécialisée dans la production de virus bénéﬁques. Lors de la création d’un nouveau virus, elle le rend disponible sur l’un de ses sites de dépôts. Elle envoie ensuite à ses abonnés, un message contenant la clé publique du virus. L’administrateur d’un réseau désirant utiliser ce virus contrôle l’authenticité du message et envoie une invitation signée électroniquement. Cette dernière précise alors le type de virus désiré, l’adresse du réseau concerné et le mode d’entrée dans les systèmes (par exemple un numéro de port spéciﬁque). Une fois le message reçu, le dépôt de virus bénéﬁques envoie le virus choisi sur le réseau cible. Une fois sur place, le virus s’authentiﬁe et commence à se reproduire.</p>
<h4><a name="c112"></a>1.1.2 L’identiﬁcation</h4>
<p>Le deuxième critère technique concerne l’identiﬁcation du virus bénéﬁque par les antivirus. Les programmes antivirus détectent les virus nocifs soit à partir de leur signature, soit en contrôlant les modiﬁcations effectuées sur les programmes et documents, soit en détectant les processus et actions suspectes.</p>
<p>Une fois qu’un virus bénéﬁque est authentiﬁé sur un ordinateur, il est possible de spéciﬁer à l’antivirus de considérer ce virus comme un programme sûr. Ce mécanisme inhibe la détection par signature. Concernant les autres modes de détections, le virus bénéﬁque ne doit pas effectuer de modiﬁcations sur les programmes et documents du système. Par conséquent, un virus bénéﬁque ne peut être qu’un ver se propageant uniquement par les réseaux.</p>
<h4><a name="c113"></a>1.1.3 La gestion des ressources</h4>
<p>De nombreux virus nocifs, provoquent une surcharge du système infecté pouvant aller jusqu’au déni de service.</p>
<p>Pour éviter ce problème, un virus bénéﬁque doit être conçu aﬁn de consommer le minimum de mémoire, d’espace disque ou de temps processeur. En fait, la charge système occasionnée par le virus doit être négligeable par rapport aux bénéﬁces que l’utilisateur en retire. Concrètement cela implique, entre autres, qu’il n’y est qu’une seule instance du virus sur le système.</p>
<h4><a name="c114"></a>1.1.4 Les bogues</h4>
<p>Comme tout programme informatique, un virus contient des bogues. Dans certains cas, comme avec le RTM WORM, ces bogues ont entraîné la perte de contrôle du virus.</p>
<p>Une fois qu’un bogue, découvert dans le code d’un virus bénéﬁque, est corrigé, la version patchée du virus doit être fournie avec les mêmes règles d’authentiﬁcation. En reprenant le scénario évoqué plus haut, la nouvelle version du virus pourrait être diffusée de la même manière que la version originale : envoi d’un message contenant la clé publique du virus patché, puis authentiﬁcation par le système et mise à jour des instances du virus présentes sur le réseau.</p>
<p>De plus, la possibilité de provoquer l’arrêt instantané du virus doit être proposée aux utilisateurs. En effet, si un administrateur constate un fonctionnement anormal sur un virus bénéﬁque, il doit pouvoir imposer l’arrêt de toutes les instances du virus sur son réseau.</p>
<h3><a name="c12"></a>1.2 Les critères éthiques et légaux</h3>
<h4><a name="c121"></a>1.2.1 Modiﬁcation des données</h4>
<p>La plupart des législations interdisent la modiﬁcation des données personnelles sans l’autorisation du propriétaire. Un virus bénéﬁque ne doit donc modiﬁer aucune donnée. Le scénario envisagé permet de vériﬁer ce critère. Les actions effectuées par le virus bénéﬁque sont connues à l’avance et l’utilisateur "invite" lui-même le virus sur son système.</p>
<h4><a name="c122"></a>1.2.2 Détournement du virus</h4>
<p>Un virus bénéﬁque peut être utilisé par un pirate comme vecteur de transport pour pénétrer dans un réseau. Aﬁn de supprimer ce risque, un virus bénéﬁque doit mettre en œuvre des techniques cryptographiques fortes pour s’authentiﬁer dans les réseaux qu’il colonise. Une telle authentiﬁcation interdisant toute modiﬁcation du virus par un éventuel pirate.</p>
<p>Enﬁn, un pirate pourrait analyser un virus bénéﬁque aﬁn de s’approprier son code et de développer un virus nocif similaire. Cependant, étant donné qu’un virus bénéﬁque tel que nous l’avons décrit, ne pénètre pas de lui-même dans un système mais attend d’y être invité, le pirate devra convaincre un utilisateur ou l’administrateur réseau du bien fondé de son virus.</p>
<h4><a name="c123"></a>1.2.3 La responsabilité</h4>
<p>La question de la responsabilité en cas d’atteinte à l’intégrité, la disponibilité ou la conﬁdentialité d’un système d’information est un problème complexe. Les administrateurs réseaux sont par nature très méﬁants quand à l’utilisation de programmes autoreproducteurs sur leur système d’information.</p>
<p>Si les conditions d’implémentation d’un virus bénéﬁque telles que nous les avons décrites sont respectées, la responsabilité, en cas d’incident, ne repose plus intégralement sur l’administrateur. En effet, dans le cas du scénario exposé ci-dessus, il existe nécessairement un contrat signé entre l’entreprise fournissant les virus bénéﬁques et l’entreprise achetant ces virus. C’est donc au niveau du contrat que les responsabilités s’établissent au même titre que lorsque la même entreprise achète un système d’exploitation ou un logiciel de comptabilité.</p>
<h3><a name="c13"></a>1.3 Les critères psychologiques</h3>
<h4><a name="c131"></a>1.3.1 La conﬁance</h4>
<p>Souvent, l’utilisateur d’un ordinateur s’imagine qu’il exerce un contrôle total sur ce qui se passe dans sa machine. En fait, l’ordinateur étant un outil très sophistiqué, la plupart des utilisateurs ne saisissent pas très bien les rouages de son fonctionnement interne. Cette incertitude suscite de la méﬁance vis à vis de la machine et seul le sentiment de contrôler les réactions de l’ordinateur peut aider l’utilisateur à surmonter son appréhension.</p>
<p>C’est pourquoi, l’implémentation d’un virus bénéﬁque dans un réseau d’entreprise doit se faire de manière à ce que l’utilisateur continue de croire qu’il maîtrise le fonctionnement de son ordinateur. Ceci peut s’obtenir, par exemple, en lançant une campagne de communication interne. Dans ce cas, il s’agira d’expliquer le mode de fonctionnement du virus, en insistant sur son utilité, ses avantages et surtout la possibilité de le désactiver en cas de problème.</p>
<h4><a name="c132"></a>1.3.2 La vision négative des virus</h4>
<p>Les médias ont grandement contribué à créer une vision néfaste des virus en les présentant comme étant intrinsèquement mauvais. Et de fait, la plupart des utilisateurs suspecte les virus dès qu’ils ont un problème sur leur ordinateur.</p>
<p>Un administrateur désirant utiliser un virus bénéﬁque sur son système d’information, ne doit pas l’appeller <em>virus</em>, s’il veut que l’action bénéﬁque de son virus soit reconnue.</p>
<p>En résumé, pour qu’un virus puisse être considéré comme bénéﬁque, il doit répondre aux impératifs suivants:</p>
<ul>
<li>Attendre de recevoir une invitation avant de coloniser un ordinateur (présence sur le système cible d’un ﬁchier spéciﬁque par exemple);</li>
<li>Utiliser un mécanisme de chiffrement fort pour s’authentiﬁer auprès du système (utilisation d’une connection <em>SSH</em> par exemple);</li>
<li>Se sufﬁre à lui-même et ne pas modiﬁer d’autres programmes (être un ver réseau);</li>
<li>Ne pas être considéré comme un virus;</li>
</ul>
<h2><a name="c2"></a>2 Le virus KOH</h2>
<p>Un certain nombres de virus bénéﬁques ont déjà vu le jour, cependant, aucun d’entre eux ne répond à l’ensemble des critères que nous venons d’évoquer. Nous pouvons citer notamment:</p>
<ul>
<li>des virus antivirus:
<ul>
<li>DEN ZUK qui enleve le virus BRAIN;</li>
<li>les dernières versions de YANKEE_DOODLE qui suppriment les versions précédentes du virus;</li>
<li>NEUROQUILA qui désactivent un certain nombre d’antivirus et suppriment certains virus;</li>
</ul></li>
<li>des virus de compression de ﬁchiers comme CRUNCHER. Le concept de ce virus est de faire gagner de la place sur le disque dur en compressant et en décompressant les ﬁchiers en fonction de leur utilisation;</li>
<li>des virus pour la maintenance des ordinateurs comme le virus MAINTENANCE décrit par Fred Cohen [3] et qui permet d’effacer les ﬁchiers temporarires, d’arrêter les processus zombies ou encore de vériﬁer les permissions sur les ﬁchiers;</li>
<li>des virus de chiffrement de disque dur comme KOH;</li>
</ul>
<p>À titre d’exemple, nous allons détailler le fonctionnement du virus KOH. Ce virus, écrit par Mark Ludwig [4], permet de chiffrer l’ensemble d’un disque dur.</p>
<h3><a name="c21"></a>2.1 Justiﬁcation</h3>
<h4><a name="c211"></a>2.1.1 virus de démarrage résident</h4>
<p>Si l’on souhaite chiffrer l’intégralité d’un disque dur, les technologies virales semblent les plus appropriées. En effet, un logiciel standard de chiffrement est dépendant du système d’exploitation et doit donc attendre que celui-ci soit chargé pour pouvoir fonctionner. Cette contrainte implique que le secteur de démarrage du disque dur ne soit pas chiffré, ce qui représente une vulnérabilité non négligeable.</p>
<p>L’utilisation d’un virus de démarrage permet de s’affranchir du système d’exploitation et de chiffrer l’intégralité du disque dur. De plus, le virus est résident, ce qui offre plusieurs avantages. Tout d’abord, le virus est exécuté et chargé en mémoire à chaque démarrage de l’ordinateur, ensuite, le virus exécute les opérations de chiffrement et de déchiffrement en toute transparence.</p>
<p>Au ﬁnal, nous avons un virus qui se lance automatiquement, dès le démarrage de l’ordinateur, et qui gère les opérations de chiffrement et de déchiffrement de la totalité du disque dur de façon transparente pour l’utilisateur.</p>
<h4><a name="c212"></a>2.1.2 Autoreproduction</h4>
<p>À l’époque ou KOH a été écrit, l’utilisation des disquettes était généralisée. En tant que programme autoreproducteur, KOH présente alors plusieurs avantages:</p>
<ul>
<li>il sufﬁt d’insérer une disquette dans le lecteur pour qu’aussitôt, le virus se recopie dessus et la chiffre. L’utilisateur n’a plus à se soucier de savoir si l’un de ses supports de stockage est chiffré ou non;</li>
<li>l’utilisateur n’a pas besoin d’emmener avec lui un logiciel de déchiffrement pour pouvoir lire ses informations sur d’autres ordinateurs. Le virus étant sur la disquette, l’insertion de celle-ci dans un autre ordinateur entraîne l’activation du virus sur ce dernier;</li>
</ul>
<p>Un tel outil de chiffrement - déchiffrement des supports de stockage est un réel atout pour une entreprise ou une administration. En effet, il est difﬁcile de contrôler les ﬂux entrant et sortant des disquettes. KOH utilise des clés de chiffrement différentes pour les disquettes et les disques durs. L’administrateur réseau peut très bien distribuer les clés de chiffrement des disques durs mais pas celles des disquettes. Ainsi, l’utilisateur indélicat ne peux pas lire ses disquettes sur un ordinateur autre que ceux de son lieu de travail.</p>
<h3><a name="c22"></a>2.2 Modes d’action</h3>
<p>KOH est un virus de démarrage, résident et non furtif, ayant comme unique action d’assurer le chiffrement et le déchiffrement des supports de stockage. Les sources du virus comprennent cinq ﬁchiers:</p>
<ul>
<li><em>KOH.ASM</em> qui constitue le ﬁchier principal. Il contient, entre autre, le <em>loader</em>, le secteur de démarrage, les gestionnaires d’interruptions et le code de chiffrement du disque dur;</li>
<li><em>KOHIDEA.ASM</em> est un ﬁchier <em>include</em> qui implémente l’algorithme de chiffrement <em>IDEA</em>;</li>
<li><em>FATMAN.ASM</em> est un ﬁchier <em>include</em> qui permet de gérer les routines de la FAT;</li>
<li><em>PASS.ASM</em> est un ﬁchier <em>include</em> qui contient la routine de saisie de la phrase clé;</li>
<li><em>RAND.ASM</em> est un ﬁchier <em>include</em> qui contient le générateur de nombres pseudo-aléatoires;</li>
</ul>
<h4><a name="c221"></a>2.2.1 Colonisation</h4>
<p>KOH se copie sur les disquettes et disques durs en remplaçant le secteur de démarrage original par le sien, puis en copiant le reste de son code dans une zone inoccupée du disque. Cette zone est protégée en marquant, dans la <em>FAT</em>, les secteurs correspondants comme défectueux.</p>
<p>Le virus n’infecte les disquettes que si l’indicateur de condition <em>FD_INFECT</em> est égal à un. Dans ce cas, il commence par chiffrer le contenu de la disquette de sorte que si le processus de contamination échoue (manque d’espace libre), la disquette peut être utilisée normalement.</p>
<p>Lorsqu’un ordinateur démarre à partir d’une disquette contenant KOH, celui-ci demande s’il faut chiffrer le disque dur (voir FIG. 2). En cas de réponse positive, le disque dur est chiffré puis le système démarre normalement. En cas de réponse négative, le virus ne fait rien, par contre, il repose la question à chaque redémarrage de l’ordinateur.</p>
<div align="center">
<img src="img/amd01/fig1.png" alt="FIG. 1 – Création d’une disquette de boot contenant KOH"/>
<p><strong>FIG. 1 – Création d’une disquette de boot contenant KOH</strong></p>
<img src="img/amd01/fig2.png" alt="FIG. 2 – Chiffrement d’un disque dur par KOH pendant la séquence de boot"/>
<p><strong>FIG. 2 – Chiffrement d’un disque dur par KOH pendant la séquence de boot</strong></p>
</div>
<h4><a name="c222"></a>2.2.2 Chiffrement</h4>
<p>KOH utilise l’<em>International Data Encryption Algorithm (IDEA)</em><sup><a href="#f2" name="b2">2</a></sup> pour chiffrer et déchiffrer les données. <em>IDEA</em> chiffre des blocs de 64 bits avec des clés de 128 bits. Les processus de chiffrement et de déchiffrement sont similaires.</p>
<p>KOH conserve trois clés de 128 bits stockées dans <em>HD_KEY, HD_HPP</em> et <em>FD_HPP</em><sup><a href="#f3" name="b3">3</a></sup>.</p>
<h4><a name="c223"></a>2.2.3 Détournement d’interruption</h4>
<p>KOH détourne les interruptions <em>13H</em> pour le disque dur et <em>09H</em> pour le clavier.</p>
<p>Le <em>DOS</em> utilise l’interruption <em>13H</em> pour accéder au disque. En interceptant tous les appels à l’interruption 13H, KOH peut effectuer les opérations de chiffrement - déchiffrement de façon totalement transparente. Ainsi, lorsque le <em>DOS</em> cherche à ouvrir un ﬁchier sur le disque, le virus intercepte l’appel, déchiffre le ﬁchier et l’envoie au système d’exploitation. Lors de l’enregistrement d’un ﬁchier, l’opération inverse se déroule.</p>
<p>L’interruption <em>09H</em> est utilisée par le <em>DOS</em> pour la gestion du clavier. Le détournement de cette interruption permet à KOH de mettre en place des raccourcis clavier. Ainsi, la combinaison de touches <em>&lt;CTRL> &lt;ALT> &lt;K></em> permet de changer de phrase clé, <em>&lt;CTRL> &lt;ALT> &lt;O></em> permet de dire à KOH de chiffrer automatiquement ou non les disquettes et <em>&lt;CTRL> &lt;ALT> &lt;H></em> désinstalle le virus.</p>
<h3><a name="c23"></a>2.3 KOH virus bénéﬁque?</h3>
<p>Le virus KOH répond-il aux critères d’un virus bénéﬁque tels que nous les avons déﬁnis ci-dessus?</p>
<p>Concernant les critères techniques, le contrôle de la propagation du virus n’est pas assuré. Certes, la demande d’autorisation de chiffrement du disque dur est effective, mais lorsque la question est posée, le virus est déjà dans l’ordinateur. Concernant l’identiﬁcation, KOH est considéré, par les logiciels antivirus, comme étant un virus de la famille des virus STEALTH_BOOT. Il ne répond donc pas au critère. Concernant le critère de gestion des ressources, KOH est optimisé pour effectuer du chiffrement de disque dur à la volée. En dehors du chiffrement initial du disque, son action est transparente pour l’utilisateur. Il répond donc correctement à ce critère. Enﬁn pour le critère de gestion des bogues, il n’existe aucune infrastructure permettant de mettre à jour le virus. Cependant, lors de son lancement, KOH afﬁche à l’écran un avertissement (voir FIG. 2) demandant de faire une sauvegarde du système avant d’effectuer le chiffrement. Donc en cas de bogue dans le code du virus, l’utilisateur dispose normalement d’une sauvegarde de ses données.</p>
<p>Concernant les critères éthiques et légaux, KOH ne modiﬁe pas les données personnelles de l’utilisateur: une fois le chiffrement terminé, l’utilisateur retrouve l’ensemble de ses informations. Par contre, le code source du virus étant ouvert, un développeur mal intentionné peut rajouter des routines nocives au virus et le faire passer pour l’original. Il n’y a aucun contrôle de l’authenticité du virus lors de son utilisation. Enﬁn, le problème de la responsabilité reste entièrement du domaine de l’administrateur ou de l’utilisateur.</p>
<p>Concernant les critères psychologiques, KOH met en conﬁance son utilisateur : les messages qu’il afﬁche et la documentation fournie par son auteur sont clairs et précis. Malheureusement, KOH est considéré comme un virus, et à ce titre un administrateur sera naturellement méﬁant avant de l’implanter sur son réseau.</p>
<p>En conclusion, KOH ne satisfait pas pleinement aux critères d’un virus bénéﬁque. Cependant, il n’existe pas actuellement de virus bénéﬁque répondant à l’ensemble des critères techniques, éthiques, légaux et psychologiques. KOH est, à ma connaissance, celui qui s’en rapproche le plus.</p>
<p>Nous venons de détailler les critères permettant de différencier un virus bénéﬁque d’un virus nocif. Nous allons maintenant nous attacher à mettre en œuvre un virus bénéﬁque. L’objectif de ce développement est de fournir un outil d’aide à l’administration réseau basé sur les technologies virales.</p>
<h2><a name="c3"></a>3 Objectifs et code</h2>
<p>Le scénario retenu est le suivant. Le système d’information d’une entreprise X s’appuie sur un réseau d’ordinateurs sous <em>GNU/Linux</em>. L’administrateur du réseau souhaite mettre en place un système ﬂexible de suivi de l’ensemble des ordinateurs. Pour cela, il décide d’utiliser les technologies virales et installe le ver bénéﬁque VACCIN sur son réseau.</p>
<h3><a name="c31"></a>3.1 Diagramme fonctionnel</h3>
<p>Le mode de fonctionnement de VACCIN s’articule selon le diagramme de la ﬁgure 3.</p>
<p>Tout d’abord, VACCIN contrôle son niveau d’accès au système. S’il est exécuté par un autre utilisateur que <em>root</em>, il s’arrête. Le test suivant permet à VACCIN de déterminer à partir de quel ordinateur il est lancé. Soit le ver est exécuté à partir de l’ordinateur de l’administrateur réseau et dans ce cas il lance ses routines de colonisation, soit il est exécuté sur un autre ordinateur et dans ce cas il lance ses routines de collecte de données.</p>
<h4><a name="c311"></a>3.1.1 Colonisation</h4>
<p>La routine de colonisation de VACCIN commence par un scan du réseau. Celui-ci consiste, à partir de l’adresse IP du poste de l’administrateur et du masque réseau, à déterminer la plage d’adresses IP des ordinateurs. Ensuite, une requête est envoyée à chacune de ces adresses sur le port <em>SSH</em>, cette routine permet de déﬁnir une liste des ordinateurs effectivements connectés au réseau et faisant tourner un serveur <em>SSH</em>.</p>
<p>Une fois la liste des ordinateurs connectés au réseau construite, VACCIN la parcourt et établit une connexion <em>SSH</em> avec chacune des machines dont l’adresse IP y est référencée. Ensuite, le ver se recopie sur les ordinateurs et s’y exécute.</p>
<div align="center">
<img src="img/amd01/fig3.png" alt="FIG. 3 – Diagramme fonctionnel de VACCIN"/>
<p><strong>FIG. 3 – Diagramme fonctionnel de VACCIN</strong></p>
</div>
<h4><a name="c312"></a>3.1.2 Collecte de données</h4>
<p>Lorsque VACCIN est lancé sur un ordinateur du réseau autre que celui de l’administrateur, il commence par vériﬁer qu’il y est autorisé. Si c’est le cas, il télécharge sur le poste de l’administrateur un ﬁchier de commandes qu’il exécute ensuite et il renvoie le résultat sur l’ordinateur de l’aministrateur sous forme de ﬁchier texte. Si VACCIN n’est pas autorisé à s’exécuter il s’efface automatiquement de l’ordinateur concerné.</p>
<h3><a name="c32"></a>3.2 Le code</h3>
<h4><a name="c321"></a>3.2.1 Remarques préliminaires</h4>
<p>VACCIN est un ver écrit en langage C.</p>
<p>Aﬁn de clariﬁer le code, les routines de gestion des erreurs n’ont pas été implémentées. Par conséquent, en cas d’erreur d’ouverture d’une socket, d’un ﬁchier ou encore d’exécution d’une commande <em>system</em> le programme s’arrête sans afﬁcher de message.</p>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">#define SOURCE_HOST_IP&nbsp; &quot;192.168.184.1&quot;</span><br/>
<span style="color: #339933;">#define MASK_NETWORK &nbsp; &nbsp;&quot;255.255.255.0&quot;</span><br/>
<span style="color: #339933;">#define CONTROL_FILE&nbsp; &nbsp; &quot;/root/datav&quot;</span><br/>
<span style="color: #339933;">#define COMMAND_FILE&nbsp; &nbsp; &quot;/root/commandes.sh&quot;</span><br/>
<span style="color: #339933;">#define VER_FILE&nbsp; &nbsp; &nbsp; &nbsp; &quot;/root/vaccin&quot;</span><br/>
&nbsp;</div>
<p><strong>CODE 3.1:</strong> Les variables déﬁnies par VACCIN</p>
<p>Pour pouvoir fonctionner, VACCIN déﬁnit cinq variables (voir CODE 3.1). <em>SOURCE_HOST_IP</em> et <em>MASK_NETWORK</em> déﬁnissent respectivement l’adresse IP de l’ordinateur de l’administrateur et le masque réseau utilisé. Enﬁn, <em>CONTROL_FILE, COMMAND_FILE</em> et <em>VER_FILE</em> déﬁnissent respectivement le nom complet du ﬁchier de contrôle, le nom complet du ﬁchier de commandes et le nom complet du ﬁchier dans lequel VACCIN sera copié lors de sa colonisation.</p>
<h4><a name="c322"></a>3.2.2 La fonction main</h4>
<p>Comme tout programme écrit en C, VACCIN commence par exécuter la procédure <em>main</em>.</p>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; openlog<span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;vaccin&quot;</span><span style="color: #339933;">,</span> LOG_PID<span style="color: #339933;">,</span> LOG_USER<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; . . .<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #202020;">syslog</span><span style="color: black;">&#40;</span>LOG_NOTICE<span style="color: #339933;">,</span><span style="color: #ff0000;">&quot; ## Lancement de vaccin par root.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; . . .<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #202020;">closelog</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p><strong>CODE 3.2:</strong> Initialisation, écriture et fermeture des opérations <em>syslog</em></p>
<p>VACCIN est un ver il se doit donc d’être le plus possible furtif. C’est pour cette raison qu’il n’afﬁche aucun message sur la console par le biais de <em>stdout</em> ou de <em>stderr</em>. Cependant, l’administrateur, qui l’utilise, doit pouvoir suivre son fonctionnement, c’est pourquoi les messages d’état de VACCIN sont transmis au système par le biais du démon <em>syslogd</em>. La procédure main débute donc par l’ouverture d’une session <em>syslog</em> (voir CODE 3.2) avec la commande <em>openlog()</em>. Tout au long de son exécution les messages sont envoyés au démon <em>syslogd</em> par la commande <em>syslog()</em>. Cette dernière prend comme premier argument une constante qui permet de déﬁnir l’urgence du message. Les deux niveaux d’urgences utilisés par VACCIN sont présentés dans la ﬁgure 4. Enﬁn, VACCIN se termine par la cloture de la session <em>syslog</em> grâce à la commande <em>closelog()</em>.</p>
<p>Une fois la session <em>syslog</em> initialisée, VACCIN appel la fonction <em>isRoot()</em>. Celle-ci permet de déterminer que c’est bien l’utilisateur root qui a lancé le programme. En cas de réponse négative, VACCIN s’arrête et envoi un message de niveau critique au démon <em>syslogd</em>. Dans le cas contraire, VACCIN appel la fonction <em>isSourceHost()</em>. Cette dernière détermine l’adresse IP de l’ordinateur sur lequel le ver s’exécute. S’il s’agit de l’ordinateur de l’administrateur, VACCIN crée la liste des machines connectées au réseau grâce à la fonction <em>scanNetwork()</em> et les colonise en appellant la fonction <em>colonise()</em>. Si, au contraire l’adresse IP correspond a
une machine du réseau, VACCIN lance la fonction <em>isAutorise()</em> pour déterminer s’il est, oui ou non autorisé à s’exécuter sur son hôte. En cas de réponse positive, le ver exécute la fonction <em>recupInfos()</em> et en cas de réponse négative VACCIN s’efface du système en exécutant la fonction <em>effaceVaccin()</em>.</p>
<table summary="FIG. 4 – Les deux niveaux d’alertes de VACCIN">
<tr><th>NOM</th><th>SIGNIFICATION</th></tr>
<tr><td>LOG_NOTICE</td><td>Information importante, mais fonctionnement normal.</td></tr>
<tr><td>LOG_CRIT</td><td>Des conditions critiques se présentent, pouvant nécessiter une intervention.</td></tr>
</table>
<p><strong>FIG. 4 – Les deux niveaux d’alertes de VACCIN</strong></p>
<h4><a name="c323"></a>3.2.3 La fonction isRoot</h4>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #993333;">int</span> isRoot<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #993333;">int</span> &nbsp; &nbsp; result<span style="color: #339933;">;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span>getuid<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">!=</span> <span style="color: #0000dd;">0</span><span style="color: black;">&#41;</span> <span style="color: #339933;">||</span> <span style="color: black;">&#40;</span>geteuid<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">!=</span> <span style="color: #0000dd;">0</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result <span style="color: #339933;">=</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: black;">&#40;</span>result<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p><strong>CODE 3.3:</strong> La fonction isRoot</p>
<p>La fonction <em>isRoot()</em> utilise les fonctions système <em>uid_t getuid (void)</em> et <em>uid_t geteuid (void)</em> pour identiﬁer l’utilisateur qui exécute le ver. Si l’<em>UID</em> réel ou effectif de l’utilisateur est différent de zéro, <em>isRoot()</em> retourne 0 sinon elle retourne 1.</p>
<h4><a name="c324"></a>3.2.4 La fonction isSourceHost</h4>
<p>À partir des <em>IOCTLs</em>, la fonction isSourceHost construit la liste des interfaces réseaux disponibles sur l’ordinateur hôte. Cette liste est ensuite parcourut et l’adresse IP de chaque interface est comparée à celle de l’ordinateur de l’administrateur déﬁnit dans <em>SOURCE_HOST_IP</em>. S’il y a correspondance, le ver tourne sur l’ordinateur de l’administrateur et <em>isSourceHost</em> renvoie 1. Dans le cas contraire, le ver tourne sur l’une des machines du réseau et <em>isSourceHost</em> renvoie 0.</p>
<h4><a name="c325"></a>3.2.5 La fonction scanNetwork</h4>
<p>La fonction <em>scanNetwork</em> exécute deux opérations. Tout d’abord (voir CODE 3.4) elle détermine, à partir du masque réseau déﬁnit dans <em>MASK_NETWORK</em>, la plage d’adresse des ordinateurs du réseau. De cette information scanNetwork déduit le nombre de machines adressables et initialise la variable <em>nbrComputer</em>.</p>
<p>La deuxième opération réalisée par scanNetwork (voir CODE 3.5) consiste à effectuer une tentative de connexion sur l’ensemble de la plage d’adresses IP précédemment déterminée, en utilisant le port <em>SSH</em> (port numéro 22). Cette routine permet de construire une liste des ordinateurs connectés au réseau et ayant un serveur <em>SSH fonctionnel</em>.</p>
<h4><a name="c326"></a>3.2.6 La fonction colonise</h4>
<p>C’est la fonction <em>colonise</em> qui réalise la copie du ver sur les machines distantes (voir CODE 3.6). En s’appuyant sur la commande system, la colonisation d’un ordinateur par VACCIN se déroule en trois étapes:</p>
<ol>
<li>Le ver ouvre une connexion SSH sur l’ordinateur distant et, grâce à la commande scp, se copie dessus sous le nom ﬁxé par la variable <em>VER_FILE</em>;</li>
<li>Ensuite, le ver rajoute une ligne dans la <em>crontab</em> de l’utilisateur <em>root</em> (sur l’ordinateur distant) pour que le ver s’exécute automatiquement toute les heures;</li>
<li>Enﬁn, le ver se lance sur l’ordinateur qu’il vient de coloniser;</li>
</ol>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">inet_aton <span style="color: black;">&#40;</span>MASK_NETWORK<span style="color: #339933;">,</span> <span style="color: #339933;">&amp;</span>mask<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
inet_aton <span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;255.255.255.255&quot;</span><span style="color: #339933;">,</span> <span style="color: #339933;">&amp;</span>broadcast<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
nbrComputer <span style="color: #339933;">=</span> ntohl <span style="color: black;">&#40;</span>broadcast.<span style="color: #202020;">s_addr</span> <span style="color: #339933;">^</span> mask.<span style="color: #202020;">s_addr</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p><strong>CODE 3.4:</strong> La routine de calcul du nombre d’ordinateurs adressables</p>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span>i <span style="color: #339933;">=</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> nbrComputer<span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; hostIP.<span style="color: #202020;">s_addr</span> <span style="color: #339933;">=</span> htonl<span style="color: black;">&#40;</span>ntohl<span style="color: black;">&#40;</span>hostMask<span style="color: black;">&#41;</span><span style="color: #339933;">+</span>i<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/strcmp.html"><span style="color: #000066;">strcmp</span></a><span style="color: black;">&#40;</span>inet_ntoa<span style="color: black;">&#40;</span>hostIP<span style="color: black;">&#41;</span><span style="color: #339933;">,</span> SOURCE_HOST_IP<span style="color: black;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #0000dd;">0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">continue</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/* l’ordinateur de l’administrateur n’entre pas dans la liste */</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; bzero <span style="color: black;">&#40;</span><span style="color: #339933;">&amp;</span>sockHostIP<span style="color: #339933;">,</span> <span style="color: #993333;">sizeof</span> <span style="color: black;">&#40;</span>sockHostIP<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; sock <span style="color: #339933;">=</span> socket <span style="color: black;">&#40;</span>AF_INET<span style="color: #339933;">,</span> SOCK_STREAM<span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; sockHostIP.<span style="color: #202020;">sin_family</span> <span style="color: #339933;">=</span> AF_INET<span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; sockHostIP.<span style="color: #202020;">sin_port</span> <span style="color: #339933;">=</span> htons <span style="color: black;">&#40;</span><span style="color: #0000dd;">22</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; sockHostIP.<span style="color: #202020;">sin_addr</span> <span style="color: #339933;">=</span> hostIP<span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span>connect <span style="color: black;">&#40;</span>sock<span style="color: #339933;">,</span> <span style="color: black;">&#40;</span><span style="color: #993333;">struct</span> sockaddr <span style="color: #339933;">*</span><span style="color: black;">&#41;</span><span style="color: #339933;">&amp;</span>sockHostIP<span style="color: #339933;">,</span> <span style="color: #993333;">sizeof</span> <span style="color: black;">&#40;</span>sockHostIP<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #0000dd;">0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resultIP <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span><span style="color: #993333;">struct</span> in_addr <span style="color: #339933;">*</span><span style="color: black;">&#41;</span><a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/realloc.html"><span style="color: #000066;">realloc</span></a><span style="color: black;">&#40;</span>resultIP<span style="color: #339933;">,</span> <span style="color: black;">&#40;</span>compteur<span style="color: #339933;">+</span><span style="color: #0000dd;">1</span><span style="color: black;">&#41;</span> <span style="color: #339933;">*</span> <span style="color: #993333;">sizeof</span> <span style="color: black;">&#40;</span><span style="color: #993333;">struct</span> in_addr<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resultIP<span style="color: black;">&#91;</span>compteur<span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> hostIP<span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; compteur<span style="color: #339933;">++;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; syslog <span style="color: black;">&#40;</span>LOG_NOTICE<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot; ## %s \ n&quot;</span><span style="color: #339933;">,</span> inet_ntoa<span style="color: black;">&#40;</span>hostIP<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p><strong>CODE 3.5:</strong> La routine de scan du réseau</p>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #808080; font-style: italic;">/* Copie du ver sur l’ordinateur distant */</span><br/>
syslog<span style="color: black;">&#40;</span>LOG_NOTICE<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;## copie du ver sur %s.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span> inet_ntoa<span style="color: black;">&#40;</span>adresse<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/sprintf.html"><span style="color: #000066;">sprintf</span></a><span style="color: black;">&#40;</span>commande<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;/usr/bin/scp %s %s:%s&quot;</span><span style="color: #339933;">,</span> nom<span style="color: #339933;">,</span> destinataire<span style="color: #339933;">,</span> VER_FILE<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/system.html"><span style="color: #000066;">system</span></a><span style="color: black;">&#40;</span>commande<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #808080; font-style: italic;">/* Rajout d’une ligne dans la crontab */</span><br/>
syslog<span style="color: black;">&#40;</span>LOG_NOTICE<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;## configuration du lancement automatique pour %s.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span> inet_ntoa<span style="color: black;">&#40;</span>adresse<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/sprintf.html"><span style="color: #000066;">sprintf</span></a><span style="color: black;">&#40;</span>commande<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;/usr/bin/ssh %s <span style="color: #000099; font-weight: bold;">\&quot;</span>echo 0 <span style="color: #000099; font-weight: bold;">\\</span>* <span style="color: #000099; font-weight: bold;">\\</span>* <span style="color: #000099; font-weight: bold;">\\</span>* <span style="color: #000099; font-weight: bold;">\\</span>* %s &gt;&gt; /var/spool/cron/tabs/root<span style="color: #000099; font-weight: bold;">\&quot;</span> &quot;</span><span style="color: #339933;">,</span> destinataire<span style="color: #339933;">,</span> VER_FILE<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/system.html"><span style="color: #000066;">system</span></a><span style="color: black;">&#40;</span>commande<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #808080; font-style: italic;">/* Premiere execution du ver */</span><br/>
syslog<span style="color: black;">&#40;</span>LOG_NOTICE<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;## Premiere execution du ver sur %s.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span> inet_ntoa<span style="color: black;">&#40;</span>adresse<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/sprintf.html"><span style="color: #000066;">sprintf</span></a><span style="color: black;">&#40;</span>commande<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;/usr/bin/ssh %s <span style="color: #000099; font-weight: bold;">\&quot;</span>%s<span style="color: #000099; font-weight: bold;">\&quot;</span> &quot;</span><span style="color: #339933;">,</span> destinataire<span style="color: #339933;">,</span> VER_FILE<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/system.html"><span style="color: #000066;">system</span></a><span style="color: black;">&#40;</span>commande<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p><strong>CODE 3.6:</strong> La routine de colonisation</p>
<h4><a name="c327"></a>3.2.7 La fonction isAutorise</h4>
<p>Lorsque VACCIN s’exécute sur un ordinateur autre que celui de l’administrateur, il lance, en premier lieu, la fonction <em>isAutorise</em>. Le principe de cette routine consiste à déterminer l’existence du ﬁchier dont le nom est ﬁxé dans la constante <em>CONTROL_FILE</em>. Pour effectuer cette opération, <em>isAutorise</em> tente d’ouvrir <em>CONTROL_FILE</em> à l’aide de la fonction <em>fopen</em>. Cette fonction présente l’avantage de ne pas créer le ﬁchier s’il n’existe pas, donc si la tentative d’ouverture échoue c’est que le ﬁchier n’a pas été créé par l’administrateur. VACCIN en conclu qu’il n’est pas autorisé à s’exécuter sur ce poste.</p>
<p>La fonction <em>isAutorise</em> retourne 1 si le ﬁchier <em>CONTROL_FILE</em> existe et 0 sinon.</p>
<h4><a name="c328"></a>3.2.8 La fonction effaceVaccin</h4>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; syslog<span style="color: black;">&#40;</span>LOG_NOTICE<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;## Suppression du vaccin.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; unlink<span style="color: black;">&#40;</span>VER_FILE<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; syslog<span style="color: black;">&#40;</span>LOG_NOTICE<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;## Reinitialisation de la crontab.<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/sprintf.html"><span style="color: #000066;">sprintf</span></a><span style="color: black;">&#40;</span>commande<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;perl −ne ’print unless /0 * * * */ ’ /var/spool/cron/tabs/root &gt; /root/temp&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/system.html"><span style="color: #000066;">system</span></a><span style="color: black;">&#40;</span>commande<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/sprintf.html"><span style="color: #000066;">sprintf</span></a><span style="color: black;">&#40;</span>commande<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;mv /root/temp/var/spool/cron/tabs/root&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/system.html"><span style="color: #000066;">system</span></a> <span style="color: black;">&#40;</span>commande<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p><strong>CODE 3.7:</strong> La routine de suppression</p>
<p>La fonction <em>effaceVaccin</em> effectue l’opération inverse de <em>colonise</em>. Son objectif est de remettre l’ordinateur hôte dans un état identique à celui précédent sa colonisation. La suppression de VACCIN s’effectue en deux temps (voir CODE 3.7):</p>
<ol>
<li>Le ﬁchier programme VER_FILE est effacé par la commande système <em>unlink</em>;</li>
<li>La <em>crontab</em> de l’utilisateur root est remise dans son état initiale;</li>
</ol>
<h4><a name="c329"></a>3.2.9 La fonction recupInfos</h4>
<div class="sh" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">echo &gt;&gt; /root/datav<br/>
echo Liste des executables setuid et setgid &gt;&gt; /root/datav<br/>
echo &gt;&gt; /root/datav<br/>
find / bin −perm +6000 −exec ls −ld {} \; &gt;&gt; /root/datav<br/>
&nbsp;</div>
<p><strong>CODE 3.8:</strong> Exemple d’opération effectuée par VACCIN</p>
<p>Cette fonction correspond à la charge ﬁnale du ver VACCIN. Son objectif consiste à télécharger un ﬁchier de commandes sur l’ordinateur de l’administrateur, à exécuter ce ﬁchier sur l’ordinateur hôte et à envoyer les résultats sur le poste administrateur, sous la forme d’un ﬁchier texte portant le nom de la machine source.</p>
<p>Ce mode de fonctionnement offre une très grande souplesse d’utilisation pour l’administrateur (voir CODE 3.8). En effet, <em>commandes.sh</em> est un ﬁchier de script <em>bash</em>. Il sufﬁt donc à l’administrateur de le modiﬁer en fonction de ses besoins pour que lors de la prochaine exécution de VACCIN les opérations soient effectuées sur l’ensemble des ordinateurs de son réseau.</p>
<h3><a name="c33"></a>3.3 Analyse</h3>
<p>Aﬁn de mériter le titre de “ver bénéﬁque”, il est important que VACCIN réponde aux critères déﬁnis dans 1 page 1.</p>
<h4><a name="c331"></a>3.3.1 Les critères techniques</h4>
<p>VACCIN répond à l’ensemble des critères techniques, en effet:</p>
<ul>
<li>il met en œuvre un système de contrôle de la propagation du ver par le biais:
<ul>
<li>du scan systématique de l’ensemble des ordinateurs du réseau: l’administrateur est certain que tous les ordinateurs sont colonisés;</li>
<li>de l’utilisation d’un mécanisme d’invitation : le ﬁchier déﬁnit par la constante <em>CONTROL_FILE</em> permet de ﬁxer à l’avance les ordinateurs colonisables par le ver. Si le ﬁchier existe sur le système cible alors le ver peut s’y lancer sinon le ver s’y efface;</li>
</ul></li>
<li>n’effectuant que des opérations standards sur les systèmes cibles, VACCIN n’est pas identiﬁable comme étant un malware par un logiciel antivirus;</li>
<li>VACCIN est peu gourmand en ressources et son exécution est transparente sur le système.</li>
<li>Il n’existe pas actuellement de structure de gestion de bogues pour VACCIN. Cependant les sources du ver sont fournies avec le programme donc, en cas de découverte d’un bogue, l’administrateur peut aisément le corriger. Enﬁn, il sufﬁt de supprimer le ﬁchier <em>CONTROL_FILE</em> pour qu’à la prochaine exécution, VACCIN s’efface des ordinateurs cibles.</li>
</ul>
<h4><a name="c332"></a>3.3.2 Les critères éthiques et légaux</h4>
<p>L’utilisation d’un tel ver dans une entreprise ou une administration doit se faire selon une procédure claire et connue de tous. Cette dernière doit notamment déﬁnir:</p>
<ol>
<li>quels sont les ordinateurs susceptibles d’être colonisés;</li>
<li>quels types d’actions sont autorisés dans le ﬁchier <em>commandes.sh</em>;</li>
<li>qelles sont les modalités de contrôles des opérations intégrées dans le ﬁchier <em>commandes.sh</em>;</li>
<li>qui est chargé de contrôler l’application correcte de la procédure (déﬁnition des responsabilités);</li>
</ol>
<h4><a name="c333"></a>3.3.3 Les critères psychologiques</h4>
<p>Enﬁn, l’administrateur réseau doit, avant son implantation, informer les personnels de l’entreprise ou de l’administration de la procédure d’utilisation de ce logiciel. Cette communication peut se faire, par exemple, au <em>CHSCT</em><sup><a href="#f4" name="b4">4</a></sup>. VACCIN est alors présenté comme un logiciel se copiant automatiquement sur les ordinateurs et effectuant par la suite un certain nombre d’analyses purements techniques à destination de l’administrateur réseau.</p>
<h2><a name="c4"></a>4 Implémentation et tests</h2>
<p>Après avoir décrit en détail l’architecture de VACCIN nous allons regarder comment il fonctionne concrètement. Pour cela, nous allons implémenter un réseau d’ordinateurs virtuels grâce à <em>VMWare</em>.</p>
<h3><a name="c41"></a>4.1 Conﬁguration de la simulation</h3>
<p>La simulation que nous mettons en œuvre s’appuie donc sur le logiciel VMware Workstation<sup><a href="#f5" name="b5">5</a></sup>. Ce dernier, est un puissant logiciel de virtualisation d’ordinateurs. Il permet, à partir d’un même hôte physique, de lancer simultanément un ou plusieurs hôtes virtuels fonctionnant sous divers systèmes d’exploitation et reliés entre eux par un réseau virtuel. Une version d’évaluation à trente jours de VMware Workstation est disponible.</p>
<p>Le système d’information que nous utilisons correspond au schéma de la ﬁgure 5. Il s’articule autour d’un ordinateur physique fonctionnant sous Debian et prénommé <em>dauphin</em>. Il sert de serveur <em>DHCP</em> et dispose d’un serveur <em>SSH</em>. Dans la simulation, il joue le rôle de l’ordinateur de l’administrateur.</p>
<p>Quatre ordinateurs d’utilisateur sont conﬁgurés. Ce sont des machines émulées par <em>VMWare</em> et fonctionnant sous la distribution Suse. Leur adresse IP est attribuée par le serveur <em>DHCP</em> et elles ont chacune un serveur <em>SSH</em> propre. Au début de la simulation, nous considérons que l’utilisateur user3 travaillant sur l’ordinateur <em>linux3</em> a refusé que le ver fonctionne sur son ordinateur. Le ﬁchier de contrôle <em>/root/datav</em> est donc créé sur tous les ordinateurs du réseau sauf le sien.</p>
<div align="center">
<img src="img/amd01/fig5.gif" alt="FIG. 5 – Réseau de test pour VACCIN"/>
<p><strong>FIG. 5 – Réseau de test pour VACCIN</strong></p>
</div>
<h3><a name="c42"></a>4.2 Lancement de la simulation</h3>
<h4><a name="c421"></a>4.2.1 Exécution de VACCIN sur dauphin</h4>
<div align="center">
<img src="img/amd01/fig6.png" alt="FIG. 6 – Lancement de VACCIN"/>
<p><strong>FIG. 6 – Lancement de VACCIN</strong></p>
</div>
<p>Nous commençons par exécuter VACCIN à partir d’une console <em>root</em> sur l’ordinateur de l’administrateur réseau (voir FIG. 6). Ensuite, nous consultons le journal <em>syslog</em> sur <em>dauphin</em>, les actions exécutées par VACCIN y apparaissent (voir FIG. 7). Nous pouvons voir que tout d’abord, il constate qu’il est sur l’ordinateur de l’administrateur, ensuite il lance le scan réseau et enﬁn, pour chaque machine détectée, il exécute la routine de colonisation. Finalement, nous vériﬁons le contenu du répertoire <em>/root/</em> sur l’ordinateur de l’administrateur (voir FIG. 8). Trois nouveaux ﬁchiers s’y trouve, portant chacun le nom de l’ordinateur dont ils proviennent.</p>
<div align="center">
<img src="img/amd01/fig7.png" alt="FIG. 7 – Suivi de l’exécution de VACCIN"/>
<p><strong>FIG. 7 – Suivi de l’exécution de VACCIN</strong></p>
<img src="img/amd01/fig8.png" alt="FIG. 8 – Résultat de l’exécution de VACCIN"/>
<p><strong>FIG. 8 – Résultat de l’exécution de VACCIN</strong></p>
<img src="img/amd01/fig9.png" alt="FIG. 9 – Résultat de l’exécution de VACCIN sur linux1"/>
<p><strong>FIG. 9 – Résultat de l’exécution de VACCIN sur linux1</strong></p>
<img src="img/amd01/fig10.png" alt="FIG. 10 – Résultat de l’exécution de VACCIN sur linux3"/>
<p><strong>FIG. 10 – Résultat de l’exécution de VACCIN sur linux3</strong></p>
</div>
<h4><a name="c422"></a>4.2.2 Exécution de VACCIN sur les ordinateurs du réseau</h4>
<p>Le résultat de l’exécution de VACCIN sur les ordinateurs du réseau diffère en fonction de la présence du ﬁchier <em>/root/datav</em>. Sur les trois ordinateurs où le ﬁchier est présent, le ver s’exécute et le résultat est transmis à <em>dauphin</em> (voir FIG. 9). Par contre, dans l’ordinateur où le ﬁchier n’est pas présent, le ver s’efface automatiquement (voir FIG. 10).</p>
<h2><a name="c5"></a>Références</h2>
<ol>
<li>COHEN (F.), <a href="/lib/afc05.html">«A case for benevolent viruses»</a>, 1991.</li>
<li>BONTCHEV (V. V.), <a href="/lib/avb02.html">«Are good computer viruses still a bad idea?»</a>, EICAR Conference 1994, 1994.</li>
<li>COHEN (F.), <a href="/lib/afc06.html">«Current trends in computer viruses»</a>. International Symposium on Information Security, 1991.</li>
<li>LUDWIG (M.), Du virus à l’antivirus. Dunod, 1997.</li>
</ol>
<hr size="1"/>
<p><a name="f1" href="#b1">1</a> Depuis le 30 juin 2005, ce record est détenu par l’équipe OASIS qui rassemble des chercheurs de l’INRIA Sophia Antipolis, du laboratoire CNRS I3S et de l’Université de Nice Sophia-Antipolis. Ces chercheurs sont les premiers au monde à avoir calculé le nombre de façons de déposer 25 reines sur un échiquier de taille 25 x 25 de sorte que les reines ne puissent être en prise. Ce nombre est égal à 2 207 893 435 808 352. Le calcul s’est exécuté sur une grille de PCs de bureau à l’INRIA Sophia Antipolis.</p>
<p><a name="f2" href="#b2">2</a> <em>IDEA</em> est un algorithme de chiffrement par bloc mis au point, en 1991, par Xuejia Lai et James Massey de l’Institut Fédéral de Technologie Suisse. Initialement cet algorithme a été crée pour emplacer le <em>Data Encryption Standard (DES)</em>.</p>
<p><a name="f3" href="#b3">3</a> <em>HPP</em> est l’acronyme de Hashed PassPhrase.</p>
<p><a name="f4" href="#b4">4</a> Comité d’Hygiène, de Sécurité et des Conditions de Travail. Institué par le code du travail, le CHSCT est l’entité où siègent les représentants du personnel. C’est donc le lieu idéal pour informer les salariés d’une entreprise des méthodes et outils de sécurité informatique utilisés et des garantis de protection de leur vie privé.</p>
<p><a name="f5" href="#b5">5</a> http://www.vmware.com</p>
[<a style="" href="/lib/?lang=FR&amp;index=GV#amd01">Back to index</a>] [<a href="/lib/amd01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=amd01">de</a><a href="/lib/index.php?lang=en&amp;id=amd01">en</a><a href="/lib/index.php?lang=es&amp;id=amd01">es</a><a href="/lib/index.php?lang=it&amp;id=amd01">it</a><a href="/lib/index.php?lang=fr&amp;id=amd01">fr</a><a href="/lib/index.php?lang=pl&amp;id=amd01">pl</a><a href="/lib/index.php?lang=ru&amp;id=amd01">ru</a><a href="/lib/index.php?lang=ua&amp;id=amd01">ua</a></div>
</body>
</html>
