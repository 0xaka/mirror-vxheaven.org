<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Holger Pawlita 'Virentechniken: Analyse und Metamorphismus' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Holger Pawlita"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Pawlita, Holger,Virentechniken: Analyse und Metamorphismus, anti, skript, anfang, code, sind, boot, immer, unternehmen, engine, software, programms, makro, arbeitsspeicher, keine, programm"/>
<meta name="Description" content="Vorliegende Ausarbeitung beginnt mit einer Einführung in das Thema und einer Definition des Begriffs „Virus“. Im Hauptteil werden zunächst die diversen Virenarten erläutert und zu ihnen einige Beispiele genannt. Sodann wird auf die Techniken eingegangen, die moderne Viren benutzen, um sich vor Scannern zu schützen, sich zu replizieren oder einfach nur das System zu schädigen. Auch hier runden einige Beispiele die Darstellung ab. Abschließend wird ein Ausblick auf die voraussichtliche Entwicklung der Virentechniken in der PC- und Server-Welt für die nächsten Jahre gegeben."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"7e1fd89c09f5e7800c32c7cc1c87e05e40f98c37-1498757802-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/ahp00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Virentechniken: Analyse und Metamorphismus</h1><p><a href="/lib/?lang=de&amp;author=Pawlita%2C%20Holger">Holger Pawlita</a><br/></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/ahp00.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Virentechniken%3A%20Analyse%20und%20Metamorphismus.pdf">Download</a> PDF (64.07Kb) (Du musst im <a href="/forum">Forum</a> registriert sein)<br/>[<a style="" href="/lib/?lang=DE&amp;index=AV#ahp00">zurück zum Index</a>] [<a href="/lib/ahp00.html#disqus_thread">Kommentare</a>]<br/> 
<ul>
<li><a href="#c0">Abstract</a></li>
<li><a href="#c1">1 Einleitung</a></li>
<li><a href="#c2">2 Definition</a></li>
<li><a href="#c3">3 Taxonomie der verschiedenen Virengruppen</a>
<ul>
<li><a href="#c31">3.1 Bootviren</a></li>
<li><a href="#c32">3.2 Dateiviren</a>
<ul>
<li><a href="#c321">3.2.1 Überschreibende Dateiviren</a></li>
<li><a href="#c322">3.2.2 Verlängernde/Parasitäre Viren</a></li>
<li><a href="#c323">3.2.3 Nicht-verlängernde Viren (Cave/Spacefiller/Cavity)</a></li>
</ul></li>
<li><a href="#c33">3.3 Makro-Viren</a></li>
<li><a href="#c34">3.4 Skript-Viren</a></li>
<li><a href="#c35">3.5 Weitere Virenarten</a></li>
</ul></li>
<li><a href="#c4">4 Virentechniken</a>
<ul>
<li><a href="#c41">4.1 Stealth</a></li>
<li><a href="#c42">4.2 Tunneln</a></li>
<li><a href="#c43">4.3 Selbsterkennung</a></li>
<li><a href="#c44">4.4 Speicherresidente Viren</a></li>
<li><a href="#c45">4.5 Selbstverschlüsselung</a></li>
<li><a href="#c46">4.6 Polymorphismus</a></li>
<li><a href="#c47">4.7 Oligomorphismus</a></li>
<li><a href="#c48">4.8 Metamorphismus</a></li>
<li><a href="#c49">4.9 EPO</a></li>
<li><a href="#c4a">4.10 Weitere Techniken</a></li>
</ul></li>
<li><a href="#c5">5 Ausblick</a></li>
<li><a href="#c6">6 References</a></li>
</ul>
<h2><a name="c0"></a>Abstract</h2>
<p>Vorliegende Ausarbeitung beginnt mit einer Einführung in das Thema und einer Definition des Begriffs „Virus“. Im Hauptteil werden zunächst die diversen Virenarten erläutert und zu ihnen einige Beispiele genannt. Sodann wird auf die Techniken eingegangen, die moderne Viren benutzen, um sich vor Scannern zu schützen, sich zu replizieren oder einfach nur das System zu schädigen. Auch hier runden einige Beispiele die Darstellung ab. Abschließend wird ein Ausblick auf die voraussichtliche Entwicklung der Virentechniken in der PC- und Server-Welt für die nächsten Jahre gegeben.</p>
<h2><a name="c1"></a>1 Einleitung</h2>
<p>Viren sind eine ernstzunehmende Gefahr. Sie können zwar die Hardware nicht beschädigen, führen aber zu Daten- und Zeitverlust, Zusammenbruch von Netzwerken, Unterbrechung kritischer Geschäftsprozesse etc. Für den privaten Anwender mag dies verschmerzbar sein, so sind sie für Unternehmen ein grosses Problem. Laut Trend Micro, einem der weltweit grössten Hersteller von Antiviren-Software, belief sich der Schaden, der durch Virenattacken ausgelöst wurde, im Jahre 2003 auf 55 Milliarden US-Dollar. Das entspricht einer Verdopplung der Kosten zum Jahr 2002. Angesichts dieser enormen Zahlen ist das Gebiet Security immer mehr ins Sichtfeld grosser Unternehmen gestossen. Gerade für CIOs und das IT-Management ist sie ein grosses Thema. Die Kenntnis der verschiedenen Virenattacken und geeigneter Tools zu ihrer Abwehr ist für die betroffenen Unternehmen und für die Softwareindustrie von hohem Interesse.</p>
<h2><a name="c2"></a>2 Definition</h2>
<p>Unter einem Virus versteht man ein Stück Programmcode - meistens in Assembler oder Macroscript geschrieben -, das selbstständig läuft, sich selbst immer wieder replizieren kann und sich an Dateien oder Laufwerke anhängt. Einige Viren sind so konstruiert, dass sie sich selbst über das Netzwerk verschicken und Sicherheitssysteme umgehen können. Viren sind Programme, die sich durch Befall und Änderung anderer (Programm)-Dateien verbreiten. Diese schädlichen Programme benötigen also einen Wirt. Manche Viren löschen oder verändern Daten, die sich auf dem PC befinden.</p>
<h2><a name="c3"></a>3 Taxonomie der verschiedenen Virengruppen</h2>
<h3><a name="c31"></a>3.1 Bootviren</h3>
<p>Bootviren sind Viren, die sich im Bootblock bzw. im MBR<sup><a href="#f1" name="b1">1</a></sup> oder DBR<sup><a href="#f2" name="b2">2</a></sup> von Festplatten oder im FBR<sup><a href="#f3" name="b3">3</a></sup> von Disketten einnisten. Jeder Datenträger besitzt so einen speziellen Sektor, der zuallererst geladen wird. Im Gegensatz zu nicht-bootfähigen Trägern, beinhaltet dieser bei bootfähigen Trägern wichtige Informationen wie Initialisierung der Hardware oder Routinen zum Testen. Wird ein System von einem infizierten Datenträger gebootet, wird zuerst der Virus ausgeführt, der sich dadurch auf Bootblocks anderer Träger verbreiten kann. Der MBR wird gelesen und analysiert, um die physikalische Adresse der Bootsektoren zu finden. Ein Virus dieser Sorte lagert den originalen Bootsektor an eine andere Stelle des Datenträgers aus und überschreibt zusätzlich den Bootsektor mit seinem eigenen Virencode. Dieser installiert den Virus im Arbeitsspeicher und startet letztendlich den originalen verschobenen Bootblock, der normalerweise das OS<sup><a href="#f4" name="b4">4</a></sup> lädt oder jetzt eigene Prozeduren ausführt.</p>
<p>Noch aggressivere Varianten wie der <em>Saddam-Hussein</em>-Virus verschlüsseln zusätzlich den verschobenen MBR und unterbinden jeglichen Zugriffsversuch darauf. Andere Beispiele: <em>Michelangelo, SubSeven</em>.</p>
<h3><a name="c32"></a>3.2 Dateiviren</h3>
<p>Die Dateiviren zählen allgemein als die häufigste Virenart. Ihre Eigenart besteht darin, dass sie ausführbare Programme befallen. Die meisten Computerviren haben sich auf eine Dateiart spezialisiert, z.B. EXE, COM, SYS, DLL...</p>
<p>Wird ein infiziertes Programm ausgeführt, wird vor der eigentlichen Programmausführung der Virus gestartet, der sich daraufhin in andere Programme hineinkopiert und durch deren Weitergabe auf andere Systeme verbreiten kann.</p>
<h4><a name="c321"></a>3.2.1 Überschreibende Dateiviren</h4>
<p>Diese Virenart zerstört bei ihrem Aufruf die Originaldatei entweder komplett oder teilweise bzw. ersetzt Programmcode und macht damit das Programm unwirksam. Ihre Größe ist sehr gering. Ihre Verbreitung ist nicht sehr groß, fallen sie doch durch die Zerstörung der Programme recht schnell auf. Beispiel: <em>Banana</em></p>
<h4><a name="c322"></a>3.2.2 Verlängernde/Parasitäre Viren</h4>
<p>Ein Vertreter dieser Gruppe lässt i.A. die Originaldatei bzw. das Wirtsprogramm unbeschädigt. Stattdessen schreibt sich der Virus entweder an das Ende des Programms oder setzt sich an den Anfang des Wirtes und schiebt ihn nach hinten.</p>
<p>Bei der zweiten Variante kopiert der Virus die ersten Bytes eines Programms ans Ende, hängt den eigentlichen Virencode an und überschreibt den gesicherten Anfang des Programms durch einen Sprungbefehl auf den Virencode. Beim Start des Programms erfolgt dann ein Sprung auf den schädlichen Code. Dieser installiert den Virus im System, kopiert den gesicherten Anfang des Programms wieder an den Anfang zurück und startet das Programm regulär durch einen Sprung auf diesen Programmanfang.</p>
<h4><a name="c323"></a>3.2.3 Nicht-verlängernde Viren (Cave/Spacefiller/Cavity)</h4>
<p>Manche Compiler erzeugen in ihren übersetzten Programmen an bestimmten Stellen Höhlen (Caves) mit langen Folgen von sich wiederholenden Zeichen, oftmals binäre Nullen. In diese Caves nistet sich der Virus ein und speichert zusätzlich die Anzahl der vorhandenen Stellen. Damit macht der Virus eine spätere Wiederherstellung des Originalcodes möglich. Eine Aufteilung auf mehrere Höhlen beherrschen manche Vertreter wie der <em>CIH</em>.</p>
<p>Beispiele: <em>Jerusalem, AntiEXE</em> oder <em>CIH</em>.</p>
<h3><a name="c33"></a>3.3 Makro-Viren</h3>
<p>Dieser Virus bedient sich der mächtigen Makrosprache der Textverarbeitung. Makroviren unterscheiden sich von den anderen Viren darin, dass sie keine ausführbaren Programme befallen, sondern Datendateien, die beim Öffnen den Makro-Virus starten und im Weiteren andere Dateien dieses Typs schädigen.</p>
<p>Der erste bekannte Word-Makro-Virus war DMV. Der erste Virus itw<sup><a href="#f5" name="b5">5</a></sup> hiess <em>Concept</em>, der sich einer extremen „Beliebtheit“ erfreute, da es damals noch keine Sicherheitsvorkehrungen gab.</p>
<p>Word-Basic war eine vollständige Programmiersprache und erlaubte so die Erstellung von Viren, die auf allen Systemen mit Word- oder Office-Umgebung liefen. Die Makros wurden dann von den Programmen interpretiert und erlaubten die ersten system-unabhängigen „cross-platform“-Infektionen. Damit wurde ein Grundsatz, der bis dahin galt, verletzt und nichtig gemacht: nämlich, dass ein Virus nicht von einem zu einem anderen Typen von Computer wechseln kann.</p>
<p>Beispiele: <em>Nuclear, WM/ Concept, WM97/Melissa</em></p>
<h3><a name="c34"></a>3.4 Skript-Viren</h3>
<p>Ähnlich zu den Batch-Viren versteht man unter Skript-Viren ganz normale Programm-Viren, die kein ausführbares Programm darstellen, sondern ein interpretiertes Skript. Im Gegensatz zu den normalen Viren modifizieren diese aber keine Programme, sondern erstellen eigene Dateien mit dem Skript-Viren-Code. Das Programm verwendet dazu bestehende Datendateien, löscht diese und legt eine entsprechende Skript-Datei mit doppelter Dateiendung an. Beim Anklicken der Datei wird dann aber der Skript-Virus ausgeführt und nicht die vermeintliche Datendatei geöffnet. Beispiel: Anna Kournikova!.jpg.vbs.</p>
<h3><a name="c35"></a>3.5 Weitere Virenarten</h3>
<ul>
<li>Source-Code-Viren
<p>Diese Viren können sich in Programm-Quellcode einkopieren und dann beim Kompilieren und nachfolgendem Ausführen des Programms aktiviert werden.</p></li>
<li>Companions
<p>Companion-Viren verändern nicht den Programmcode, sondern legen eigene Programmdateien mit einer anderen Endung an, die dann statt des eigentlichen Programms ausgeführt werden.</p></li>
<li>Batch-Viren
<p>Sie sind nichts anderes als DOS-Batch-Dateien, die andere Batch-Dateien infizieren können, indem sie diese durch eigenen Code überschreiben.</p></li>
<li>Multipartite Viren
<p>Unter multipartiten Viren, die auch als Hybridviren bekannt sind, versteht man Kombinationen aus Boot- und Dateiviren. Der Vorteil für die programmierenden Angreifer ist die Ausnutzung beider möglichen Infektionswege. Beispiel: <em>Tequila</em></p></li>
</ul>
<h2><a name="c4"></a>4 Virentechniken</h2>
<p>Nach der einführenden Beschreibung der wichtigsten Viren und deren Derivaten, werden nun einige Konzepte bzw. Techniken vorgestellt, die moderne Viren nutzen, um vor den Anti-Viren-Scannern unbemerkt zu bleiben.</p>
<h3><a name="c41"></a>4.1 Stealth</h3>
<p>Bestimmte Viren (auch unter dem Namen „Tarnkappenviren“ bekannt) bedienen sich sog. Stealth-Techniken, um ihre Anwesenheit zu verschleiern. Sie nutzen dabei die Möglichkeit, Systemkommandos zu modifizieren. Einige Viren prüfen z.B. beim Öffnen einer Datei, ob eben diese Datei schon viral ist und filtern dann beim Einlesen den Virus-Code heraus, der daraufhin ausgeführt wird. So werden die Virenscanner überlistet, die ja auf die Systemkommandos wie Öffnen und Lesen einer Datei angewiesen sind und so die Infektion nicht erkennen.</p>
<p>Andere nisten sich in Systemkommandos ein, um die veränderte Längenänderung einer Datei, die sich durch die Infektion zwangsläufig ergibt, vor den Virenscannern zu verschleiern. Dadurch dass sie jeglichen Zugriff auf die infizierten Wirte kontrollieren, sind diese Viren meist schwer feststellbar.</p>
<p>Der Virus <em>Brain</em>, der auch der erste DOS-Virus war, besaß eine derartige Stealth-Routine. Dabei lenkte er auf physikalischer I/O-Ebene Zugriffe auf <em>Brain</em>-infizierte Bootsektoren auf den originalen Bootsektor um. Nachteil dieser Technik besteht darin, dass der Virus resident im Speicher sein muss, um solche Modifikationen durchführen zu können. Virenscanner können dies aber beim Durchsuchen des Speichers feststellen.</p>
<h3><a name="c42"></a>4.2 Tunneln</h3>
<p>Diese Virenart versucht hauptsächlich Antiviren-Software auszuhebeln. Sie suchen nach den originalen Interrupt-Handlern für DOS und BIOS, um diese dann direkt aufzurufen. Hierdurch werden eventuelle Wächterprogramme unter DOS umgangen, die sich gerade in diese Interrupts eingeklinkt haben, um Virenaktivitäten erkennen zu können. Zum Beispiel blockiert der Virus <em>W32/MTX</em> sowohl E-Mails an Antiviren-Hersteller als auch Aufrufe an deren Homepages. So ist es dem Opfer nicht möglich, ein Antiviren-Programm oder ein Update herunterzuladen.</p>
<h3><a name="c43"></a>4.3 Selbsterkennung</h3>
<p>Um eine mehrfache Infektion zu vermeiden und dadurch eventuell aufzufallen, wie etwa die Urform des <em>Jerusalem</em>-Virus, muss sich der Virus irgendwie selbst identifizieren. Unter speicherresidenten DOS-Viren ist die Einrichtung eines "Are You There“-Calls beliebt. Dabei wird eine MS-DOS Systemfunktion verbogen, sodass der Aufruf mit dem vom Betriebssystem normalerweise ignorierten Parameter einen definierten Rückgabewert ergibt. Eine andere Möglichkeit, die nur sehr wenige Viren nutzen, ist, so wie Antiviren-Programme den Arbeitsspeicher nach sich selbst zu scannen. Entweder wird nach einer Kennmarke gesucht oder nach dem Viruscode selbst.</p>
<h3><a name="c44"></a>4.4 Speicherresidente Viren</h3>
<p>Wenn sich nach Beenden eines infizierten Programms der Viruscode oder Teile im Arbeitsspeicher befinden, so spricht man von einem TSR<sup><a href="#f6" name="b6">6</a></sup>- oder residenten Virus. Diese Viren bleiben nach der ersten Ausführung im Arbeitsspeicher aktiv bis zum Ausschalten des PCs. Dabei klinken sie sich in der Regel in Systemfunktionen/Interrupts ein. Wenn eine dieser abgefangenen Systemfunktionen aufgerufen wird, erhält zuerst der Virencode die Kontrolle, und der Virus kann eine Datei oder einen Sektor infizieren, auf den das System zugreift. Danach wird die Kontrolle an die eigentlich aufgerufene Systemfunktion übergeben. Manche Viren wie der <em>DenZuk</em> schaffen es sogar, einen Softboot (Strg+Alt+Entf) zu überleben.</p>
<h3><a name="c45"></a>4.5 Selbstverschlüsselung</h3>
<p>Bei dieser Technik versucht der Virus der Suchmethode nach Zeichenfolgen (sogenannte „Scanstrings“) durch Verschlüsselung zu entgehen. Die Viren verschlüsseln dabei den Hauptteil ihres Codes mit einem veränderlichen Schlüssel, um bei Scans nicht allzu anfällig zu sein, und lassen nur die Entschlüsselungsroutine unverschlüsselt im Viruscode. Verschlüsselte Viren bestehen somit aus mindestens einer Entschlüsselungsfunktion (Decryptor) und dem Hauptcode. Der Decryptor entschlüsselt den Hauptvirencode, damit dieser ausgeführt werden kann. Verschlüsselte Viren verwenden in der Regel feste oder variable Entschlüsselungsroutinen, während der Decryptor eines polymorphen Virus zufällig aus Prozessoranweisungen generiert wird und zahlreiche Befehle enthält, die für den Entschlüsselungsvorgang nicht benötigt werden. Am Beginn des Codes befindet sich eine Entschlüsselungsroutine, die dann den Virusbody direkt in den Arbeitsspeicher entpackt. Diese Viren haben eine Schwachstelle: nämlich die Entschlüsselungsroutine selbst, denn bei den einfachen Viren ändert sich diese nicht. Eine andere gebräuchliche Art der Verschlüsselung ist es, den Virus mit einem Laufzeitpacker wie PkLite, Diet oder UPX zu komprimieren.</p>
<h3><a name="c46"></a>4.6 Polymorphismus</h3>
<p>Polymorphe Viren verschlüsseln sich ebenfalls. Aber im Gegensatz zu den eigentlichen Verschlüsselungsviren benutzen sie neben einer unbegrenzten Anzahl von Decryptoren zusätzlich mehrere verschiedene Verschlüsselungsmethoden. Das macht die Arbeit für Virenscanner deutlich schwerer. Müssen sie nun nicht nur eine, sondern gleich mehrere verschiedene Verschlüsselungsroutinen erkennen.</p>
<p>Wie der Name schon sagt<sup><a href="#f7" name="b7">7</a></sup> können polymorphe Viren ihre Form ändern, d.h. sie enthalten keine festen Zeichenfolgen, und können sich somit vor Virenscannern als harmlos darstellen. Polymorphe Viren richten sich hauptsächlich gegen Signatur-Scanner, die das Dateisystem nach bestimmten Codesequenzen absuchen. Der Decryptor ändert sich komplett bei jeder neuen Infektion, so dass keine Kopie aussieht wie die andere, aber trotzdem seine Funktion gleich bleibt. Sie können ihren Code so variieren, dass unter mehreren verschiedenen Virenvarianten kaum gleiche Codestücke zur Verwendung in Virenscannern vorhanden sind. Jedes Mal, wenn der Virus eine Wirtsdatei befällt, verändert er die Entschlüsselungsroutine und/oder den Chiffrierschlüssel. Die Chiffrierung maskiert den Hauptteil des Virus, so dass eine Erkennung mittels einer Signatur nur schwer möglich ist.</p>
<p>Man unterscheidet bei den polymorphen Viren verschiedene Komplexitätsgrade. Z.B. könnten <em>mehrere Decryptoren</em> verwendet werden, von denen einer ausgesucht wird. Weiter lassen sich für jedes Teilstück <em>variable Instruktionen</em> verwenden, von denen jedesmal eine ausgewählt wird. <em>Garbage</em> bzw <em>Junk Code</em> sind Codestücke, die im Grunde völlig nutzlos sind, bzw. den Decryptor in seiner Funktionsweise nicht beeinträchtigen. Diese verhindern die Erzeugung von Scanstrings, da jedes Mal andere neutrale Befehle in den Decryptor eingefügt wird. Es gibt polymorphe Viren, die <em>Calls</em> und <em>Jumps</em> in den Decryptor einfügen, so dass der Code undurchsichtiger wird. Zusätzlich ist die <em>Vertauschung der Reihenfolge</em> der Instruktionen möglich. Polymorphe Engines, die alle vorangegangenen Fähigkeiten besitzen, gelten als recht effektiv. <em>Permutation</em> ist eine ganz andere Technik. Hierbei wird der Virus in verschiedene Teile zerstückelt (Suche nach Dateien, Infektion, Payload<sup><a href="#f8" name="b8">8</a></sup>) und die Reihenfolge dieser Teile vertauscht.</p>
<p>Ähnlich wie bei den Virus Construction Kits (Virenbaukästen) erschienen bald die ersten fertigen polymorphen Verschlüsselungsgeneratoren wie die MtE<sup><a href="#f9" name="b9">9</a></sup>, die als OBJ-Datei wie ein Baustein nur noch in einen bereits bestehenden Virus eingebunden werden und so jeden möglichen Virus mit polymorphen Eigenschaften aufrüsten konnten. Die MtE ist der am weitesten verbreitete polymorphe Codegenerator und findet z.Zt. in ca. 36 verschiedenen Viren seine Anwendung.</p>
<h3><a name="c47"></a>4.7 Oligomorphismus</h3>
<p>Eine kleine Abart zum Polymorphismus bildet der Oligomorphismus. Bei der Entschlüsselung entnehmen oligomorphe Viren die Schlüssel im Gegensatz zu polymorphen Viren, die ihre Schlüssel unbegrenzt neu erzeugen können, aus einer Liste.</p>
<h3><a name="c48"></a>4.8 Metamorphismus</h3>
<p>Metamorphismus ähnelt sehr dem Polymorphismus. Aber während polymorphe Viren nur verschiedene Entschlüsselungsroutinen generieren können, können metamorphe Schädlinge ganzen variablen Code erzeugen und besitzen keinen Decryptor. Man muss sich die Meta-Engine wie eine Black Box vorstellen, in den man den gewünschten zu verändernden Code eingibt und diese dann daraus den veränderten Code ausgibt, der sich syntaktisch vom Input unterscheidet, aber von der Funktionalität gleich ist. Sie besitzen i.G. zu den polymorphen Viren keinen konstanten Virus-Body. Das macht metamorphe Viren besonders knifflig für Virenscanner.</p>
<p>Wieder kann man die Level einer metamorphen Engine klassifizieren nach folgenden Features: <em>Neugenerierung des Virus-Code, Code Reduction, Code Expansion, Replication und Permutation</em>. Die Features einer metamorphen Engine laufen pseudozufällig ab. Daher treten einige von ihnen mit sehr geringer Wahrscheinlichkeit auf, d.h. die Länge des Codes kann bei jeder Ausführung des Virus variieren. Zusätzlich kann man die Komplexität auch noch hinsichtlich ihrer Schichten einteilen. <em>Win32.LTX</em> z.B. kann die Meta-Engine vier- bis siebenmal aufrufen und so über dem eigentlichen Virus-Code vier bis sieben Schichten aufbauen.</p>
<h3><a name="c49"></a>4.9 EPO<sup><a href="#fa" name="ba">10</a></sup></h3>
<p>Der erste parasitäre Virus <em>Impanate</em> verbarg sich bei einer Infektion, indem er sich in den Programmfluss eintrug ohne dabei den originalen Einsprungspunkt („Entry Point“) der Software zu ändern. Unter dem „Entry Point“ versteht man i.A. die Stelle, an der der eigentliche Programmcode in der Software beginnt. Er geht also bei der Datei-Infektion nicht den einfachen Weg und schreibt seinen Code an den Anfang oder Ende der zu infizierenden Datei, sondern schreibt sich in irgendeine Funktion in der Mitte. Auf diese Weise wird die Entdeckung durch Anti-Viren-Software sehr erschwert. Der Virus-Code wird dann aber nur ausgeführt, wenn die Routine, die den Virus enthält, aufgerufen wird. Wenn diese Routine nur selten ausgeführt wird, kann es sein, dass der Virus eine lange Zeit untätig ist. Beispiele: <em>Zmist, Simile.D</em></p>
<h3><a name="c4a"></a>4.10 Weitere Techniken</h3>
<ul>
<li><strong>AntiBait</strong>
<p>Dateien werden vor dem Infizieren auf AV-Köder-Eigenschaften überprüft.</p></li>
<li><strong>Anti-Debugging</strong>
<p>Der Virus enthält Teile, die es schwerer machen ihn zu debuggen/disassemblen.</p></li>
<li><strong>Anti-Heuristic</strong>
<p>Der Virus ist so programmiert, dass ein AV-Programm ihn nicht als Virus erkennt.</p></li>
<li><strong>Anti-Removal</strong>
<p>Der Virus enthält Code, der es erschwert, ihn zu entfernen.</p></li>
<li><strong>Anti-AV/Retro-Virus</strong>
<p>Der Virus greift aktiv Anti-Viren-Programme an. Weiter können derartige moderne Viren die Scanner erkennen und überlisten (Beispiel <em>CW-Shredder</em>).</p></li>
<li><strong>Archiv-Infector</strong>
<p>Der Virus kann ZIP oder andere Archive öffnen und enthaltene Dateien infizieren.</p></li>
<li><strong>Replication</strong>
<p>Der Virus sucht aktiv in der Verzeichnisstruktur nach anfälligen Dateien.</p></li>
<li><strong>Dropper</strong>
<p>Bei Befall mit einem Dropper wird der eigentliche Virus erst später installiert oder gestartet, um sich so vor dem Zugriff des Anti-Viren-Scanners zu schützen.</p></li>
</ul>
<h2><a name="c5"></a>5 Ausblick</h2>
<p>Wer gedacht hat, dass Malicious Code-Programmierer Computer-Fachleute sein müssen, der irrt. Selbst aus den Kinderzimmern von heute finden neue Kreationen ihren Weg ins Netz. Weiterhin verstand man früher Viren-Schreiber als Vandalen. Heute programmieren sie häufig Malware, um damit Geld zu verdienen. Schließlich gehören Virenschreiber zu den gesuchtesten Leuten bei Anti-Viren-Software-herstellern. Angesichts immer neuer Ideen der Virenerfinder müssen sich die Viren-scanner immer raffiniertere Routinen zum Echtzeitschutz ausdenken. Auf Jahre hinaus ist ein Wettlauf zwischen Viren und Anti-Viren-Software zu erwarten. Der Trend geht klar zu metamorphen Viren mit polymorphen Eigenschaften. Und da Microsoft selbst schon in den Virenscannermarkt investiert und durch die Übernahme des rumänischen Software-Herstellers GeCAD deren Virusscan-Technik eingekauft hat, zeigt doch wie lukrativ dieser Markt ist. Aber nicht nur Windows ist bei den Hackern beliebt, es kommen nun auch häufiger Schädlinge für UNIX oder Mac OS in Umlauf. Neuestes Ziel scheint die Desktopsuche zu werden. Wie ein gefundenes Fressen sammeln sie Daten und katalogisieren sie sogar und bieten so ein interessantes Ziel für Angreifer.</p>
<p>Die Bedrohung nimmt zu. Laut den Antiviren-Software-Herstellern haben sich die 20 bis 40 neu registrierten Viren pro Tag seit 2003 fast verdoppelt. Auch 38 % aller deutschen Unternehmen schätzen das „Virenrisiko“ momentan höher ein als noch vor einem Jahr, nur 20 % fühlen sich weniger bedroht.</p>
<h2><a name="c6"></a>6 References</h2>
<ul>
<li>Krauß, Thomas: Viren, Würmer und Trojaner. Interest Verlag 2004</li>
<li>http://www.computerbase.de/news/internet/hacker_sicherheit/2004/dezember/desktopsuche_ziel_virenschreibern/</li>
<li>http://www.fuhs.de/de/fachartikel/buch/index.shtml</li>
<li>http://vx.netlux.org/lib/static/vdat/epmetam2.htm</li>
<li>http://www.hackernetwork.de/</li>
<li>http://www.snake-basket.de/d/faq.txt</li>
<li>http://www.irc-security.de/?go=viren</li>
<li>http://www.f-secure.de/v-desk/virus.shtml</li>
<li>http://www.ecs.syr.edu/Faculty/popyack/Lectures/Feb6/feb6.html</li>
<li>http://www.securityfocus.com/virus</li>
<li>http://securityresponse.symantec.com/avcenter/reference/hunting.for.metamorphic.pdf</li>
</ul>
<hr size="1"/>
<p><a name="f1" href="#b1">1</a> Master Boot Record</p>
<p><a name="f2" href="#b2">2</a> DOS Boot Record</p>
<p><a name="f3" href="#b3">3</a> Floppy Boot Record</p>
<p><a name="f4" href="#b4">4</a> Operating System</p>
<p><a name="f5" href="#b5">5</a> itw = in the wild</p>
<p><a name="f6" href="#b6">6</a> Terminate and Stay Resident in memory</p>
<p><a name="f7" href="#b7">7</a> <em>griech.</em> poly ~ viel und morphein ~ Gestalt</p>
<p><a name="f8" href="#b8">8</a> erst durch die darin enthaltenen Schadensroutinen wird die Malware zum Schädling</p>
<p><a name="f9" href="#b9">9</a> Mutation Engine</p>
<p><a name="fa" href="#ba">10</a> Entry Point Obscuring</p>
[<a style="" href="/lib/?lang=DE&amp;index=AV#ahp00">zurück zum Index</a>] [<a href="/lib/ahp00.html#disqus_thread">Kommentare</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=ahp00">de</a><a href="/lib/index.php?lang=en&amp;id=ahp00">en</a><a href="/lib/index.php?lang=es&amp;id=ahp00">es</a><a href="/lib/index.php?lang=it&amp;id=ahp00">it</a><a href="/lib/index.php?lang=fr&amp;id=ahp00">fr</a><a href="/lib/index.php?lang=pl&amp;id=ahp00">pl</a><a href="/lib/index.php?lang=ru&amp;id=ahp00">ru</a><a href="/lib/index.php?lang=ua&amp;id=ahp00">ua</a></div>
</body>
</html>
