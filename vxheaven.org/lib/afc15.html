<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Fred Cohen 'A Cost Analysis of Typical Computer Viruses and Defenses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Fred Cohen"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Cohen, Fred,Cost Analysis of Typical Computer Viruses and Defenses, computer, backups, cost, shells, change, viruses, environment, term, binary, ﬁles, integrity, cryptographic, checksums, cover, information"/>
<meta name="Description" content="Various properties of computer viruses have been studied at length by many authors [1], but one of the areas where research results are relatively rare is evaluation of the costs of defenses. In this paper, we explore the costs of computer virus defenses in typical computing environments."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"7da390b40133b5b9edff6607fe327a14c893cb14-1498755968-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/afc15.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>A Cost Analysis of Typical Computer Viruses and Defenses</h1><p><a href="/lib/?lang=en&amp;author=Cohen%2C%20Fred">Fred Cohen</a><br/> <em>Computers & Security, Volume 10, Issue 3, pp.239-250</em><br/> <em>ISSN 0167-4048</em><br/> <em>May 1991</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/afc15.html';</script><div class="ci"><a href="/lib/?ci=afc15">6</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/A%20Cost%20Analysis%20of%20Typical%20Computer%20Viruses%20and%20Defenses.pdf">Download</a> PDF (91.28Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=TH#afc15">Back to index</a>] [<a href="/lib/afc15.html#disqus_thread">Comments</a>]<br/> <form method="post" action="">
<img src="/img/cache/0b9fd596a90421f9f1f68a9760275737.gif" alt="\text{T_EX size}" valign="middle"/>
<select name="TeX_size"><option value="-2">-2</option><option value="-1">-1</option><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select>
<input type="submit" value="Scale"/>
</form>
<ul>
<li><a href="#c0">Abstract</a></li>
<li><a href="#c1">1 Background</a></li>
<li><a href="#c2">2 Notation and Assumptions</a></li>
<li><a href="#c3">3 Analysis of Virus Scanners</a></li>
<li><a href="#c4">4 Analysis of Virus Monitors</a></li>
<li><a href="#c5">5 Analysis of Cryptographic Checksums</a></li>
<li><a href="#c6">6 Analysis of Integrity Shells</a></li>
<li><a href="#c7">7 Cost Comparisons</a></li>
<li><a href="#c8">8 Eﬀects of Pre-Interpretation Checks</a></li>
<li><a href="#c9">9 Eﬀects of High Performance</a></li>
<li><a href="#ca">10 Eﬀects of Online Backups and Automated Repair</a></li>
<li><a href="#cb">11 Eﬀects of Cleaning Up Backups</a></li>
<li><a href="#cc">12 Cryptographic Checksum Maintenance</a></li>
<li><a href="#cd">13 Summary, Conclusions, and Further Work</a></li>
<li><a href="#ce">References</a></li>
</ul>
<p><em>Search Terms: Computer Viruses, Computer Risk Analysis</em></p>
<p><small>Copyright &copy; ASP, 1990 ASP Press, PO Box 81270, Pittsburgh, PA 15217</small></p>
<h2><a name="c0"></a>Abstract</h2>
<p>Various properties of computer viruses have been studied at length by many authors [1], but one of the areas where research results are relatively rare is evaluation of the costs of defenses. In this paper, we explore the costs of computer virus defenses in typical computing environments.</p>
<h2><a name="c1"></a>1 Background</h2>
<p>The major computer virus defenses in widespread use today are “scanners” [2], “monitors” [3], “cryptographic checksums” [4], and “integrity shells” [5]. Other practical techniques that are viable for this purpose, but have not been put into widespread use as virus defenses are limited function [6,7], limited sharing [6,7], and sound change control [8].</p>
<p>Virus scanners are programs that search for known computer viruses. They normally work by searching some of the ﬁles on a disk for known and easily detected viruses. Some scanners also use special indicators to detect harder to identify viruses. For example, some viruses force the seconds ﬁeld in the ﬁle modiﬁcation time under DOS to 61 seconds, and some scanners use this as an indicator of that virus. Most virus scanners only cover viruses in binary executable ﬁles and only cover viruses that have ﬁxed locations relative to the start of a program. Viruses with more complex infection mechanisms (e.g. random placement within a program), complex evolutionary viruses, and viruses that infect interpreted ﬁles (e.g. “Basic” viruses), are rarely scanned for by modern scanners. This is because these types of scans require complete examination of ﬁles, and thus a lot of time.</p>
<p>Cryptographic checksums are hard to forge many-to-one transforms that typically take a user supplied key and ﬁle, and produce a number [4]. By summing ﬁles with this technique and subsequently checking them on a regular basis, we can usually detect unauthorized changes, even when an attacker is trying to avoid detection.</p>
<p>Integrity shells are command interpreters that look for changes in interpreted information before interpreting it. They normally use cryptographic checksums for detection, can detect all primary infection and prevent all secondary infection, and are optimal for virus defense in untrusted systems [5]. Integrity shells can check all interpreted information, not just binary executable ﬁles.</p>
<p>Virus monitors are programs that look for known viruses each time an executable program is run. This is a special case of the integrity shell technique, where instead of using a cryptographic checksum to detect change, we look only for known viruses. Like scanners, monitors typically look only for viruses with simple infection mechanisms at known locations.</p>
<h2><a name="c2"></a>2 Notation and Assumptions</h2>
<p>We will abbreviate as follows:</p>
<table summary="">
<tr><td><img src="/img/cache/425801eab1cf896cb55b2f975e11330d.gif" alt="T_s" valign="middle"/> Total for scanner</td><td><em>s</em> systems</td></tr>
<tr><td><img src="/img/cache/0036ac1e1ae00ff6a59a729ecdb0ca91.gif" alt="T_c" valign="middle"/> Total for crypto checksum</td><td><em>c</em> checks/year</td></tr>
<tr><td><img src="/img/cache/0fb7878c9c075438f56bf019b6702ea6.gif" alt="T_m" valign="middle"/> Total for monitor</td><td><em>e</em> employee cost/min</td></tr>
<tr><td><img src="/img/cache/475b78897f974bc7658f55655285a0ff.gif" alt="T_i" valign="middle"/> Total for integrity shell</td><td><em>u</em> (d)(update-count)</td></tr>
<tr><td><img src="/img/cache/f35535c4e7d552b81d0e8bae47533f98.gif" alt="t_s" valign="middle"/> minutes per scan</td><td><img src="/img/cache/20054ac83fe5975c381297d700d32016.gif" alt="t_c" valign="middle"/> minutes per check</td></tr>
<tr><td><img src="/img/cache/0438878bb26a8c2bd0f7954904615acc.gif" alt="l_s" valign="middle"/> license for scanner</td><td><img src="/img/cache/b1c3ace081166024a4d1ebc17138f378.gif" alt="l_c" valign="middle"/> license crypto-checksum</td></tr>
<tr><td><img src="/img/cache/f8a7caa879dea19360191369dedb0c21.gif" alt="l_m" valign="middle"/> license for monitor</td><td><img src="/img/cache/b39335b6584e8455ab4de3c86b439e21.gif" alt="l_i" valign="middle"/> license integrity shell</td></tr>
<tr><td><img src="/img/cache/825b3fd5bafbc46b9a560ea9f16b21dd.gif" alt="a_n" valign="middle"/> new attacks</td><td><img src="/img/cache/d894c6de1c9809dc6f42d004466d7b3c.gif" alt="a_o" valign="middle"/> old attacks</td></tr>
<tr><td><img src="/img/cache/5c1e5e56899fb8e1fb3a2bcd890f390a.gif" alt="r_s" valign="middle"/> system cleanup costs</td><td><img src="/img/cache/c8b3c7427b35c675ae360d9da42397bb.gif" alt="r_f" valign="middle"/> ﬁle cleanup costs</td></tr>
<tr><td><img src="/img/cache/8277e0910d750195b448797616e091ad.gif" alt="d" valign="middle"/> distribution costs</td><td><img src="/img/cache/c02c4a71b77353b6618d5fb75c880ad7.gif" alt="o_i" valign="middle"/> comm-rate[K/c]</td></tr>
</table>
<p>Most of these terms are self explanatory, but a few are a bit obscure. The licensing cost for crypto-checksums and integrity shells is normally a one-time cost, whereas for scanners and monitors, regular updates force licenses to be paid over time. To compensate, we use 10% per year of the total licensing cost for integrity shells and crypto-checksums as an equivalent to the yearly licensing cost for scanners and monitors. oi is a term that describes the rate of spread of a virus, and has experientially been about 2 for a typical PC in a typical environment, and about 10 for a typical PC in a LAN environment. The update count is the number of times per year we do updates of scanners and monitors (which require updates to stay eﬀective), and the distribution cost is the cost of each distribution (or redistribution) and installation of a software package.</p>
<p>We will also assume, for comparison purposes, that all performance is measured relative to a 4 Mhz PC-XT with 65 msec hard disk drives. Many current processors are far faster. For example, it is not unusual to see a 32 Mhz PC with an 18msec hard disk, which would be from 20 to 30 times faster than our assumed performance levels. Performance variations will also be discussed later, so we hope to cover this diﬀerence at that time.</p>
<p>Another important assumption we make is that the number of attacks per year does not vary with the number of systems. This is clearly not a valid assumption in many cases. To compensate for this, we discuss the eﬀect of making the number of attacks linear in the number of systems.</p>
<h2><a name="c3"></a>3 Analysis of Virus Scanners</h2>
<p>Most scanners and monitors are licensed on a per system per year basis. They require regular updates and must be used on a regular basis in order to be eﬀective. They cover some viruses, and don’t cover others, and there is a signiﬁcant delay between the initial release of a virus and its inclusion in scanners and monitors. For most organizations, there is a substantial cost associated with the cleanup of a virus once detected. The more often we scan, the less a virus spreads before detection, but at the same time, scanning takes a signiﬁcant amount of time, and that time can be quite costly when spent on a large number of systems on a regular basis.</p>
<p>The yearly operating cost of performing checks, assuming that employees are relatively idle while the checks are being done, is the number of checks per year times the employee cost times the time required for each scan. The update cost is the cost of distribution and installation times the number of updates per unit time. The license fee is set contractually. All of these are linear in the number of systems being scanned, so the yearly operating cost of performing scans is calculated as follows:</p>
<div align="center">yearly-operating-cost=<img src="/img/cache/1ba3153a141789cdab4006d52d748fd4.gif" alt="s[cet_s + l_s + u]" valign="middle"/></div>
<p>Typical ﬁgures are; one check each working day (usually at bootup), US$20 per hour (1/3 of a dollar per minute) for idle employee costs, 3 minutes per bootup scan, US$10 per year for licensing fees, US$5 per update, and 4 updates per year. Thus the yearly operating cost per system of scanning comes to:</p>
<div align="center">((250)(1/3)(3)) + 10 + ((5)(4)) = 250 + 10 + 20 =$280/system/year</div>
<p>The most striking thing here is that licensing costs are the least important factor in the cost of scanning. Even the update cost, which tends to exceed licensing cost, is trivial compared to the cost of performing daily checks. By using weekly checks instead of daily checks, or by scheduling coﬀee breaks during checking times, the cost of checking can be dramatically reduced. Unfortunately, scanning is usually done at system startup, and employees tend to sit and wait for the system to become ready at startup.</p>
<p>If there are viruses in the environment, the situation changes considerably. For viruses that are not detected by the current version of the scanner, it is a reasonable assumption that they will spread throughout all of the systems in the environment over a period of days to months, depending on the communications methods in use. We also assume that eventually, a cleanup will be necessary or desired, and for the moment, we will assume that there are no side eﬀects of the virus such as data diddling, ﬁle deletion, etc. [9] Cleanup costs are assumed to include all down-time of equipment, employee time spent on cleanup, and time wasted while awaiting cleanup. Thus we calculate the “new attack cost” as follows:</p>
<div align="center">new-attack-cost=<img src="/img/cache/eabac3c819a1d85498ee7e555770e08c.gif" alt="a_n r_s s" valign="middle"/></div>
<p>It is hard to assess a typical environment today because of poor reporting, poor detection, and a general lack of statistical data on the subject. According to the IBM high integrity research laboratory [10], they don’t ﬁnd out about a virus until it has spread to about 10 major organizations. They were ﬁnding new viruses at a rate of more than one per week as of February, 1990. If a complete system cleanup costs $100, you would expect to spend $100 per system per year in cleanup costs from each new virus.</p>
<p>For known attacks that enter the environment, a regularly used scanning program can be quite eﬀective in limiting damage. The spread of a virus in a computing environment is actually quite complex, and substantial work has been done to make an accurate model [11]. Another less accurate model that assumes an inﬁnite population and homogeneous communications predicts (not surprisingly) exponential spread [12]. For simplicity, we will take the position that exponential spread occurs based on the communications rate, but is limited by the number of systems available for infection. Spread rate has been found to be 10 times larger in a networked environment than in an environment without networks [10], and clearly this should be taken into account. The old attack cost can then be calculated as:</p>
<div align="center">old-attack-cost=<img src="/img/cache/578501150fd06b78e2e91f7aee9c0035.gif" alt="a_o r_s \min[s,o_i]" valign="middle"/></div>
<p>In this model, as the checks per year goes down, the system tends towards increased cleanup costs. <em>K</em> can be calculated based on measured spread rates. Our observations have indicated that a virus in a non-networked environment spreads to 2 systems in the ﬁrst day, 4 in the second day, etc. Thus, for a comm-rate of 2 for non-networked systems (20 for LANs), a check every business day, cleanup costs of $100 per system, 3 old viruses per year, and any number of systems over 2, we get a yearly cleanup cost as follows:</p>
<div align="center">(3)($100)(min[(>2),<img src="/img/cache/3e96fc79b8123328ac2fc28632abb227.gif" alt="2^{250/250}" valign="middle"/>]=$600</div>
<p>For a LAN environment with 20 old viruses per year, 20 or more systems, and all other factors being equal, we get:</p>
<div align="center">(20)($100)min[(>20),<img src="/img/cache/9a11f745a045bebf58cbf0cf80d69f89.gif" alt="20^{250/250}" valign="middle"/>]=$40,000</div>
<p>If we try to reduce checking costs by only checking once per week, we ﬁnd that the expected loss from attacks goes up exponentially. For example, in the LAN environment above, we get:</p>
<div align="center">(20)($100)min[<img src="/img/cache/76def02a0155a8d05d46fd5876d3c17d.gif" alt="s,20^{250/50}" valign="middle"/>]=min[($2,000s),$200,000,000]</div>
<p>Checking often is very important in terms of reduced cleanup costs when viruses appear, and this tends to dominate all other factors when checks are done infrequently.</p>
<p>The total cost, not including any side eﬀects caused by viruses, is simply the sum of the costs we have given so far and a one-time initial distribution cost. The cost per system per year is then simply derived.</p>
<div align="center"><img src="/img/cache/425801eab1cf896cb55b2f975e11330d.gif" alt="T_s" valign="middle"/> = yearly-operating-cost + new-attack-cost + old-attack-cost + <em>d</em></div>
<div align="center">cost-per-system-per-year = <img src="/img/cache/51e9fc5030814f834b6eda307bf1846e.gif" alt="T_s/s" valign="middle"/></div>
<p>There are some other time related factors in considering the future of virus scanners. For example, a typical scanner (circa 1/1/90) on a PC-XT, took 3 minutes per scan and reliably scanned for about 50 ﬁle viruses. As of 9/1/90, these ﬁgures were up to over 200 viruses, and scan times of about 15 minutes. If this trend continues, we will see 1 hour scan times within the next year or two! If virus designers continue to improve their techniques, as they have been doing lately, scanners will have to begin full searches in order to be eﬀective against new strains of viruses. This will increase scanning times by at least an order of magnitude, and there is no reason to believe that other factors will compensate for this reduced performance.</p>
<h2><a name="c4"></a>4 Analysis of Virus Monitors</h2>
<p>Virus monitors are essentially the same as virus scanners except that they exploit the integrity shell concept to eliminate most of the cleanup costs and dramatically increase scanning rates without dramatically increasing scanning costs. Since a scan of each program is performed before it is run, like the integrity shell, a monitor detects primary infections and prevents secondary infection by known viruses. Some state-of-the-art monitors even have special purpose routines for removal of many known viruses, thus eliminating most of the costs of repair.</p>
<p>Because checking a single ﬁle for a known virus is currently very fast, there is no real penalty for the checking time. Thus we get the modiﬁed form of the scanner equation.</p>
<div align="center">yearly-operating-cost = <img src="/img/cache/cdf5d9489c7904a310b5cd9088fb2fe3.gif" alt="s[l_m + u]" valign="middle"/></div>
<p>Using the same basis as was used for scanners above and a $5 per year licensing cost, the cost per system for using monitors comes to only:</p>
<div align="center">5+(5)(4)=5+20=$25/system/year</div>
<p>In this scenario, we can even aﬀord to distribute new versions of the monitor every month and save money over the scanning program. At 12 distributions per year, we only get $65 per system per year, around 1/4 of the cost of scanning.</p>
<p>The cost of unmonitored attacks with a virus monitor are the same as the costs for a scanner, thus we get:</p>
<div align="center">new-attack-cost=<img src="/img/cache/eabac3c819a1d85498ee7e555770e08c.gif" alt="a_n r_s s" valign="middle"/></div>
<p>The cost for monitored attacks goes down considerably with a monitoring system because there is eﬀectively no delay between the introduction of a virus and its detection. In essence, a known virus planted in a program is detected before it is ever used, and thus before it can spread at all. The cleanup costs for monitored attacks is also very low, since it involves only the replacement of a single ﬁle.</p>
<div align="center">old-attack-cost=<img src="/img/cache/1eaac39ce5229a5f408e6d731408e31c.gif" alt="a_o r_f" valign="middle"/></div>
<p>With an automated cleanup facility, this cost goes to very nearly zero, but since the cost is so low to start, it does not have a noticeable impact on overall attack costs unless the number of known attacks is very large and the number of unknown attacks is very small.</p>
<p>As in the case with scanners, monitors have total costs as follows:</p>
<div align="center"><img src="/img/cache/0fb7878c9c075438f56bf019b6702ea6.gif" alt="T_m" valign="middle"/> = yearly-operating-cost + new-attack-cost + old-attack-cost + <em>d</em></div>
<div align="center">cost-per-system-per-year = <img src="/img/cache/182764dabc0a575d6739b12e46e6ee28.gif" alt="T_m/s" valign="middle"/></div>
<h2><a name="c5"></a>5 Analysis of Cryptographic Checksums</h2>
<p>Cryptographic checksums can be used in a manner similar to scanners, in that they are periodically run to check for the presence of viruses, but there are signiﬁcant diﬀerences between the two technologies.</p>
<p>The major disadvantage of cryptographic checksums is that they take longer than most current scanners because they have to perform analysis on the entire ﬁle instead of looking only in a few key places. Eventually, scanners will also have to do this to remain eﬀective (even now, some viruses cannot be detected by scanners without a ﬁll ﬁle scan), and when that time comes, cryptographic checksums will be faster because they perform simpler operations than the multiple string search operations required by full ﬁle scanners.</p>
<p>The major advantages of cryptographic checksums are that they detect (probabilistically) all modiﬁcations, and thus detect all viruses, whether previously known or previously unknown [4], and thus they don’t require updates. Current high speed cryptographic checksums operate at a rate of about 20 Kbytes per second on a standard PC-XT running at 4MHz. A 20Mbyte disk thus takes about 1,000 seconds to verify, or about 10-15 minutes depending on the ﬁle structure complexity. This is only 3 times the time required for a scanner circa 1/1/90, and comparable to the time for the most thorough scanners circa 9/1/90.</p>
<p>The yearly operating costs can be calculated as shown below. Notice that there are no update costs, but that for the time being <img src="/img/cache/20054ac83fe5975c381297d700d32016.gif" alt="t_c" valign="middle"/> is higher than <img src="/img/cache/f35535c4e7d552b81d0e8bae47533f98.gif" alt="t_s" valign="middle"/> by a factor of 1 to 3.</p>
<div align="center">yearly-operating-cost = <img src="/img/cache/50729dcd050110d654416169a3630906.gif" alt="s[cet_c + l_c]" valign="middle"/></div>
<p>There is a minor diﬃculty in calculating licensing costs because unlike scanners, checksum programs do not have to be periodically updated. As a result, they are usually purchased once, installed once, and paid for all at one time. To keep costs in yearly terms, we assume that the one-time cost of a checksum program is paid at a rate of 10% of the purchase cost per year. Thus, the yearly licensing cost of a checksum program is taken to be 1/10 of the one-time licensing cost.</p>
<p>Typical ﬁgures for a large number of systems are $50/system in licensing fees ($5/system/year). We can operate at 3 minutes/check if only executable ﬁles are checked (which is comparable to the case for scanners and monitors). Everything else remaining the same, so we come to a typical cost of:</p>
<div align="center">(250)(1/3)(3) + 5 = $255/system/year</div>
<p>As in the case of scanners, the dominant cost is the cost of using this technique every day. The cost of all attacks under a cryptographic checksum system are the same as the cost of known attacks for virus scanners, while the total costs are the sum of attack costs and checking costs.</p>
<div align="center">attack-cost = <img src="/img/cache/4ebd346da8d8715b474250cebbe3c0e3.gif" alt="(a_o + a_n)r_s \min[s,o_i]" valign="middle"/></div>
<div align="center"><img src="/img/cache/0036ac1e1ae00ff6a59a729ecdb0ca91.gif" alt="T_c" valign="middle"/> = attack-cost + yearly-operating-cost + <em>d</em></div>
<h2><a name="c6"></a>6 Analysis of Integrity Shells</h2>
<p>Integrity shells are similar to cryptographic checksums in that they don’t require updates, and similar to monitors in that they don’t have daily checking overhead and are optimal in their detection of attacks, thus preventing viral spread. Thus the yearly operating cost for integrity shells comes to only the licensing fee.</p>
<p>As with checksumming systems, integrity shells do not require periodic updates, so we will again treat the yearly licensing cost as 10% of the one-time licensing fee.</p>
<p>Attack related costs with integrity shells are the same as monitored attack costs for virus monitors. As with monitors, state-of-the-art integrity shells completely automate the repair process for known and unknown corruptions in most cases, but there is an overhead associated with this repair (this will be covered in detail later)</p>
<p>Thus we have the total cost of integrity shells as:</p>
<div align="center"><img src="/img/cache/8af41151d49c0ea7ebd415928dc71e7f.gif" alt="T_i = (a_o + a_n)r_f + sl_i + d" valign="middle"/></div>
<p>In large quantities, integrity shells cost about $50/system, which comes to a time deferred cost of $5/system/year. Assuming that there are 3 known and 2 unknown attacks per year, and that the cost for a single ﬁle cleanup is $10, the total yearly cost for integrity shells, including all costs of attack and defense, comes to only $[50+5s +5]! For an operation with 100 systems, this comes to a total of $555, or only $5.55/system/year.</p>
<h2><a name="c7"></a>7 Cost Comparisons</h2>
<p>We start by restating the total costs from the four techniques under consideration:</p>
<div align="center">
<p><img src="/img/cache/2e84200f2e3286f1a663242fa62dc2c5.gif" alt="T_s = s[cet_s + l_s + u] + a_n r_s s + a_o r_s \min[s, o_i] + d" valign="middle"/></p>
<p><img src="/img/cache/b918c3999601905a4967bc5cebd503e0.gif" alt="T_c = s[cet_c + l_c] + [a_n + a_o]r_s \min[s, o_i] + d" valign="middle"/></p>
<p><img src="/img/cache/9eb91586908f4e136f8282a57d08645a.gif" alt="T_m = s[l_m + u] + a_n r_s s + a_o r_f + d" valign="middle"/></p>
<p><img src="/img/cache/4c5aef3f8081058d59565bbb3c9de5ea.gif" alt="T_i = sl_i + [a_n + a_o]r_f + d" valign="middle"/></p>
</div>
<p>The assumed values used for comparison above were:</p>
<table summary="assumed values">
<tr><td><img src="/img/cache/4a8a08f09d37b73795649038408b5f33.gif" alt="c" valign="middle"/></td><td>250</td><td><img src="/img/cache/e1671797c52e15f763380b45e841ec32.gif" alt="e" valign="middle"/></td><td>1/3</td></tr>
<tr><td><img src="/img/cache/f35535c4e7d552b81d0e8bae47533f98.gif" alt="t_s" valign="middle"/></td><td>3</td><td><img src="/img/cache/20054ac83fe5975c381297d700d32016.gif" alt="t_c" valign="middle"/></td><td>3</td></tr>
<tr><td><img src="/img/cache/0438878bb26a8c2bd0f7954904615acc.gif" alt="l_s" valign="middle"/></td><td>5</td><td><img src="/img/cache/b1c3ace081166024a4d1ebc17138f378.gif" alt="l_c" valign="middle"/></td><td>5</td></tr>
<tr><td><img src="/img/cache/f8a7caa879dea19360191369dedb0c21.gif" alt="l_m" valign="middle"/></td><td>5</td><td><img src="/img/cache/b39335b6584e8455ab4de3c86b439e21.gif" alt="l_i" valign="middle"/></td><td>5</td></tr>
<tr><td><img src="/img/cache/825b3fd5bafbc46b9a560ea9f16b21dd.gif" alt="a_n" valign="middle"/></td><td>2</td><td><img src="/img/cache/d894c6de1c9809dc6f42d004466d7b3c.gif" alt="a_o" valign="middle"/></td><td>3</td></tr>
<tr><td><img src="/img/cache/5c1e5e56899fb8e1fb3a2bcd890f390a.gif" alt="r_s" valign="middle"/></td><td>100</td><td><img src="/img/cache/c8b3c7427b35c675ae360d9da42397bb.gif" alt="r_f" valign="middle"/></td><td>10</td></tr>
<tr><td><img src="/img/cache/8277e0910d750195b448797616e091ad.gif" alt="d" valign="middle"/></td><td>5</td><td><img src="/img/cache/c02c4a71b77353b6618d5fb75c880ad7.gif" alt="o_i" valign="middle"/></td><td>2 (no LAN)</td></tr>
<tr><td><img src="/img/cache/7b774effe4a349c6dd82ad4f4f21d34c.gif" alt="u" valign="middle"/></td><td>20</td><td><img src="/img/cache/c02c4a71b77353b6618d5fb75c880ad7.gif" alt="o_i" valign="middle"/></td><td>20 (LAN)</td></tr>
</table>
<p>We will assume for comparison purposes that <img src="/img/cache/023b31249905e847cdeeabfdb04ccc85.gif" alt="o_i \lt s" valign="middle"/> (i.e. we always detect viruses before all systems are infected), and thus simplify <img src="/img/cache/cbf5c1a5e1e6fce8c2f00afa56836588.gif" alt="\min[s, o_i]" valign="middle"/> to <img src="/img/cache/c02c4a71b77353b6618d5fb75c880ad7.gif" alt="o_i" valign="middle"/>.</p>
<p>To make comparisons, we will subtract equations. We begin by comparing <img src="/img/cache/425801eab1cf896cb55b2f975e11330d.gif" alt="T_s" valign="middle"/> to <img src="/img/cache/0036ac1e1ae00ff6a59a729ecdb0ca91.gif" alt="T_c" valign="middle"/> as follows:</p>
<div align="center"><img src="/img/cache/3f7b074da99bdd5bed084dc7f2e799ab.gif" alt="
\begin{eqnarray}
\text{Term 1} &amp; &amp; \text{Term 2}\\
T_s = s[cet_s + l_s + u]&amp;+&amp; a_n r_s s + a_o r_s o_i + d\\
T_c = s[cet_c + l_c] &amp;+&amp; [a_n + a_o]r_s o_i + d\\
T_s - T_c = s(ce[t_s - t_c] + [l_s - l_c + u]) &amp;+&amp; a_n r_s[s - o_i]
\end{eqnarray}
" valign="middle"/></div>
<p>Unless checking is so rare that all systems get infected before checking detects an infection, <img src="/img/cache/1521e3dfd6d15a8b7db4bc9c500057f6.gif" alt="o_i \ll s" valign="middle"/>, and dividing by <em>s</em>, we get a per system cost diﬀerence of:</p>
<div align="center"><img src="/img/cache/ce74776453ba62327dd95ec6d5dcc6e4.gif" alt="ce[t_s - t_c] + u + [l_s - l_c] + a_n r_s" valign="middle"/></div>
<p>With daily scanning or checking, any reasonable diﬀerence in licensing fees <img src="/img/cache/09356e3ef975f07cf22035434b036956.gif" alt="(l_s - l_c)" valign="middle"/> are dominated by scanning and checking costs <img src="/img/cache/32a60a8914d673797eee548d72eae245.gif" alt="(t_s - t_c)" valign="middle"/>. Update costs (<em>u</em>) also tend to dominate licensing fee diﬀerences for this sort of system, so we can simplify in most cases to:</p>
<div align="center"><img src="/img/cache/8871c8844ae733a0b61fe94b4e4f8a91.gif" alt="u - ce(t_c - t_s) + a_n r_s" valign="middle"/></div>
<p>so scanners are less expensive if and only if:</p>
<div align="center"><img src="/img/cache/f19e34d22c4398e4ceba4311b618ba50.gif" alt="u + a_n r_s \lt ce(t_c - t_s)" valign="middle"/></div>
<p>In other words, if update costs and recovery costs from new attacks combine to exceed the checking cost diﬀerence between the two defenses, scanners are more expensive than cryptographic checksums. Using our previous numbers, we compute:</p>
<div align="center">20+(2)(100) &lt; (250)(1/3)(3-3)</div>
<p>As we see, if scanning and checksumming times are equal, scanners are always more expensive (assuming that licensing fee diﬀerences are not extraordinary). Put another way, if scanning and checksumming times are equal, the update costs and new virus eradication costs must be less than the licensing fee diﬀerence in order for scanners to be less expensive. For 4 updates per year at $5 per update, and assuming no unscanned for attacks, a checksumming system would have to cost $200 per system more than a scanner in order to be less cost eﬀective ($200 at 10% per year is the same as $20 per year licensing fees). The only advantage of scanners for large numbers of systems is faster scan times, and this advantage will probably not last long.</p>
<p>We now compare scanners to monitors:</p>
<div align="center"><img src="/img/cache/7fc9d226b914c039633cb5fd66bcfdfa.gif" alt="
\begin{eqnarray}
\text{Term 1}&amp; &amp;\text{Term 2}\\
T_s = s[cet_s + l_s + u] &amp;+&amp; a_n r_s s + a_o r_s o_i + d\\
T_m = s[l_m + u] &amp;+&amp; a_n r_s s + a_o r_f + d\\
T_s - T_m = s[cet_s + (l_s - l_m)] &amp;+&amp; a_o[r_s o_i - r_f]
\end{eqnarray}
" valign="middle"/></div>
<p>We assume that licensing fees for scanners and monitors are approximately the same relative to scanning costs (<img src="/img/cache/ac4a5d8f8f2b2248bfdb8d7ee9abefb7.gif" alt="[l_s - l_m] = 0" valign="middle"/>). We also note that <img src="/img/cache/8ee5f791c06d13cb9caada0d0dcebfc2.gif" alt="o_i &gt; 1" valign="middle"/> for any reasonable scenario, and the cost to clean a system is normally far greater than the cost to clean a single ﬁle (<img src="/img/cache/76fd39fcbf678ed5e6d5630ad408a94c.gif" alt="r_s \gg r_f" valign="middle"/>). We then get:</p>
<div align="center"><img src="/img/cache/a74ff558203926ba66fbc041d94e7db7.gif" alt="T_s - T_m = scet_s + a_o r_s" valign="middle"/></div>
<p>Since all of the terms are positive, <img src="/img/cache/425801eab1cf896cb55b2f975e11330d.gif" alt="T_s" valign="middle"/> is always greater than <img src="/img/cache/0fb7878c9c075438f56bf019b6702ea6.gif" alt="T_m" valign="middle"/>, and thus scanning costs always exceed monitoring costs.</p>
<p>We now quickly look at the relative costs of checksums and integrity shells:</p>
<div align="center"><img src="/img/cache/4a44ab257d94e6124500cb1ab52aeb0b.gif" alt="
\begin{eqnarray}
\text{Term 1}&amp;&amp;\text{Term 2}\\
T_c = s[cet_c + l_c] &amp;+&amp; [a_n + a_o]r_s o_i + d\\
T_i = sl_i &amp;+&amp; [a_n + a_o]r_f + d\\
T_c - T_i = s[(l_c - l_i) + cet_c] &amp;+&amp; [a_n + a_o](r_s o_i - r_f)
\end{eqnarray}
" valign="middle"/></div>
<p>Assuming that licensing cost diﬀerences are not large, we can drop the (<img src="/img/cache/229aff8739781fd9c9c5457088c15885.gif" alt="l_c - l_i" valign="middle"/>) term. Since (<img src="/img/cache/8ee5f791c06d13cb9caada0d0dcebfc2.gif" alt="o_i &gt; 1" valign="middle"/>) for any reasonable system, and (<img src="/img/cache/76fd39fcbf678ed5e6d5630ad408a94c.gif" alt="r_s \gg r_f" valign="middle"/>) as we discussed earlier, we simplify to:</p>
<div align="center"><img src="/img/cache/4b23779554219227a97278c69d99aa1f.gif" alt="T_c - T_i = scet_c + [a_n + a_o]r_s o_i" valign="middle"/></div>
<p>Since all of these terms are positive, <img src="/img/cache/0036ac1e1ae00ff6a59a729ecdb0ca91.gif" alt="T_c" valign="middle"/> is always greater than <img src="/img/cache/475b78897f974bc7658f55655285a0ff.gif" alt="T_i" valign="middle"/>, and thus integrity shells are always more cost eﬀective than cryptographic checksum programs.</p>
<p>Finally, we will compare integrity shells to monitors:</p>
<div align="center"><img src="/img/cache/82ebe06147a2555662078aa23b0b1135.gif" alt="
\text{Term 1}&amp;&amp;\text{Term 2}\\
T_m = s[l_m + u] &amp;+&amp; a_n r_s s + a_o r_f + d\\
T_i = sl_i &amp;+&amp; [a_n + a_o]r_f + d\\
T_m - T_i = s[(l_m - l_i) + u] &amp;+&amp; a_n r_s s + a_o r_f - [a_n + a_o]r_f\\
= s[(l_m - l_i) + u] &amp;+&amp; a_n[r_s s - r_f]
" valign="middle"/></div>
<p>The number of systems (<em>s</em>) is always at least 1, and as before, (<img src="/img/cache/3eb3cd7d68516ea8b02f2f58abbb1dbe.gif" alt="r_s \gg rf" valign="middle"/>). If we assume that yearly licensing cost diﬀerences (<img src="/img/cache/578aea298e7b88a835a96ba48fa7f4f7.gif" alt="l_m - l_i" valign="middle"/>) are small compared to update costs (<em>u</em>), we get a per system cost diﬀerence of:</p>
<div align="center"><img src="/img/cache/23a1976b27ad90048d94b2e695eedcc3.gif" alt="T_m - T_s = u + a_n r_s" valign="middle"/></div>
<p>We conclude that integrity shells are always less expensive than virus monitors because all of these terms are positive. The cost diﬀerence comes from the added update cost required to keep monitors up to date (<em>u</em>), and the cost of cleanup for attacks that monitors don’t detect (<img src="/img/cache/4175c03706a0610f0720e13c8ce7212c.gif" alt="a_n r_s" valign="middle"/>).</p>
<p>Another way to look at this, is that the yearly licensing cost of an integrity shell must exceed the yearly licensing cost of a monitor by the update cost and the undetected attack cleanup cost in order for a monitor to be more cost eﬀective than an integrity shell.</p>
<div align="center"><img src="/img/cache/522ea49173d82b3bf8d64f42a4ca51b8.gif" alt="l_i &gt; l_m + u + a_n r_s" valign="middle"/></div>
<p>For u = 20, free monitor licensing, and assuming no unmonitored attacks ever take place, integrity shell license costs would have to exceed $200 per system ($20 per system per year) to be less cost eﬀective than monitors.</p>
<h2><a name="c8"></a>8 Eﬀects of Pre-Interpretation Checks</h2>
<p>We assumed the time for monitors and integrity shells to check information at runtime to be negligible. The actual time (assuming PC-XT at 4Mhz, 62ms disk drive) is currently about 0.5 seconds for a typical monitor, and 20Kbytes per second for an integrity shell. The average DOS program is only about 17K bytes in length [13], so we would expect an integrity shell to take an average of 0.85 seconds, or about 0.35 seconds more than a monitor. Since a typical scanner takes 3 minutes and is used once per day, you would have to run about 211 programs per day, or one program every 2.5 minutes for integrity shell time costs to equal scanning costs. With monitors, this is one program every two minutes.</p>
<p>In typical secretarial environments, only 10 or 20 programs are run per day, and while programmers tend to run more programs, they tend to run smaller programs, and they tend not to wait for them to ﬁnish before going onto the next task. Furthermore, most environments now have much faster machines, and the programs being run have signiﬁcant startup times that cause the relative costs of monitors and integrity shells to be far less important. For example, on a 32Mhz PC with an 18msec disk drive, integrity shells take under 1/10 of a second per program, while the most thorough scanner still takes over 1 minute to check the executables at startup.</p>
<h2><a name="c9"></a>9 Eﬀects of High Performance</h2>
<p>Performance enhancements help cryptographic checksums and integrity shells a lot, but their impact on scanners and monitors is not as nice. As performance gets very high, scanning and monitor times are reduced, but periodic redistribution costs are not aﬀected. We show the basic equations again:</p>
<div align="center"><img src="/img/cache/a54fc04c225ec2a476aa5a335e2e83ca.gif" alt="
\begin{eqnarray}
T_s = s[cet_s + l_s + u] &amp;+&amp; a_n r_s s + a_o r_s o_i + d\\
T_c = s[cet_c + l_c] &amp;+&amp; [a_n + a_o]r_s o_i + d\\
T_m = s[l_m + u] &amp;+&amp; a_n r_s s + a_o r_f + d\\
T_i = sl_i &amp;+&amp; [a_n + a_o]r_f + d
\end{eqnarray}
" valign="middle"/></div>
<p>For very fast systems, we assume that <img src="/img/cache/404860ad4010e751520e6ee8cdbe8cb3.gif" alt="t_s = 0" valign="middle"/> and <img src="/img/cache/355be6afc161834cf03ef84b5b9e59c4.gif" alt="t_c = 0" valign="middle"/>, and get:</p>
<div align="center"><img src="/img/cache/0eddef057780a2a4fdd9a1dd025a7828.gif" alt="
\begin{eqnarray}
T_s = s[l_s + u] &amp;+&amp; a_n r_s s + a_o r_s o_i + d\\
T_m = s[l_m + u] &amp;+&amp; a_n r_s s + a_o r_f + d\\
T_c = sl_c &amp;+&amp; [a_n + a_o]r_s o_i + d\\
T_i = sl_i &amp;+&amp; [a_n + a_o]r_f + d
\end{eqnarray}
" valign="middle"/></div>
<p>If <img src="/img/cache/1595f5f32268b45cbe9f867650ae086c.gif" alt="l_i, l_s, l_m" valign="middle"/>, and <img src="/img/cache/b1c3ace081166024a4d1ebc17138f378.gif" alt="l_c" valign="middle"/> are about equal, and asusming that <img src="/img/cache/8c2531e78f0c8e427d4cbbe034e0f57f.gif" alt="r_f \ll r_s" valign="middle"/> and <img src="/img/cache/1521e3dfd6d15a8b7db4bc9c500057f6.gif" alt="o_i \ll s" valign="middle"/>, we then ﬁnd diﬀerences as follows:</p>
<div align="center"><img src="/img/cache/58d0c99b943c3a09e705b36018e749a8.gif" alt="T_s - Tm = s[l_s - l_m] + a_o[r_s o_i - rf] = 0 + a_o r_s o_i" valign="middle"/></div>
<p>In other words, scanners and monitors diﬀer only by repair costs from known viruses spreading to a relatively small number of systems (<img src="/img/cache/c02c4a71b77353b6618d5fb75c880ad7.gif" alt="o_i" valign="middle"/>).</p>
<div align="center"><img src="/img/cache/3646a3cca4abf5dca711adc80453395b.gif" alt="T_m - T_c = su + a_n r_s s + a_o r_f - a_n r_s o_i - a_o r_s o_i" valign="middle"/></div>
<p>Since <img src="/img/cache/bdbc191661afef6dadb2027f22817584.gif" alt="s \gg o_i" valign="middle"/> and <img src="/img/cache/8ee5f791c06d13cb9caada0d0dcebfc2.gif" alt="o_i &gt; 1" valign="middle"/> and <img src="/img/cache/8c2531e78f0c8e427d4cbbe034e0f57f.gif" alt="r_f \ll r_s" valign="middle"/>, we get:</p>
<div align="center"><img src="/img/cache/95431137951e2a53970768b7ddf8e5f8.gif" alt="T_m - T_c = s[u + a_n r_s] - a_o r_s o_i" valign="middle"/></div>
<p>In this case, the only circumstance where (<img src="/img/cache/6904df36d871a26e075743e0808aa148.gif" alt="T_m - T_c \lt 0" valign="middle"/>), and thus where monitors are cheaper than checksums, is the case where:</p>
<div align="center"><img src="/img/cache/3dac6f9b08336f8bf83416eb2d660419.gif" alt="s[u + a_n r_s] \lt a_o r_s o_i" valign="middle"/></div>
<p>In other words, in cases where update costs (<em>u</em>) and new virus cleanup costs (<img src="/img/cache/4175c03706a0610f0720e13c8ce7212c.gif" alt="a_n r_s" valign="middle"/>) are less expensive than cleaning old viruses spreading to a small number of systems (<img src="/img/cache/c400feacd18d859f0e412af980e8b44a.gif" alt="a_o r_s o_i" valign="middle"/>), monitors are more cost eﬀective. With large numbers of systems, in order for monitors to be less expensive than checksums, the number of old viruses would have to out number the number of new viruses by a factor equal to the number of systems. For an environment with 1,000 systems, that would mean 1,000 entries of old viruses would have to take place for every entry of a new virus in order for monitors to be more cost eﬀective than cryptographic checksums. Clearly, as performance goes up, cryptographic checksums are more cost eﬀective in large organizations.</p>
<p>Since performance is not an issue, we could theoretically check for viruses quite often without signiﬁcant penalty. In the extreme, we could perform checksums every few seconds, and thus limit the spread of viruses to a very small portion of a system. In the limit, this is what an integrity shell does, except that it only checks those ﬁles which have to be checked when they have to be checked.</p>
<p>Integrity shells again come out on top as follows:</p>
<div align="center"><img src="/img/cache/e48b1c72ce7e214ccd3adf6343b7cdc7.gif" alt="T_c - T_i = 0 + [a_n a_o][r_s o_i - r_f]" valign="middle"/></div>
<p>Since <img src="/img/cache/6d26911760eff172caf55828fa4de5f7.gif" alt="r_s o_i \gg r_f, T_c &gt; T_i" valign="middle"/>, and integrity shells beat out cryptographic checksums. Our high performance assumption has no eﬀect on <img src="/img/cache/dd4ee065f5b69267776526994d098ae9.gif" alt="T_m - T_i" valign="middle"/>, except that it removes any minor advantage of monitors due to faster checking times at program invocation.</p>
<h2><a name="ca"></a>10 Eﬀects of Online Backups and Automated Repair</h2>
<p>Another cost related to monitors, scanners, integrity shells, and cryptographic checksums is the cost of automated repair, on-line backups, and manual repair with oﬀ-line backups. We begin with automated repair, which is essentially free (except for licensing costs) if done properly. To do this properly, we must make certain that we only cure known strains of known viruses. Only one product currently on the market is reliable in this way, but we assume that diligent eﬀort will improve this situation with time.</p>
<p>On-line backups have real costs in terms of the disk space required to keep redundant information. In their simplest form, on-line backups double the disk space for all covered ﬁles. In a sense, the comparison here is unfair, because on-line backups can be used to cover all information, including data ﬁles, interpreted ﬁles, and other non-binary non-executable information. On-line backups can also repair unknown and known viruses as well as any other corruptions to stored information whether intentional or not. Thus the cost of coverage must be deferred over all corruptions for integrity shells and cryptographic checksums (which detect all corruptions), but only deferred over known viruses for monitors and scanners (since they don’t detect any other corruptions). This enhances the case for cryptographic checksums and integrity shells still further.</p>
<p>The cost of on-line backups is directly related to the cost of disk space. Current retail costs of disk space for personal computers runs in the range of $20/Mbyte for small disks, and $10/Mbyte for large disks. Most systems have relatively small disks, so let’s use the $20 ﬁgure for the purpose of analysis. Assuming we are only covering binary executables with on-line backups, we only need to cover a small portion of the space on a typical system. A typical user PC has under 2Mbytes of its disk space taken by executable ﬁles (based on a very small survey of development systems). This would then come to a one-time cost of $40 per system for storage of on-line backups, or as we did with licensing fees, $4/year/system.</p>
<p>Unfortunately, this makes the assumption that you can buy disk space by the Mbyte, which you cannot. If you have extra disk space, on-line backups are essentially free, and if you don’t, they are quite expensive. A rational approach might be to use on-line backups when there is available disk space, and use oﬀ-line backups when there is inadequate disk space.</p>
<p>Regardless of the technique applied for virus eradications, it has no signiﬁcant impact on other virus related costs, since any eradication technique can be used with any detection mechanism. There is a tendency in the market, however, for integrity shells to use on-line backups, and for monitor to use customized cures. Clearly, we can mix these techniques as we desire, and perhaps an approptiate mix will give us the best of both worlds.</p>
<h2><a name="cb"></a>11 Eﬀects of Cleaning Up Backups</h2>
<p>We have also left out a major factor in the cleanup costs of monitors and scanners. If we are to do a thorough job of cleanup, we must not only remove viruses from on-line ﬁles, but also from backups. Otherwise, the backups will be infected, and when we try to restore from them, we will restore the viruses as well as the other information. With checksums and integrity shells, this is not a problem because no undetected changes occur, and thus backups don’t become corrupted over a signiﬁcant period of time, but with monitors and scanners, any time we get an update and detect a new virus, we must clean the entire history of backups in order to fully eradicate it.</p>
<p>Another closely related problem is that evolutionary viruses may release known strains into the environment. When we detect the known strain, we may be able to cure it, but we will not necessarily ever trace down its source, because it evolved from an unknown strain. This makes cleaning backups nearly impossible once an evolutionary virus of unknown origin infects the system over an extended period.</p>
<h2><a name="cc"></a>12 Cryptographic Checksum Maintenance</h2>
<p>The only negative point we are aware of for cryptographic checksums and integrity shells, relates to the need to maintain the checksums as the ﬁles on the system change legitimately. These costs might dominate if cryptographic checksums and integrity shells had no provisions to deal with change. There are two factors that enhance the integrity shell’s position in this arena.</p>
<p>One factor is that the binary executables covered by monitors and scanners change very rarely, while the non-executables not covered by monitors and scanners change more often. Thus, in order to be competitive with monitors and scanners, integrity shells must only be able to deal with the small rate of change in binary executables. In a typical system, binaries don’t change more than once per year, so an automatic procedural method can often be used to maintain this mechanism.</p>
<p>As an example, in several organizations, the strategy has been adopted to issue an automatic resumming order whenever distributing an update to a binary executable. Thus along with the other installation routines on each widely distributed disk, comes a command to resum the new executables. This takes an extra few seconds during the installation process, but relative to other distribution costs, is trivial.</p>
<p>The second factor is that integrity shells on the market today have automation for handling change in a manner consistent with the organizational policy. Thus, if the organization determines that no changes are allowed without explicit user permission, this policy will be enforced. If changes are only allowed under speciﬁc conditions, those conditions can be explicitly and automatically enforced as well.</p>
<p>As an example, with a policy that no binary executable is to be trusted unless it has been explicitly checksummed during a distribution, no untrusted program (e.g. the AIDS disk of 1989) can be executed by the user. In the other extreme, a commonly used word processor changes its own binary executable to reﬂect user customizations, and may change itself at any time. This too is handled by integrity shells which can be told of this case and automatically resum this program after each execution, without leaving the window of vulnerability that would be present if we only resummed changed information on a periodic basis.</p>
<p>The net eﬀect is that in a well controlled environment, controlling cryptographic checksums is a normal part of the change control process, and is essentially free after it is integrated into the environment.</p>
<h2><a name="cd"></a>13 Summary, Conclusions, and Further Work</h2>
<p>We have provided a mathematical analysis of the costs of viruses and defenses for the most common defensive strategies. The analysis clearly shows that integrity shells are the most cost eﬀective technique today in almost every case, and that their advantage over other techniques becomes larger as time passes, as performance increases, as the number of viruses increases, and as the number of systems being covered increases. Of the other techniques, there is a short period of time over which virus monitors will be more cost eﬀective than cryptographic checksums in many cases, but as performance increases and the number of viruses increases, cryptographic checksums become better than monitors. Scanners, the most popular technique in the market at this time, are the least cost eﬀective.</p>
<p>The analysis makes many assumptions about environments and viral spread, and some of them will be more or less valid in any given environment. This analysis is also not particularly deep, and it may well be that more thorough analysis will reveal more relevant information on the costs of viruses and defenses. Nevertheless, for a broad range of environments, the conclusions drawn seem to be valid.</p>
<p>Signiﬁcant further work is called for in the area of mixed strategies for defense and the costs of other defensive methods. In particular, prevention through limited sharing and limited function should be explored for cost eﬀectiveness, and mixes of all of these strategies should be considered.</p>
<h2><a name="ce"></a>References</h2>
<ol>
<li>F. Cohen, “A Summary of Recent Results on Computer Viruses”, 1990 NIST/DOD Annual Conference on Computer Security.</li>
<li>F. Cohen, “A Note on the use of Pattern Matching in Computer Virus Detection”, Invited Paper, Computer Security Conference, London, England, Oct 11-13, 1989, also appearing in DPMA Computer Virus Clinic, 1990.</li>
<li>J. Hirst, “Eliminator - Virus Detection and Removal”, Users manual, British Computer Virus Research Centre, 1990</li>
<li>F. Cohen, “<a href="/lib/afc03.html">A Cryptographic Checksum for Integrity Protection</a>”, IFIP-TC11 “Computers and Security”, V6#6 (Dec. 1987), pp 505-810.</li>
<li>F. Cohen, “<a href="/lib/afc07.html">Models of Practical Defenses Against Computer Viruses</a>”, IFIP-TC11, “Computers and Security”, V7#6, December, 1988.</li>
<li>F. Cohen, “Computer Viruses”, PhD Dissertation, University of Southern California, 1986, ASP Press (PO Box 81270, Pittsburgh, PA 15217 USA)</li>
<li>F. Cohen, “<a href="/lib/afc01.html">Computer Viruses - Theory and Experiments</a>”, DOD/NBS 7th Conference on Computer Security, originally appearing in IFIP-sec 84, also appearing in IFIP-TC11 “Computers and Security”, V6(1987), pp22-35 and other publications in several languages</li>
<li>F. Cohen, “How To Do Sound Change Control and What It Costs”, Information Protection, V1#6, June, 1990, ASP Press, (PO Box 81270, Pittsburgh PA 15217)</li>
<li>F. Cohen, “<a href="/lib/afc13.html">A Short Course on Computer Viruses</a>”, ASP Press, 1990 (PO Box 81270, Pgh PA 15217, USA)</li>
<li>S. White, “A Status Report on IBM Computer Virus Research”, Italian Computer Virus Conference, 1990.</li>
<li>W. Gleissner, “<a href="/lib/mwg02.html">A Mathematical Theory for the Spread of Computer Viruses</a>”, “Computers and Security”, IFIP TC-11, V8#1, Jan. 1989 pp35-41.</li>
<li>Tipet, “The Tipet Theory of Computer Virus Propagation”, Foundationware, USA.</li>
<li>M. Cohen, “A New Integrity Based Model for Limited Protection Against Computer Viruses”, Masters Thesis, The Pennsylvania State University, College Park, PA 1988.</li>
</ol>
[<a style="" href="/lib/?lang=EN&amp;index=TH#afc15">Back to index</a>] [<a href="/lib/afc15.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=afc15">de</a><a href="/lib/index.php?lang=en&amp;id=afc15">en</a><a href="/lib/index.php?lang=es&amp;id=afc15">es</a><a href="/lib/index.php?lang=it&amp;id=afc15">it</a><a href="/lib/index.php?lang=fr&amp;id=afc15">fr</a><a href="/lib/index.php?lang=pl&amp;id=afc15">pl</a><a href="/lib/index.php?lang=ru&amp;id=afc15">ru</a><a href="/lib/index.php?lang=ua&amp;id=afc15">ua</a></div>
</body>
</html>
