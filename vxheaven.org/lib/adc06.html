<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>David Chess, Steve White 'An Undetectable Computer Virus' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="David Chess, Steve White"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Chess, David; White, Steve,Undetectable Computer Virus, infected, subroutine, computer, number, virus, line, programs, returns, eventually, true, instance, algorithm, constant, result, copy"/>
<meta name="Description" content="One of the few solid theoretical results in the study of computer viruses is Cohen's 1987 demonstration that there is no algorithm that can perfectly detect all possible viruses [1]. This brief paper adds to the bad news, by pointing out that there are computer viruses which no algorithm can detect, even under a somewhat more liberal definition of detection. We also comment on the senses of &quot;detect&quot; used in these results, and note that the immediate impact of these results on computer virus detection in the real world is small."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"d609d95f66a0bcbae7ea036f614835d85e3e0f49-1498757351-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/adc06.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>An Undetectable Computer Virus</h1><p><a href="/lib/?lang=en&amp;author=Chess%2C%20David">David Chess</a>, <a href="/lib/?lang=en&amp;author=White%2C%20Steve">Steve White</a><br/> <em>Virus Bulletin Conference</em><br/> <em>September 2000</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/adc06.html';</script><div class="ci"><a href="/lib/?ci=adc06">9</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/An%20Undetectable%20Computer%20Virus.pdf">Download</a> PDF (32.87Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=TH#adc06">Back to index</a>] [<a href="/lib/adc06.html#disqus_thread">Comments</a>]<br/> <form method="post" action="">
<img src="/img/cache/0b9fd596a90421f9f1f68a9760275737.gif" alt="\text{T_EX size}" valign="middle"/>
<select name="TeX_size"><option value="-2">-2</option><option value="-1">-1</option><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select>
<input type="submit" value="Scale"/>
</form>
<address>
IBM Thomas J. Watson Research Center<br/>
Hawthorne, New York, USA<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="b7d4dfd2c4c4f7c2c499ded5da99d4d8da">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>, <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="abd8d9dcc3c2dfceebded885c2c9c685c8c4c6">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</address>
<p>One of the few solid theoretical results in the study of computer viruses is Cohen's 1987 demonstration that there is no algorithm that can perfectly detect all possible viruses [1]. This brief paper adds to the bad news, by pointing out that there are computer viruses which no algorithm can detect, even under a somewhat more liberal definition of detection. We also comment on the senses of "detect" used in these results, and note that the immediate impact of these results on computer virus detection in the real world is small.</p>
<h2>Computer Viruses</h2>
<p>Consider the set of programs which produce one or more programs as output. For any pair of programs <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> and <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/>, <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> <em>eventually</em> produces <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/> if and only if <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> produces <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/> either directly or through a series of steps (the "eventually produces" relation is the transitive closure of the "produces" relation.) A <em>viral set</em> is a maximal set of programs <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> such that for every pair of programs <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> and <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/> in <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/>, <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> eventually produces <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/>, and <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/> eventually produces <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/>. ("Maximal" here means that there is no program <img src="/img/cache/4b43b0aee35624cd95b910189b3dc231.gif" alt="r" valign="middle"/> not in the set that could be added to the set and have the set still satisfy the conditions.) For the purposes of this paper, a <em>computer virus</em> is a viral set; a program <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is said to be an instance of, or to be infected with, a virus <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> precisely when <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is a member of the viral set <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/>. A program is said to be <em>infected</em> simpliciter when there is some viral set <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> of which it is a member. A program which is an instance of some virus is said to spread whenever it produces another instance of that virus. The simplest virus is a viral set that contains exactly one program, where that program simply produces itself. Larger sets represent polymorphic viruses, which have a number of different possible forms, all of which eventually produce all the others.</p>
<div align="center">
<img src="img/adc06/fig1.gif" alt="Figure 1. The shapes represent programs, and the arrows show which programs produce which as output. The filled shapes are members of viral sets, the empty shapes are not. The filled hexagon represents a simple non-polymorphic virus, whose sole member produces only itself."/>
<p><strong>Figure 1. The shapes represent programs, and the arrows show which programs produce which as output. The filled shapes are members of viral sets, the empty shapes are not. The filled hexagon represents a simple non-polymorphic virus, whose sole member produces only itself.</strong></p>
</div>
<p>In practical terms, this notion of computer virus encompasses overwriting viruses (which replace existing programs with copies of themselves) and some kinds of worms (which spread as standalone programs by creating new copies of themselves). A more complex notion of computer virus would incorporate "parasitic" viruses, which infect other programs by inserting themselves in such a way that both the viral code and the original program are executed when the infected program is executed. (The classic informal definition of "computer virus" is "a program that can 'infect' other programs by modifying them to include a possibly evolved copy of itself." [1]. A more formal definition in terms of regions of a Turing Machine tape can be found in [2].) In a subsequent paper, we will extend the current results to that richer notion of computer virus; essentially all the results we obtain here still hold.</p>
<h2>Detecting a Virus</h2>
<p>For the purposes of this paper, an algorithm <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/> detects a virus <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> if and only if for every program <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/>, <img src="/img/cache/a7673424a7b194eaa05d1bfc16cf00dc.gif" alt="A(p)" valign="middle"/> terminates, and returns "true" if and only if <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is infected with <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/>. Similarly, an algorithm <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/> detects a set of viruses <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/> if and only if for every program <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/>, <img src="/img/cache/a7673424a7b194eaa05d1bfc16cf00dc.gif" alt="A(p)" valign="middle"/> terminates, and returns "true" if and only if <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is infected with some virus <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> which is a member of <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/>. This is essentially Cohen's definition in [1], and it is the only formal definition of detection that has proven theoretically fruitful. It also captures (at least to a first approximation) our intuitive notion of computer virus detection.</p>
<h2>Cohen's Result</h2>
<p>In [1], Fred Cohen demonstrates that there is no algorithm that can detect the set of all possible computer viruses (returning "true" if and only if its input is an object infected with some computer virus). The proof is a simple diagonal argument, like Cantor's proof of the uncountability [3] of the real numbers, or Turing's proof of the undecidability of the Halting Problem [4]. For any candidate computer virus detection algorithm <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/>, there is a program <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/>, which reads:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; if A(p), then exit; else spread<br/>
&nbsp;</div>
<p>Clearly <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/> does not return the correct result when called on <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/>, since if it returns "true" (i.e. it says that <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is infected), then <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> just exits (and is therefore not infected), whereas if <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/> returns anything else (i.e. it says that <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is not infected), then <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> spreads (and is therefore infected).<sup><a href="#f1" name="b1">1</a></sup> So there is no algorithm which detects all viruses without error; any program that attempts to detect all viruses will either miss some infected files (a false negative), accuse some non-infected files of being infected (a false positive) or fail to return anything (a bug).</p>
<h2>An Undetectable Virus</h2>
<p>A very similar example demonstrates that there are viruses for which no error-free detection algorithm exists. That is, not only can we not write a program that detects all viruses known and unknown with no false positives, but in addition there are some viruses for which, even when we have a sample of the virus in hand and have analyzed it completely, we cannot write a program that detects just <em>that</em> particular virus with no false positives.<sup><a href="#f2" name="b2">2</a></sup></p>
<p>As noted above, a virus is said to be "polymorphic" if the size of the viral set is greater than one; that is, if the code of the virus is different in different infected objects. Consider a virus which is sufficiently polymorphic that for any implementable algorithm <img src="/img/cache/02129bb861061d1a052c592e2dc6b383.gif" alt="X" valign="middle"/> the program <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; if X(p) then exit, else spread<br/>
&nbsp;</div>
<p>is an instance of the virus (provided of course that <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> actually spreads). There is no algorithm <img src="/img/cache/9d5ed678fe57bcca610140957afab571.gif" alt="B" valign="middle"/> that correctly detects this virus, by an argument directly analogous to that above: for any algorithm <img src="/img/cache/9d5ed678fe57bcca610140957afab571.gif" alt="B" valign="middle"/> that claims to detect this virus, there is a program <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp; &nbsp; &nbsp; if B(q) then exit, else spread<br/>
&nbsp;</div>
<p>for which <img src="/img/cache/9d5ed678fe57bcca610140957afab571.gif" alt="B" valign="middle"/> does not return the correct result. If <img src="/img/cache/6a3fa4c43eb52b1203eb4cfc29131f84.gif" alt="B(q)" valign="middle"/> returns true, then <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/> does not spread, and is therefore not an instance of this or any other virus; whereas if <img src="/img/cache/6a3fa4c43eb52b1203eb4cfc29131f84.gif" alt="B(q)" valign="middle"/> returns false, then <img src="/img/cache/7694f4a66316e53c8cdd9d9954bd611d.gif" alt="q" valign="middle"/> does spread, and is an instance of the virus.</p>
<p>Is any possible actual virus sufficiently polymorphic to have this property? Clearly yes. Consider a virus <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/> one instance of which is <img src="/img/cache/4b43b0aee35624cd95b910189b3dc231.gif" alt="r" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">if subroutine_one(r) then exit, else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace the text of subroutine_one with a random program;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; exit;<br/>
}<br/>
subroutine_one:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return false;<br/>
&nbsp;</div>
<p>For any candidate <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/>-detection algorithm <img src="/img/cache/0d61f8370cad1d412f80b84d143e1257.gif" alt="C" valign="middle"/>, there is a program <img src="/img/cache/03c7c0ace395d80182db07ae2c30f034.gif" alt="s" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">if subroutine_one(s) then exit, else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace the text of subroutine_one with a random program;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; exit;<br/>
}<br/>
subroutine_one:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return C(argument);<br/>
&nbsp;</div>
<p>for which <img src="/img/cache/0d61f8370cad1d412f80b84d143e1257.gif" alt="C" valign="middle"/> does not return the correct result; if <img src="/img/cache/dd19f7e464396afdc493182c5c93318d.gif" alt="C(s)" valign="middle"/> returns true, then <img src="/img/cache/03c7c0ace395d80182db07ae2c30f034.gif" alt="s" valign="middle"/> just exits (and is therefore not an instance of <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/>, or of any other virus), whereas if <img src="/img/cache/dd19f7e464396afdc493182c5c93318d.gif" alt="C(s)" valign="middle"/> returns false, then <img src="/img/cache/03c7c0ace395d80182db07ae2c30f034.gif" alt="s" valign="middle"/> is an instance of <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/>. So no algorithm can detect <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/> without error.<sup><a href="#f3" name="b3">3</a></sup></p>
<h2>A Looser Notion of Detection</h2>
<p>There is a looser notion of detection under which our result still holds. We may be willing to forgive a candidate <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/>-detection algorithm for claiming to find <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> in some program <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> which is not infected with <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/>, provided that <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is infected with some virus. Let us say, then, that an algorithm <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/> loosely-detects a virus <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> if and only if for every program <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/>, <img src="/img/cache/a7673424a7b194eaa05d1bfc16cf00dc.gif" alt="A(p)" valign="middle"/> terminates, returning "true" if <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is infected with <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/>, and returning something other than "true" if <img src="/img/cache/83878c91171338902e0fe0fb97a8c47a.gif" alt="p" valign="middle"/> is not infected with any virus. The algorithm may return any result at all for programs infected with some virus other than <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> (although it must still terminate).</p>
<div align="center">
<img src="img/adc06/fig2.gif" alt="Figure 2. The slanted lines show the (perfect) detection of the viral set of filled ovals; the algorithm picks out exactly those programs infected with that virus. The vertical lines show loose-detection of the viral set consisting of the filled hexagons; the algorithm picks out all the programs in that viral set, as well as some other infected programs."/>
<p><strong>Figure 2. The slanted lines show the (perfect) detection of the viral set of filled ovals; the algorithm picks out exactly those programs infected with that virus. The vertical lines show loose-detection of the viral set consisting of the filled hexagons; the algorithm picks out all the programs in that viral set, as well as some other infected programs.</strong></p>
</div>
<p>It is clear that our result still applies under this looser notion of detection. Since every algorithm either returns true for a program which simply exits, or fails to return true for some program infected with <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/>, no algorithm even loosely-detects <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/>.</p>
<h2>Comparison with Cohen</h2>
<p>Our result is clearly complementary to Cohen's result in [1] that no algorithm can detect all viruses. That result may be expressed as</p>
<img src="/img/cache/9d54b4d26a8bbd96d1cd0defcaf8f0d1.gif" alt="\forall A, \exist V \text{s.t. A does not detect V (for every algorithm, there is some virus that it does not detect)}" valign="middle"/>
<p>whereas our results are</p>
<img src="/img/cache/89225aa395ce84be67ca15e5b3010050.gif" alt="
 \exist V s.t. \forall A, A \text{does not detect V (there exists a virus which no algorithm perfectly detects)}\\
 \exist V s.t. \forall A, A \text{does not loosely-detect V (there exists a virus which no algorithm looselydetects)}
" valign="middle"/>
<div align="center">
<img src="img/adc06/fig3.gif" alt="Figure 3. Cohen's result says that it is impossible for a program to perfectly draw the solid line suggested above, enclosing all and only those programs that are infected with some virus. For every program that attempts to draw that line, there will be some infected object that the program says is uninfected, or some uninfected object that it says is infected."/>
<p><strong>Figure 3. Cohen's result says that it is impossible for a program to perfectly draw the solid line suggested above, enclosing all and only those programs that are infected with some virus. For every program that attempts to draw that line, there will be some infected object that the program says is uninfected, or some uninfected object that it says is infected.</strong></p>
</div>
<div align="center">
<img src="img/adc06/fig4.gif" alt="Figure 4. Our result says that for some viruses it is impossible for a program to correctly draw the solid line suggested above, enclosing all those programs that are infected with that virus, and enclosing no programs that are not infected with any virus."/>
<p><strong>Figure 4. Our result says that for some viruses it is impossible for a program to correctly draw the solid line suggested above, enclosing all those programs that are infected with that virus, and enclosing no programs that are not infected with any virus.</strong></p>
</div>
<h2>Practical Consequences</h2>
<p>The virus <img src="/img/cache/61e9c06ea9a85a5088a499df6458d276.gif" alt="W" valign="middle"/> above is clearly not a remarkably viable virus, nor is the failure of detection a particularly serious one. In particular, no user of a real virus detection program <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> would object if it were to say that it found a virus in <img src="/img/cache/e358efa489f58062f10dd7316b65649e.gif" alt="t" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">if D(t), then exit; else spread<br/>
&nbsp;</div>
<p>or in <img src="/img/cache/7b774effe4a349c6dd82ad4f4f21d34c.gif" alt="u" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">if subroutine_one(u) then exit, else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace the text of subroutine_one with a random program<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; exit;<br/>
}<br/>
subroutine_one:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return D(argument);<br/>
&nbsp;</div>
<p>since, although these do not in fact spread, they are closely related to programs that do spread. The main immediate impact of Cohen's undecidability result on the day-to-day activities of those who study computer viruses is that we can dismiss without detailed study any claim that some method correctly detects "all possible viruses known and unknown". The main practical impact of the current result is to dispel the notion that it is always possible to create a detector for a given virus that has no false positives, even if you have a copy of the virus in hand.</p>
<p>When we say in common speech that a given program detects a given virus, we mean something rather different from the formal senses above. Every widely-deployed virus detection program in use today will claim to find a virus in at least some non-viral objects (a false positive), because the methods used for detection are approximate, based on the presence of a particular binary string in a certain place, on the calculation of the finite-size checksum of a macro, on a certain pattern of changes to a file, and so on. Producers of anti-virus software of course try to minimize the number of actual non-viral programs that are falsely detected. But no one worries about the fact that the algorithms used to detect viruses produce false positives on an enormous number of non-viral objects that have never been, and will never be, present on any actual user's computer. This paper's title, then, is deliberately somewhat provocative: while the viruses that we present here are undetectable in the strict formal sense of the term, there is no reason to think that it is impossible to write a program that would detect them sufficiently well for all practical purposes.</p>
<p>Acceptable virus detection, in the real world, involves detecting all viable instances of the virus in question, and preferably some number of minor variants of it, while falsely detecting the virus in only a vanishingly small number of innocent programs that are actually present on a computer somewhere. It would be helpful to have a formal characterization of this more realistic notion of detection; theorists in the area of computer virus protection might usefully work toward such a characterization.</p>
<h2>References</h2>
<ol>
<li>Fred Cohen, "<a href="/lib/afc01.html">Computer Viruses: Theory and Experiments</a>", Computers and Security 6 (1987) 22-35.</li>
<li>Fred Cohen, "<a href="/lib/afc10.html">Computational Aspects of Computer Viruses</a>", Computers and Security 8 (1989) 325-244.</li>
<li>Y. N. Moschovakis, "Notes on Set Theory", Springer-Verlag, NY, 1994, p. 11 (or any similar text).</li>
<li>Alan Turing, "On Computable Numbers, with an application to the Entscheidungsproblem", Proceedings London Mathematical Society (series 2) vol 42, 1936-7, pp.230-265.</li>
</ol>
<h2>Appendix</h2>
<p>The example undetectable virus in the body of the paper requires access to an arbitrarily-large stream of random bits; many formalizations of the notion of algorithm do not allow this. This Appendix gives a slightly more complex example that does not require any random bits. Understanding the main results of this paper does not require understanding this Appendix.</p>
<p>Consider the virus <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/> one instance of which is <img src="/img/cache/9dd4e461268c8034f5c8564e155c67a6.gif" alt="x" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">state = 0;<br/>
serial_number = 0;<br/>
if subroutine_one(x) then exit;<br/>
if state==0 then {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread once, incrementing the constant in the second line of the new copy,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread again, making these changes in the new copy:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; change the constant in the first line to 1,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace the body of subroutine_one() with the subroutine corresponding to<br/>
&nbsp; &nbsp; &nbsp; &nbsp; serial_number under mapping M<br/>
} else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread, making these changes in the new copy:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; change the constant in the first line to 0,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; change the constant in the second line to 0,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace the body of subroutine_one() with the code &quot;return false;&quot;<br/>
}<br/>
exit;<br/>
subroutine_one():<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return false;<br/>
end;<br/>
&nbsp;</div>
<p>where <img src="/img/cache/69691c7bdcc3ce6d5d8a1361f22d04ac.gif" alt="M" valign="middle"/> is a mapping from the integers to the set of programs for the relevant machine, such that for every implementable algorithm <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/>, there is some integer <img src="/img/cache/7b8b965ad4bca0e41ab51de7b31363a1.gif" alt="n" valign="middle"/> such that <img src="/img/cache/69691c7bdcc3ce6d5d8a1361f22d04ac.gif" alt="M" valign="middle"/> maps <img src="/img/cache/7b8b965ad4bca0e41ab51de7b31363a1.gif" alt="n" valign="middle"/> to <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/>. Many such mappings of course exist for the typical machine. (Note that the variable serial_number must be stored as an unlimited-size integer (a "bignum").)</p>
<p>All instances of the above which begin "state = 0;" are viral, and trivial to detect; they differ only in the second line, where serial_number is set. Every program which differs from the above only in having a different non-negative integer in the second line is an element of <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/>. Instances of the above which begin "state = 1;", on the other hand, are only sometimes viral, since the content of subroutine_one() is different, and will often not terminate at all, or will return true (causing the program to exit before spreading). Those that are viral create, in the next generation, exactly the above code again, so every element of <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/> is an ancestor, eventually, of every other (and <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/> is therefore a viral set). For any candidate <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/>-detection algorithm <img src="/img/cache/3a3ea00cfc35332cedf6e5e9a32e94da.gif" alt="E" valign="middle"/>, consider program <img src="/img/cache/415290769594460e2e485922904f345d.gif" alt="y" valign="middle"/>:</p>
<div class="adhoc" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">state = 1;<br/>
serial_number = Q;<br/>
if subroutine_one(y) then exit;<br/>
if state==0 then {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread once, incrementing the constant in the second line of the new copy,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread again, making these changes in the new copy:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; change the constant in line 1 to 1,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace the body of subroutine_one() with the subroutine corresponding to<br/>
&nbsp; &nbsp; &nbsp; &nbsp; serial_number under mapping M<br/>
} else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; spread, making these changes in the new copy:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; change the constant in line 1 to 0,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; change the constant in line 2 to 0,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; replace the body of subroutine_one() with the code &quot;return false;&quot;<br/>
}<br/>
exit;<br/>
subroutine_one():<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return E(argument);<br/>
end;<br/>
&nbsp;</div>
<p>where <img src="/img/cache/69691c7bdcc3ce6d5d8a1361f22d04ac.gif" alt="M" valign="middle"/> maps <img src="/img/cache/f09564c9ca56850d4cd6b3319e541aee.gif" alt="Q" valign="middle"/> to an implementation of <img src="/img/cache/3a3ea00cfc35332cedf6e5e9a32e94da.gif" alt="E" valign="middle"/>. Just as described above, <img src="/img/cache/3a3ea00cfc35332cedf6e5e9a32e94da.gif" alt="E" valign="middle"/> does not return the correct result when called on <img src="/img/cache/415290769594460e2e485922904f345d.gif" alt="y" valign="middle"/>, so <img src="/img/cache/3a3ea00cfc35332cedf6e5e9a32e94da.gif" alt="E" valign="middle"/> does not detect <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/>. And because <img src="/img/cache/3a3ea00cfc35332cedf6e5e9a32e94da.gif" alt="E" valign="middle"/> either returns "true" on a program that simply exits, or returns something other than "true" on a program infected with <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/>, <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/> also fails to loosely-detect <img src="/img/cache/a88c849719f260199e49946541fd97b5.gif" alt="W'" valign="middle"/> in the sense defined above.</p>
<p><a name="f1" href="#b1">1</a> Note that A is not an input to p here; every time p is run, it calls A on itself, and spreads if and only if A returns false. The program p therefore always spreads, or always exits, regardless of any input.</p>
<p><a name="f2" href="#b2">2</a> A similar proof, showing that no Turing Machine program can decide if one virus "evolves" into another, can be found in [2], but as far as we are aware the implications of that result for virus detection have never been explored.</p>
<p><a name="f3" href="#b3">3</a> This example assumes that P has access to an arbitrarily-long stream of random bits; some formalizations of the notion of algorithm do not allow this. See the appendix for a somewhat more complex example that does not require any random bits.</p>
[<a style="" href="/lib/?lang=EN&amp;index=TH#adc06">Back to index</a>] [<a href="/lib/adc06.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=adc06">de</a><a href="/lib/index.php?lang=en&amp;id=adc06">en</a><a href="/lib/index.php?lang=es&amp;id=adc06">es</a><a href="/lib/index.php?lang=it&amp;id=adc06">it</a><a href="/lib/index.php?lang=fr&amp;id=adc06">fr</a><a href="/lib/index.php?lang=pl&amp;id=adc06">pl</a><a href="/lib/index.php?lang=ru&amp;id=adc06">ru</a><a href="/lib/index.php?lang=ua&amp;id=adc06">ua</a></div>
</body>
</html>
