<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Rogue Warrior 'Guide to improving Polymorphic Engines' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Rogue Warrior"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Rogue Warrior,Guide to improving Polymorphic Engines, counter, fixed, engine, times, emulator, byte, detection, call, generic, part, researchers, write, decryptor, time, important"/>
<meta name="Description" content="This is a guide for those who already know how to make an engine but cannot work out why their viruses are still detectable."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"b24ab1c513d6a61ab5dca430e90c7c6b37fd036d-1498756356-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vrw02.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Guide to improving Polymorphic Engines</h1><p><a href="/lib/?lang=en&amp;author=Rogue%20Warrior"> Rogue Warrior</a><br/> <em><a href="/vx.php?fid=274#f274">Insane Reality Magazine [8]</a></em><br/> <em>December 1996</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vrw02.html';</script><div class="ci"><a href="/lib/?ci=vrw02">1</a></div>[<a style="" href="/lib/?lang=EN&amp;index=PO#vrw02">Back to index</a>] [<a href="/lib/vrw02.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#p1">Introduction</a></li>
<li><a href="#p2">Levels of Polymorphism</a></li>
<li><a href="#p3">Polymorphic Virus Detection Methods</a>
<ul>
<li><a href="#p31">Scan Strings</a></li>
<li><a href="#p32">Variable Scan Strings</a></li>
<li><a href="#p33">Cryptanalysis</a></li>
<li><a href="#p34">Generic Decryptor (a.k.a. Emulation)</a></li>
<li><a href="#p35">Heuristics</a></li>
</ul></li>
<li><a href="#p4">Combatting Virus Detection Methods</a>
<ul>
<li><a href="#p41">Anti Scan String methods</a></li>
<li><a href="#p42">Cryptanalysis</a></li>
<li><a href="#p43">Generic Decryption</a></li>
</ul></li>
<li><a href="#p5">Stopping analysis of your virus by AV researchers</a></li>
<li><a href="#p6">Planning your engine features</a></li>
<li><a href="#p7">Conclusion</a></li>
</ul>
<h2><a name="p1">Introduction</a></h2>
<p>This is a guide for those who already know how to make an engine but cannot work out why their viruses are still detectable.</p>
<p>The single purpose of polymorphic viruses is to avoid detection - at the heart of the polymorphic virus is the engine. It can usually take from 30-80% of the virus code size so is a very important component of the virus to have working properly.</p>
<p>This guide will tell you how polymorphic detectors work in order to help you design/make a better engine to defeat scanners.</p>
<p>Making a good engine takes a good amount of time. If you don't make it correctly you might as well leave it out completely because it's main purpose (avoiding detection) will not work!.</p>
<h2><a name="p2">Levels of Polymorphism</a></h2>
<p>Polymorphism covers has many levels of skill.</p>
<p>According to Vesselin Bontchev (AV) these are:</p>
<ol>
<li>Fixed set of constant decryptors (a.k.a Oligomorphic).</li>
<li>Variable instructions for single instruction.</li>
<li>Garbage code insertion.</li>
<li>Instruction swapping.</li>
<li>2+3+4</li>
<li>Permuting</li>
</ol>
<p>#6 is not considered higher than #5 it's simply considered a different classing.</p>
<p>I think there is now a 7th class. Highly advanced polymorphism which is designed to be better than #5. These ones have the following attributes:</p>
<ul>
<li>Heuristic counter-measures</li>
<li>Goat counter-measures</li>
<li>Emulator counter-measures</li>
</ul>
<p>All these attributes are not part of the virus but instead part of the <em>polymorphic code produced by the virus</em>.</p>
<h2><a name="p3">Polymorphic Virus Detection Methods</a></h2>
<p>There are many methods for detecting polymorphic viruses here are some popular methods:</p>
<ul>
<li>Scan Strings</li>
<li>Variable Scan Strings</li>
<li>Cryptanalysis</li>
<li>Generic Decryptor</li>
<li>Heuristics</li>
</ul>
<h3><a name="p31">Scan Strings</a></h3>
<p>Works by searching for a pattern of bytes in FIXED positions and a FIXED sequence. e.g.,</p>
<pre>
	scan string: aa ?? bb ?? cc
	virus text : aa xx bb xx cc
</pre>
<h3><a name="p32">Variable Scan Strings</a></h3>
<p>Work by searching for a pattern of bytes in VARIABLE positions but in a FIXED sequence. e.g.,</p>
<pre>
	scan string:	aa * bb * cc
	virus text:	1. aa xx xx bb xx xx xx xx cc
			2. aa bb xx xx xx cc
			3. and so on...
</pre>
<h3><a name="p33">Cryptanalysis</a></h3>
<p>Works by finding part of the VIRUS BODY and then performing some very basic cryptanalysis on it and then decrypting it (if possible).</p>
<p>This method according to many AV is not used anymore (due to the effectiveness of Generic Decryptor) but I will tell you how to defeat it anyway just to be sure ;-) -- its not hard to defeat.</p>
<h3><a name="p34">Generic Decryptor (a.k.a. Emulation)</a></h3>
<p>Works by emulating instructions in the polymorphic decryptor in order to make the virus decrypt itself and then it detects the virus by a standard scan string.</p>
<h3><a name="p35">Heuristics</a></h3>
<p>This has undeservedly been a virus buzz word for a long time. It has been the target of polymorph engine creators to beat the heuristics which shows how little they know of polymorphic detection.</p>
<p>This method involves searching for inconsistencies between the code being analysed and normal everyday code found in programs.</p>
<p>While it is important - it is not THAT important and will not help you stop being detected by anti virus software.</p>
<p>It is important to note that heuristics is not used very much (they do use a bit) in the most popular AV programs (F-PROT, McAfee and AVP) these are the programs you should target. Do not target programs which only hard core virus people use. Most of the hard core AV software could spot a virus anyway. -- in other words: <em>target the less intelligent software users</em></p>
<h2><a name="p4">Combatting Virus Detection Methods</a></h2>
<h3><a name="p41">Anti Scan String methods</a></h3>
<p>This is really easy - avoid the use of code common to every decryptor just because some code isn't in the same position doesn't mean it cannot be scanned though. For example:</p>
<p><em>xx=garbage code.</em></p>
<p>Your Decryptor #1 (as hexidecimal):</p>
<pre>45 34 xx xx xx 54 80 xx xx xx 12 xx xx xx 34 32 xx xx xx 43 xx xx xx xx</pre>
<p>Your Decryptor #2:</p>
<pre>xx xx xx 45 30 xx xx xx xx xx 54 81 xx xx xx xx xx 12 xx xx 34 32 xx 43</pre>
<p>Looking at this code you can see an obvious pattern it can be scanned using this string:</p>
<pre>
45 3? * 54 8? * 12 * 34 32 * 43

Legend:
? - match 1 positions only
* - match up to N bytes but low as 0 bytes
</pre>
<p>This will identify this decryptor (not the virus) by looking for code common to each decryptor. So how do you combat it? Well try making sure that you always have at LEAST 1 alternative to every instruction your engine can generate.</p>
<p>NOTE: Make enough alternatives that it makes multiple variable scan strings not an option to AV!</p>
<h3><a name="p42">Cryptanalysis</a></h3>
<p>This is very easy to defeat - simple add multiple encryption operations for example:</p>
<p>A loop using a single XOR with byte/word is very easy to cryptanalyse but a loop using XOR b/w, ADD b/w, SUB b/w, ROL b/w in one loop is VERY hard to cryptanalyse.</p>
<p>The only problem with this is applying the encryptions in reverse order to that of your virus decryptor so that when the virus decryptor is run it will do it in the correct ordering.</p>
<p>There is an easy way to do this! -- There isn't really I was just joking there is no easy way =)</p>
<p>You can leave bit out anyway because AV's are using all using Generic Decryption as far as I know.</p>
<h3><a name="p43">Generic Decryption</a></h3>
<p>This method is very popular amongst AV and requires the cooperation of the virus to work. If a virus can detect it is being emulated and then throw an emulator off by some method then it will defeat this method.</p>
<p>Products known to be using this technique are: F-PROT AVP TBAV DSAV (and I would guess McAfee?).</p>
<p>How does generic decryption work? well the AV products each have in them a little Intel software CPU emulator which does not allow instructions to actually execute but simulates them enough in certain controlled ways in order to make the virus decrypt itself in a safe environment - this way all they need is a scan string for a very complex polymorphic virus!</p>
<p>These controlled conditions avoid endless loops and other similar bugs in normal programs from making the emulator hang. I experimented and found that making a 10 KB decryptor on a virus will dramatically slow down scanning in DSAV and AVP because the emulator is actually simulating the code. I made 10 x 10KB samples and these took over 3 minutes to be examined by DSAV and AVP however each of these took only milliseconds to run normally.</p>
<p>This shows that the emulators in DSAV and AVP are really quite good and don't give up easily when trying to decrypt a virus (I used the /ANALYSE option on DSAV). F-PROT and TBSCAN did not emulate these samples correctly even with maximum heuristics enabled or if they did they must have discovered how to simulate INCREDIBLY quickly (even TBSCAN being written in assembly language cannot run them that fast).</p>
<p>So how do we stop this emulation taking place? or better put: How do we detect ourselves being emulated and throw the emulator off?</p>
<p>e.g., Imagine we know that the PSP contains a certain constant value at ALL times - but we also know the emulator doesn't emulate the PSP. With this knowledge we can construct some code in our polymorphic DECRYPTOR to detect this and throw the emulator off:</p>
<pre class="source">
	mov ax,[0000]
	sub ax,20CDh
	jz ok
	mov ah,4Ch
	int 21
ok:
</pre>
<p>Note: This code must be in the decryptor because it's goal is to stop decrypting BEFORE we reach the virus body. This code must be generated with the same principles of variability that all other poly code requires - if you don't make this code variable also then you risk having the code used against you to detect the virus!!!</p>
<p>Possible methods to exploit for detecting and terminating emulation:</p>
<ul>
<li>Inability of DOS call return values to be predicted by the emulator without actually calling them. i.e., we can make a DOS call in the poly code and check the return values. If they are not consistent with a REAL call to that function then it can be assumed we are being emulated and then take evasive action.</li>
<li>Inability of emulator to write to ALL of memory. By writing to safe areas in RAM we can test if that area has ACTUALLY been written to by the virus or just emulated. If it has not been written to then we assume emulation in progress.
<p>e.g., long winded version:</p>
<pre class="source">
	cli			;disable ints
	cld			;set data string copy direction
	push 6000h
	pop ds			;any segment which AV and virus don't own.
	push ds
	pop es			;es=ds=6000h
	sub si,si
	mov di,0002
	lodsw			;save in ax, si=di=2
	xor ds:[0000],1234h	;write
	mov cx,0f000h		;some large amount
L1:	rep movsw		;write to memory (a large amount is better)
	cmp ds:[0000],ax	;did the AV forget about the write?
	mov ds:[0000],ax	;set it back to normal regardless
	jz not_emulated		;seems they messed up remembering where we
				;wrote.
	mov ah,4Ch
	int 21h			;bye Mr Emulator.
not_emulated:
</pre></li>
<li>Inability of emulator to emulate all control structures (PSP, MCB, SFT, etc).
<p>Most emulators can emulate the PSP, MCB and so on but every single structure would take too much memory and processing so trying to exploit this possible weakness is a good idea.</p>
<p>TbClean a program which emulates viruses to disinfect programs only emulates certain small parts of the PSP leaving other parts to be exploited by emulation trapping. In fact one can trick TbClean into converting the virus infected file into an infected Trojan horse program for the person who runs it next.</p>
<p>NOTE: TbClean is good fun for testing your polymorphic decryptors it shows you how the emulator is going to go through your code like a hot knife through butter. Make sure to crack the registration on TbClean so you can use it properly &lt;grin>.</p></li>
<li>Limited resources of an emulator.
<p>Remember that many AV programs are built to be fast so by making your virus take a very long time (in AV program terms) to analyse your virus might make it quit thinking that it has encountered an endless loop.</p>
<p>However! running a time consuming decryptor normally takes next to no time. So we can see that resources of time, memory, processing power all contribute to methods for killing off an AV scanner emulator.</p>
<p><em>You must think how to detect and force the emulator to quit</em></p></li>
</ul>
<h2><a name="p5">Stopping analysis of your virus by AV researchers</a></h2>
<p>AV researchers are the ones responsible for making your virus detectable so having some ways to hinder AV researchers doing analysis of your polymorphic virus and engine is always good to throw in.</p>
<p>The most common way to analyse a new polymorphic virus is to generate 1000's of samples of your virus. This involves activating the virus on a test computer and executing 1000's of goat programs.</p>
<p>The goal in generating these 1000's of copies is to get a good sampling of what the engine can generate and then test the detection method against it.</p>
<p>If your virus chooses only to show a certain sample then their detector may work in the Lab but not when it comes to "in the wild" situations.</p>
<p>Of course it is best to not make it obvious to AV that you are trying to do this or they might catch on and alter their methods.</p>
<h2><a name="p6">Planning your engine features</a></h2>
<p>It's always good idea to have plan of the engine structure.</p>
<p>Many coders spend their time byte-fiddling trying to optimise their code - this method of planning enables to you block-fiddle - each of these blocks can be shuffled and optimised meaning every change for the better is saving you lots of bytes instead of 1-2 bytes.</p>
<p>NOTE: NEVER place ANY code in a CALL/RET routine unless it is used more than once!</p>
<p>A polymorphic engine is very similar to the code generation phase of a compiler - most compiler writers use the word "emit" [1] as the word to say they're outputting code. So try to use the same because it's good to follow this standard when planning your engine.</p>
<p><em>[1]: Means "output" or "give off" for those bad at English.</em></p>
<p>e.g., Here is a very basic model of an engine plan (you may want to add more detail than this to any plan you make):</p>
<pre class="source">
   Engine:
     EmitDecryptor

   EmitDecryptor:
     repeat EmitGarbage &amp; EmitAntiEmulation, random(5) times
     EmitSetupRegs
     repeat EmitGarbage &amp; EmitAntiEmulation, random(5) times
     MarkLoopStart
     repeat EmitDecryptionCode, random(5) times
     repeat EmitGarbage &amp; EmitAntiEmulation, random(5) times
     EmitEndLoop
     repeat EmitGarbage &amp; EmitAntiEmulation, random(5) times
   End-EmitDecryptor

   EmitGarbage:
     Randomly Select 1 of:
       EmitFakeINT21   - randomly select some int 21 functions
       EmitFakeINT10   - randomly select some int 10 functions
       EmitCMPbmemXX   - cmp byte ptr [xxxx],xx
       EmitCMPwmemXXXX - cmp word ptr [xxxx],cccc
       EmitMOVbmemXX   - mov byte ptr [xxxx],cc
       EmitMOVwmemXXXX - mov word ptr [xxxx],cccc
       EmitMOVbregXX   - mov rb,cc
       EmitMOVwregXXXX - mov rx,cccc
       EmitMOVbregMEM  - mov rb,byte ptr [xxx]
       EmitMOVwregMEM  - mov rw,byte ptr [xxxx]
       EmitCALL        - CALL xxxx/garb/jmp yyyy/garb/xxxx:/garb/ret/yyyy:
       EmitJMP         - JMP xxxx/garb/xxxx:
   End-EmitGarbage

   EmitAntiEmulation:
     Randomly Select 1 of:
       EmitFarCALL       - place RETF into mem/CALL yyyy:xxxx
       EmitFarJMP        - place Far JMP into mem/JMP yyyy:xxxx
       EmitWriteAndTest  - write to known RAM mem, test it changes, if not
                           crash
       EmitFakeExit      - set int 21 = virus_cs:virus_return and call
                           ah=4c, int 21
       EmitPSPcheck      - cmp ds:[0000],21CDh/jnz crash: use better check!
                           just an example.
       EmitDOScheck      - dos call/check return value is consistent.
   End-EmitAntiEmulation

   EmitSetupRegs:
     If Boolean Then
       LoopType = Counter or Pointer
       Select Count Register from [AX,BX,CX,DX,SI,DI]
       Select Pointer Register from [SI,DI,BP]
     Else
       LoopType = Pointer
       Select Pointer Register from [SI,DI,BP]
     End If
   End-EmitSetupRegs

   MarkLoopStart:
     Save output pointer (usually DI register) to remember loop location.
   End-MarkLoopStart

   EmitDecryptionCode:
     Randomly select 1 of:
       EmitXORptr
       EmitADDptr
       EmitSUBptr
   End-EmitDecryptionCode

   EmitEndLoop:
     If LoopType=Counter and Counter=CX and Boolean Then
       EmitLoop
     Else If LoopType=Counter and Boolean Then
       EmitDECJNZ
     Else If LoopType=Counter and Boolean Then
       EmitDECJZJMP
     Else If LoopType=Pointer and Boolean Then
       EmitDECCMPJNZ
     Else If LoopType=Pointer and Boolean Then
       EmitDECCMPJZJMP
     End
   End-EmitEndLoop

</pre>
<p>This is just a simple example of a plan so you can see how to structure your engine - do not forget these parts:</p>
<ul>
<li>encrypting the virus body in reverse order and reverse operation.</li>
<li>adjusting for execution location in memory: if the entry point of the virus is not at a zero offset then you must adjust all memory references and pointers by the relocation amount.</li>
</ul>
<p>This part is usually done while emitting.</p>
<h2><a name="p7">Conclusion</a></h2>
<p>If you are going to go the trouble of making a polymorph engine then do it right and don't waste 1-3Kb of code on an engine which can be generically decrypted.</p>
<p>If you are going to make a good engine remember the following points:</p>
<ul>
<li>it must not have fixed bytes in fixed positions.</li>
<li>it must not have fixed bytes in variable positions.</li>
<li>it must not be able to be decrypted by generic decryption engines in AV software.</li>
<li>it helps if the code is heuristically "clean" but it is not the be all and end all of an engine to be this way.</li>
<li>make sure it is a bitch to analyse by AV.</li>
<li>make sure it is a bitch to remove if it does get caught.</li>
</ul>
<p>The final pain in the ass</p>
<p>Some AV are obsessed with EXACT detection - even if they are able to detect your decryptor like they do to many some TPE based viruses - in the end they always want exact detection. So try to make your engine such a hard ass that it might allow detection of the actual "decryptor" part but NOT the virus body - This will be a great annoyance to the AV (even though they may say otherwise).</p>
<p>Remember inexact detection leads to inability to remove the virus and if you virus ever becomes common they will have to answer the customers question "why can't you remove it?".</p>
[<a style="" href="/lib/?lang=EN&amp;index=PO#vrw02">Back to index</a>] [<a href="/lib/vrw02.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vrw02">de</a><a href="/lib/index.php?lang=en&amp;id=vrw02">en</a><a href="/lib/index.php?lang=es&amp;id=vrw02">es</a><a href="/lib/index.php?lang=it&amp;id=vrw02">it</a><a href="/lib/index.php?lang=fr&amp;id=vrw02">fr</a><a href="/lib/index.php?lang=pl&amp;id=vrw02">pl</a><a href="/lib/index.php?lang=ru&amp;id=vrw02">ru</a><a href="/lib/index.php?lang=ua&amp;id=vrw02">ua</a></div>
</body>
</html>
