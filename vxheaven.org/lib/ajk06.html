<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Jeffrey Kephart, Steve White 'Directed-Graph Epidemiological Models of Computer Viruses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Jeffrey Kephart, Steve White"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Kephart, Jeffrey; White, Steve,Directed-Graph Epidemiological Models of Computer Viruses, computer, mathematical, growth, security, model, epidemiology, beta, viruses, models, overline, weak, hierarchical, links, node, virus"/>
<meta name="Description" content="Despite serious concerns raised by the proven ability of computer viruses to spread between individual systems and establish themselves as a persistent infection in the computer population, there have been very few efforts to analyze their propagation theoretically. The strong analogy between biological viruses and their computational counterparts has motivated us to adapt the techniques of mathematical epidemiology to the study of computer-virus propagation. In order to allow for the most general patterns of program sharing, we extend a standard epidemiological model by placing it on a directed graph and use a combination of analysis and simulation to study its behavior. We determine the conditions under which epidemics are likely to occur, and in cases where they do, we explore the dynamics of the expected number of infected individuals as a function of time. We conclude that an imperfect defense against computer viruses can still be highly effective in preventing their widespread proliferation, provided that the infection rate does not exceed a well-defined critical epidemic threshold."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"4b6b14940bd78d4b7781588f007f459de3d75fa1-1498756102-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/ajk06.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Directed-Graph Epidemiological Models of Computer Viruses</h1><p><a href="/lib/?lang=en&amp;author=Kephart%2C%20Jeffrey">Jeffrey Kephart</a>, <a href="/lib/?lang=en&amp;author=White%2C%20Steve">Steve White</a><br/> <em>Proceedings of the IEEE Computer Society Symposium on Research in Security and Privacy, pp. 343-359</em><br/> <em> 1991</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/ajk06.html';</script><div class="ci"><a href="/lib/?ci=ajk06">7</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Directed-Graph%20Epidemiological%20Models%20of%20Computer%20Viruses.pdf">Download</a> PDF (1.59Mb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=EP#ajk06">Back to index</a>] [<a href="/lib/ajk06.html#disqus_thread">Comments</a>]<br/> <form method="post" action="">
<img src="/img/cache/0b9fd596a90421f9f1f68a9760275737.gif" alt="\text{T_EX size}" valign="middle"/>
<select name="TeX_size"><option value="-2">-2</option><option value="-1">-1</option><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select>
<input type="submit" value="Scale"/>
</form><form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
Jeffrey O. Kephart, and Steve R. White<br/>
High Integrity Computing Laboratory<br/>
IBM Thomas J. Watson Research Center<br/>
P.O. Box 704, Yorktown Heights, NY 10598
</address>
<ul>
<li><a href="#c0">Abstract</a></li>
<li><a href="#c1">1 Introduction</a>
<ul>
<li><a href="#c11">1.1 The Problem of Computer Viruses</a></li>
<li><a href="#c12">1.2 Previous Work on Computer Virus Spread</a></li>
<li><a href="#c13">1.3 Previous Epidemiological Models and Their Limitations</a></li>
<li><a href="#c14">1.4 Modelling Viral Epidemics on Directed Graphs</a></li>
</ul></li>
<li><a href="#c2">2 SIS Model on a Random Graph</a>
<ul>
<li><a href="#c21">2.1 Deterministic Approximation</a></li>
<li><a href="#c22">2.2 Probabilistic Analysis</a>
<ul>
<li><a href="#c221">2.2.1 Probabilistic Approximation</a></li>
</ul></li>
<li><a href="#c222">2.2.2 Calculation of the Extinction Probability and the Metastable Distribution</a></li>
<li><a href="#c23">2.3 Simulations</a></li>
<li><a href="#c24">2.4 Weak Links</a></li>
</ul></li>
<li><a href="#c3">3 Hierarchical Model</a></li>
<li><a href="#c4">4 Spatial Model</a>
<ul>
<li><a href="#c41">4.1 Deterministic Analysis</a></li>
<li><a href="#c42">4.2 Simulations on Two-Dimensional Lattices</a></li>
</ul></li>
<li><a href="#c5">5 Conclusion</a></li>
<li><a href="#c6">Acknowledgments</a></li>
<li><a href="#c7">References</a></li>
</ul>
<h2><a name="c0"></a>Abstract</h2>
<p>Despite serious concerns raised by the proven ability of computer viruses to spread between individual systems and establish themselves as a persistent infection in the computer population, there have been very few efforts to analyze their propagation theoretically. The strong analogy between biological viruses and their computational counterparts has motivated us to adapt the techniques of mathematical epidemiology to the study of computer-virus propagation. In order to allow for the most general patterns of program sharing, we extend a standard epidemiological model by placing it on a directed graph and use a combination of analysis and simulation to study its behavior. We determine the conditions under which epidemics are likely to occur, and in cases where they do, we explore the dynamics of the expected number of infected individuals as a function of time. We conclude that an imperfect defense against computer viruses can still be highly effective in preventing their widespread proliferation, provided that the infection rate does not exceed a well-defined critical epidemic threshold.</p>
<h2><a name="c1"></a>1 Introduction</h2>
<p>A fascination with the potential ability of computer programs to mimic biological processes such as self-replication and the workings of the human brain dates from the earliest days of computer science [1, 2, 3]. Until recently, much of the work in this field (with the notable exception of genetic algorithms [4]) was relegated to sporadic reporting in the Mathematical Games department in <em>Scientific American</em>. In the last few years, however, a remarkable resurgence of interest in the analogies between biological and computational mechanisms has revitalized a number of long-neglected fields, including neural networks [5], cellular automata [6], and artificial life [7]. Recently, a new concept has added itself to this intellectual milieu: the computer virus [8] - a self-replicating program that spreads within computing systems, either by attaching itself parasitically to existing programs or by spawning self-sufficient copies of itself<sup><a href="#f1" name="b1">1</a></sup>. The compelling analogies that exist between computer viruses and their biological counterparts have been apparent ever since the term was coined [8]. This has led some authors to suggest that the mathematical techniques which have been developed for the study of the spread of infectious diseases might be adapted to the study of the spread of computer viruses [8, 9]. We believe that. this paper represents the first serious attempt to adapt matthematical epidemiology to this problem.</p>
<p>In the remainder of this section, we give a very brief history of the problem of computer viruses and describe our objectives in stiidying them. Then, we critique some previous work on the spread of computer viruses, following it with a similar discussion of the relevant literature on mathematical epidemiology<sup><a href="#f2" name="b2">2</a></sup>. We conclude that the standard epidemiological approach has much to offer, but that it must be augmented in order to account properly for the localized nature of program sharing (one of the major vectors for viral infection). Finally, we propose a model which explicitly incorporates such locality, discuss our approach to studying the behavior of that, model, and provide an outline for the remainder of the paper.</p>
<h3><a name="c11"></a>1.1 The Problem of Computer Viruses</h3>
<p>Computer viruses were originally thought of as problematic primarily because of their ability to carry out directed attacks against isolated systems [8]. Their potential ability to flow from user to user in a system meant that attacks could reach parts of the system that had been thought to be more secure. In the last few years, however, as viruses have been written and released outside of controlled environments and into the world’s computing community, their ability to spread <em>between</em> individual systems and thus affect a <em>global</em> collection of systems has proved to be of greater concern.</p>
<p>Since the first documented reports of microcomputer viruses in the mid-1980’s [10, 11], they have spread throughout the world. At this date, we estimate very conservatively that there are many thousands of microcomputers with active virus infections, and this population of infected systems continues to spread the infection. The Internet Worm [12, 13, 14, 15] infected at least hundreds and probably thousands of computers on the Internet in the space of a few hours in November, 1988, with the resultant loss of a substantial amount of service and many hours devoted to expurgating it from systems.</p>
 
<p>Our long-term goal is to develop and analyze quantitatively models which capture the spreading characteristics of computer viruses. The potential benefits of doing so can be divided into two major categories.</p>
<p>First, mathematical models could aid in the evaluation and development of general policies and heuristics for inhibiting the spread of viruses. Although it is well known that a general-purpose computing system need only satisfy minimal conditions to be capable in principle of being completely infiltrated by a virus [8],the set of conditions under which this is <em>likely</em> to occur may be considerably more restricted. We wish to gain a quantitative understanding of the vulnerability of current systems to viral infections and to determine the effectiveness of proposed heuristics for inhibiting viral spread [16, 17, 18, 19, 20]. In a similar vein, mathematical modelling of the sort we describe could be helpful in the design of new systems - allowing a reasonable tradeoff between the ease with which legitimate programs can flow and the ease with which viruses can spread.</p>
<p>A second major use for mathematical modelling, more in the spirit of biological epidemiology, is to apply it to a particular epidemic. In its more passive application, modelling can aid in predicting the course of a particular epidemic, so as to plan what resources will be needed to deal with the problem. A more aggressive role for modelling, which is gaining popularity in the biological realm, is to use it to determine the optimal policy for controlling the course of a particular epidemic by isolating or immunizing the population at appropriate times [24].</p>
<p>In this paper, we shall deduce a number of general properties of the spread of computer viruses from simple models which capture some essential features of the networks in which they propagate. We believe that this work is an important first step towards a theory which ultimately will be sufficiently realistic to evaluate specific proposals for thwarting the spread of computer viruses.</p>
<h3><a name="c12"></a>1.2 Previous Work on Computer Virus Spread</h3>
<p>Cohen was the first to define and describe computer viruses in their present form [8]. He demonstrated that, in the worst case, infection can spread to the transitive closure of information flow in a system. In other words, if <em>A</em> can infect <em>B</em> and <em>B</em> can infect <em>C</em>, a virus that originates with <em>A</em> can propagate to <em>C</em>. He performed extensive experiments on a variety of systems (most of them multi-user) which demonstrated that a virus could propagate to a level of security higher than that from which it had originated. He and Murray [9] pointed out the connection between computer virus spread and biological epidemiology, but neither pursued it to the point of developing an explicit model.</p>
<p>Recently, there have been attempts to describe viral spread more quantitatively. Gleissner [21] examined a model of computer virus spread on a multi-user system. Quantitative analysis of the model reproduced Cohen’s result that a virus would reach the transitive closure of information flow, and showed that this could occur at an exponential rate. However, the usefulness of these results was limited because no allowance was made for the fact that individual users of the system might detect and remove viruses or alert other users to their presence. Tippett [22] used the well-known fact that many population models exhibit exponential growth in their initial phases to suggest that the computer virus population might grow to worrisome proportions. However, he did not justify the application of such models to the spread of computer viruses, and the paucity of data on the actual spread of computer viruses makes any such extrapolation extremely suspect. Jones and White [23] examined an analogy between viral spread and infestations of crops by insects and other pests, but did not present an explicit model. Their claim that segregating computing resources leads to an <em>increase</em> in the virus pop ulation seems particularly questionable. Solomon [25] studied a deterministic model of computer virus propagation based upon mathematical epidemiology. The quantitative results that he obtained are equivalent to Eq. 2 of this work. He also introduced and analyzed a novel and potentially important form of inter-virus interaction, whereby the increased vigilance of a user who detects any virus will increase his or her probability of detecting other viruses in the future.</p>
<h3><a name="c13"></a>1.3 Previous Epidemiological Models and Their Limitations</h3>
<p>The first application of mathematical modelling to the spread of infectious disease was carried out by Daniel Bernoulli in 1760 [26]. Although his work predated the identification of the agent responsible for the transmission of smallpox by a century, he formulated and solved a differential equation describing the dynamics of the infection which is still of value in our day. The development of mathematical epidemiology was stalled by a lack of understanding of the mechanism of infectious spread until the beginning of this century [27]. McKendrick developed the first stochastic theory in 1926 [28], and in the 1930’s Kermack and McKendrick [27] established the extremely important threshold theorem, showing that the density of susceptible individuals must exceed a certain critical value in order for an epidemic to occur. In 1975, Bailey [27] reported that the number of references to mathematical epidemiology had quintupled to 500 in a space of 18 years. Currently, there are several papers on mathematical epidemiology per month in <em>Mathematical Biosciences</em>, one of many journals which publishes such work.</p>
<p>In order to apply this vast catalog of mathematical techniques to the study of computer virus spread, we view a single computing system as an individual in a population of similar individuals. Following the usual epidemiological approach, we neglect the details of infection inside a single system and consider an individual to be in one of a small number of discrete states, e.g. <em>infected</em>, <em>uninfected</em>, <em>immune</em>, etc. One might object to such a simplistic classification because some types of computer viruses, such as those that infect a large class of executable files in a system, can cause a system to become “more” infected over time - thereby increasing the rate at which infection can be transmitted from that
 
system. However, the time scale on which the internal infection occurs is generally much shorter than that on which the infection spreads to other systems, so such a simplification is quite reasonable.</p>
<p>A further simplification which is characteristic of epidemiology is to abstract the details of viral transmission into a probability per unit time that a particular infected individual will infect a particular uninfected individual. Likewise, we abstract the details of detection and removal of a virus into a probability per unit time for an infected individual to be "cured". One could in principle derive the infection rates from the known details of the transmission process and the pattern of program sharing. If this information is unavailable (as it was for Bernoulli), it is often possible to simply measure the rates or infer them by fitting the observed course of an epidemic to a model.</p>
<p>Most current epidemiological models are homogeneous, in the sense that an infected individual is equally likely to infect any of the susceptible individuals. Taken literally, this means that a man sneezing in Chicago is as likely to infect someone in New Delhi as he is someone else in Chicago. This approximation turns out to be adequate for diseases such as influenza, in which the disease can be transmitted via casual contact. However, its validity is generally conceded to be questionable for diseases in which each individual has a limited number of potentially infectious contacts.</p>
<p>Program sharing is far from homogeneous, as one can readily establish by a bit of introspection. Most individuals exchange the majority of their programs with just a few other individuals, and never have any contact with the vast majority of the world's population. Another aspect of program sharing which must be taken into account in models is the fact that it can be strongly asymmetric. For example, the rate at which a retailer ships software greatly exceeds the rate at which a customer sends software to the retailer. Such asymmetry is occasionally important in the biological realm as well, particularly in the case of sexually transmitted diseases.</p>
<p>Recognized deficiencies of the assumption of homogeneous, symmetric interactions have encouraged a variety of attempts to incorporate heterogeneity and asymmetry into biological models. The spatial model is one method that has been used to account for local, symmetric interactions [27]. Local, asymmetric interactions have typically been studied by segregating the population by age, sex, or geographic location, and then treating interactions within the individual subpopulations as homogeneous and symmetric [29, 30, 31]. The model presented in this paper is general enough to encompass both of these approaches, the original homogeneous model, and a variety of other heterogeneous interaction models, some of which we shall explore in this paper.</p>
<h3><a name="c14"></a>1.4 Modelling Viral Epidemics on Directed Graphs</h3>
<p>We account for the heterogeneous communication pattern among individual computer systems in a new and general way: by representing an individual system (a microcomputer, for instance) as a node in a graph. Directed edges from a given node <em>j</em> to other nodes represent the set of individuals that can be infected by <em>j</em>. A rate of infection is associated with each edge. Similarly, a rate at which infection can be detected and "cured" is associated with each node.</p>
<p>Throughout this paper, we shall study one of the simplest of the standard epidemiological models, the SIS (susceptible → infected → susceptible) model, on these graphs. In the SIS model, individuals immediately become susceptible once they are cured of an infection. In our case, this represents an extreme in which users do not become more vigilant after having experienced a viral infection. Our emphasis will be on determining the probability that an infection becomes extinct in a specified population. Under the conditions in which an epidemic is viable, we characterize the expected number of infections as a function of time, particularly equilibria and fluctuations about them. We shall recover some of the well-known results for homogeneous interactions as limiting cases of our more general results.</p>
<p>In the next section, we discuss this model on random graphs. In doing so, we gain a good deal of insight into the relationship between homogeneous and graph models of epidemics and develop a number of useful analytical techniques and approximations. Then, in sections 3 and 4, we investigate the model on hierarchical graphs and <em>N</em>-dimensional Cartesian lattices. We shall conclude in section 5 with a summary of our findings, their potential implications for hindering the spread of computer viruses, and recommendations for future work in this area.</p>
<h2><a name="c2"></a>2 SIS Model on a Random Graph</h2>
<p>Due to its structural simplicity and the relative ease with which it can be analyzed, the first type of graph on which we shall study virus propagation is a random graph, illustrated in Fig. 1. We construct a <em>random</em> graph of <em>N</em> nodes by making random, independent decisions about whether to include each of the <em>N(N - 1)</em> possible directional edges which can connect two nodes. If <em>p</em> is the probability for a particular edge to be included in the graph, the expected total number of edges is <em>pN(N - 1)</em>.</p>
<p>In our version of the SIS model, each edge has associated with it an <em>infection</em> rate <img src="/img/cache/6f9b03539d52f0429d60485c3a1a4747.gif" alt="\beta_{j,k}" valign="middle"/> (also referred to as the <em>birth</em> rate of the virus) at which an infected node <em>j</em> can infect an uninfected neighbor <em>k</em>. Similarly, each node <em>j</em> has a <em>cure</em> rate <img src="/img/cache/19b0c0960cefee0255c780ae26490805.gif" alt="\delta_j" valign="middle"/>, (or <em>death</em> rate of the virus) at which it will become cured if it is infected. The probabilities per unit time of infection along any edge and of cure of any node are independent. Once an individual is cured, it is immediately capable of being reinfected. The standard homogeneous interaction version of the SIS model is easily recovered from this more general model by connecting all possible pairs of nodes and making all infection and cure rates identical.</p>
<p>Our goal is to study the behavior of the SIS model on a typical member of the class of random graphs with <em>N</em> nodes and edge probability <em>p</em>. In the remainder of
 
this section we explore several different techniques for doing so: the deterministic approximation, approximate probabilistic analysis, and simulation.</p>
<div align="center">
<img src="img/ajk06/fig1.gif" alt="Figure 1: Random graph with 10 nodes. Black filled and unfilled circles represent infected and uninfected nodes, respectively. The probability per unit time that node 2 will infect node 4 is \beta_{24}, and the probability per unit time that node 2 will be cured is \delta_2. If node 4 becomes infected by either node 2 or node 6, its probability per unit time of being cured will be \delta_4."/>
<p><strong>Figure 1: Random graph with 10 nodes. Black filled and unfilled circles represent infected and uninfected nodes, respectively. The probability per unit time that node 2 will infect node 4 is <img src="/img/cache/1f72c0ebac351054df502d0c20e6473a.gif" alt="\beta_{24}" valign="middle"/>, and the probability per unit time that node 2 will be cured is <img src="/img/cache/cdd49c3bfdabb14da35ffd7d58b9b09f.gif" alt="\delta_2" valign="middle"/>. If node 4 becomes infected by either node 2 or node 6, its probability per unit time of being cured will be <img src="/img/cache/8bf7a485dfaca28e6ea331840bd4d389.gif" alt="\delta_4" valign="middle"/>.</strong></p>
</div>
<h3><a name="c21"></a>2.1 Deterministic Approximation</h3>
<p>It is often the case that a deterministic analysis can provide a reasonably accurate picture of many aspects of the dynamics of an epidemic [27], [32]. For the sake of simplicity, we shall assume that the infection rate along each edge is and the cure rate for each node is <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/>. If the population <em>N</em> is sufficiently large, we can convert <em>I(t)</em>, the <em>number</em> of infected nodes in the population at time <em>t</em>, to <img src="/img/cache/f34768824314b5ba5da4d76c43ce9717.gif" alt="i(t) \equiv I(t) / N" valign="middle"/>, a continuous quantity representing the <em>fraction</em> of infected nodes. Then, if we assume that the details of the graph’s connectivity are fairly unimportant, the dynamics of infection depend only upon how <em>many</em> nodes are infected (rather than <em>which</em> particular nodes are infected). Later, in section 2.3, when we use simulations to test the validity of this assumption, we shall find that it works well when there are many edges in the graph but fails miserably when there are only a few edges per node.</p>
<p>Now consider a particular infected node. Since the expected number of edges in the graph is <em>pN(N - 1)</em>, the expected number of edges emanating from this node (which we shall refer to as the <em>connectivity</em><sup><a href="#f3" name="b3">3</a></sup>, is <img src="/img/cache/4d0dcf7d02520cfc863d5bd06f502388.gif" alt="\overline{b} = p(N-1)" valign="middle"/>. The fraction of neighbors that are susceptible to infection is <em>1 - i</em>, so the expected number of uninfected nodes which can be infected by this node is <img src="/img/cache/c62811466cd5ed1a8cbff2e5021c543d.gif" alt="\overline{b}(1 - i)" valign="middle"/>. Therefore, on average we expect the total system-wide rate at which infected nodes infect uninfected nodes to be <img src="/img/cache/129e65ae3d56899fcf00f2b408c94c4b.gif" alt="\beta'I(1-i)" valign="middle"/>, where <img src="/img/cache/7afee62aa270ce7d26614219458f5d85.gif" alt="\beta'\equiv\beta\overline{b}" valign="middle"/> is the average total rate at which a node attempts to infect its neighbors. The system-wide rate at which infected nodes are cured is simply <img src="/img/cache/ca9cd9dc0247d64e3c0d788b77f32cac.gif" alt="\delta I" valign="middle"/>. By ignoring stochastic variation in the number of branches emanating from each node and in the average infection and cure rates, we obtain a deterministic differential equation describing the time evolution of <em>i(t)</em>:</p>
<p><img src="/img/cache/388207a85e6c50caa4d46d9db0ea6ef1.gif" alt="\frac{di}{dt} = \beta\overline{b}i(1-i)-\delta i" valign="middle"/>. (1)</p>
<p>The solution to Eq. 1 is:</p>
<p><img src="/img/cache/1f280efc6515cb8f708adaefb26e05ad.gif" alt="i(t) = \frac{i_0(1-\rho')}{i_0+(1-\rho'-i_0)e^{-(\beta'-\delta)t}}" valign="middle"/>, (2)</p>
<p>where <img src="/img/cache/9ea0d6161e3cc5e76d61329b4d18ecfb.gif" alt="\rho' \equiv \delta/\beta'" valign="middle"/> is the average ratio of the rate at which an infected node is cured to that at which it infects other nodes, and <img src="/img/cache/83e8bdf19df3e21cc1b8ba2cabe3c10a.gif" alt="i_0 \equiv i(t = 0)" valign="middle"/> is the initial fraction of infected nodes.</p>
<p>If <img src="/img/cache/8b0ca585287d7f495eb3217fd8e70f1e.gif" alt="\rho' &gt; 1" valign="middle"/>, the fraction of infected individuals decays exponentially from the initial value <img src="/img/cache/4a767ada62cc8cca3501af23d53f5c8e.gif" alt="i_0" valign="middle"/> to 0, i.r., there is no epidemic. If <img src="/img/cache/ca6978cd950d1329eaef878b80382559.gif" alt="\rho'\le 1" valign="middle"/>, the fraction of infected individuals grows from the initial value <img src="/img/cache/4a767ada62cc8cca3501af23d53f5c8e.gif" alt="i_0" valign="middle"/> at a rate which is initially exponential (<img src="/img/cache/26d499b489dbb694da88a9c9a2b8e8eb.gif" alt="i_0e^{(\beta'-\delta)t}" valign="middle"/>)and eventually saturates at the value <img src="/img/cache/52cd48d191a31fe8881849e92882923a.gif" alt="1-\rho'" valign="middle"/>. This result has a simple intuitive interpretation: if the average number of neighbors that an individual can infect during the time that it is infected exceeds one, there will be an epidemic; if this number is less than one, the infection will die out. The existence of this threshold was first established for homogeneous interactions by Kermack and McKendrick [27] in the 1930’s, and here we will show that it holds for directed graphs as well. According to this deterministic result, all that matters is the total rate <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> at which an infected node transmits infection to other nodes - not the details of how it distributes that infection.</p>
<h3><a name="c22"></a>2.2 Probabilistic Analysis</h3>
<p>As we have just seen, the deterministic approximation is useful for estimating some important characteristics of epidemics - the conditions under which they occur, the rate at which they grow, and the expected number of infections once they have reached equilibrium. However, since it ignores the stochastic nature of an epidemic, it provides no information about other important features of the dynamics, including the size of fluctuations in the number of infected individuals and the possibility that fluctuations will result in extinction of the infection. Consider for a moment the issue of the survival of the virus in a population. The deterministic analysis concludes that there will be an epidemic if <img src="/img/cache/ca6978cd950d1329eaef878b80382559.gif" alt="\rho'\le 1" valign="middle"/> and there will not be one if <img src="/img/cache/ddb2050e68f005fe0df632b6d88349f8.gif" alt="\rho'&gt;1" valign="middle"/>. However, it is intuitively clear that, even if <img src="/img/cache/ca6978cd950d1329eaef878b80382559.gif" alt="\rho'\le 1" valign="middle"/>, a statistical fluctuation might wipe out the virus before it spreads to enough individuals to become firmly established. With a little more effort, we can formulate an approximate probahilistic analysis which captures these and certain other important aspects of epidemics which can not be obtained from a deterministic analysis.</p>
 
<p>As in the deterministic analysis of the previous section, we shall assume that the number of infected nodes sufficiently characterises the state of a system, <em>i.e.</em>, the details of <em>which</em> nodes are infected are relatively unimportant. Although it is very easy to construct particular graphs for which such details are important (<em>e.g.</em>, small graphs with a large variation in the in-degree and out-degree of nodes), we assume that the properties of most members of the class of random graphs with <em>N</em> nodes and edge probability <em>p</em> will not be sensitive to them. Again, we must resort to simulation (in section 2.3) to test the validity of these assumptions. First, we shall describe the probabilistic approximation. Then, we shall use it to calculate various quantities of interest.</p>
<h4><a name="c221"></a>2.2.1 Probabilistic Approximation</h4>
<p>Let <em>p(I,t)</em> denote the probability distribution for there to be <em>I</em> infected individuals at time <em>t</em>. Many quantities of interest can be calculated from this distribution. The probability that the infection is extinct at time <em>t</em> is represented by <em>p(0,t)</em>, and the expected number of infected individuals and its variance are easily computed by appropriate sums over the <em>p(I,t)</em>. The time-evolution of this distribution is given by:</p>
<p><img src="/img/cache/04b826221c1f97c3f47c9a9a370c5506.gif" alt="\frac{dp(I,t)}{dt}=-p(I,t)[R_{I\rightarrow I_+} + R_{I\rightarrow I_-}] + p(I_+,t)R_{I+\rightarrow I} + p(I_-,t)R_{I_-\ \rightarrow I}" valign="middle"/>, (3)</p>
<p>where <img src="/img/cache/07bfe9e7bba0d5d715f0e3d4e9f05134.gif" alt="I_-\equiv I-1, I_+\equiv I + 1" valign="middle"/>, and <img src="/img/cache/f745177de8d27778fe96696e21b19ffb.gif" alt="R_{a\rightarrow b}" valign="middle"/> denotes the rate at which transitions occur from state <em>a</em> to state <em>b</em>.</p>
<p>The rates <img src="/img/cache/f745177de8d27778fe96696e21b19ffb.gif" alt="R_{a\rightarrow b}" valign="middle"/> can be calculated as follows. The probability per unit time that a new infedion will occur is simply the number of infected nodes times the rate at which each node tries to infect each of its neighbors times the probability that a given neighbor is susceptible times the number of neighbors. If we assume that the various probabilities are independent (<em>i.e.</em>, there is no correlation between the probability that a node is infected and the probability that its neighbors are infected), we obtain:</p>
<p><img src="/img/cache/cd91425f073d5ba01629dcff32ec21b0.gif" alt="R_{a\rightarrow a+1} = a(1-a/N)\beta'" valign="middle"/>. (4)</p>
<p>where <img src="/img/cache/7afee62aa270ce7d26614219458f5d85.gif" alt="\beta'\equiv\beta\overline{b}" valign="middle"/> is the average total rate at which a node attempts to infect its neighbors. The probability per unit time that an infected node will be cured is simply the number of infected nodes times the rate at which each is cured:</p>
<p><img src="/img/cache/a65a08e33674a776f4ae501445c843a3.gif" alt="R_{a\rightarrow a-1} = a\delta" valign="middle"/>. (5)</p>
<p>Substituting these approximations for the rates into Eq. 3, we obtain:</p>
<p><img src="/img/cache/28825bc24c883745b4b932fc920cd51c.gif" alt="\frac{dp(I,t)}{dt}=-p(I,t)[I(1-i)\beta'+\delta I]+p(I_+,t)I_+\delta+p(I_,t)[I_-(1-i_-)\beta']" valign="middle"/>, (6)</p>
<p>where <img src="/img/cache/0cc0840558c52626868d5b7b74ee4253.gif" alt="i \equiv I/N" valign="middle"/> and <img src="/img/cache/cd05a59a431d7dd560c32121cf46e169.gif" alt="i_\pm \equiv I_\pm/N" valign="middle"/>. For a graph with <em>N</em> nodes, this is a set of <em>N + 1</em> coupled linear differential equations which is relatively simple to solve because the matrix is tridiagonal.</p>
<p>Figure 2 compares the expected number of infected individuals as a function of time as obtained from Eq. 6 with the deterministic result given by Eq. 2. The graph contains 100 nodes with connectivity <img src="/img/cache/dfac437bbbc03cad05c865f2fb6c9d2d.gif" alt="\overline{b}=5" valign="middle"/>, and the infection and cure rates are <img src="/img/cache/db8954aa8d83f79b3935726a5a11e364.gif" alt="\beta'=1.0" valign="middle"/> and <img src="/img/cache/24ccd2f77c81fe018e52dd5d4dbca8a9.gif" alt="\delta=0.2" valign="middle"/>, respectively<sup><a href="#f4" name="b4">4</a></sup>. The agreement between the deterministic and stochastic averages is quite good, except for a notable difference between <em>t</em> = 7 and <em>t</em> = 12, when the number of infections starts to saturate. The expected magnitude of the stochastic deviations from run to run, represented by the gray area, grow to a maximum of &plusmn;20 at <em>t</em> = 6.3 and then diminish to &plusmn;4.51 in equilibrium. The large deviations during the exponential rise can be attributed to the extreme sensitivity of the number of infected individuals at a particular time to random jitter in when the exponential rise occurs. Thus, one would expect a lot of variance in the number of infected individuals from one simulation run to another. However, in equilibrium the size of the infected population is completely insensitive to the moment at which the exponential rise occurred, and the variations from one run to another are much smaller. In equilibrium, the ergodic hypothesis [33] also allows us to interpret these variations as the magnitude of fluctuations about the equilibrium.</p>
<p>The same dynamics are presented from a different point of view in Figure 3, which shows snapshots of <em>p(I,t)</em> at successive stages in its evolution. The parameters are the same as in Fig. 2. Initially, at time <em>t</em> = 0, the probability distribution is a delta function at <em>I</em> = 1 (<em>i.e.</em>, there is exactly one infected node). As time passes, the probability distribution splits into two components: a delta function at <em>I</em> = 0 (corresponding to extinction of the virus) and a “survival” component which is initially distributed exponentially (<em>t</em> = 1). At first, the mean of the survival component increases exponentially in time, and the standard deviation grows quite large, reaching a maximum of 20 at <em>t</em> = 6.3. Soon, however, the population becomes saturated with infected individuals, and the survival component is nearly gaussian with a mean of 79.75 and a standard deviation of 4.51 at <em>t</em> = 20. This “metastable” phase is extremely long-lived, but the extinction component grows extremely slowly at the expense of the survival component until finally it is all that remains. In general, any population of viruses will eventually die out, but the time scale on which this takes place is so long as to be unobservable unless the graph is quite small. Eventual extinction is inevitable because there is a very tiny probability that all infected individuals will detect and cure their infection at approximately the same time.</p>
<p>The fact that the metastable phase has a finite lifetime
 
means that we cannot define the probability that the virus becomes extinct without specifying the time period of interest. However, in practice the choice of a “time limit” has little effect on the measured extinction probability provided that it is somewhere within the wide timespan of the metastable regime. For those epidemics which have not died out by a certain time limit, we are interested in the form of the survival component - the distribution <em>p(I,t)</em> for <em>I</em> > 0. Although <em>p(I,t)</em> itself approaches 0 as <img src="/img/cache/6b5d6a53c31d2a26b57e5ea617cbd6d4.gif" alt="t\to\infty" valign="middle"/>, the conditional probability for there to be <em>I</em> infections given that there is at least one infection approaches a well-defined <em>metastable</em> distribution:</p>
<p><img src="/img/cache/222c2bbe9a4a9a7e1a32ac1a59709108.gif" alt="p_\infty\equiv\lim_{t\to\infty}\frac{p(I,t)}{\sum_{I=1}^Np(I,t)}\text{ for }I\ge1" valign="middle"/>. (7)</p>
<p>The survival component is then</p>
<p><img src="/img/cache/2b13a789fdb9c9347fb6655182342c73.gif" alt="p_{survival}=(1-p(0,t))p_\infty" valign="middle"/>. (8)</p>
<p>Given that an epidemic is still active after a given amount of time, we can calculate from <img src="/img/cache/7c5456396236123a72fd0ac753d3ee44.gif" alt="p_\infty" valign="middle"/> the expected number of infected individuals and the fluctuations about that expectation, and these quantities approach a well-defined asymptote.</p>
<div align="center">
<img src="img/ajk06/fig2.gif" alt="Figure 2: Comparison of the number of infected nodes I as a function of time in the deterministic and stochastic models. The total population is 100 nodes. The average rate at which a node attempts to infect its neighbors is \beta'=1.0, and the cure rate is \delta=0.2. Thus the system is above the classical threshold for an epidemic by a factor of 5. Black curve: deterministic I(t). White curve: stochastic average of I(t). Gray area: One standard deviation about the stochastic average. The final equilibrium values differ by only 0.3%. For t &lt; 15, the gray area can be interpreted as the magnitude of fluctuations about the equilibrium."/>
<p><strong>Figure 2: Comparison of the number of infected nodes <em>I</em> as a function of time in the deterministic and stochastic models. The total population is 100 nodes. The average rate at which a node attempts to infect its neighbors is <img src="/img/cache/db8954aa8d83f79b3935726a5a11e364.gif" alt="\beta'=1.0" valign="middle"/>, and the cure rate is <img src="/img/cache/24ccd2f77c81fe018e52dd5d4dbca8a9.gif" alt="\delta=0.2" valign="middle"/>. Thus the system is above the classical threshold for an epidemic by a factor of 5. Black curve: deterministic <em>I(t)</em>. White curve: stochastic average of <em>I(t)</em>. Gray area: One standard deviation about the stochastic average. The final equilibrium values differ by only 0.3%. For <em>t</em> > 15, the gray area can be interpreted as the magnitude of fluctuations about the equilibrium.</strong></p>
</div>
<div align="center">
<img src="img/ajk06/fig3.gif" alt="Figure 3: Evolution of the probability distribution for the number of infected individuals in the stochastic approximation. All parameters are the same as in Fig. 2. Starting from a state in which one individual is infected at t = 0, the distribution splits into an “extinction” component (I = 0) and a “survival component” which eventually assumes a gaussian form with the same average and standard deviation as in Fig. 2. The survival component lasts for an extremely long time, but decays with a time constant of 1.12 \times 10^{34}. Note: vertical scales are not all the same."/>
<p><strong>Figure 3: Evolution of the probability distribution for the number of infected individuals in the stochastic approximation. All parameters are the same as in Fig. 2. Starting from a state in which one individual is infected at <em>t</em> = 0, the distribution splits into an “extinction” component (<em>I</em> = 0) and a “survival component” which eventually assumes a gaussian form with the same average and standard deviation as in Fig. 2. The survival component lasts for an extremely long time, but decays with a time constant of <img src="/img/cache/138fd5f13c01eef054a9f0edffb9a858.gif" alt="1.12 \times 10^{34}" valign="middle"/>. Note: vertical scales are not all the same.</strong></p>
</div>
<h3><a name="c222"></a>2.2.2 Calculation of the Extinction Probability and the Metastable Distribution</h3>
<p>By making a few more approximations, we can derive expressions for the probability of extinction as a function
 
of time, the expected lifetime of the epidemic, and the form of the long-lived metastable distribution <img src="/img/cache/7c5456396236123a72fd0ac753d3ee44.gif" alt="p_\infty" valign="middle"/>.</p>
<p>First, we shall derive an approximate expression for <img src="/img/cache/7c5456396236123a72fd0ac753d3ee44.gif" alt="p_\infty" valign="middle"/>. Setting the derivative on the left-hand side of Eq. 6 equal to zero, we obtain an equation for the equilibrium distribution <img src="/img/cache/904cb96cf8b4f807b770bd9f976e34a2.gif" alt="p(I)\equiv p(I,t\to\infty)" valign="middle"/>:</p>
<p><img src="/img/cache/a8f1bfc61542798ac37e0dedc7655f6d.gif" alt="p(I+1)=\frac{I(1-i+\rho')}{I_+\rho'}p(I)-\frac{I_-(1-i_-)}{I_+\rho'}p(I-1)" valign="middle"/>, (9)</p>
<p>where <em>p(I)=0</em> for <em>I</em> &lt; 0 or <em>I > N</em> and <img src="/img/cache/233836ca58fefe7c6c278d6f6d1867f6.gif" alt="\rho'\equiv\delta/\beta'" valign="middle"/>. Substituting <em>I</em> = 0 into Eq. 9, we obtain <em>p(1) = 0</em>. We can then substitute <em>p(1) = 0</em> into the equation to obtain <em>p(2) = 0</em>. Continuing in the same fashion, we can show trivially that <em>p(I) = 0</em> for all <em>I</em> > 0. This demonstrates our previous claim that the only equilibrium solution is the extinction component.</p>
<p>However, the survival component is <em>nearly</em> a solution, and is only prevented from being one because of the slow leakage of probability to the extinction component. We may obtain the survival component by artificially stopping this leakage, which is achieved by setting <em>p(I = 1)</em> to some arbitrary constant <img src="/img/cache/03b632315ee5bee654b60a6bd902a249.gif" alt="p_1" valign="middle"/> and using Eq. 9 to generate <em>p(I)</em> for <em>I</em> > 1. The resultant distribution - the survival component - should then be normalized such that the sum of the probabilities is unity. Carrying out this procedure with <img src="/img/cache/8b0ca585287d7f495eb3217fd8e70f1e.gif" alt="\rho' &gt; 1" valign="middle"/>, one can show that the survival component has an extremely short lifetime, which is consistent with the conclusion of the deterministic analysis that no epidemic can occur if the infection rate is less than the cure rate. On the other hand, if <img src="/img/cache/af0fc393585f56452a01077292df699a.gif" alt="\rho'\le\frac{1}{N+1}" valign="middle"/>, one can show that practically all of the nodes will be infected, and the lifetime of the survival component will be extremely long.</p>
<p>In the more interesting intermediate case in which <img src="/img/cache/8821278592149bec916f765aa6361ba4.gif" alt="\frac{1}{N+1} \le \rho' \le 1" valign="middle"/>, <em>p(I)</em> attains a maximum for some <img src="/img/cache/4b73e844be0563dd32e10e42f7d11605.gif" alt="1 \le I = I_{max} \le N" valign="middle"/>. The value of <img src="/img/cache/d97304cbafc40d74d35ee27c96d0c58f.gif" alt="I_{max}" valign="middle"/> is determined by the condition <img src="/img/cache/f2e1143d673144330cb8af49332d0adf.gif" alt="p(I_{max}-1) \approx p(I_{max}) \approx p(I_{max}+1)" valign="middle"/>. Substitution of this condition into Eq. 9 yields</p>
<p><img src="/img/cache/2254e7909d001e30b1f6a53cb8f39bb0.gif" alt="I_{max} \approx N (1 - \rho') + \calO(1)" valign="middle"/>. (10)</p>
<p>Motivated by the form of the survival component in the last two frames of Fig. 3, we match a gaussian to <img src="/img/cache/ffe48482e62ff08503f1e3c21070fb70.gif" alt="p(I_{max}-1), p(I_{max})" valign="middle"/>, and <img src="/img/cache/00b702978369405576d9e0423e1e77ca.gif" alt="p(I_{max}+1)" valign="middle"/> and normalize the sum of the extinction and survival components to unity, with the result:</p>
<p><img src="/img/cache/c90a539e336de14e397c25f74f575f0f.gif" alt="p_\infty(I)=\frac{e^{-(I-I_{max})^2/2N\rho'}}{\sqrt{2\pi N\rho'}}" valign="middle"/>. (11)</p>
<p>Thus we find that the metastable distribution is a gaussian with mean <img src="/img/cache/7af437effafd6aa73ae824119a09fefe.gif" alt="N(1-\rho')" valign="middle"/> and standard deviation <img src="/img/cache/00b0f06592accdf2c5636b406d4d7741.gif" alt="\sqrt{N\rho'" valign="middle"/>. The mean is identical to that obtained from the deterministic approximation, and the standard deviation is virtually equal to that obtained from the numerical solution of Eq. 6 depicted in Fig. 3.</p>
<p>Having obtained the metastable distribution, we can now use it to estimate the lifetime of the metastable survival component. First, we must obtain an expression for <em>p(0,t)</em>, the extinction probability as a function of time. Returning to the dynamical equation for the evolution of the probability distribution (Eq. 6), substituting <em>I</em> = 0, and using Eqs. 8 (which is valid once the distribution has assumed its metastable form) and 11, we obtain:</p>
<p><img src="/img/cache/eb2510e4e3ee4955ccca4f759db704ea.gif" alt="\frac{dp(0,t)}{dt}=\delta p(1,t)\approx\delta(1-p(0,t))\frac{e^{-N(1-\rho')^2/(2\rho')}}{\sqrt{2\pi N\rho'}}" valign="middle"/>. (12)</p>
<p>Solving Eq. 12 for <em>p(0,t)</em> , we find that, after the initial transient, the survival component decays exponentially with a characteristic lifetime given by</p>
<p><img src="/img/cache/613a092312f8ea37cc4580c50d209723.gif" alt="\tau=\frac{e^{N(1-\rho')^2/(2\rho')}}{\delta\sqrt{2\pi N\rho'}}" valign="middle"/>. (13)</p>
<p>Numerical solution of Eq. 9 reveals that Eq. 13 yields a rather severe overestimate of the lifetime of the metastable phase. This can be attributed to the fact that, while the gaussian approximation of Eq. 11 to the survival component is very good in the vicinity of <img src="/img/cache/d97304cbafc40d74d35ee27c96d0c58f.gif" alt="I_{max}" valign="middle"/>, it is exceedingly poor in the far reaches of the tail, at <em>I</em> = 1. However, the numerical solution confirms that the functional form of Eq. 13 is correct, <em>i.e.</em>, the lifetime of a graph increases approximately exponentially with the number of nodes. For example, the lifetime of <img src="/img/cache/138fd5f13c01eef054a9f0edffb9a858.gif" alt="1.12 \times 10^{34}" valign="middle"/> for a 100-node graph is reduced to only 888 for a 10-node graph, all other parameters being equal. The constant multiplying <em>N</em> in the exponent is about half that predicted by Eq. 13 when <img src="/img/cache/54165ed650af63efbd740271f832aeac.gif" alt="\rho'=0.2" valign="middle"/>.</p>
<p>Finally, we can obtain a good approximation to the probability that the infection will become extinct before it reaches the metastable phase by letting the number of nodes <img src="/img/cache/e723c1e75d7026b63f244ac799e6692d.gif" alt="N\to\infty" valign="middle"/> do (rendering the lifetime infinite). Then Eq. 6 simplifies to:</p>
<p><img src="/img/cache/a4f75fd9b1d56e28d5e0046d19560dfa.gif" alt="\frac{dp(I,t)}{dt}=-p(I,t)[I(\beta'+\delta)]p(I_+,t)[I_+\delta]+p(I_-,t)[I_-\beta']" valign="middle"/>, (14)</p>
<p>which is the well-known linear birth and death process [34]. A solution can be obtained by the method of generating functions, with the result:</p>
<p><img src="/img/cache/cd2a4b34658e0511eae016f11ce1bce8.gif" alt="
\begin{eqnarray}
\lim_{t\to\infty}p(0,t) &amp;=&amp; {\rho'}^{I_0}&amp;\ if\ &amp;\rho'\lt1\\
			&amp;=&amp; 1		&amp;\ if\ &amp;\rho'\ge1,
\end{eqnarray}" valign="middle"/>, (15)</p>
<p>where <img src="/img/cache/7cb83b83e7602ed56ce440eaac109fdf.gif" alt="I_0" valign="middle"/> is the number of infected nodes which are originally present in the population.</p>
<p>To summarize, the probabilistic analysis corroborates the deterministic result that an epidemic can not occur if <img src="/img/cache/156cb1bdd58a506e10696394bb04a8bc.gif" alt="\rho'\ge 1" valign="middle"/>. Contrary to the findings of the deterministic
 
analysis, even if <img src="/img/cache/bba33b3859b8644732b21bd999b00186.gif" alt="\rho'\le1" valign="middle"/>, the probability that an epidemic will not occur is greater than zero, being equal to <img src="/img/cache/f03b3382b68c24f359a5f2cb6d33946b.gif" alt="{\rho'}^{I_0}" valign="middle"/>, where <img src="/img/cache/7cb83b83e7602ed56ce440eaac109fdf.gif" alt="I_0" valign="middle"/> is the number of infected nodes initially present in the population. This is not really a discrepancy. The deterministic analysis is founded on the assumption of an infinite number of nodes and an original <em>fraction</em> of infected nodes <img src="/img/cache/4a767ada62cc8cca3501af23d53f5c8e.gif" alt="i_0" valign="middle"/>. Thus <img src="/img/cache/7cb83b83e7602ed56ce440eaac109fdf.gif" alt="I_0" valign="middle"/> is infinite, and the probabilistic formula (Eq. 15) yields an extinction probability of zero. The probabilistic and deterministic analyses agree that the average number of infected nodes in equilibrium is <img src="/img/cache/7af437effafd6aa73ae824119a09fefe.gif" alt="N(1-\rho')" valign="middle"/>, and the probabilistic analysis reveals that the root-mean-square fluctuations are <img src="/img/cache/8ac042cda0ab42257a88cbfe577cb9c2.gif" alt="\sqrt{N\rho'}" valign="middle"/>. Thus the relative size of the fluctuations decreases as <img src="/img/cache/7572e688de7f1788f205ddcdded98fd0.gif" alt="\frac{1}{\sqrt{N}}" valign="middle"/>, which lends some justification to the assumption that they are zero in the deterministic analysis.</p>
<h3><a name="c23"></a>2.3 Simulations</h3>
<p>Both the deterministic and stochastic analyses of the model required a number of assumptions which can only be tested by simulation. We have simulated the model using a straightforward event-driven implementation. A graph is generated randomly according to the prescription given at the beginning of this section, and a single initially-infected node is selected randomly. Then, the simulation proceeds one event (<em>i.e.</em>, an attempted infection or cure of a node) at a time, using time steps generated randomly according to an exponential distribution<sup><a href="#f5" name="b5">5</a></sup>. The mean of this distribution is determined by the probabilities per unit time of infection and cure, the number of infected nodes, and the number of edges emanating from the collection of infected nodes.</p>
<p>Figure 4 compares a typical simulation run on a 100-node graph to the corresponding deterministic solution, using the parameters of Figs. 2 and 3. The simulation run follows the deterministic solution reasonably well, except that the equilibrium appears to be lower.</p>
<div align="center">
<img src="img/ajk06/fig4.gif" alt="Figure 4: Comparison between average number of infected individuals vs. time as given by deterministic theory and a typical simulation run on a randomly-generated graph with 100 nodes. The average number of edges emanatingfrom each node is \overline{b} = 5, and all other parameters are as givenin Fig. 2. The magnitude of the fluctuations agrees reasonably well with that predicted by the stochastic theory (compare with Fig. 2), but the average number of infected individuals is slightly lower. This discrepancy can be attributed to the low connectivity of the graph (\overline{b} = 5)."/>
<p><strong>Figure 4: Comparison between average number of infected individuals vs. time as given by deterministic theory and a typical simulation run on a randomly-generated graph with 100 nodes. The average number of edges emanatingfrom each node is <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 5, and all other parameters are as givenin Fig. 2. The magnitude of the fluctuations agrees reasonably well with that predicted by the stochastic theory (compare with Fig. 2), but the average number of infected individuals is slightly lower. This discrepancy can be attributed to the low connectivity of the graph (<img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 5).</strong></p>
</div>
<p>To investigate this discrepancy, we performed 2500 simulation runs using the same parameters but different seeds for the random number generator. In 25.9±0.9% of the runs, the population became extinct by <em>t</em> = 1200 (a time limit that we chose to be comfortably within the metastable regime). This is noticeably larger than the extinction probability of 0.20 predicted by Eq. 15. For each of those runs which survived, we measured the average number of infected individuals between <em>t</em> = 200 and <em>t</em> = 1200 and the fluctuations about this equilibrium. The average equilibrium for these runs was 75.01±0.04, which as we suspected from Fig. 4 is significantly lower than the deterministic prediction of <img src="/img/cache/19945e22cb0e8980bcf79e7534874761.gif" alt="N(1-\rho') = 80.0" valign="middle"/> and the stochastic prediction of 79.75. The average magnitude of the fluctuations within a run was 4.857±0.005, somewhat larger than the stochastic prediction of 4.508. The variation in the equilibrium obtained across different simulation runs was only ±1.65, indicating that the entire class of random graphs is in fact well-characterized by these measurements - one of the main assumptions made in the deterministic and stochastic analyses.</p>
<p>Why is the extinction probability a bit higher and the average number of infected individuals a bit lower than predicted? The fault must lie in one or more of the approximations that were used to derive the deterministic and stochastic theories. The most likely suspect is the neglect of the particular details of how nodes are connected to one another. This assumption came into play in at least two guises. First, it allowed us to assume that the dynamics could be expressed solely in terms of how many nodes were infected, without having to delve into the details of <em>which</em> were infected (a problem that would be completely intractable). Second, we neglected variation in the number of nodes that a given node could ii:fect, assuming that every node tried to infect exactly <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> other nodes. Intuitively, we expect both of these assumptions to become increasingly valid as the connectivity <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> is increased.</p>
<p>Imagine for a moment the extreme limit of tenuousness (below what is referred to by random graph theorists as the <em>percolation threshold</em> [35]), in which most nodes are isolated and a few are joined in small clusters. It is readily apparent that infection cannot spread beyond the small cluster in which the initially infected individual is located. Thus the equilibrium level should be depressed substantially below the homogeneous limit. If the infection is confined to very small clusters, it becomes much more likely that all infections in the cluster will be detected and cured at approximately the same time. In such a case, the lifetime of the metastable
 
phase could become less than our chosen time limit, in which case the measured extinction probability would increase. Thus, infections should die out more easily in tenuous graphs.</p>
<p>This conjecture is borne out by Figure 5, in which we have varied the connectivity of the graph <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/>, keeping the average total rate at which a node-attempts to infect its neighbors fixed at <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> = 1.0. For <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> &lt; 1.0, it is nearly certain that the infection will die out quickly. Tke extinction probability drops precipitously for 1 &lt; <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> &lt; 2 and slowly approaches the homogeneous limit of 0.20 as <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> is increased to 10 and beyond. When the simulations are repeated on graphs of 1000 rather than 100 nodes, the behavior is quite similar, except that the transition in the range 1 &lt; <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> &lt; 2 becomes slightly sharper. In Fig. 5b, we see that the average number of infections in equilibrium is severely depressed below the homogeneous limit in tenuous graphs. Again, there is a characteristic curve which is fairly insensitive to the size of the graph except in the transition region, which becomes sharper for larger graphs. We have observed similar qualitative behavior in simulations in which <img src="/img/cache/6bd59ff4906c58bb3cd35fa5c458f8d2.gif" alt="\rho'" valign="middle"/> = 0.5, in which case the tracsition region is shifted upwards to approximately 2 &lt; <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> &lt; 4.</p>
<h3><a name="c24"></a>2.4 Weak Links</h3>
<p>In the random graph model that we have examined so far, a node is able to infect only a few other nodes in the graph (at least for the typical situation in which <img src="/img/cache/24f395bbaff8bd74a9077ebcdaf39128.gif" alt="\overline{b} \ll N" valign="middle"/>). Although it is probably true that most users share most of their programs with a small number of other individuals, there is generally a much larger group of other individuals with whom they exchange programs every once in a while. To what extent will these extra pathways enable viruses to spread?</p>
<p>We study the effect of infrequent sharing with a large number of other individuals by modifying the random graph model slightly, giving a node a small but finite chance of infecting any node which is not explicitly connected to it. In addition to the previously-defined infection rate <img src="/img/cache/b0603860fcffe94e5b8eec59ed813421.gif" alt="\beta" valign="middle"/>, which we shall now refer to as the "strong" infection rate, we define the "weak" infection rate <img src="/img/cache/87df69bca200f7b3371c597ac54937b4.gif" alt="\beta_w" valign="middle"/>. As before, the average total-infection rate through the "strong" links is given by <img src="/img/cache/4e8bb53691df646e6950095a9e1a97cd.gif" alt="\beta\overline{b}" valign="middle"/>. The average total infection rate through the "weak" links is <img src="/img/cache/c990c6d7357ec10644ef95246371db1d.gif" alt="\beta_w(N - \overline{b} - 1)" valign="middle"/>. Thus the total infection rate through all links is:</p>
<p><img src="/img/cache/3d6c9cc3e55476ac09963ffe06bbf4ec.gif" alt="\beta'\equiv\beta\overline{b}+\beta_w(N-\overline{b}-1)=(1+\omega)\beta\overline{b}" valign="middle"/>, (16)</p>
<p>where</p>
<p><img src="/img/cache/c314f85a0f9fa61277b5404856517351.gif" alt="\omega\equiv\frac{\beta_w(N-\overline{b}-1)}{\beta\overline{b}}" valign="middle"/> (17)</p>
<p>is the ratio between the total weak and strong infection rates.</p>
<div align="center">
<img src="img/ajk06/fig5.gif" alt="Figure 5: Extinction probability (a) and average number of infections (b) vs. connectivity \overline{b} for random graph with the usual infection and cure rates: \beta'=1.0 and \delta=0.2. Each point represents an average over 2500 simulation runs. For \overline{b} \lt 1, it was extremely rare for an epidemic to survive beyond the time limit of 1200, despite the fact that the infection rate is 5 times the classical epidemic threshold. For higher connectivities, the extinction probability and the average number of infected individuals approach the values predicted by the classical homogeneous interaction theory. The dependence of these quantities upon the connectivity changes very little when the number of nodes in the graph is increased from 100 to 1000; the transition region becomes slightly sharper. (Note: the measured equilibria for 1000-node graphs have been divided by 10 to scale them properly to the 100-node results.)"/>
<p><strong>Figure 5: Extinction probability (a) and average number of infections (b) vs. connectivity <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> for random graph with the usual infection and cure rates: <img src="/img/cache/db8954aa8d83f79b3935726a5a11e364.gif" alt="\beta'=1.0" valign="middle"/> and <img src="/img/cache/24ccd2f77c81fe018e52dd5d4dbca8a9.gif" alt="\delta=0.2" valign="middle"/>. Each point represents an average over 2500 simulation runs. For <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> &lt; 1, it was extremely rare for an epidemic to survive beyond the time limit of 1200, despite the fact that the infection rate is 5 times the classical epidemic threshold. For higher connectivities, the extinction probability and the average number of infected individuals approach the values predicted by the classical homogeneous interaction theory. The dependence of these quantities upon the connectivity changes very little when the number of nodes in the graph is increased from 100 to 1000; the transition region becomes slightly sharper. (Note: the measured equilibria for 1000-node graphs have been divided by 10 to scale them properly to the 100-node results.)</strong></p>
</div>
<p>Figure 6 displays the effect upon the extinction probability and the average number of infections in equilibrium of various ratios <img src="/img/cache/260b57b4fdee8c5a001c09b555ccd28d.gif" alt="\omega" valign="middle"/>. The results for <img src="/img/cache/ec7f4ab987a1b85f9dc3d77b6ca72b8f.gif" alt="\omega = 0" valign="middle"/> are simply those of Fig. 5, <em>i.e.</em>, there are no weak links. When <img src="/img/cache/260b57b4fdee8c5a001c09b555ccd28d.gif" alt="\omega" valign="middle"/> is increased to 0.2, the qualitative behavior of both the extinction probability and the average number of infections is the same, but the transition region is shifted towards more tenuous connectivities. For example, a graph with <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 0.9, which is practically impervious to infection when there are no weak lipks, becomes behaviorally equivalent to a graph with <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 1.5: the extinction probability drops to nearly 1/2, and nearly half of the population is infected in equilibrium. When <img src="/img/cache/260b57b4fdee8c5a001c09b555ccd28d.gif" alt="\omega" valign="middle"/> is increased further to 0.5, the transition region disappears.
 
Thus for <img src="/img/cache/33af424eddf67b8cfdfc9b2df79cbec1.gif" alt="\overline{b}\to0" valign="middle"/> there is a finite probability (0.40) for an epidemic to occur, and the average number of infected individuals in equilibrium is 40. These limiting values are easily understood by completely disregarding the strong links, in which case we have from Eq. 16 that the effective value of <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> is 1/3 of its nominal value, or <img src="/img/cache/ff32ddb3edeef4b8f68d11af8294e084.gif" alt="{\beta'}_{eff}\equiv 1/3" valign="middle"/>. Since <img src="/img/cache/b71afbe18d8bf523e8ef2922d52988ee.gif" alt="\delta = 0.2 \le {\beta'}_{eff}" valign="middle"/>, the conditions for an epidemic to occur are satisfied by the weak links alone, with an effective value of <img src="/img/cache/a1c9dadfc03beaa890d1892585b24207.gif" alt="{\rho'}_{eff} \equiv \delta/{\beta'}_{eff} = 0.6" valign="middle"/>, in agreement with the simulation.</p>
<div align="center">
<img src="img/ajk06/fig6.gif" alt="Figure 6: Extinction probability (a) and average number of infections (b) vs. connectivity \overline{b} for random graph with weak links. Three different values of the ratio \omega between the sum of the weaklink infection rates and the sum of the strong-link infection rates are presented. As usual, the infection and cure rates arc \beta' = 1.0 and \delta = 0.2. Each point represents an average over 2500 simulation runs on 100-nodegraphs. As the weak links become stronger, the extinction probability and the average number of infections approach their homogeneous limits over a wider range of connectivities."/>
<p><strong>Figure 6: Extinction probability (a) and average number of infections (b) vs. connectivity <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> for random graph with weak links. Three different values of the ratio <img src="/img/cache/260b57b4fdee8c5a001c09b555ccd28d.gif" alt="\omega" valign="middle"/> between the sum of the weaklink infection rates and the sum of the strong-link infection rates are presented. As usual, the infection and cure rates arc <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> = 1.0 and <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/> = 0.2. Each point represents an average over 2500 simulation runs on 100-nodegraphs. As the weak links become stronger, the extinction probability and the average number of infections approach their homogeneous limits over a wider range of connectivities.</strong></p>
</div>
<p>The simulation results of Figs. 5 and 6 suggest that the homogeneous limit is reasonably good when the total infection rate is spread among a sufficient number of nodes. However, when too much of the total infection rate is concentrated into too few nodes, epidemics have a much harder time establishing themselves than would be predicted by the homogeneous approximation. For example, according to Fig. 6a, when the connectivity <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 1 and there are no weak links, the epidemic threshold is approximately <img src="/img/cache/380d89c91d1d6233d2879c244c6f5499.gif" alt="\beta'=5\delta" valign="middle"/>, which is five times the classical value. Other simulations that we have not presented here indicate that, for <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 2, the epidemic threshold is about twice the classical value. These results are unaffected by the number of nodes <em>N</em> in the graph, provided that <em>N</em> exceeds about 100. Weak links diminish the increase in the threshold, but do not eliminate it. For example, when the total infection rate through the weak links is 0.2 times the total infection rate through the strong links (<img src="/img/cache/260b57b4fdee8c5a001c09b555ccd28d.gif" alt="\omega" valign="middle"/> = 0.2), the threshold can be five times the classical value, but only if the graph is twice as tenuous (<img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 0.5) as it needs to be when there are no weak links.</p>
<h2><a name="c3"></a>3 Hierarchical Model</h2>
<p>Motivated by a desire to study the effect of infrequent program sharing with many other individuals, we augmented the random graph model by introducing weak links in section 2.4. However, the classification of links into just two types - strong and weak - is a bit crude. It is probably more realistic to assume that an individual exchanges programs at a very high rate with very few other individuals, at a lower rate with a larger class of other individuals, at an even lower rate with an even larger class of others, <em>etc</em>. This leads naturally to the hierarchical model illustrated in Figure 7.</p>
<div align="center">
<img src="img/ajk06/fig7.gif" alt="Figure 7: Binary hierarchical graph with 3 levels. Infection rates between nodes separated by a given number of levels are listed to the left of the tree. Infected and uninfected nodes are represented by black and unfilled circles, respectively. Initially, only node 2 was infected, but it quickly infected node 1. For a while, nodes 1 and 2 attempted to infect one another (to no effect, since they were already infected). Eventually, node 1attempted successfully to infect node 3. Node 3 quickly infected node 4, but was cured soon afterward. Node 3 will probably be infected soon by node 4, but nodes 5, 6, 7, and 8 will probably not be infected for a relatively long time."/>
<p><strong>Figure 7: Binary hierarchical graph with 3 levels. Infection rates between nodes separated by a given number of levels are listed to the left of the tree. Infected and uninfected nodes are represented by black and unfilled circles, respectively. Initially, only node 2 was infected, but it quickly infected node 1. For a while, nodes 1 and 2 attempted to infect one another (to no effect, since they were already infected). Eventually, node 1attempted successfully to infect node 3. Node 3 quickly infected node 4, but was cured soon afterward. Node 3 will probably be infected soon by node 4, but nodes 5, 6, 7, and 8 will probably not be infected for a relatively long time.</strong></p>
</div>
<p>The hierarchical model has an unexpected side benefit. Note that all nodes with a given subtree communicate with one another more frequently than with any node in any other subtree. Thus, the hierarchy of rates automatically enforces a hierarchy of cliques<sup><a href="#f6" name="b6">6</a></sup>. In the
 
computer community, cliques of users certainly exist, although not in such an extreme form as in this model. For example, users within a department may share software frequently among themselves, less frequently with users in other departments of the same company or university, and still less frequently with users in other cities or countries. The random graph model and others derived from it are incapable of accounting for such correlations because of the way in which they are constructed - the connections are chosen randomly and independently.</p>
<p>For simplicity, we assume that the frequency of contact between two nodes decreases geometrically with the distance <img src="/img/cache/09bb12ff6af52a773448036b5e06350b.gif" alt="\cal{l}" valign="middle"/> between them (the number of levels one must go up in the tree to reach a common ancestor), while the size of the class of neighbors at a given distance grows geometrically with <img src="/img/cache/09bb12ff6af52a773448036b5e06350b.gif" alt="\cal{l}" valign="middle"/>. More explicitly, assume that the hierarchy consists of a binary tree with <em>L</em> levels. Then there are <img src="/img/cache/62eb4164f4b40a5c5a84b23db23e5845.gif" alt="N = 2^L" valign="middle"/> nodes. Suppose that the infection rate between nodes separated by a distance <img src="/img/cache/09bb12ff6af52a773448036b5e06350b.gif" alt="\cal{l}" valign="middle"/> is given by <img src="/img/cache/4f4967494769b33c6984ff28114913bd.gif" alt="\beta_0r^{\cal{l}-1}" valign="middle"/>.The number of nodes at distance <img src="/img/cache/09bb12ff6af52a773448036b5e06350b.gif" alt="\cal{l}" valign="middle"/> is simply <img src="/img/cache/348b6bca28bd9d9432bb8980e9ffce1c.gif" alt="2^{\cal{l}-1}" valign="middle"/>. Therefore, the total infection rate from one node is</p>
<p><img src="/img/cache/e5791785abbf1355dc3d54a8f8533bff.gif" alt="\beta'=\sum_{\cal{l}=1}^{\cal{l}=L}\beta_0(2r)^{\cal{l}-1}=\beta_0\frac{1-(2r)^L}{1-2r}" valign="middle"/> (18)</p>
<p>As before, we assume that the cure rate for each node is <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/>.</p>
<p>By keeping <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> and <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/> fixed and varying the <em>localization parameter r</em>, we can explore a wide range of situations. When <em>r</em> = 0, the network effectively consists of isolated pairs of nodes with infection rate <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/>. By setting <em>r</em> = 1, we obtain the homogeneous limit, in which the infection rate between all pairs of nodes is equal to <img src="/img/cache/e86ccd40783c9c40c833e3582329b4dd.gif" alt="\frac{\beta'}{N}" valign="middle"/>. Thus, the parameter <em>r</em> ought to be similar in its effect to the connectivity <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/>.</p>
<p>We have investigated the dependence of the extinction probability upon the localization parameter by means of simulation. The results are summarized in Fig. 8. As expected, the extinction probability exhibits threshold behavior qualitatively similar to that of Fig. 5a. For strongly localized graphs, extinction of the infected population is virtually guaranteed, even though the infection rates are well above the classical threshold (by a factor of five for <img src="/img/cache/9a4da49820dc17a8226bfde1461079c2.gif" alt="\rho'= 0.2" valign="middle"/> and a factor of two for <img src="/img/cache/37efca01019f81d5ec6d38f9c7d7d631.gif" alt="\rho' = 0.5" valign="middle"/>). As <img src="/img/cache/9da88350c6231b67863affcaa4d5df88.gif" alt="r\to1" valign="middle"/>, the extinction probability aproaches the homogeneous limit, as expected. The upward shift in position and the increase in width of the transition region as <img src="/img/cache/6bd59ff4906c58bb3cd35fa5c458f8d2.gif" alt="\rho'" valign="middle"/> is increased are both consistent with what we have observed for larger values of <img src="/img/cache/6bd59ff4906c58bb3cd35fa5c458f8d2.gif" alt="\rho'" valign="middle"/> as the connectivity is varied in the random graph model.</p>
<p>Note that we have not presented the corresponding curves for the average number of infected individuals in equilibrium. The reason is quite interesting. When <em>r</em> is in the transition region, the individual simulation runs often fail to attain a well-defined equilibrium. A typical example, shown in Fig. 9, displays a character much more mercurial than that of a typical simulation in the random graph model (Fig. 4). In Fig. 4, a welldefined equilibrium level is reached by <em>t</em> = 10. However, in Fig. 9, the number of infected individuals <em>I</em> varies over a large range in a very irregular fashion even after many hundreds of time units. The range within which <em>I</em> varies lies far below the homogeneous limit of <img src="/img/cache/fa82f38cd3e29406114def4c605c8307.gif" alt="N(1-\rho')=102.4" valign="middle"/>, as is expected since <em>r</em> is in the transition region. Inspection of a number of individual simulation runs strongly suggests that the metastable phase, if it exists, is much shorter in duration than its random graph counterpart. This is reasonable because rapid extinction is consistent with the small number of infected individuals and the large magnitude of the fluctuations in that quantity.</p>
<div align="center">
<img src="img/ajk06/fig8.gif" alt="Figure 8: Extinction probability vs. localization parameter r for SIS model on hierarchical graph of 128 nodes. For sufficiently localized interactions (small r), rapid extinction of the virus is virtually assured, even when the infection rate is well above the classical epidemic threshold (by a factor of 5 for \rho' = 0.2 and a factor of 2 for \rho' = 0.5). The relatively small width of the transition region is reminiscent of Fig. 5a."/>
<p><strong>Figure 8: Extinction probability vs. localization parameter <em>r</em> for SIS model on hierarchical graph of 128 nodes. For sufficiently localized interactions (small <em>r</em>), rapid extinction of the virus is virtually assured, even when the infection rate is well above the classical epidemic threshold (by a factor of 5 for <img src="/img/cache/6bd59ff4906c58bb3cd35fa5c458f8d2.gif" alt="\rho'" valign="middle"/> = 0.2 and a factor of 2 for <img src="/img/cache/6bd59ff4906c58bb3cd35fa5c458f8d2.gif" alt="\rho'" valign="middle"/> = 0.5). The relatively small width of the transition region is reminiscent of Fig. 5a.</strong></p>
</div>
<p>We have also performed simulations on larger hierarchical graphs with as many as 8192 nodes. Interestingly, in the transition region the average number of infections does not increase with the size of the graph, and the magnitude and irregular character of the fluctuations is unaltered. This contrasts strongly with the behavior of random graphs, for which the number of infected individuals scales linearly with <em>N</em> and the relative size of the fluctuations decreases as <img src="/img/cache/11e20d73c8440be32494bdbc3d383be1.gif" alt="\sqrt{N}" valign="middle"/>. In some simulation runs, one can identify a series of plateaus in <em>I(t)</em>, separated by relatively rapid growth spurts. The growth spurts occur when a node "gets lucky" and infects a distant node, which then spreads the infection throughout a previously untouched region of the graph. When <em>r</em> is sufficiently far above the transition region, <em>I(t)</em> continues to grow until it saturates eventually at the homogeneous equilibrium. The rate at which it does so is much slower than for a random graph and is extremely
 
sensitive to <em>r</em> (see Fig. 12). The functional form of the growth rate and its dependence upon <em>r</em> is not yet known.</p>
<div align="center">
<img src="img/ajk06/fig9.gif" alt="Figure 9: Number of infections I vs. time for typical simulation run on 128-node hierarchical graph with localization parameter r = 0.1. The infection and cure rates have their usual values of \beta' = 0.1 and \delta = 0.2. The aimless, irregular drift in the number of infected individuals at a value much lower than the homogeneous equilibrium (I=102.4) is characteristic of simulation runs with localization parameter lying within the transition region (see \rho' = 0.2 curve in Fig. 8)."/>
<p><strong>Figure 9: Number of infections <em>I</em> vs. time for typical simulation run on 128-node hierarchical graph with localization parameter <em>r</em> = 0.1. The infection and cure rates have their usual values of <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> = 0.1 and <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/> = 0.2. The aimless, irregular drift in the number of infected individuals at a value much lower than the homogeneous equilibrium (<em>I</em>=102.4) is characteristic of simulation runs with localization parameter lying within the transition region (see <img src="/img/cache/6bd59ff4906c58bb3cd35fa5c458f8d2.gif" alt="\rho'" valign="middle"/> = 0.2 curve in Fig. 8).</strong></p>
</div>
<h2><a name="c4"></a>4 Spatial Model</h2>
<p>The hierarchical model of the previous section allowed us to explore the consequences of <em>localized</em> program sharing. In this section, we shall learn more about the effects of locality by studying epidemics on a completely different topological structure - a <em>d</em>-dimensional Cartesian lattice. Each point in the lattice represents a node which can infect or be infected by all nodes within some local neighborhood. As in the hierarchical model, locality immediately implies the existence of cliques, but their form is somewhat different in the spatial model. For example, consider the neighborhood of infectible nodes surrounding node <em>A</em>. If we move one step to the rigl-t to node <em>B</em>, we find that <em>B</em>'s neighborhood has many nodes in common with <em>A</em>'s.</p>
<p>Although it may be less realistic in some respects than the hierarchical model, the spatial model offers the advantage of being more amenable to deterministic analysis. Given our experience that random graphs with sufficient connectivity are reasonably well-described by a deterministic approximation, we expect this to hold for the spatial model as well, provided that the neighborhood is sufficiently large. First, we shall use a deterministic approximation to derive an equation for the spatio-temporal dynamics of an epidemic. Then, we shall confirm these results with simulations.</p>
<h3><a name="c41"></a>4.1 Deterministic Analysis</h3>
<p>To begin the analysis, imagine imbedding a graph in a <em>d</em>-dimensional space by associating each node <em>j</em> arbitrarily with a position <img src="/img/cache/4a38c93ec7b5b0dc5b7d5ff76e0a8ae4.gif" alt="\vec x_j" valign="middle"/>. We can derive a deterministic approximation for <img src="/img/cache/11efbb8b4c3b25a8643cd4781b42a022.gif" alt="i(\vec x,t)" valign="middle"/>,the fraction of infected individuals at position <img src="/img/cache/8bb50605ff63759107f02187b2ee1a8d.gif" alt="\vec x" valign="middle"/> at time <em>t</em>, as follows. Let <img src="/img/cache/802d78971fca31265d1a3852f24efc1c.gif" alt="\beta(\vec x,\vec x')" valign="middle"/> represent the rate at which the node at <img src="/img/cache/a490f28254fc04a3685764a27ac2c8d2.gif" alt="\vec x'" valign="middle"/> attempts to infect the node at <img src="/img/cache/8bb50605ff63759107f02187b2ee1a8d.gif" alt="\vec x" valign="middle"/> and <img src="/img/cache/0e55501366413ac7302d01870734a17f.gif" alt="\delta(\vec x)" valign="middle"/>) represent the rate at which a node at <img src="/img/cache/8bb50605ff63759107f02187b2ee1a8d.gif" alt="\vec x" valign="middle"/> is cured (if it was infected). Then, following the same considerations as were used to derive the deterministic approximation for random graphs, we obtain:</p>
<p><img src="/img/cache/55360743509d082c74c5593313194623.gif" alt="\frac{\partial i(\vec x,t)}{\partial t} = \sum_{\vec x'}\beta(\vec x,\vec x')i(\vec x',t)(1-i(\vec x',t))-\delta(\vec x)i(\vec x,t)" valign="middle"/>, (19)</p>
<p>Note that Eq. 19 is a slightly generalized form of Eq. 1, with node indices replaced by positions.</p>
<p>Now assume that a node can only interact with nodes lying within some small local neighborhood, and that the infection rates between two nodes depend only upon the distance between them. Furthermore, assume that the cure rate <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/> is independent of <img src="/img/cache/8bb50605ff63759107f02187b2ee1a8d.gif" alt="\vec x" valign="middle"/>. Then, if <img src="/img/cache/11efbb8b4c3b25a8643cd4781b42a022.gif" alt="i(\vec x,t)" valign="middle"/> and <img src="/img/cache/15caf6019d07ded9af4a74434b59470e.gif" alt="\beta(|\vec x - \vec x'|)" valign="middle"/> vary sufficiently slowly from one node to another, we can treat them as continuous functions, in which case it can be shown that Eq. 19 becomes approximately:</p>
<p><img src="/img/cache/f637cb4c6eb678657adb963bd7df62a3.gif" alt="\frac{di(\vec x,t)}{dt} = \beta i(\vec x,t)(1-i(\vec x,t))-\delta i(\vec x,t)+D(1-i(\vec x,t))\nabla^2 i(\vec x,t)" valign="middle"/>, (20)</p>
<p>where</p>
<p><img src="/img/cache/ff4a93c39c244ab43d087d5bdc8d2cff.gif" alt="D\equiv\frac{1}{2}\int_{\vec r}d\vec r\beta(r)r^2" valign="middle"/>. (21)</p>
<p>The first two terms in Eq. 20 are the familiar growth and decay terms that appear in Eq. 1. By themselves, they describe growth or decay of the level of infection at each point in space independently of the dynamics at any other point in space. The last term is something new. It is a second-order spatial derivative which accounts for diffusion of infection between different points in space. The diffusion coefficient <em>D</em> can be derived for various assumptions about the influence of nodes upon their neighbors. For example, if <img src="/img/cache/bbbaf3c1ce388650c765a0a12641e9c0.gif" alt="\beta(\vec r)" valign="middle"/> is uniform within a hypercubic volume <img src="/img/cache/8287b9f28088c1bc8c36fbb78d97e30b.gif" alt="V=L^d" valign="middle"/> with integral <img src="/img/cache/b5c6a398aebac4ce2f3bdc991b1b8245.gif" alt="\beta'\equiv\normalsize\int_{\vec r}d\vec r\beta(\vec r)" valign="middle"/>, <img src="/img/cache/3f08b8298f66b3c2a81c7e7ba968444f.gif" alt="D = \beta'L^2/24" valign="middle"/>. If <img src="/img/cache/bbbaf3c1ce388650c765a0a12641e9c0.gif" alt="\beta(\vec r)" valign="middle"/> is gaussian-distributed with standard deviation <img src="/img/cache/ffe9f913124f345732e9f00fa258552e.gif" alt="\eta" valign="middle"/>, <img src="/img/cache/386bb7ab0f24b5e342d2e5de0b613e4c.gif" alt="D = \beta'\eta^2/2" valign="middle"/>.</p>
<p>Due to the assumed radial symmetry of <img src="/img/cache/01157d7100cb118e3385385441268d47.gif" alt="\beta(|\vec x -\vec x'|)" valign="middle"/>, <img src="/img/cache/11efbb8b4c3b25a8643cd4781b42a022.gif" alt="i(\vec x,t)" valign="middle"/> will remain radially symmetric if the initial condition <img src="/img/cache/32ff562a9435dcaf4021fc251bb47023.gif" alt="i(\vec x,0)" valign="middle"/> is. Such a choice greatly simplifies both the calculation and the presentation of the results. Figure 10 depicts the typical course of an epidemic in two dimensions as predicted by Eq. 20, where <img src="/img/cache/b8d8d3492bc91384b70b95f05bd0cc54.gif" alt="i(x,0)" valign="middle"/> is a narrow gaussian with volume <img src="/img/cache/70cb0d80bfc2f30d56804877776ee594.gif" alt="0.0001\pi" valign="middle"/>.The population inhabits a circle of radius 1, so this initial distribution constitutes 1/10000 of the population.</p>
<p>In its first phase of growth, the pulse grows in height (<em>t</em> = 4). When the pulse saturates at the equilibrium
 
value of 0.8, it remains pinned at that value but keeps spreading outward radially. The leading front of the expanding circle develops a sharp edge, with a radius that increases at a constant velocity (note the positions at <em>t</em> = 20, 50,and 80). Thus the number of infected individuals, proportional to the area of the circle, increases <em>quadratically</em> with time. In <em>d</em> dimensions, the infection expands outward at constant velocity as a sharp-edged sphere, so the number of infected individuals grows as <img src="/img/cache/0fbeafd9dead0ba52d88b4777f5c9f2c.gif" alt="t^d" valign="middle"/>. This is of course much slower than the exponential growth of the random graph model. Finally, when the infection reaches the entire population, the total fraction of infected individuals reaches the same limit as in the random graph model, and its distribution is spatially uniform.</p>
<div align="center">
<img src="img/ajk06/fig10.gif" alt="Figure 10: Density of infected individuals i as a function of radius r from the initially source of infection at times t = 0,4, 20, 50, and 80. As usual, the infection and cure rates are \beta' = 1.0 and \delta = 0.2. The diffusion coefficient D=3.75\times10^{-5}. Initially, 0.0001 of the population is infected, represented by a narrow gaussian with a standard deviation of 0.02 near r = 0. At first, the height of the gaussian grows, until it saturates at the homogeneous limit of 0.8. Then, the infection enters a diffusive phase, growing outward at constant velocity in a circle with a fairly sharp boundary of fixed shape. Eventually, the spatial distribution of infection becomes uniform, with 80% of the individuals being infected."/>
<p><strong>Figure 10: Density of infected individuals <em>i</em> as a function of radius <em>r</em> from the initially source of infection at times <em>t</em> = 0,4, 20, 50, and 80. As usual, the infection and cure rates are <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> = 1.0 and <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/> = 0.2. The diffusion coefficient <img src="/img/cache/d296b1e0616e003aec4f845ec0979acc.gif" alt="D=3.75\times10^{-5}" valign="middle"/>. Initially, 0.0001 of the population is infected, represented by a narrow gaussian with a standard deviation of 0.02 near <em>r</em> = 0. At first, the height of the gaussian grows, until it saturates at the homogeneous limit of 0.8. Then, the infection enters a diffusive phase, growing outward at constant velocity in a circle with a fairly sharp boundary of fixed shape. Eventually, the spatial distribution of infection becomes uniform, with 80% of the individuals being infected.</strong></p>
</div>
<h3><a name="c42"></a>4.2 Simulations on Two-Dimensional Lattices</h3>
<p>We have simulated epidemics on a two-dimensional square array wrapped around in both dimensions to form a torus (so as to avoid edge effects). The neighborhood about each node is an <img src="/img/cache/29d74cbfae8724d7c08f43c0ad1a81f5.gif" alt="\cal{l}\text{-by-}\cal{l}" valign="middle"/> block centered on (but not including) itself. The infection rate is equal to <img src="/img/cache/08048d2aa9b7a7dda3e30bc5d956d252.gif" alt="\frac{\beta'}{\cal{l}^2-1}" valign="middle"/> for each node within that neighborhood and zero for all nodes outside of it. The dynamical details of the simulation are identical to those which we have presented for the random graph; the only difference lies in the choice of infection rates between pairs of nodes. Thus, if we were to expand the neighborhood to include all of the nodes, our resultant system would be equivalent to a fully-connected graph and its dynamics would be described by the homogeneous limit.</p>
<p>Figure 11 illustrates the state of a typical simulation run auring the spreading phase of the epidemic. Initially, the central node in the 100 by 100 array was infected. The size of the neighborhood was chosen to be <img src="/img/cache/09bb12ff6af52a773448036b5e06350b.gif" alt="\cal{l}" valign="middle"/>=3, <em>i.e.</em>, it was composed of the 8 nearest neighbors. It is interesting to note that, despite the fact that <img src="/img/cache/798caebcf4c5f3ccd5d53510bb1793bd.gif" alt="\beta'(\vec r}" valign="middle"/> is square in shape, the pattern of infection is roughly circular. In fact, the greater generality of radial spreading is expected from details of the derivation of Eq. 20 which we have omitted here.</p>
<div align="center">
<img src="img/ajk06/fig11.gif" alt="Figure 11: State of an epidemic in diffusion phase (t = 50) as obtained from a simulation on a 100-by-100 array. The infection and cure rates are \beta' = 1.0 and \delta = 0.2, as usual. Each node can infect the 8 neighbors lying within a 3-by-3 square centered on itself. Black and white squares represent infected and uninfected individuals, respectively. As in the theoretical curves of Fig. 10, the boundary of the expanding circle of infected nodes is roughly circular and fairly sharp (despite the fact that the infection neighborhood is square)."/>
<p><strong>Figure 11: State of an epidemic in diffusion phase (<em>t</em> = 50) as obtained from a simulation on a 100-by-100 array. The infection and cure rates are <img src="/img/cache/41cc4cd855bd99837d3117b0222185a3.gif" alt="\beta' = 1.0" valign="middle"/> and <img src="/img/cache/dfb8ee14bdfb693943c64a8af7fbd9c7.gif" alt="\delta = 0.2" valign="middle"/>, as usual. Each node can infect the 8 neighbors lying within a 3-by-3 square centered on itself. Black and white squares represent infected and uninfected individuals, respectively. As in the theoretical curves of Fig. 10, the boundary of the expanding circle of infected nodes is roughly circular and fairly sharp (despite the fact that the infection neighborhood is square).</strong></p>
</div>
<p>Simulations verify the quadratic growth with time of the total number of infected individuals. Figure 12 compares the relative rates at which the equilibrium is attained in the two-dimensional lattice with that of the random and hierarchical graphs. In order to provide a fair comparison, the infection and cure rates were their usual values of <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> = 1.0 and <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/> = 0.2, and the number of nodes in the simulation of each of the three models was chosen to be as close as possible to 10000. Furthermore, the connectivity of the random graph and the localization parameter of the hierarchical graph were chosen to be well above the transition region, so that the equilibrium would be as close as possible to the homogeneous limit.</p>
<p>It must be emphasized that the curves in Fig. 12 are not to be taken as an absolute comparison of the growth rates for these three models. The exact rates depend upon the diffusion coefficient in the spatial model and are extremely sensitive to the localization parameter in the hierarchical model. (For example, when <em>r</em> is increased by only 10%, the growth rate is increased by about 35%.) It is the functional form of the growth that
 
is of the greatest importance. As expected, the random graph attains the equilibrium at an exponential rate, while the two-dimensional spatial model reaches it at a much slower, quadratic rate. The functional form of the growth rate for the hierarchical graph is not yet known, but in this and other simulations it appears to be quite slow.</p>
<p>Thus both of the local models that we have studied exhibit very slow growth compared to the random graph model (<em>e.g.</em>, polynomial rather than exponential in time). We expect that this will prove to be the case for other more complicated and realistic models that take locality into account. In local models, the majority of the infected nodes find themselves in a region that has already reached local equilibrium. It is only the relatively small number of nodes on the expanding front of the infected region that can spread the infection to the uninfected nodes lying outside the region. Since they can only infect nodes lying close by, the vast majority of uninfected nodes lying outside the region are unavailable. The spread of infection on a random graph is much more efficient because the boundary of the infected region expands so rapidly that it quickly encompasses the entire graph. It is likely that the real situation lies somewhere in between the extremes represented by the random graph model and the two local models that we have studied in this section and the previous one.</p>
<div align="center">
<img src="img/ajk06/fig12.gif" alt="Figure 12: Comparison of fraction i of infected individuals vs. time for random graph, hierarchical graph, and two-dimensional graph SIS models. The infection and cure rates have their usual values of \beta' = 1.0 and \delta = 0.2. The number of nodes in the simulations are 10000 for the random and spatial models and 2^{13} = 8192 for the hierarchical model. In order to ensure that the equilibrium was close to the homogeneous limit, the connectivity of the random graph was chosen to be \overline{b} = 10, and the localization parameter for the hierarchical graph was r = 0.225. The parameters for the spatial graph are as given in Fig. 11. As predicted, the growth in the infected populationis quadratic in the spatial model, which is much slower than the exponential growth exhibited by the random graph model. The functional form of the growth of i in the hierarchical graph is not yet known."/>
<p><strong>Figure 12: Comparison of fraction <em>i</em> of infected individuals vs. time for random graph, hierarchical graph, and two-dimensional graph SIS models. The infection and cure rates have their usual values of <img src="/img/cache/1d20e87c46153a58bd076c6e7e02ed55.gif" alt="\beta'" valign="middle"/> = 1.0 and <img src="/img/cache/77a3b715842b45e440a5bee15357ad29.gif" alt="\delta" valign="middle"/> = 0.2. The number of nodes in the simulations are 10000 for the random and spatial models and <img src="/img/cache/4531b6467fafd5eaf383243287f30da3.gif" alt="2^{13}" valign="middle"/> = 8192 for the hierarchical model. In order to ensure that the equilibrium was close to the homogeneous limit, the connectivity of the random graph was chosen to be <img src="/img/cache/ad56baf9691dac9231a90c27ef79e27d.gif" alt="\overline{b}" valign="middle"/> = 10, and the localization parameter for the hierarchical graph was <em>r</em> = 0.225. The parameters for the spatial graph are as given in Fig. 11. As predicted, the growth in the infected populationis quadratic in the spatial model, which is much slower than the exponential growth exhibited by the random graph model. The functional form of the growth of <em>i</em> in the hierarchical graph is not yet known.</strong></p>
</div>
<h2><a name="c5"></a>5 Conclusion</h2>
<p>Cohen showed that a <em>perfect</em> defense against computer viruses is impossible; we have shown that it may be unnecessary. Defense mechanisms are adequate for preventing widespread propagation of viruses if the rate at which they detect and remove viruses is sufficiently high relative to the rate at which viruses spread between users. The fact that an epidemic can only occur if the infection rate exceeds a finite critical threshold has been known in the biological realm for over half a century; we have shown that this result holds in the computational realm as well. For conditions which seem likely to hold in the computational domain, we have discovered that the epidemic threshold is actually higher than its classical value. Another encouraging finding is that, even if the infection rate is above the epidemic threshold, the number of infected individuals grows much more slowly than predicted by the standard homogeneous interaction model if the interactions are local.</p>
<p>In section 2, we formulated the directed random graph model and studied its behavior using three different techniques: deterministic approximation, stochastic approximation, and simulation. We obtained theoretical results which were essentially identical to those of the classical homogeneous interaction theory by ignoring the details of the connectivity of the graphs. In particular, we found that epidemics can not occur unless the ratio of the total rate at which an infected individual attempts to infect other individuals exceeds the rate at which individuals become cured. If the infection rate exceeds this threshold, an epidemic is still not certain, but it becomes increasingly probable as the infection rate is increased further above the threshold. The average number of infected individuals in equilibrium increases with the infection rate. It can take on any value, from near zero when the infection rate is just above threshold to the size of the population when the cure rate (and hence the threshold) is zero.</p>
<p>Simulations showed that these theoretical results hold when the connectivity of the graphs is sufficiently large, but fail miserably when the connectivity is small. In particular, if the total infection rate is held fixed while the connectivity is decreased, there is a dramatic decrease in the probability of an epidemic and in the average number of infected individuals. In other words, when the connectivity is small, the epidemic threshold is greatly increased over the value predicted by our extension of the classical homogeneous interaction theory. To our knowledge, this is the first observation of an apparent interaction between two well-known threshold phenomena: the epidemic threshold discovered by Kermack and McKendrick in the 1930’s [27] and the percolation threshold for random graphs discovered by Erdos and Rényi in 1960 [36].</p>
<p>In section 2.4, we added weak links to the random graph model to simulate the effect of infrequent program sharing with many other individuals. In this case, the epidemic threshold is intermediate between the random-graph and the homogeneous values. The hierarchical model of section 3 was introduced to account for a distribution of rates of program sharing in a more realistic
 
manner than the weak-link model. In addition, it allowed us to capture the phenomenon of user cliques - groups of users which share programs with one another more frequently than with other users. We observed an increase of the epidemic threshold over its classical value which was very similar in character to that of the random graph model. Individual simulations of epidemics on hierarchical graphs revealed a number of interesting and surprising features. In some cases, the number of infected individuals fluctuated wildly; in others, the number of infections formed a series of plateaus separated by rapid growth spurts.</p>
<p>Taken together, the results of the random graph, weak-link, and hierarchical models demonstrate that, when most of the total infection rate is concentrated into just a few nodes, epidemics have a much harder time establishing themselves than predicted by the classical homogeneous theory. We are currently trying to develop theories which can describe this very interesting effect quantitatively.</p>
<p>By studying a spatial model in section 4, we viewed the effect of locality and user cliques from another perspective and obtained some analytic results based upon a diffusion-like equation for viral spreading in space and time. We found that the number of infected individuals grows polynomially in time, as opposed to the exponential growth rate in random graphs. The growth rate in the hierarchical model also appears to be polynomial under some conditions, but we have not yet obtained analytic results in this case. We believe that actual systems are intermediate between the extremes of random connectivity and local connectivity, so we expect the growth rate of infection to be intermediate between that of the random graph model and that of the hierarchical and spatial models.</p>
<p>The epidemiological approach to the study of computer virus propagation is quite general because it makes no assumptions about <em>how</em> viruses are detected and removed. <em>Any</em> mechanism that diminishes the infection rate or increases the detection rate will help to prevent widespread epidemics. The existence of a sharp threshold for epidemics means that it is worth doing everything possible to bring the infection rate below this threshold, but that further effort is not warranted. Our discovery that the topology of program sharing can have a profound effect upon the ability of viruses to spread may eventually lead to alternative methods for suppressing epidemics which could supplement the above-mentioned efforts to affect the infection and cure rates. While the models that we have studied are still somewhat simplistic, we expect that future work on more complex and realistic models will retain many of the features that we have observed here.</p>
<p>The work that we have presented here immediately suggests a number of areas for further research. We are currently trying to gain a better understanding of how the epidemic threshold depends upon the connectivity of a random graph. Our present understanding of the hierarchical model is solely based upon simulations, and we would like to develop theoretical expressions for the epidemic threshold as a function of the localization parameter and for the functional form of the growth rate of an epidemic. The peculiar phenomena that we have observed in individual simulations on hierarchical graphs, such as wild fluctuations and plateaus in the number of infected individuals as a function of time, deserve further attention. We would also like to experiment with disordered hierarchical graphs, in which the hierarchy of rates is retained but the locality of interactions is strongly disturbed or destroyed. This might allow us to isolate the effects of locality more cleanly.</p>
<p>We have not touched upon several areas that merit future investigation. A number of other models in the epidemiological literature have important analogs in the computational realm. In particular, the SIR (susceptible → infected → removed) model, in which individuals become permanently immune once they have been infected and cured, would be appropriate in the limit where users become extremely vigilant after having experienced a viral infection. The actual situation is probably somewhere between the SIS and SIR extremes. After discovering a viral infection, users may initially become much more conscientious about using anti-virus software, but if a long time passes without incident they may relax their vigilance to some degree. Models analogous to this scenario have been studied within a biological context, for there are some cases in which the body gradually loses its immunity to a particular disease [27]. Another interesting notion is the "kill signal", a message sent by a node upon discovering that it is infected, warning all nodes to which it is connected that they may also be infected. Our preliminary investigations suggest that this may be one of the most powerful means for thwarting epidemics. Certainly, it makes a good deal of intuitive sense and has long been used in the medical profession for the purpose of stamping out sexually transmitted diseases. The kill signal is just one of many examples of adaptive responses to viral infection. A close study of the immune system might prove to be a rich source of ideas for other adaptive methods for control and suppression of computer virus infections.</p>
<p>Finally, we feel that it is of the utmost importance to collect data on program-sharing habits and viral spread rates and incorporate them into our models. User surveys and centralised reporting of virus incidents would be invaluable. As epidemiologists have discovered, the task of collecting such information and incorporating it into models is fraught with difficulties, but we hope to benefit from the decades of experience that they have accumulated in dealing with such problems.</p>
<p>We are not the first to apply the mathematical techniques of epidemiology outside of the biological realm. Mathematical epidemiology has been used to gain insights into how ideas propagate [37] and, more practically, to develop novel algorithms for maintaining replicated databases [38]. As often occurs when mathematical techniques are adapted to new applications, we have been forced to extend those techniques in somewhat unfamiliar and unanticipated directions. We hope that in so doing we have enriched mathematical epidemiology and all fields to which it can be applied as much as we have benefitted from using it.</p>
 
<h2><a name="c6"></a>Acknowledgments</h2>
<p>We are grateful to William C. Arnold, David M. Chess and Steve H. Weingart for useful conversations on how computer viruses behave in the real world, and to Scott Kirkpatrick for encouraging our interest in analytic and modelling approaches to this problem. We thank Paula K. Sweeney, David W. Levine and Paul J. Fink, Jr. for their assistance in harnessing the power of several IBM RISC System 6000 computers. In combination with a few IBM 3090s, the resultant 300 MIPS performance enabled our simulations to be completed in a few weeks.</p>
<h2><a name="c7"></a>References</h2>
<ol>
<li>J. Von Neumann and A. W. Burks, <em>Theory of Self-Reproducing Automata</em>, University of Illinois Press, Urbana, Illinois, 1966.</li>
<li>S. Ulam, “On some mathematical problems connected with patterns of growth of figures,” <em>Proceedings of Symposia in Applied Mathematics</em>, vol. 14, pp. 215-224.Reprinted in A. W. Burks, ed., <em>Essays on Cellular Automata</em>, University of Illinois Press, Urbana, Illinois, 1962.</li>
<li>W.S. McCulloch and W. Pitts, “A logical calculus of the ideas immanent in nervous activity,” <em>Bulletin of Mathematical Biophysics</em>, vol. 5, 1943, pp. 115-133.</li>
<li>J. Holland, <em>Adaptation in Natural and Artificial Systems</em>, University of Michigan Press, Ann Arbor, Michigan, 1975.</li>
<li>D. E. Rumelhart, J. L. McClelland, and the PDP Research Group, <em>Parallel Distributed Processing</em>, vol. 1 and 2, The MIT Press, Cambridge, Massachusetts, 1987.</li>
<li>S. Wolfram, “Universality and complexity in cellular automata,” <em>Physica</em> 10D, 1984, pp. 1-35.</li>
<li>Christopher Langton, ed., <em>Artificial Life</em>, Addison-Wesley Publishing Company, Redwood City, California, 1989.</li>
<li>Fred Cohen, “<a href="/lib/afc01.html">Computer viruses, theory and experiments</a>,” <em>Computers &amp; Security</em>, vol. 6, 1987, pp. 22-35.</li>
<li>W. H. Murray, “<a href="/lib/awm00.html">The application of epidemiology to computer viruses</a>,” <em>Computers &amp; Security</em>, vol. 7, pp. 130-150, 1988.</li>
<li>Dr. Harold Joseph Highland, “The BRAIN virus: fact and fantasy,” <em>Computers &amp; Security</em>, vol. 7, pp.367-370, 1988.</li>
<li>Anne E. Webster. ”University of Delaware and the Pakistani computer virus,” <em>Computers &amp; Security</em>, vol. 8, pp.103-105, 1989.</li>
<li>Cliff Stoll, “<a href="/lib/mcs01.html">An epidemiology of viruses and network worms</a>,” <em>12th National Computer Security Conference</em>, 1989, pp. 369-377.</li>
<li>M.W. Eichin and J.A. Rochlis, “<a href="/lib/aem02.html">With microscope and tweezers: An analysis of the Internet virus of November 1988</a>,” <em>Proc. 1989 IEEE Symp. on Security and Privacy</em>, Oakland, California, May 1-3, 1989, pp. 326-343.</li>
<li>D. Seeley, “<a href="/lib/ase01.html">A tour of the worm</a>,” <em>Proc. Usenix Winter 1989 Conference</em>, San Diego, California, 1989, p. 287.</li>
<li>E. Spafford, “The Internet worm program: an analysis,” <em>Computer Comm. Review</em>, vol. 19, 1989, p. 1.</li>
<li>Fred Cohen, “<a href="/lib/afc07.html">Models of practical defenses against computer viruses</a>,” <em>Computers &amp; Security</em>, vol. 8, 1989, pp. 149-160.</li>
<li>Maria M. Pozzo and Terence E. Gray, “<a href="/lib/atg00.html">An approach to containing computer viruses</a>,” <em>Computers &amp; Security</em>, vol. 6, 1987, pp. 321-331.</li>
<li>Catherine L. Young, “Taxonomy of computer virus defense mechanisms,” <em>Proc. 10th National Computer Security Conference</em>, Baltimore, Maryland, 1987, pp. 220-225.</li>
<li>Nick Lai and Terrence E. Gray, “Strengthening discretionary access controls to inhibit trojan horses and computer viruses,” <em>Proc. Summer 1988 USENIX Conf.</em>, San Francisco, California, June 20-24, pp. 275-286.</li>
<li>George I. Davida, Yvo G. Desmedt and Brian J. Matt, “Defending systems against viruses through cryptographic authentication,” <em>Proc. 1989 Symp. on Security and Privacy</em>, Oakland, California, May 1-3, 1989, pp. 312-318.</li>
<li>Winfried Gleissner, “<a href="/lib/mwg02.html">A mathematical theory for the spread of computer viruses</a>,” <em>Computers &amp; Security</em>, vol. 8, 1989, pp. 35-41.</li>
<li>Peter S. Tippett, “Computer virus replication,” <em>Comput. Syst. Eur.</em>, vol. 10, 1990, pp. 33-36.</li>
<li>S. K. Jones and Clinton E. White, Jr., “The IFM Model of Computer Virus Management,” <em>Computers &amp; Security</em>, vol. 9, 1990, pp. 411-418.</li>
<li>David Greenhalgh, “Some results on optimal control applied to epidemics,” <em>Math. Biosciences</em>, vol. 88, 1988, pp. 125-158</li>
<li>Alan Solomon, “<a href="/lib/aas15.html">Epidemiology and computer viruses</a>,” unpublished, 1990.</li>
<li>Daniel Bernoulli, “Essai d’une nouvelle analyse de la mortalité causée par la petite vérole et des avantages de l’inoculation pour la prévenir,” <em>Mém. Math. Phys. Acad. Roy. Sci. Paris</em>, 1760, pp. 1-45.</li>
<li>Norman T. J. Bailey, <em>The mathematical theory of infectious diseases and its applications</em>, second edition, Oxford University Press, New York, 1975.</li>
 
<li>A. G. McKendrick, "Applications of mathematics to medical problems," <em>Proc. Edin. Math. Soc.</em>, vol. 14, 1926, pp. 98-130.</li>
<li>H. W. Hethcote, "An immunization model for a heterogeneous population," <em>Theoret. Population Biol.</em>, vol. 14, 1978, pp. 338-349.</li>
<li>Lisa Sattenspiel and Carl P. Simon, "The spread and persistence of infectious diseases in structured populations," <em>Mathematical Biosciences</em>, vol. 90, 1988, pp. 341-366.</li>
<li>Martina Morris, "Networks and diffusion: modeling the effects of selective mixing on the spread of disease," submitted to <em>American Journal of Sociology</em>.</li>
<li>Paul Waltman, <em>Deterministic Threshold Models in the Theory of Epidemics</em>, Springer-Verlag, New York, 1974.</li>
<li>F. Reif, <em>Fundamentals of Statistical and Thermal Physics</em>, McGraw-Hill, New York, 1965, p. 584.</li>
<li>Donald Ludwig, <em>Stochastic Population Theories</em>, Springer-Verlag, New York, 1978.</li>
<li>Edgar M. Palmer, <em>Graphical evolution: an introduction to the theory of random graphs</em>, John Wiley &amp; Sons, New York, 1985.</li>
<li>P. Erdös and A. Rényi, "On the evolution of random graphs," <em>Magyar Tud. Akad. Mat. Kutató Int. Közl</em>, vol. 5, 1960, pp. 17-61.</li>
<li>W. Goffman and V.A. Newill, "Generalisation of epidemic theory, an application to the transmission of ideas," <em>Nature</em>, vol. 204, 1964, pp. 225-228.</li>
<li>A. Demers, D. Greene, C. Hauser, W. Irish, J. Larson, S. Shenker, H. Sturgis, D. Swinehart, and D. Terry, "Epidemic algorithms for replicated database maintenance," <em>Oper. Syst. Rev.</em>, vol. 22, 1988, pp. 8-32.</li>
</ol>
 
<hr size="1"/>
<p><a name="f1" href="#b1">1</a> The latter case is sometimes referred to as a “worm”, but since we are solely concerned with the property of self-replication, we shall call all such entities “viruses”.</p>
<p><a name="f2" href="#b2">2</a> We use the term “epidemic” to refer to any widespread, persistent infection in a population, even in cases where the fraction of infected individuals is extremely low.</p>
<p><a name="f3" href="#b3">3</a> The term “connectivity” is used in a differentsense by graph theorists.</p>
<p><a name="f4" href="#b4">4</a> These values for the infection and cure rates will be adhered to throughout this work to facilitate comparison of the various models. Since <img src="/img/cache/b79dca073a5a1315465e68c34a2a765b.gif" alt="\rho'=\frac{\delta}{\beta'}=0.2" valign="middle"/>,the infection rate is five times the classical homogeneous threshold of <img src="/img/cache/dd5825b30c7300e9a1484d4aae0afc58.gif" alt="\rho'=1" valign="middle"/> for epidemics that was derived in section 2.1.</p>
<p><a name="f5" href="#b5">5</a> The event-drivensimulation has computational advantages over simulations which employ fixed time steps. Within a fixed time interval, no events can occur (which is inefficient), or several can occur, causing confusion about the order of the events within that interval. The event-driven simulation guarantees that exactly one event occurs per time step.</p>
<p><a name="f6" href="#b6">6</a> We use the term "clique" in its colloquial sense, not in its graph-theoretical sense.</p>
[<a style="" href="/lib/?lang=EN&amp;index=EP#ajk06">Back to index</a>] [<a href="/lib/ajk06.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=ajk06">de</a><a href="/lib/index.php?lang=en&amp;id=ajk06">en</a><a href="/lib/index.php?lang=es&amp;id=ajk06">es</a><a href="/lib/index.php?lang=it&amp;id=ajk06">it</a><a href="/lib/index.php?lang=fr&amp;id=ajk06">fr</a><a href="/lib/index.php?lang=pl&amp;id=ajk06">pl</a><a href="/lib/index.php?lang=ru&amp;id=ajk06">ru</a><a href="/lib/index.php?lang=ua&amp;id=ajk06">ua</a></div>
</body>
</html>
