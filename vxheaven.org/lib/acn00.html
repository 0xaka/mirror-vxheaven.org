<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Carey Nachenberg 'Computer Parasitology' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Carey Nachenberg"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Nachenberg, Carey,Computer Parasitology, peer, mail, worm, definitions, door, office, wireless, home, mapi, virus, penetration, anti, explorezip, viruses, infection"/>
<meta name="Description" content="Computer viruses have progressed from urban myth to annoyance to major threat; yet, even with all the damage that computer viruses have done, they pale in comparis on to what we have seen and have yet to see from the computer worm."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"0a5bef1528185058a57ece698d125616bb5b8087-1498755815-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/acn00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Computer Parasitology</h1><p><a href="/lib/?lang=en&amp;author=Nachenberg%2C%20Carey">Carey Nachenberg</a><br/> <em>Proceedings of the Ninth International Virus. Bulletin Conference, September/October 1999, pp. 1–25</em><br/> <em> 1999</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/acn00.html';</script><div class="ci"><a href="/lib/?ci=acn00">1</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Computer%20Parasitology.pdf">Download</a> PDF (96.81Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=WO#acn00">Back to index</a>] [<a href="/lib/acn00.html#disqus_thread">Comments</a>]<br/> 
<address>
Carey Nachenberg<br/>
Symantec AntiVirus Research Center<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="2a69444b49424f44484f584d6a5953474b445e4f4904494547">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</address>
<ul>
<li><a href="#c0">Introduction</a></li>
<li><a href="#c1">Worm Classifications</a>
<ul>
<li><a href="#c11">Worm Transport Classifications</a>
<ul>
<li><a href="#c111">E-mail Worms</a></li>
<li><a href="#c112">Arbitrary Protocol Worms: IRC Worms, TCP/IP Worms, etc.</a></li>
</ul></li>
<li><a href="#c12">Worm Launch Classifications</a>
<ul>
<li><a href="#c121">Self-launching Worms</a></li>
<li><a href="#c122">User-launched Worms</a></li>
<li><a href="#c123">Hybrid-launch Worms</a></li>
</ul></li>
</ul></li>
<li><a href="#c2">A Brief History of Worms</a>
<ul>
<li><a href="#c21">The Xerox Worms: The First Computer Worms</a></li>
<li><a href="#c22">The CHRISTMA EXEC Worm: The First Widespread E-mail, User-launched Worm</a></li>
<li><a href="#c23">The Internet Worm: The First Arbitrary Protocol, Back Door Worm</a></li>
<li><a href="#c24">The IRC Worms: The First Consumer-oriented Arbitrary Protocol, Self Launching Worms</a></li>
<li><a href="#c25">The Happy99 Worm: The First Mainstream Consumer-oriented Worm</a></li>
<li><a href="#c26">The Melissa Virus+Worm: The First Mainstream Corporate Macro Hybrid (both a Virus and Worm)</a></li>
<li><a href="#c27">The ExploreZip Worm: The First Widespread Hybrid-launch, Arbitrary Protocol Worm</a></li>
</ul></li>
<li><a href="#c3">Evolution of Enabling Technology</a>
<ul>
<li><a href="#c31">Infrastructural Homogeneity</a></li>
<li><a href="#c32">Ubiquitous Programmability</a></li>
<li><a href="#c33">Increased Connectedness via a Homogeneous Communications Mechanism</a></li>
</ul></li>
<li><a href="#c4">Other Factors</a>
<ul>
<li><a href="#c41">Corporate/Consumer Bridge Technologies</a></li>
<li><a href="#c42">Home Networking</a></li>
</ul></li>
<li><a href="#c5">The Future of Worms</a>
<ul>
<li><a href="#c51">Cable/DSL Brings Worms To The Home</a></li>
<li><a href="#c52">MAPI Worms</a></li>
<li><a href="#c53">Information Stealers and Remote Control Worms</a></li>
<li><a href="#c54">Peer-to-peer Worms</a></li>
<li><a href="#c55">E-mail Scripting Worms</a></li>
<li><a href="#c56">ActiveX and Java Worms</a></li>
<li><a href="#c57">Second Generation Worms</a>
<ul>
<li><a href="#c571">Polymorphic Worms</a></li>
<li><a href="#c572">Retro Worms</a></li>
<li><a href="#c573">Stubborn Worms</a></li>
<li><a href="#c574">Wireless Worms</a></li>
</ul></li>
</ul></li>
<li><a href="#c6">Examination of Worm Epidemics</a>
<ul>
<li><a href="#c61">Case Study: Mass E-mail Worms, CHRISTMA EXEC and Melissa</a>
<ul>
<li><a href="#c611">It’s easy to obtain “addresses” of other targets</a></li>
<li><a href="#c612">Homogeneous e-mail makes spreading easy</a></li>
<li><a href="#c613">Humans are the biggest security risk; there’s no need to find a back door into the system</a></li>
<li><a href="#c614">Corporate e-mail systems offer “one degree of separation”</a></li>
<li><a href="#c615">Why infect one other computer when you can infect 50… or 50,000</a></li>
<li><a href="#c616">Spread to other computers as soon as you can</a></li>
<li><a href="#c617">Mailbox penetration or computer penetration?</a></li>
</ul></li>
<li><a href="#c62">Case Study: Back Door Worms and The Internet Worm</a>
<ul>
<li><a href="#c621">It’s easy to obtain “addresses” of other targets</a></li>
<li><a href="#c622">Homogeneous environments makes spreading easy</a></li>
<li><a href="#c623">Back door worms spread best unhindered</a></li>
<li><a href="#c624">Spread to other computers without user intervention</a></li>
<li><a href="#c625">Computer penetration</a></li>
</ul></li>
<li><a href="#c63">Case Study: Hybrid Worms and ExploreZip</a>
<ul>
<li><a href="#c631">It’s easy to obtain “addresses” of other targets</a></li>
<li><a href="#c632">Homogeneous computers makes spreading easy</a></li>
<li><a href="#c633">The human is the biggest security risk; there’s no need to find a back door into the system</a></li>
<li><a href="#c634">Spread slowly or spread quickly?</a></li>
<li><a href="#c635">Mailbox penetration or computer penetration?</a></li>
<li><a href="#c636">Payload and trigger conditions affect the worms’ viability</a></li>
</ul></li>
</ul></li>
<li><a href="#c7">Containment</a>
<ul>
<li><a href="#c71">Proactive Steps</a>
<ul>
<li><a href="#c711">Run Anti-virus Software on Servers, Gateways, and Desktops</a></li>
<li><a href="#c712">Remove “all company” Addresses From Your Lists</a></li>
<li><a href="#c713">Lock Down All Peer-to-peer Networking</a></li>
<li><a href="#c714">Deploy Internal Firewalls</a></li>
<li><a href="#c715">Disable E-mail Script Capabilities</a></li>
<li><a href="#c716">Strip Executable Content From Incoming E-mail</a></li>
<li><a href="#c717">Use Heuristics and If Possible, Digital Immune System Technology</a></li>
</ul></li>
<li><a href="#c72">Before Impending Infection</a>
<ul>
<li><a href="#c721">To Prepare For E-mail Worms</a></li>
<li><a href="#c722">To Prepare For Arbitrary-protocol Worms</a></li>
</ul></li>
<li><a href="#c73">Active Infection</a>
<ul>
<li><a href="#c731">If Hit By A Destructive Worm: Update File Server Permissions</a></li>
<li><a href="#c732">If Hit By a Data Export Worm: Limit Access To Data and Networks</a></li>
<li><a href="#c733">If Hit By an E-mail or Arbitrary-protocol Worm Infection: Distribute Virus Definitions to Gateways, E-mail Servers and File Servers First</a></li>
<li><a href="#c734">If Hit By a File Server-aware Worm Infection: Distribute Virus Definitions to File Servers First</a></li>
<li><a href="#c735">If Hit By a Back Door Worm Infection: Down All Affected Networks</a></li>
</ul></li>
</ul></li>
<li><a href="#c8">Future Anti-worm Technologies</a>
<ul>
<li><a href="#c81">Windows Memory Scanning and Repair</a></li>
<li><a href="#c82">Behavior Blockers</a></li>
<li><a href="#c83">Personal Firewalls</a></li>
<li><a href="#c84">Worm Heuristics</a></li>
<li><a href="#c85">Automated Worm Replication and Analysis</a></li>
</ul></li>
<li><a href="#c9">Future Containment Approaches</a>
<ul>
<li><a href="#c91">Ubiquitous Authentication</a></li>
<li><a href="#c92">Policy-driven File/Macro-level Access Control</a></li>
<li><a href="#c93">Macro-free Products</a></li>
</ul></li>
<li><a href="#ca">Conclusion</a></li>
</ul>
<h2><a name="c0"></a>Introduction</h2>
<p>Computer viruses have progressed from urban myth to annoyance to major threat; yet, even with all the damage that computer viruses have done, they pale in comparis on to what we have seen and have yet to see from the computer worm.</p>
<p>Viruses are computer programs that are designed to spread themselves from one file to another on a <em>single</em> computer. A virus might rapidly infect every application file on an individual computer, or slowly infect the documents on that computer, but it does not intentionally try to spread itself from that computer to other computers. In most cases, that’s where humans come in. We send e-mail document attachments, trade programs on diskettes, or copy files to file servers. When the next unsuspecting user receives the infected file or disk, they spread the virus to their computer, and so on.</p>
<p>So how do humans spread viruses? Most people exchange information in time intervals on the order of minutes, hours or days. Furthermore, information is sent to a relatively small group of people. Looking in my own e-mail out-box, I send messages with attachments (usually documents) to an average of three people roughly every 33 minutes during business hours. While these figures may not be typical of most users, they’re certainly plausible and are corroborated by the (relatively) slow spread of most computer viruses.</p>
<p>Worms, on the other hand, are insidious because they rely less (or not at all) upon human behavior in order to spread themselves from one computer to others. The <em>computer worm</em> is a program that is designed to copy itself from one computer to another, leveraging some network medium: e-mail, TCP/IP, etc. The worm is more interested in infecting as many machines as possible on the network, and less interested in spreading many copies of itself on a single computer (like a computer virus). The prototypical worm infects (or causes its code to run on) a target system only once; after the initial infection, the worm attempts to spread to other machines on the network.</p>
<p>The infamous Melissa only required a user to open a single infected document to spread itself to hundreds of thousands of users! IRC worms only require a simple user login to the IRC online chat system to spread themselves, and the recent Explore.Zip worm could gain hold of thousands of machines with the launch of a single program. While humans exchange information at large time intervals to small groups of people, computer worms have no such restrictions.</p>
<p>Computer worms will pose the greatest threat to both consumer and corporate computer systems over the next decade. As we will see, they will change the nature of anti-virus (anti-malware?) software and require paradigm shifts in enterprise security and infrastructure<sup><a href="#f1" name="b1">i</a></sup> . This paper will cover the past, present and future of computer worms, attempt to provide IT professionals with an understanding of how and why these threats spread, and offer some insight into the nature of future anti-worm solutions and worm-resistant corporate infrastructures that can be leveraged to protect the enterprise from these threats.</p>
<h2><a name="c1"></a>Worm Classifications</h2>
<p>This section will propose some general classifications for computer worms. Computer worms can be classified based on two characteristics:</p>
<ol>
<li>The transport mechanism used by the worm to send itself.</li>
<li>How the worm is actually launched on a computer system.</li>
</ol>
<h3><a name="c11"></a>Worm Transport Classifications</h3>
<p>The following are known or potential worm transport schemes.</p>
<h4><a name="c111"></a>E-mail Worms</h4>
<p>The <em>e-mail worm</em> is one that uses e-mail as its primary means of transport. Under this top-level classification, we can create two subcategories:</p>
<ol>
<li><em>Native e-mail worms</em></li>
<li><em>Parasitic e-mail worms</em></li>
</ol>
<p>A <em>native e-mail worm</em> is one which is built in the native scripting language of the host e-mail system. Such a worm is carried in a proprietary form along with its associated e-mail message, as opposed to being carried as a file attachment. The native e-mail worm can only exist within the e-mail platform, and is not viable outside of the host e-mail system. To date, we have seen no native e-mail worms.</p>
<p>A <em>parasitic e-mail worm</em> is one which leverages the transport capabilities of an e-mail system to spread itself. The parasitic e-mail worm, for example, may use the e-mail program to send itself as an attachment to an e-mail. The parasitic e-mail worm can exist outside of the e-mail platform, and may actually use other techniques to spread itself. Of the recent worms, Melissa, ExploreZip and Happy99 would be considered parasitic e-mail worms.</p>
<h4><a name="c112"></a>Arbitrary Protocol Worms: IRC Worms, TCP/IP Worms, etc.</h4>
<p>The <em>arbitrary protocol worms</em> spread themselves using one or more non e-mail based protocols, such as IRC’s DCC protocol, the FTP protocol, or using simple TCP/IP sockets. The Internet Worm could be considered an arbitrary protocol worm since it used standard TCP/IP connections (from one UNIX box to another) to spread itself.</p>
<p>The <em>peer-to-peer worm</em> is another example of an arbitrary protocol worm that spreads itself over peer-to-peer networks.</p>
<h3><a name="c12"></a>Worm Launch Classifications</h3>
<p>These classifications are used to describe how the worm actually gains control of a computer system: does it require user interaction (and how much?), or can it spread unaided.</p>
<h4><a name="c121"></a>Self-launching Worms</h4>
<p>Worms that are capable of spreading to a new system and actively running on that system can be called <em>self-launching worms</em>. These worms do not require user interaction in order to gain control of a system; instead, they exploit some aspect of the host (operating system, application system, e-mail system) to cause their code to automatically execute upon introduction to a new system. The Internet Worm and the IRC worms (described in later sections) are examples of self-launching worms. A subset of this category is the <em>back door worm</em>. The back door worm is one that exploits a back door in a target system to gain entry <em>and</em> to ensure that it is launched, again without human intervention.</p>
<h4><a name="c122"></a>User-launched Worms</h4>
<p>This category of worms requires user intervention in order to execute on a new system. For instance, the Melissa worm/virus is just such a worm. In order for Melissa to infect a system, an infected attachment must be manually opened/viewed by a user. The worm cannot cause itself to launch on a system without user intervention.</p>
<h4><a name="c123"></a>Hybrid-launch Worms</h4>
<p>These worms are capable of spreading using both mechanisms. An example of a hybrid-launch worm is ExploreZip. This worm, when sent in e-mail, required a user to launch the infected attachment to gain control of the system. On the other hand, once running on a computer system, ExploreZip would automatically spread itself to other computers over the peer-to-peer network. These targeted machines would then become infected on the next reboot (without any known user intervention).</p>
<h2><a name="c2"></a>A Brief History of Worms</h2>
<h3><a name="c21"></a>The Xerox Worms: The First Computer Worms</h3>
<p>The first computer worms were created in the labs of John Shock and Jon Hepps of Xerox’s Palo Alto Research Center in the early 1980s. The team developed five different worms, each of which were designed to perform useful tasks on the network. These researchers quickly learned the danger of worms; one of the self-replicating programs had a bug that caused it to malfunction while running during non-business hours. The next morning, users found their computers crashed and found that resetting them did not help; the worm would continually re-infect the systems and quickly cause them to crash. After this event, the research group produced a “vaccine” (perhaps the first ever anti-virus) to prevent the worm from crashing systems and subsequent worm research died out.<sup><a href="#f2" name="b2">ii</a></sup></p>
<h3><a name="c22"></a>The CHRISTMA EXEC Worm: The First Widespread E-mail, User-launched Worm</h3>
<p>Years later, in December of 1987, the first widespread computer worm was released into IBM VM/CMS systems. This worm, dubbed the CHRISTMA EXEC Worm, was a simplified predecessor to the Melissa virus/worm seen this year. The worm was written in the REXX programming language, a common batch programming language on UNIX systems. When a user received this file as an e-mail attachment, they had to detach the file to the hard drive and manually run the batch file to cause the worm to spread. Once the worm was launched by the user, it displayed a character-based picture of a Christmas tree and then attempted to spread itself further over the IBM e-mail system. The worm used entries in the audit trail file (that contained logs of all received and sent e-mail), as well as the user’s personal address book to determine its next round of recipients.<sup><a href="#f3" name="b3">iii</a></sup></p>
<p>Even though CHRISTMA required significant manual user intervention to spread, it clogged thousands of mailboxes and the underlying network with millions of copies of itself<sup><a href="#f4" name="b4">iv</a></sup>.</p>
<h3><a name="c23"></a>The Internet Worm: The First Arbitrary Protocol, Back Door Worm</h3>
<p>Roughly one year later, on November 2<sup>nd</sup>, 1988, the infamous Internet Worm (created by Robert Tappan Morris) wreaked havoc on the fledgling Internet. Unlike the CHRISTMA EXEC Worm, this worm was designed to spread itself without any human intervention. The Morris worm would spread to DEC VAX and Sun 3 machines running BSD UNIX<sup><a href="#f5" name="b5">v</a></sup> by connecting to the target UNIX machine in one of three ways (to the e-mail service, the <em>finger</em> service, or by hacking passwords and performing a remote execution on a target machine). Once it had penetrated the target computer, it would send over a small C program and cause the target host to compile and run this program. Next, the compiled program would pull over the remaining worm components and launch them; at this point the worm had a foothold of the targeted computer and could spread to new computers on the Internet.<sup><a href="#f6" name="b6">vi</a></sup> It is estimated that the Morris worm affected more than 6,000 computers on the Internet using these techniques.</p>
<h3><a name="c24"></a>The IRC Worms: The First Consumer-oriented Arbitrary Protocol, Self Launching Worms</h3>
<p>In 1997, standard end-users users encountered the first mainstream computer worms: IRC worms. IRC, or Internet Relay Chat, is a chatting system available on the Internet. Users can connect to this system using an IRC client (e.g. a Windows program) and chat with thousands of other users about thousands of different topics. One of the most popular IRC client programs, mIRC, was equipped with a fairly powerful scripting language that was targeted by the first IRC worms. These scripts were programmed to send themselves to new users as they joined the IRC chat “channels.” Once the recipient was infected, their mIRC program would execute the worm logic and also participate in the reproduction of the worm. While many were benign, some of these worms were capable of other malicious actions. For instance, users who spread the worms could send commands to infected systems and cause these systems to perform any number of malicious actions.<sup><a href="#f7" name="b7">vii</a></sup> In essence, these were the first “remote control” worms ever created, since they allowed an attacker to remotely control and/or damage infected systems.</p>
<h3><a name="c25"></a>The Happy99 Worm: The First Mainstream Consumer-oriented Worm</h3>
<p>The Happy99 worm, released in early 1999, has arguably affected more home Internet users than any other worm in history. As of July 27<sup>th</sup>, 1999, the Symantec AntiVirus Research Center has received over 4,200 submissions of Happy99. Once the worm is received in e-mail and launched by the user, it displays a window with fireworks and, in the background, installs itself onto the system. Subsequently, any time the user sends an e-mail (with the popular Internet SMTP protocol used by Eudora, Netscape mail, etc.), or posts a message to a USENET newsgroup, the worm will send an additional message to the same recipient(s), adding the worm as an attachment. While this worm undoubtedly affected both corporate and consumer users, this worm is considered a consumer-oriented worm because it spreads using the SMTP protocol, which is the predominant e-mail protocol used by end-users.</p>
<h3><a name="c26"></a>The Melissa Virus+Worm: The First Mainstream Corporate Macro Hybrid (both a Virus and Worm)</h3>
<p>The “Melissa Virus” is actually both a computer virus and a computer worm, or hybrid threat. Melissa is spread inside of Word 97 document files. When a user receives and subsequently views a Melissa-infected document, the Melissa macros will run inside of Word for Windows 97 and use the Outlook e-mail program (if present) to send a copy of the infected document to the first fifty users in the Outlook address book. Melissa will also infect the Word for Windows environment, allowing it to spread to other documents on the user’s machine. These second-generation infections are also fully infectious, and if shared with other users, will continue the infection process.</p>
<p>Based on the number of e-mail boxes that were flooded with copies of Melissa, it is without a doubt, the most prolific worm of all time<sup><a href="#f8" name="b8">viii</a></sup>. Melissa spread itself prolifically during its short reign, filling up potentially hundreds of thousands of <em>e-mail boxes</em>. However, due to the quick handiwork of system and mail administrators, the actual number of computer users directly affected by Melissa was probably far less than the number of affected mailboxes. In other words, most users probably did not actually launch Melissa, but might have found several copies of it in their in-box had they been able to access e-mail.</p>
<p>Melissa achieved such widespread distribution because when it spreads, it sends itself to the first fifty entries in the Outlook address book. While some of these entries might refer to typical end-user e-mail addresses, many corporations have entries such as “All Whammydyne Employees” among the top fifty entries. An e-mail sent to the “All Whammydyne Employees” address would literally reach each of the 3,000 employees at Whammydyne. Consequently, a small number of seed infections in a corporation could quickly clog hundreds of thousands of e-mail boxes with Melissa infections.</p>
<h3><a name="c27"></a>The ExploreZip Worm: The First Widespread Hybrid-launch, Arbitrary Protocol Worm</h3>
<p>Unlike Melissa or Happy99, the ExploreZip Worm spread itself to other computers using two distinct mechanisms. First, like Melissa, ExploreZip was capable of leveraging Outlook, Outlook Express and Exchange e-mail programs to send itself over e-mail. Instead of sending itself to the first fifty users like Melissa, this worm sends itself to users that have recently sent e-mail to the infected user.</p>
<p>In addition to spreading itself via e-mail, ExploreZip will also iterate through all machines that are visible on a peer-to-peer Microsoft network. The worm will copy itself to accessible machines and update a configuration file on the target machine to cause the machine to launch the ExploreZip worm during the next boot-up. The worm continually searches for other peer machines to infect, and consequently, was difficult to eradicate from corporate networks. The moment an administrator would remove the worm from a machine, another copy would re-infect it.</p>
<p>In addition to infecting peer-to-peer networked machines, ExploreZip also deleted the contents of a variety of files from both local hard drives and the hard drives of networked peers. The peer-to-peer capabilities of this worm clearly underscore the vulnerability of peer-to-peer networks in the enterprise.</p>
<h2><a name="c3"></a>Evolution of Enabling Technology</h2>
<p>Three technological trends have had a huge impact on the viability and simplicity of computer worms: infrastructural homogeneity, ubiquitous programmability, and increasing connectedness via a homogeneous communications mechanism.</p>
<h3><a name="c31"></a>Infrastructural Homogeneity</h3>
<p><strong>The homogeneity of computers, operating systems and communications platforms has been the single largest enabler for computer worms.</strong></p>
<p>Today, more than 90% of the world’s desktop computers are running the Wintel platform. An equally high percentage of end-users use standard SMTP e-mail, and many large corporations (and even some end-users) are standardizing on e-mail clients like Microsoft Outlook. In the word processing area, Microsoft Office enjoys a virtual monopoly for home and business users alike.</p>
<p>In agriculture, such a homogeneous environment is called a monoculture, and is generally known to be a <em>bad thing</em>. If a farmer plants a single variety of crop on their land (for instance, to optimize their yield of that crop), they increase the susceptibility of their crop to disease – and once the disease affects one plant, it can easily spread to genetically-similar neighbor plants. In essence, the standardization of all of the above computing technologies has created a computing monoculture that has increased our computers’ susceptibility to computer-borne disease.</p>
<p>Already, we have seen thousands of macro viruses attacking the Microsoft Office platform. Several high-profile worms have leveraged the widespread Outlook and SMTP e-mail platforms. Finally, more than 99% of all computer viruses are designed for the Wintel platform. However, it is likely that virus writers have targeted these platforms for more than just their sheer ubiquitousness. These platforms are also readily available to young male adolescents (the predominant creators of malware), well documented, and most importantly, easily programmable.</p>
<h3><a name="c32"></a>Ubiquitous Programmability</h3>
<p><strong>Ubiquitous programmability of Windows components (Word/Excel macros, COM, etc.) has made it possible for worms to spread without complex programming.</strong></p>
<p>Who would have thought that the word processor or spreadsheet would be the single most successful platform for computer viruses and worms? E-mail is easy to imagine – worms could send themselves over e-mail - but common Office applications? Unfortunately, by adding robust programming capabilities to the Microsoft Office product line, Microsoft has made the Office products the platform of choice for virus and Trojan creation. By allowing macros to copy themselves from one document to another, the Office platform has been a huge enabler for computer viruses.</p>
<p>Unfortunately, Microsoft Office macros not only have access to the features and components of the Office suite, but also to other components of the host computer system. If Microsoft had limited the Office macro environment so that macros could only interact with other components of the Office suite, this would have limited malware creations to viruses and Trojan horses that could spread themselves only within the limited Office environment. Unfortunately, a second technology – the Component Object Model (COM) – has had a huge impact on today’s malware.</p>
<p>In a nutshell, when a programmer designs a new application, s/he can choose to make the functionality of the application available to the rest of the system (and not just the user) via COM. Programmers can then design their programs to make use of the functionality provided by the COM-enabled program. Using COM, Outlook provides the means for other programs to log-in to the user’s mailbox, examine messages, extract attachments, enumerate the entries in the address book and send e-mail. For instance, one could write an expense reporting application that would make use of the Outlook e-mail program. The designer of the expense reporting application could program it to use e-mail functionality of Outlook to send copies of an expense report to the finance department, without having to know a single thing about how to program an e-mail system. Clearly, COM technology has been a huge enabling technology for programmers.</p>
<p>In a logical move, and one which provides great value for legitimate programmers, Microsoft made it possible for Office macros to leverage the same powerful features of COM. Furthermore, given the simplicity of the macro programming language supported by Office, virtually anyone could pick up a book and develop powerful macro programs that have the ability to do far more than summing tables in a spreadsheet (a typical task that could be performed by a macro)! These COM-enabled macros can affect the entire host computer system, and more worrisome, the worldwide network of machines based on the same technological monoculture.</p>
<h3><a name="c33"></a>Increased Connectedness via a Homogeneous Communications Mechanism</h3>
<p><strong>The increasing connectedness of the Internet permits worms to spread faster, and to more machines, than ever before.</strong></p>
<p>Until recently, the propagation rate of computer viruses was limited to how fast computer users sent infected files in e-mail (or on file servers, floppy diskettes, etc.). Computer viruses can quickly infect many files on a single computer system but spread much more slowly from one computer system to another because of their reliance on user behavior. Given that users share information more than they share programs (at least in the corporate environment), user-initiated e-mail has allowed macro viruses to spread far more quickly than their binary cousins (DOS and Windows viruses). Yet as quickly as macro viruses can be spread by user e-mail, they pose a limited threat to the computing community at large. By the time a new macro virus can infect a handful of users, anti-virus companies can respond with a fingerprint update and prevent any further spread.</p>
<p>With more users on the Internet than ever before as potential targets, worms can now spread more quickly than ever. And as mentioned, the homogeneous, ubiquitous, COM-accessible communications mechanisms makes writing such a worm a snap. Why should a malware threat wait to be sent by the user when it can send itself? The computer worm doesn’t wait for the user to send its malicious logic in an e-mail. Instead, it takes matters into its own hands. The worm exploits the communications infrastructure to send itself from one computer to another; consequently, it can potentially spread itself thousands of times faster than a traditional virus.</p>
<p>While e-mail is an ideal transport mechanism for computer worms, it is far from the only viable communications mechanism. Malicious code has only begun to exploit peer-to-peer networking, and this trend it likely be change in the coming years. Windows 95, 98, NT (and soon Windows 2000) support peer-to-peer networks. Users can configure Windows to allow other users on the Windows network to access their files without restriction. By exploiting this facility, computer worms can quickly find other machines on the Windows network and copy itself to these machines. The most recent Explore.Zip worm uses exactly such a mechanism to spread itself over corporate networks, and was extremely successful.</p>
<p>Once such a threat sends itself to a second computer, given the high probability that that computer will support the same homogeneous technologies as the first host, it has a high chance of continuing its spread.</p>
<h2><a name="c4"></a>Other Factors</h2>
<p>There are a number of other factors which may enable worms to spread much more quickly, in both the home and corporations.</p>
<h3><a name="c41"></a>Corporate/Consumer Bridge Technologies</h3>
<p>“Malware authors go with what malware authors know.” In other words, virus writers will design their threats to exploit those technologies that they have on their own computer so they can test their creations. Consequently, those corporations that employ worm-enabling technologies that are common to both the corporation and the home are much more susceptible to these attacks. For example, to date we have seen a number of viruses and worms leverage Microsoft Outlook and Outlook Express to send themselves; these programs are widely used corporate and consumer e-mail programs (and they share the same COM programmable interface). Conversely, we have seen no worm-based attacks that leverage Notes to spread themselves. Notes, unlike the Outlook products, is used exclusively in corporations, and is a less available technology for virus/worm authors.</p>
<h3><a name="c42"></a>Home Networking</h3>
<p>As more homes begin to setup home networks, we expect the growth in number and prevalence of computer worms will grow dramatically. Given that many of today’s virus writers can’t test a worm before deploying it due to lack of resources, access to a home network for testing purposes may accelerate the growth and release of new worm programs.</p>
<h2><a name="c5"></a>The Future of Worms</h2>
<p>While the majority of computer malware consists merely of knockoffs of older malware strains, there are a core group of virus writers that consider themselves “trail blazers.” This group has brought us threats like Boza, the first 32-bit Windows virus, Strange Brew, the first Java virus, and countless others. It is inevitable that over the next few years we will see viruses and worms attacking and leveraging many heretofore untargeted platforms, as varied as Palm Pilots, Lotus Notes, and personal web servers.</p>
<h3><a name="c51"></a>Cable/DSL Brings Worms To The Home</h3>
<p><strong>Continuous static connection + Connected desktop apps + Scripting Capabilities = Worm heaven</strong></p>
<p>As more users adopt broadband technologies in the home, we expect that the incidence of computer worms targeted at home users (and small businesses) will grow rapidly. Today, home Internet users are assigned dynamic IP addresses each time they login to the Internet. Given that users log in and out frequently, it becomes very difficult for a worm to find such a target machine and spread to it.</p>
<p>As users migrate to broadband technology such as cable modems or Digital Subscriber Line (DSL), they will have constant, reasonably static connections to the Internet, making their computer a “sitting goose.” Computer hackers or roving worms will be able to easily cull Internet addresses and use them to attack these machines. Furthermore, we expect that as more users adopt broadband technologies in the home, that consumer-driven connected applications will grow in popularity.</p>
<p>Today, products like PointCast sprinkle corporate desktops, but are less appealing for the disconnected home user. However, as broadband technologies become more ubiquitous in the home, these connected applications will grow in popularity; real-time stock tickers, search agents, personal web servers, music players, and “instant message”/chat programs will be running on every desktop. Furthermore, as we have seen in the Office application category, vendors will start adding macro/scripting support to these applications to extend their capabilities for power users.</p>
<p>While each of these connected applications will increase the quality of the home computing experience, each also contributes security risks for the home user. We expect that computer worms will exploit these connected (and often not security-conscious) applications as back doors into home systems. In such an environment, a worm like Melissa will easily infect huge numbers of home users. Unfortunately, since threats that affect the home inevitably find their way into the corporation, these threats will have an impact on the enterprise too. We expect that as corporate users bring their connected applications from home into the workplace, this will be a ripe platform for worm propagation, and the spread-rate of these worms over this new medium will rival that of the peer-to-peer and MAPI-based worms described below.</p>
<p>The personal firewall (in conjunction with anti-virus software) will become a must-have application and help to stem at least some of the worms and viruses that will plague the growing number of connected desktops.</p>
<h3><a name="c52"></a>MAPI Worms</h3>
<p>MAPI is an acronym that stands for Messaging Application Programming Interface. Many common e-mail client applications, such as Outlook, Exchange, etc. support the MAPI system (which is provided via the COM mechanisms discussed in previous sections). This means that other applications, including worms and viruses, can leverage e-mail functionality (sending e-mail, receiving e-mail, examining attachments, etc.) without having to understand the details of e-mail systems or protocols. In fact, Office 97 macro viruses can access the MAPI system using the simple Visual Basic language, making it possible to construct a computer worm in less than 30 lines of programming statements! The Melissa and ExploreZip viruses used this facility to spread themselves, and we expect that this mechanism will be employed more than any other worm replication mechanism in the foreseeable future.</p>
<p>Some corporations have found good uses for Office 97, macro-based MAPI support: at least some departments create self-mailing documents and spreadsheets to facilitate submission of expense reports and other forms. However, given the huge threat this functionality poses to corporations, it is questionable whether this functionality should be supported at all by Office applications. Furthermore, merely making macro-based MAPI support an configurable option of the Office platform is an inadequate solution.</p>
<p>Even today, many macro viruses can and do change Office settings – for example, disabling macro protection – without the users knowledge. A properly designed worm could easily enable disabled MAPI support and then use this facility to spread itself. The only way to address MAPI-based worms is to deliver Office applications with no MAPI capabilities, or more generally no COM capabilities, to the enterprise.</p>
<p>MAPI or e-mail based worms have two interesting properties that are worth further discussion. First, the sheer volume of e-mail generated by a worm can have unanticipated collective effects on the computer network or e-mail infrastructure. As we saw with Melissa, a number of companies actually had their e-mail servers crash due to the sheer volume and velocity of e-mails sent by this virus/worm. These crashes occurred despite the fact that Melissa was engineered to limit its spread to fifty e-mail addresses and only e-mail itself once from any infected machine.</p>
<p>Second, based on anecdotal reports from Symantec customers <sup><a href="#f9" name="b9">ix</a></sup>, e-mail based worms may achieve a high rate of penetration in corporate e-mailboxes, but these worms actually have a much lower penetration rate on the corporate desktop. These corporate customers indicated that only a small percentage of users actually opened Melissa-infected documents and infected their desktops. While even a small number of infected users might spread a Melissa-like threat to hundreds of thousands of corporate users, unless these attachments are opened by those users, they pose little threat to corporate informational assets; the infections contained in e-mail boxes are not actively running and cannot steal information from desktop files, the server, etc. Based on this experience with Melissa, it might be interesting to study the average rate that users check e-mail, and how often they bother to open e-mail attachments at all. Another interesting question: how long does it take IT departments to detect such a spreading threat.</p>
<p>Of course, whether or not mail-based threats achieve high desktop penetration is of little help to administrators; corporate users and IT staff will still experience huge amounts of lost time due to clean-up efforts, downed e-mail systems, and help-desk calls. However, it does indicate that e-mail-only worms may pose more of a threat as a denial of service attack than as a desktop infiltrator/information asset thief.</p>
<h3><a name="c53"></a>Information Stealers and Remote Control Worms</h3>
<p>Over the last few years, we’ve seen a rash of new virus, worm and Trojan threats that are capable of exporting information from an infiltrated machine or allowing a remote attacker to take control of such a machine. While older malicious code threats would delete files or format hard drives, the new <em>payloads</em> of choice are information stealing and remote control since these payloads leverage the power of the Internet.</p>
<p>A good example of this is the Prettypark worm. If this worm finds its way onto a computer and can acquire a connection to the Internet, it will connect to the IRC chatting service and wait for commands from an attacker. A malicious person can send Prettypark commands and perform any number of malicious actions on the compromised computer including stealing information, deleting files, etc. Personal and corporate firewalls and encryption software can help to limit the risk from these threats.</p>
<p>We expect that the number and complexity of information-stealing and remote control worms will dramatically increase over the next few years. It is even believable that a digital underclass will develop that will use such malicious tools to extort, black mail and steal valuable corporate information.</p>
<h3><a name="c54"></a>Peer-to-peer Worms</h3>
<p>The Melissa virus/worm spread itself using MAPI e-mail commands and achieved a huge penetration of company e-mail systems, flooding virtually every e-mailbox in some corporations. However, it is unclear how many actual corporate desktop computers it was able to infiltrate. How many of the thousands of corporate users who received Melissa in e-mail actually viewed the document attachment and launched Melissa? According to word-of-mouth accounts, few.</p>
<p>On the other hand, consider the ExploreZip worm. This worm spreads both using e-mail and by exploiting peer-to-peer networks. Specifically, ExploreZip will seek out other networked Windows 95/98/NT computers with unsecured, mapped hard drives and spread to these machines and run without the need for user intervention. While a Melissa-like threat could fill e-mail systems with millions of copies of itself, an peer-to-peer threat like ExploreZip has the potential to achieve a much higher rate of actual desktop (and server) penetration in organizations with lax security. Based on anecdotal evidence, those Symantec customers that were hit by ExploreZip had a much higher number of active infections (i.e. actively running copies of ExploreZip on Windows 95/98/NT machines) than those hit by Melissa.</p>
<p>Worms can spread to other peer-networked machines by using simple Windows programming techniques, so this is likely to be exploited far more in the future. This should serve as a wakeup call to administrators; peer-to-peer networks are large holes waiting to be exploited by computer worms.</p>
<h3><a name="c55"></a>E-mail Scripting Worms</h3>
<p>We often tell end-users that they can’t get a virus by simply opening an e-mail. While this is true for most consumer e-mail packages, there is a risk with corporate, group-ware e-mail systems. Most of the group-ware e-mail programs allow the user to embed programmable scripts in messages. These scripts allow the user to create simple mail-based user interfaces, forms, etc.; unfortunately, on some platforms, they may also be leveraged to produce malicious or self replicating code.</p>
<p>If such a script-based worm were to be deployed in a corporation, it could quickly flood the e-mail system with copies of itself. It could also spread to partner corporations that share the same e-mail system, assuming that the e-mail is transported using the native protocols of the group-ware system. However, such a worm would probably not be able to spread to other external organizations. Why? Since most <em>intercompany</em> mail is sent over the standard SMTP protocol, the script information associated with messages is stripped from the e-mail as it passes through the Internet, rendering it harmless.</p>
<p>Do we expect to see these worms? Yes and no. Given that the Internet acts as a natural “antibiotic” for these types of malicious code (stripping it out of non-internal e-mail), the likelihood is that such a malicious message would have to originate inside a corporation (or one of its partners) to be successful. The risk of creating such a worm would therefore be high, since the worm author could be easily caught. On the other hand, the Word Concept virus was created inside a corporation as a proof of concept. In any case, it would be a good idea to check with e-mail vendors for information in this area.</p>
<h3><a name="c56"></a>ActiveX and Java Worms</h3>
<p>While worm authors may choose to build ActiveX-based worms, the likelihood of Java worms is extremely small in the short to medium term.</p>
<p>ActiveX programs are basically fully functional Windows programs that are capable of performing any number of malicious actions (just like ExploreZip), and therefore should be considered a potential threat. ExploreZip, Happy99 and even Windows viruses could easily be built and deployed as ActiveX components instead of standard Windows programs. That said, given that ActiveX components must be digitally signed before they can be used in most browser environments, we believe that this will limit the number of ActiveX worms actually deployed in the wild. Any time people can be linked to their creations, the associated liability appears to be a strong deterrent. (See the Ubiquitous Authentication section for more details.)</p>
<p>Java worms are unlikely for two reasons. First, Java security prevents unsigned Java applets from spreading themselves or accessing the local computer resources. Second, while signed Java applets can access the host computer system and potentially spread themselves, the liability issues associated with digitally signed applets will likely limit the number of wild threats.</p>
<h3><a name="c57"></a>Second Generation Worms</h3>
<p>Computer viruses and anti-virus technologies have experienced a co-evolution over the years. For example, in the DOS virus space, simple self-replicating viruses prompted simple string scanning engines. These string scanning engines prompted encrypted viruses, which prompted “algorithmic,” script-based wild-card string scanning technologies. These updated engines prompted polymorphic or self-mutating viruses, and so on.</p>
<p>As of the writing of this paper, we have seen only the first generation of computer worms. These worms don’t attempt to hide themselves, always propagate identical copies of themselves, and are fairly easy to remove from computer systems. Over the next few years, we are likely to see a similar evolution of worm technology that parallels the evolution seen in the computer virus world. The following sections describe some of the anticipated advancements we expect to see in this space.</p>
<h4><a name="c571"></a>Polymorphic Worms</h4>
<p>Worms like Melissa and ExploreZip spread themselves through e-mail by sending identical copies of themselves from one computer to another over e-mail or over the peer-to-peer network. For example, every time ExploreZip sends an e-mail to another user, it attaches the exa ct same 210,432 bytes of executable code. Furthermore, ExploreZip always sends a virtually identical text message in each e-mail:</p>
<blockquote>
<p>Hi <em>Recipient Name</em>!</p>
<p>I received your email and I shall send you a reply ASAP.</p>
<p>Till then, take a look at the attached zipped docs.</p>
<p>bye/sincerely <em>Recipient Name</em></p>
</blockquote>
<p>In a similar fashion, each time Melissa sends itself in e-mail, it uses the same subject line and same message text.</p>
<p>Early on, a number of resourceful system administrators used these static attributes to help them weed out these worms from their e-mail servers. By writing simple scripts or programs that looked for these static text messages, many administrators were able to purge both Melissa and ExploreZip from their e-mail databases. What is the likelihood that the next batch of worms will be this simple? Small.</p>
<p>These worms could easily change or randomly generate their attachment names, the e-mail text, the subject lines and other attributes to make these worms a nightmare to detect. Just as with the early comp ute viruses, administrators are using homegrown tools and techniques to root out these menaces; however, in the near future, we expect that such homegrown solutions will quickly hit their limits.</p>
<p>Furthermore, the next iteration of worms could easily polymorph themselves, as hundreds of traditional DOS, Windows and macro viruses do today. Or even worse, these worms could be equipped with a “worm generator” that would generate entirely new worm strains with similar or different propagation mechanisms, different sequences of instructions, etc. and flood corporate e-mail systems and networks with hundreds of functionally different worm and virus strains! While anti-virus companies have strong technologies for detecting polymorphic viruses, signature scanning techniques and even simple heuristics will be useless against randomly generated worm/virus threats.</p>
<h4><a name="c572"></a>Retro Worms</h4>
<p>Retroviruses, a misnomer from biology, are computer viruses that actively attack anti-virus software to prevent themselves from being detected. Many retroviruses will delete anti-virus definition files, disable memory resident scanners and generally wreak havoc with anti-virus software. We expect that at least some of the next generation computer worms will also possess these characteristics.</p>
<p>Consider what kind of trouble ExploreZip would have created had it deleted the anti-virus software of every computer it spread to? Not only would the administrator have to distribute virus definitions to thousands of computers, but he or she would als o have to redistribute and re-install the entire anti-virus application. While a retro-virus might have reach a small percentage of the corporate desktops, a worm like ExploreZip could quickly decimate a majority of the desktops’ anti-virus protection.</p>
<p>Memory resident computer viruses have been around for years, and anti-virus companies have always instructed its customers to boot from a clean, write-protected floppy and then scan their system with the latest virus definitions to clean them. This high-cost solution works well on DOS and Windows 9X-based systems, but will become less effective as corporations migrate to Windows NT and Windows 2000 (potentially encrypted) NTFS file systems. If desktops are configured to use NTFS partitions, traditional anti-virus software will be unable to access protected files outside of Windows NT, and the problem only gets worse with Windows 2000’s encrypted file system.</p>
<p>The next generation of anti-virus software may contain Windows memory scanning and memory repair technologies<sup><a href="#f10" name="b10">x</a></sup> to deal with memory-resident Windows viruses and worms, but it is unclear how effective these memory-oriented engines will work. For example, consider what would happen if an NTFS-based system became infected by a new memory resident retro worm (or virus). If this retro worm prevented anti-virus software from loading while the worm was resident, how could the administrator repair such a system? They could not launch the anti-virus software from within Windows, since the worm would prevent such an action. Furthermore, if the administrator attempted to clean-boot the machine and run the anti-virus software from a DOS floppy diskette, they will also fail due to anti-virus software’s reluctance to scan NTFS file systems.</p>
<p>Perhaps one of the only solutions to this problem is for anti-virus vendors to produce one-shot tools that are specifically tailored for each new resident retro worm (virus). These tools must be constructed from scratch, so they cannot be recognized by retro worms; otherwise they will be just as susceptible to the retro worm as existing anti-virus software. (And now consider something really scary – a worm or virus that prevents any new executable files from being copied to the system or launched from any drive except the local computer drives. It’s time to get the disk formatting tools out!)</p>
<h4><a name="c573"></a>Stubborn Worms</h4>
<p>Stubborn worms (viruses) are those worms that are designed to prevent themselves from being unloaded from an infected system. There are a number of ways of accomplishing this and many are described in Peter Szor’s paper found in these proceedings<sup><a href="#f11" name="b11">xi</a></sup>. There are several possible attacks that anti-virus software might be able to use to remove such a worm, but in general, such a worm would be difficult if not impossible to remove from a system.</p>
<h4><a name="c574"></a>Wireless Worms</h4>
<p>While wireless devices are in their infancy in the United States, they are gaining widespread acceptance in Japan (where the wireless infrastructure is actually more advanced than the wired infrastructure) and in Europe. Today’s cellular phones have most of their software content embedded in firmware, and do not have the ability to run or download arbitrary software applications, but this is likely to change in the next two to three years. As these devices begin to support arbitrary software applications, there is no reason why they cannot also host malicious mobile code.</p>
<p>Today, in the small hand held (SHH) space, Palm Pilots and Windows CE devices have the ability to run arbitrary software applications, including computer viruses. Furthermore, the newer Palm Pilot computers and other hand-held devices also support infrared and wireless communication (Palm VII). Using this technology, users of the Palm III and later models can actually exchange applications “through the air!” Unfortunately, it would also be simple to construct a computer worm that would send itself using the same mechanism. In the future, we expect that other small handheld devices will also support such wireless application exchange, and we will see computer viruses and worms attack these devices. In fact, we already know of several malicious programs that purported to spread using the infrared communications mechanism of handheld calculators!</p>
<p>How would such a wireless worm work? If we assume that wireless SHH devices can easily locate and talk with other devices using either standard data-oriented cellular phone numbers or via an IP addresses, a wireless worm could do the following:</p>
<ol>
<li>Examine the “recently called” list or “received calls from” list of the device.</li>
<li>Send a message to the phone numbers/IP addresses of all devices in the lists above. This message would contain the computer worm. The message subject might say “try this cool game, it’s fun!”</li>
<li>Upon receipt at the other end, the user would read the message and run the worm program, causing it to spread to other devices.</li>
</ol>
<p>Such a wireless threat could quickly infiltrate thousands of wireless devices, delete or modify phone entries, application data, etc. Hopefully, since all transmissions between devices are likely to be logged (and billed!), authorities can quickly pinpoint the origin of such attacks and take appropriate measures. However, given the dependence that businesses have on these phones, a wireless worm attack could have a devastating affect on businesses, government and consumers alike and might be a target for terrorist cyber-attacks.</p>
<h2><a name="c6"></a>Examination of Worm Epidemics</h2>
<p>Arguably, since the dawn of modern computing, we’ve seen a total of four worm-driven epidemics: CHRISTMA EXEC, the Internet Worm, Melissa and ExploreZip. This section will examine each of these threats and attempt to identify why they were successful and what underlying holes they exploited to spread as prolifically as they did.</p>
<h3><a name="c61"></a>Case Study: Mass E-mail Worms, CHRISTMA EXEC and Melissa</h3>
<p>Let’s take the easy ones first. CHRISTMA EXEC and Melissa both spread exceptionally well due to their exploitation of <em>corporate</em> e-mail. Even though each of these threats required user intervention to spread themselves (the user had to manually detach and launch CHRISTMA EXEC to spread it), they spread to thousands of machines in a matter of days. The following list details why these worms spread so well and more generally why corporate e-mail is such an effective vector for worms:</p>
<h4><a name="c611"></a>It’s easy to obtain “addresses” of other targets</h4>
<p>Since most e-mail programs maintain address lists to facilitate sending e-mail in the enterprise (or even from the home machine), the worm has an easy list of targets to send itself to.</p>
<h4><a name="c612"></a>Homogeneous e-mail makes spreading easy</h4>
<p>Since most desktops in a corporation use the same mail solution, a worm can exploit this homogeneity and spread rapidly.</p>
<h4><a name="c613"></a>Humans are the biggest security risk; there’s no need to find a back door into the system</h4>
<p>Why would a worm try to hack into a UNIX system or find a back-door past the firewall when it can just send itself to a person that is likely to open the attachment and spread the worm throughout their corporation? Without human involvement, these e-mail worms would not spread beyond the first recipient.</p>
<h4><a name="c614"></a>Corporate e-mail systems offer “one degree of separation”</h4>
<p>Corporate e-mail systems allow anyone in the corporation to send e-mail to anyone else in the corporation. The e-mail address book provides all the addresses in one easy-to-find place. Furthermore, modern operating systems like Windows make it easy for a worm to get to this information (with COM, etc.). Consequently, a e-mail-based worm can quickly reach everyone in an organization. This is in contrast to consumer e-mail networks, where a user might have several dozen e-mail addresses in his/her address book, but not thousands. This is <em>one reason</em> why threats like Melissa spread so rapidly to so many machines, while threats like Happy99 (an SMTP-based, largely consumer oriented worm) have spread widely, but much more slowly.</p>
<p>While corporate e-mail systems allow one user to easily send mail to any other user in the corporation, these address books typically do not contain consumer e-mail addresses. This is one reason why Melissa had such a low penetration of home users outside of corporations. The other reason is that most home users don’t use exchange, so even if a home user did get hit, the worm would not be able to spread to other computers as a worm, but only in its viral capacity. Had Melissa spread using either Internet (SMTP) e-mail systems or Exchange, we probably would have seen a high infection rate of home users as well.</p>
<h4><a name="c615"></a>Why infect one other computer when you can infect 50… or 50,000</h4>
<p>Both Melissa and CHRISTMA EXEC spread so rapidly because during each iteration, they sent themselves to a large number of machines. Even worse, Melissa spread itself to potentially thousands of other machines with each infection because of its inadvertent usage of “all company” e-mail addresses near the top of the Exchange address book.</p>
<h4><a name="c616"></a>Spread to other computers as soon as you can</h4>
<p>These worms spread themselves to other computers via e-mail as soon as they were opened/run on a computer. This allowed them to spread rapidly and not at human speeds. Contrast this behavior with the Happy99 worm, which would only send itself out to other users when the infected user sent e-mail to those users. Since most home users don’t send extensive amounts of e-mail, this limited the spread rate of the Happy99 virus.</p>
<h4><a name="c617"></a>Mailbox penetration or computer penetration?</h4>
<p>While these e-mail based worms were prolific at spreading themselves, they mostly wound up languishing in e-mailboxes rather than actually running on people machines. In the case of Melissa, anecdotal evidence from Symantec customers indicated that the virus/worm got spread to thousands of e-mailboxes but was actually launched by only a small subset of the corporate population. This can be attributed to several factors:</p>
<ol>
<li>People check their e-mail/detach attachments at a slow rate compared to the spread rate of the worm.</li>
<li>System administrators intervened and brought down e-mail systems before more people could become infected and spread the threat.</li>
<li>The worm spread so prolifically that it brought down e-mail systems, preventing most users from accessing it.</li>
<li>Given that all Melissa e-mails were identical, this allowed IT staffs to warn their users, also limiting the actual machine penetration.</li>
</ol>
<p>One or all of the above effects may have had an impact on the success of Melissa.</p>
<h3><a name="c62"></a>Case Study: Back Door Worms and The Internet Worm</h3>
<p>A back door worm is one that gains access to a system via a “back door” or system vulnerability, rather than being delivered via front-Office means (e-mail, for example). This class of worms has the potential to achieve rapid system penetration (as opposed to just e-mailbox penetration, like Melissa) since it gains entry into and runs on a system without user intervention.</p>
<p>There are a number of methods that can be used to penetrate supposedly secure systems<sup><a href="#f12" name="b12">xii</a></sup>, including:</p>
<ol>
<li>Exploiting default administrator passwords, that have not been reset, to gain access to a system.</li>
<li>Using dictionary-based password attacks to break into user accounts and remotely login to a system.</li>
<li>Using buffer-overflow attacks on common or obscure network services to cause arbitrary machine code to be executed on a target system.</li>
<li>Exploitation of debug facilities that are built into standard network services.</li>
<li>Attack of non-secured shared drives and peer-to-peer devices.</li>
</ol>
<p>The Internet Worm actually used the second, third and fourth items from the list above to penetrate computer systems on the fledgling Internet. The following factors may be responsible for the success of the Internet Worm</p>
<h4><a name="c621"></a>It’s easy to obtain “addresses” of other targets</h4>
<p>Just like Melissa, the Internet Worm found it easy to find other targets. Without this facility, it would have had a much harder time spreading. According to<sup><a href="#f10">x</a></sup>:</p>
<blockquote>“The [Internet] worm's role in life is to reproduce - nothing more. To do that it needs to find other hosts. It does a 'netstat -r -n' to find local routes to other hosts &amp; networks, looks in /etc/hosts, and uses the yellow pages distributed hosts file if it's available. Any time it finds a host, it tries to infect it through one of the three methods, see above. Once it finds a local network (like 129.63.nn.nn for ulowell) it sequentially tries every address in that range.”</blockquote>
<p>With the advent of corporate directories (such as Novell’s NDS or Microsoft’s ActiveDirectory), worms will find it even easier to obtain a list of targets to attack. While the Internet Worm used a roundabout method to locate targets, its technique was evidently just as efficient as any modern worm we’ve seen to date.</p>
<h4><a name="c622"></a>Homogeneous environments makes spreading easy</h4>
<p>The Internet Worm was successful (supposedly hitting up to 1/10<sup>th</sup> of all computers on the fledgling Internet) because it targeted the dominant platforms and exploited common holes. Given corporate standardization on the Windows platform (and a small number of other platforms: Novell, Linux, Solaris, HP/UX, AIX), corporations may be overly susceptible to future back door-based worm attacks.</p>
<h4><a name="c623"></a>Back door worms spread best unhindered</h4>
<p>Had Internet administrators installed operating system security fixes/patches or used firewalls with updated security rules, they may have largely prevented the Internet Worm fiasco. The back doors that the Internet Worm used to infiltrate systems were well known at the time of infection and fixes were available well before the Internet Worm made its debut!</p>
<p>Today, some modern firewalls with application-level proxies can block externally-based back door worms from entering the corporate network. These firewalls monitor all transactions from the outside world into the corporate network and can detect buffer overflow exploits or the other attacks mentioned above and alert the administrator to the threat. Like anti-virus software, these firewalls must be updated on a regular basis or they may leave the corporate network unprotected from recently discovered attacks.</p>
<p>If corporations maintain an up-to-date firewall, most back door-only worms will be successfully repelled from entering the corporate network via an external network connection. However, these back door worms may enter the corporation via other means: users can download them from USENET news groups, receive them in e-mail, etc.</p>
<p>If a back door worm does infiltrate the corporate network, via any number of avenues (such as e-mail, download off the Internet, etc.), it can wreak havoc on the enterprise. Once a worm finds its way into the corporation, it has free reign of the corporate network and can attack virtually any machine in the corporation without hindrance from a firewall. <em>To protect against such back door worms, corporations should definitely consider employing internal firewalls around systems that contain critical data and/or applications.</em></p>
<h4><a name="c624"></a>Spread to other computers without user intervention</h4>
<p>The Internet Worm spread itself to other computers as soon as it gained control of a new computer and did not require human intervention to spread. This allowed it to spread extremely rapidly to susceptible machines.</p>
<h4><a name="c625"></a>Computer penetration</h4>
<p>The Internet Worm achieved widespread computer penetration since it actively infiltrated computer systems and did not rely upon user behavior to gain control of these systems. A user did not have to detach the Internet Worm from an e-mail to spread it; this worm spread itself without any user intervention or action. Similarly, by employing a back door scheme, ExploreZip was also able to penetrate a larger number of actual computer systems (vs. e-mailboxes) than Melissa.</p>
<h3><a name="c63"></a>Case Study: Hybrid Worms and ExploreZip</h3>
<p>The Hybrid Worm is one that uses a number of different mechanisms to spread itself over computer networks. To date, the ExploreZip Worm is the best example of a successful hybrid worm: it spreads itself using both e-mail and back doors. This type of worm has arguably has the best odds of both infiltrating many machines in a single company, as well as spreading well across different companies, due to its combination of infection vectors. This combination of vectors allows ExploreZip to:</p>
<ol>
<li>Quickly penetrate corporate firewalls, via the e-mail vector.</li>
<li>Quickly spread itself across the peer-to-peer corporate network, achieving active running infections on desktops, using its back-door vector.</li>
<li>Quickly spread itself to other corporate sites and end-users, via the e-mail vector.</li>
</ol>
<h4><a name="c631"></a>It’s easy to obtain “addresses” of other targets</h4>
<p>As with the other worms, ExploreZip spreads quickly because it has easy access to lists of target computers. Specifically, ExploreZip uses two mechanisms to spread. First, it scrutinizes the Outlook e-mail in-box to determine which users have recently sent e-mail to the infected user. The worm then replies to these users, sending a copy of itself as an attachment. As these target users open the attachment, they will spread the worm as well.</p>
<p>In addition, the worm uses facilities built into the Windows operating system and Windows networks to locate other peer-to-peer networked hard drives. If lax security is in place, the worm will find one or more vulnerable computers and copy itself to these machines. Finally, it updates an .INI file on the target drive so the host computer will launch and spread the worm upon the next reboot. It is clear that peer-to-peer networks are extremely vulnerable to worm-based attack and should be eliminated from the corporate network if at all possible.</p>
<h4><a name="c632"></a>Homogeneous computers makes spreading easy</h4>
<p>As with the other worm threats, ExploreZip requires a homogeneous environment to spread. The worm relies upon an Outlook (Outlook Express) e-mail client and peer-to-peer Windows networking to spread.</p>
<h4><a name="c633"></a>The human is the biggest security risk; there’s no need to find a back door into the system</h4>
<p>Given that the Hybrid Worm exploits both e-mail as well as back doors, it can easily gain access to a firewall-protected corporate network via e-mail. Once inside the poorly secured corporate network, the worm can use either mechanism to spread itself.</p>
<h4><a name="c634"></a>Spread slowly or spread quickly?</h4>
<p>Unlike Melissa, ExploreZip did not exploit the “1 degree of separation” aspect of corporate e-mail systems. Rather than sending itself to the first fifty users in the address book, ExploreZip only sent itself to those users that sent e-mail to the infected machine. Presumably, this would cause ExploreZip to spread at a much slower rate than other worms: the rate at which users receive new e-mail. This technique arguably limited the spread of ExploreZip, at least via e-mail, but may have also contributed to its success! While Melissa took down corporate e-mail servers due to the sheer volume of e-mail, ExploreZip metered its spread, and the lack of e-mail volume may have prevented administrators from being alerted to ExploreZip’s presence.</p>
<p>ExploreZip may have also had success because it continuously tries to spread to other peer-to-peer networked computers once it has infected a system. While rapid replication in e-mail may be a giveaway for a computer worm, rapid replication via other back-door mechanisms appears to be a very effective vector assuming it does not noticeably bog down the corporate network. Using this peer-to-peer mechanism, several of Symantec’s customers had thousands of computers hit by ExploreZip!</p>
<p>Finally, ExploreZip was also unlike Melissa in that it continues to send itself (to anyone that sends e-mail to an infected system) well after the initial infection of a system. Melissa, on the other hand, only sends e-mail out once during the initial infection. Because of this behavior, even a single isolated computer infected by ExploreZip can continue to actively “push” the infection for days or weeks. This behavior, coupled with the e-mail reply behavior described above, may have balanced ExploreZip’s spread rate.</p>
<h4><a name="c635"></a>Mailbox penetration or computer penetration?</h4>
<p>Unlike Melissa or CHRISTMA EXEC, ExploreZip was able to achieve a high penetration of e-mailboxes <em>and</em> actual computer systems. The high penetration of computer systems can be attributed to its peer-to-peer spreading mechanism. Users on other peer-to-peer networked computers could become infected with a simple reboot; there is no need to open e-mail or launch an attachment!</p>
<h4><a name="c636"></a>Payload and trigger conditions affect the worms’ viability</h4>
<p>Of the major computer worms, only ExploreZip has a malicious payload. This worm will destroy the contents of several types of files, including documents, spreadsheets and programming source code, on both local and networked volumes. ExploreZip will perform this attack the moment it infiltrates a new system and will continue to attack the local and networked computers until it is manually terminated or the infected machine is quarantined from the network.</p>
<p>By using such a payload mechanism, ExploreZip has doomed itself to be discovered very rapidly. On the other hand, it also has the opportunity to damage a large amount of critical data before it can be eradicated from the corporate network. If ExploreZip had a delayed payload (e.g. deleted files only after a month of infection), ExploreZip would have probably never been able to deploy its malicious payload in an actual computing environment. This is in contrast to slower-spreading computer viruses like CIH. Since these viruses spread themselves more slowly and attract less attention, they have the opportunity to penetrate a large number of systems over a longer period of time. By intentionally dealing their payload, they can achieve widespread distribution and then perform more widespread damage.</p>
<p>Since ExploreZip will delete files from networked volumes without actually residing on the computer that hosts those volumes, ExploreZip can destroy data on machines whether or not they are protected by anti-virus software! This is yet another reason why peer-to-peer networks are so dangerous in the corporation. A single infection of ExploreZip on an unprotected machine can destroy files on hundreds of anti-virus-protected networked computers, without generating a single anti-virus alert.</p>
<h2><a name="c7"></a>Containment</h2>
<p>How can corporations protect themselves against computer worms? The following sections describe some of the defenses that corporations and governments can use to stem the threat of computer worms.</p>
<h3><a name="c71"></a>Proactive Steps</h3>
<h4><a name="c711"></a>Run Anti-virus Software on Servers, Gateways, and Desktops</h4>
<p>Enough said.</p>
<h4><a name="c712"></a>Remove “all company” Addresses From Your Lists</h4>
<p>Computer users rarely have the need to send e-mails to the entire company and such a facility is extremely vulnerable to e-mail-based computer worms. E-mail administrators should limit public e-mail lists to small functional groups and eliminate all company-wide lists. Should users need to send such an e-mail (this should be rare), they can forward the e-mail to an administrator for company-wide posting.</p>
<h4><a name="c713"></a>Lock Down All Peer-to-peer Networking</h4>
<p>Peer-to-peer networks are a huge security risk for network-aware worms and viruses. We recommend that administrators lock down peer-to-peer networked drives on all computers where this is not absolutely required. Administrators may also want to establish an official policy against peer-to-peer volumes and distribute this to users.</p>
<p>At the very least, the administrator should maintain a special computer grouping or domain in the network management software (or anti-virus console) for all peer-to-peer networked computers. This will enable quick deployment of anti-virus definitions to these particularly vulnerable machines.</p>
<h4><a name="c714"></a>Deploy Internal Firewalls</h4>
<p>Corporate firewalls are fairly effective at preventing both hacker and malware attacks from outside sources; however, they provide no benefit once a worm has entered the corporate network. As we have seen with ExploreZip, the vast majority of computers that were actually penetrated by Exp loreZip were attacked from within the corporation, from other peer-to-peer networked computers. Deploying internal firewalls could prevent such intra-network infections.</p>
<p>Administrators should consider deploying internal firewalls around corporate servers, such as:</p>
<ol>
<li>File servers</li>
<li>E-mail servers</li>
<li>Corporate databases/SQL servers.</li>
</ol>
<p>In addition, personal firewalls are effective at preventing attacks on desktop PCs running Windows 9X or Windows NT. While this may be a more expensive option, it could seriously neuter many back door worms and Trojan horses.</p>
<h4><a name="c715"></a>Disable E-mail Script Capabilities</h4>
<p>If your group-ware product supports e-mail scripting, this should be disabled for all but a few users (most likely those in the IT department). By disabling these facilities, you can protect your corporation from Native e-mail threats.</p>
<h4><a name="c716"></a>Strip Executable Content From Incoming E-mail</h4>
<p>Some group-ware and gateway-based anti-virus products have options to allow the administrator to strip executable content from either incoming or outgoing e-mail messages. Administrators should take advantage of these facilities if they are available. For example, while some employees use macros in the corporation, it is rarely the case that users need to exchange macros between companies. By configuring your anti-virus solution to automatically strip all macros from document attachments entering or leaving the enterprise, you can protect your users and business partners from inadvertent worm or virus infection. If such a measure is too obtrusive for your work environment, the same facility can be used only in the event of a worm outbreak (or impending outbreak).</p>
<h4><a name="c717"></a>Use Heuristics and If Possible, Digital Immune System Technology</h4>
<p>Anti-virus heuristics are very effective at detecting new and unknown viruses; depending on the type of virus, heuristics can detect up to 90+% of all new and unknown strains. By coupling strong heuristics on the desktop, the server and the gateway with a digital immune system, the anti-virus offering can be made more even powerful.</p>
<p>A digital immune system (such as the one being developed by Symantec and IBM) is a <em>closed loop</em> system that is comprised of both client and server components. The system generally works in the following way:</p>
<ol>
<li>The anti-virus software on the desktop, file server, gateway, or group-ware server detects a potential new or unknown virus with heuristics.</li>
<li>The sample is quarantined from the host computer and sent to the administrators console for review.</li>
<li>The administrator can examine the sample, automatically strip any proprietary content, and forward the sample to the vendor-operated automated servers for analysis.</li>
<li>Upon receiving the sample(s), the automated servers determine if the sample is already detected by the latest anti-virus definitions (its possible that another user submitted the same sample only hours earlier). If so, the system immediately returns an appropriate fix for the virus, for deployment in the enterprise.</li>
<li>If the sample is not known, it is fed into an automated replication system. The sample is replicated to other files (documents, executable files, etc.)</li>
<li>The system correlates all replicated copies of the virus/worm and derives a fingerprint and a cure.</li>
<li>The system tests the fingerprint and the cure to make sure it works on all replicated samples.</li>
<li>The system officially integrates the fingerprint and the cure into the virus database.</li>
<li>The system sends the solution back to the customer and immediately scans all other pending issues just in case they contain the same virus/worm (this speeds up the resolution time for subsequently submitted issues). The user can then deploy these definitions to their servers, gateways and desktops.</li>
<li>As new updates are produced, they can be publicly posted to web servers or proactively pushed to the community of digital immune users.</li>
</ol>
<p>The first version of the Symantec/IBM digital immune system, released in July, 1999, is capable of automatically analyzing and deploying a fingerprint and cure for most Word and Excel macro viruses in about 2 hours time (at the time of this writing, about a week after deployment, three viruses have been automatically analyzed). Such a closed loop system can be very effective in reducing the window of vulnerability for corporate users, and as the software systems and hardware imp rove in speed, we hope to reduce the cycle time to fifteen minutes or less. The ultimate goal is to deploy the cure faster than the virus/worm can spread itself.</p>
<h3><a name="c72"></a>Before Impending Infection</h3>
<h4><a name="c721"></a>To Prepare For E-mail Worms</h4>
<p>If you receive notification of a possible new e-mail-based worm threat, but do not believe that this worm has already infiltrated your network, you have the following options:</p>
<ol>
<li>If your vendor has provided you with virus definitions, immediately deploy these virus definitions to the gateway anti-virus scanners and the group-ware anti-virus scanners. Next, deploy the virus definitions to the file servers and finally to the desktops.</li>
<li>If your e-mail gateway (or anti-virus protection) can be configured to strip attachments, configure this protection to automatically strip all file attachments of the appropriate type (e.g. prevent document attachments if you’re facing a Melissa-like threat, etc.). This rather draconian measure can be undone later after virus definitions are available.</li>
</ol>
<h4><a name="c722"></a>To Prepare For Arbitrary-protocol Worms</h4>
<p>If you receive notification of a possible new arbitrary-protocol worm threat, but do not believe that this worm has already infiltrated your network, you have the following options:</p>
<ol>
<li>If the worm may use e-mail facilities, follow the steps above.</li>
<li>If the worm uses other TCP/IP-based mechanisms to spread, update your firewall rules to temporarily block potential points of entrance into your corporation.</li>
</ol>
<h3><a name="c73"></a>Active Infection</h3>
<p>If you believe that the worm has infiltrated your network, the following recommendations may help:</p>
<h4><a name="c731"></a>If Hit By A Destructive Worm: Update File Server Permissions</h4>
<p>If you suspect that a worm may be modifying or destroying data on shared network volumes, immediately change the privileges on all files to READ ONLY. This will prevent the worm from destroying important corporate data, while allowing users to access critical business data.</p>
<h4><a name="c732"></a>If Hit By a Data Export Worm: Limit Access To Data and Networks</h4>
<p>If you suspect that a worm may attempt to access sensitive files and export this information out of the enterprise, immediately do the following:</p>
<ol>
<li>If you believe the worm is using standard network protocols to export information, lock down Internet access, stopping all outgoing transmissions to the Internet. If you know specific communications ports that the worm uses to communicate with the outside world, you can configure the firewall to specifically block these transmissions and allow other legitimate transmissions to continue.</li>
<li>If you believe the worm is file server-aware and may be examining your file servers, take down all file servers until a reasonably full virus definition rollout (to desktops and file servers) and containment process is complete.</li>
<li>Disable all outgoing e-mail (or down e-mail servers) if the worm exports information via e-mail.</li>
</ol>
<h4><a name="c733"></a>If Hit By an E-mail or Arbitrary-protocol Worm Infection: Distribute Virus Definitions to Gateways, E-mail Servers and File Servers First</h4>
<p>Ideally, when receiving a new virus definition set from an anti-virus vendor, administrators should roll out the latest definitions to the entire corporation. In practice, this is next to impossible. There is a huge list of reasons why network management software (NSM) fails to properly distribute software updates: remote computers aren’t available to be updated, computers have been turned off, hard drives are too full, users reboot during updates, etc. That said, administrators should roll out their virus definitions in a tiered fashion to reduce the spread of e-mail-based or hybrid computer worms. By rolling the definitions out to the computer systems that e-mail worms use to spread themselves, one can quickly lock down the corporate network from further infections.</p>
<p>First, roll out the anti-virus definition update to the e-mail gateway(s). This will prevent the threat from re-entering and re-infecting the corporate network from the Internet.</p>
<p>Second, take down all group-ware e-mail servers, roll out the anti-virus definition update to these servers, and immediately initiate a scan of all messages. Some anti-virus products allow you to scan only those messages that arrived after a certain time. If you know the approximate date and time of the initial infection, you can use this facility to limit the scanning time and get users back on e-mail as soon as possible. These steps will prevent any new copies of the worm from filling users’ mailboxes and remove any existing copies that have already flooded the e-mail system. While it would be ideal for users to continue using e-mail during the cleaning process, this leaves them open to infection (with most anti-virus products for the common group-ware systems).</p>
<p>Third, roll out the virus definitions to all file servers and initiate an immediate on-demand scan of all shared volumes. After rolling out the new virus definitions, there is no need to “down” the server; the anti-virus software will monitor all file transfers to and from the server in real time.</p>
<p>Finally, begin rollout of the virus definitions to all desktops and initiate an on-demand scan of all desktop systems.</p>
<h4><a name="c734"></a>If Hit By a File Server-aware Worm Infection: Distribute Virus Definitions to File Servers First</h4>
<p>If your company is infected with a worm that uses file servers to spread itself, you should update your server anti-virus definitions first and immediately initiate an on-demand scan of all susceptible volumes.</p>
<p>Next, roll out the new virus definitions to the gateway and group-ware anti-virus products, and finally to the desktops. Make sure to initiate an on-demand scan of all systems as they are updated.</p>
<h4><a name="c735"></a>If Hit By a Back Door Worm Infection: Down All Affected Networks</h4>
<p>If you have reason to believe that your company has been infected with a back door worm, you should update your gateway, server and group-ware anti-virus definitions first and immediately initiate an on-demand scan.</p>
<p>Next, you have two choices:</p>
<ol>
<li>Shut down all critical networks and/or target machines that may act as a vector or a host for the worm and then initiate manual cleanup of all potentially infected machines. This extreme response should be applied in the case where the worm is known to re-infect connected systems or if the worm is damaging.</li>
<li>Roll out virus definitions to potentially infected machines and initiate an on-demand scan as soon as possible.</li>
</ol>
<h2><a name="c8"></a>Future Anti-worm Technologies</h2>
<p>The following sections describe current and future technologies that will help to protect against computer worms.</p>
<h3><a name="c81"></a>Windows Memory Scanning and Repair</h3>
<p>Many of the new computer worms, such as ExploreZip, Happy99 and Remote Explorer (both a virus and a worm) are native 32-bit Windows programs. While this current generation of worms can easily be removed from memory with standard Windows tools, the next generation of worms may not be so simple. Native 32-bit Windows <em>retro worms</em> and <em>stubborn worms</em> may be difficult, if not impossible, to remove from computer systems without specialized memory scanning and repair tools. There are a number of technological hurdles that must be overcome before these technologies are effective at removing new/unknown worms, but even with limited functionality they may still provide real value for corporate customers and consumers alike (See Retro Worms section).</p>
<h3><a name="c82"></a>Behavior Blockers</h3>
<p>Instead of detecting computer worms after they have a chance to infiltrate and gain control of a computer system, why not stop them from infiltrating the system in the first place! This is what behavior blockers attempt to do. A worm-oriented behavior blocker might do the following:</p>
<ol>
<li>Require user, administrator or policy-driven authorization to update critical areas of the Windows computer (such as the Windows registry, INI files, batch files, system services, device drivers, etc.)</li>
<li>Block all attempts to send e-mail by all non-authorized programs, macros or scripts.</li>
<li>Block all attempts to send e-mail to more than N users (where N might be 50, 100 or 500) by non-authorized programs.</li>
<li>Block all attempts to use non-standard Internet services (this is what a personal firewall does; see below for details).</li>
</ol>
<p>As with all behavior blockers, stopping the behaviors listed above will occasionally prevent useful activities from occurring. However, the high cost of computer worm outbreaks may quickly justify the inclusion of worm-oriented behavior blocking on the corporate and consumer desktops.</p>
<h3><a name="c83"></a>Personal Firewalls</h3>
<p>Like corporate firewalls, personal firewalls monitor all network communications entering and leaving the protected computer. These lightweight firewalls are designed to block all transmissions that aren’t specifically allowed by the user (or administrator) and may help to prevent arbitrary protocol worms from gaining a foothold in a corporation.</p>
<h3><a name="c84"></a>Worm Heuristics</h3>
<p>Anti-virus companies are already updating their heuristics to detect the next wave of macro-based computer worms. Companies are also looking into methods for heuristically detecting 32-bit Windows-based worms; this is actually a much more difficult task than simple virus heuristics. While viruses are typically small programs (on the order of several kilobytes), 32-bit Windows threats (including computer worms) are often hundreds of kilobytes or more, and are much more difficult to detect heuristically. Case in point, ExploreZip, a native Windows worm built using Inprise’s Delphi development environment, was not detected by a single anti-virus heuristic (known to the author).</p>
<h3><a name="c85"></a>Automated Worm Replication and Analysis</h3>
<p>It is likely that in the future, anti-virus vendors that are pursuing digital immune system strategies will update their immune systems to automatically generate cures for computer worms, in addition to viruses. Already, researchers at the IBM T.J. Watson Research Center are working on automated replication for computer worms, for inclusion in the Symantec/IBM Digital Immune System.</p>
<p>Unlike computer viruses, which can be automatically replicated and analyzed on a single, contained computer, worms require entire virtual test networks to be constructed to detect the worm’s replication across multiple machines. Furthermore, given the wide variety of protocols, applications, and systems that may be leveraged by the worm to help it spread, such worm replication and auto-analysis systems will undoubtedly be complex beasts (Melissa leverages Outlook, Happy99 leverages SMTP e-mail, IRC worms require the mIRC client, etc.).</p>
<h2><a name="c9"></a>Future Containment Approaches</h2>
<p>Given the destructive potential of the computer worms we have seen thus far, how might corporations and vendors deal with computer worms in the future? The following sections provide some insight into potential solutions to alleviate the computer worm problem.</p>
<h3><a name="c91"></a>Ubiquitous Authentication</h3>
<p>When Microsoft announced that it would use digital signatures to protect against malicious mobile code, the entire anti-virus community nearly had a fit. Many researchers complained “Digital signatures/authentication systems don’t actually stop malicious mobile code.” This is true. But while these systems can’t tell you whether or not a piece of code is malicious or not, they can tell you where it came from, and this can be an equally useful function.</p>
<p>At the last ICSA conference, I asked the question: “How many corporations have been hit by a malicious ActiveX or Java program?” The answer was zero, and this concurred with all of the research I had done over the previous mo nths<sup><a href="#f13" name="b13">xiii</a></sup> . Why is this the case? Based on a decent amount of research, my deduction is that authentication had a great deal to do with the lack of in-the-wild attacks. Internet Explorer, by default, will only accept authenticated ActiveX controls from the Internet and it will only allow authenticated Java access the local computer system. Therefore, any potentially harmful ActiveX or Java content downloaded off the web will be digitally signed, assigning liability to the software producer. While such a technique will not prevent a computer virus from infecting an ActiveX object before it is digitally signed, it will prevent the majority of intentional attacks. (And based on experience, the former case is very rare as well.)</p>
<p>In a similar fashion, robust, authenticated e-mail systems may also help to dramatically reduce the number of computer worms infecting corporations. For instance, consider the following solution: At the corporate e-mail gateway, a proxy authentication server verifies the authenticity of all incoming e-mail via digital signatures. Any e-mail that can’t be authenticated will automatically have all attachments that may contain executable content stripped from the message. All authenticated e-mails will pass through unhindered. Such a system could also be configured to be even more stringent, stripping all non-signed executable files, ActiveX controls or user macros from all messages. A similar solution could be used at the firewall to verify the content of all executable code pulled fromthe World Wide Web.</p>
<p>Such a system would not strictly protect against e-mail-based or computer worms, but it would:</p>
<ol>
<li>Provide a huge disincentive for anyone within the corporation to intentionally spread a user-launched worm, since they could now be tracked and easily prosecuted.</li>
<li>Provide a huge disincentive for anyone outside the corporation to intentionally introduce a user-launched worm into the corporation, since they could also be tracked and easily prosecuted.</li>
<li>Prevent any user-launched worms of external origin from entering the corporation accidentally.</li>
</ol>
<p>Unfortunately, given the lack of a ubiquitous public key infrastructure (PKI) for the Internet, such solutions are at least several years away. While it may seem overkill to require authentication for each and every e-mail or web transmission into the corporation, based on all available information, this is one of the most effective ways to discourage/prevent malicious code attacks.</p>
<h3><a name="c92"></a>Policy-driven File/Macro-level Access Control</h3>
<p>In most corporations, any user can run any program (or macro) on their PC without intervention. Such an open environment is extremely susceptible to computer viruses, worms and Trojan horses. If computer worms continue to increase in prevalence, we may see corporations adopting and deploying “access control” technologies on the desktop. An access control solution would only allow specifically approved programs and macros to run on the typical user’s computer, without exception. This scheme, while extreme, can largely prevent infestation by malicious code.</p>
<h3><a name="c93"></a>Macro-free Products</h3>
<p>If worms continue to grow in prevalence, corporations may start requesting (and getting!) Office and group-ware products that are macro-free or macro-light. While Microsoft has, up to this point, resis ted producing Office products without macro capabilities, the time may soon come when both macro-enabled and macro-free(light) versions of the Office applications are available. This simple solution should save millions of dollars in cleanup costs, and corporations will soon have to make a concerted effort to determine if the usefulness of the macro justifies its cost due to its security risk.</p>
<h2><a name="ca"></a>Conclusion</h2>
<p>Computer worms have grown to become the fastest spreading and most costly malicious code threats of this decade. These worms leverage our infrastructural homogeneity, the ubiquitous programmability of Wintel machines, and increasing connectedness of the Internet to spread rapidly through the enterprise. Relatively speaking, computer viruses spread slowly when compared to the computer worm. While a virus might slowly spread from one corporate department to another, the computer worm can often blitzkrieg through an organization in hours or even minutes. This makes worms, especially with destructive payloads or data export capabilities, extremely ruthless attackers.</p>
<p>Today’s anti-virus solutions are only marginally effective at protecting against the fast-spreading worm and it is clear that these solutions will need to evolve and be supplemented by other systems to provide sufficient protection for customers. Solutions like digital immune systems, e-mail authentication, heuristics, and behavior blocking will help to control the worm problem in the future; however, corporations need to seriously consider containment plans and emergency response to deal with emergencies and special cases. Without major changes to applications, communications facilities and the operating systems – all of which are unlikely to be accepted in the corporation or the home - computer worms are an inevitability and anti-virus/anti-worm software is, at best, a partial solution to the problem.</p>
<p>Good luck and may you never need a parasitologist.</p>
<hr size="1"/>
<p><a name="f1" href="#b1">i</a> Private communications with Steve Trilling, SARC</p>
<p><a name="f2" href="#b2">ii</a> http://www.ifs.univie.ac.at/~c9225414/security/worm.html</p>
<p><a name="f3" href="#b3">iii</a> http://www.eu.veg.org/Risks/20.32.html</p>
<p><a name="f4" href="#b4">iv</a> http://www.byte.com/art/9611/sec11/art4.htm</p>
<p><a name="f5" href="#b5">v</a> http://www.ifs.univie.ac.at/~c9225414/security/worm.html</p>
<p><a name="f6" href="#b6">vi</a> http://www.ee.ryerson.ca:8080/~elf/hack/iworm.html</p>
<p><a name="f7" href="#b7">vii</a> http://www.avpve.com/viruses/classification/4_mirc.html</p>
<p><a name="f8" href="#b8">viii</a> Private communications with Steve Trilling, SARC</p>
<p><a name="f9" href="#b9">ix</a> Private communication with Sherrallee Buzzell, SARC Coordinator</p>
<p><a name="f10" href="#b10">x</a> ‘Memory Scanning Under Windows NT’, Peter Szor. Proceedings of the 1999 Virus Bulletin Conference.</p>
<p><a name="f11" href="#b11">xi</a> ‘Memory Scanning Under Windows NT’, Peter Szor. Proceedings of the 1999 Virus Bulletin Conference.</p>
<p><a name="f12" href="#b12">xii</a> http://www.ee.ryerson.ca:8080/~elf/hack/iworm.html</p>
<p><a name="f13" href="#b13">xiii</a> ‘Mobile Code Threats, Fact or Fiction’, Carey Nachenberg. Proceedings of the 1999 ICSA IVPC Conference.</p>
[<a style="" href="/lib/?lang=EN&amp;index=WO#acn00">Back to index</a>] [<a href="/lib/acn00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=acn00">de</a><a href="/lib/index.php?lang=en&amp;id=acn00">en</a><a href="/lib/index.php?lang=es&amp;id=acn00">es</a><a href="/lib/index.php?lang=it&amp;id=acn00">it</a><a href="/lib/index.php?lang=fr&amp;id=acn00">fr</a><a href="/lib/index.php?lang=pl&amp;id=acn00">pl</a><a href="/lib/index.php?lang=ru&amp;id=acn00">ru</a><a href="/lib/index.php?lang=ua&amp;id=acn00">ua</a></div>
</body>
</html>
