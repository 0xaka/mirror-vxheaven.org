<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Zsombor Kurdi 'Viruses using .NET Framework' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Zsombor Kurdi"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Kurdi, Zsombor,Viruses using .NET Framework, code, virus, viruses, java, computer, figure, infection, operating, framework, msil, programming, infected, programmers, malicious, malware"/>
<meta name="Description" content="In our age, programming languages and development tools advance to make programmers' work much easier. The tools can assemble programs written different programming languages, they can build executables can be run independently of the operating system. This simplification of software development causes the simplification of writing programs with the prepense of malice (e.g. viruses). So developers of these tools have to care about the security. Farther this virtual equivalency of computers – and the spreading of Internet – make easier to viruses infecting a computer."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"4035504bc67a2ffe16aa2dfe537095d3f54fa503-1498757527-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/azk00.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Viruses using .NET Framework</h1><p><a href="/lib/?lang=en&amp;author=Kurdi%2C%20Zsombor">Zsombor Kurdi</a><br/> <em>4th Serbian-Hungarian Joint Symposium on Intelligent Systems, SISY 2006, pp.473-478</em><br/> <em> 2006</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/azk00.html';</script><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Viruses%20using%20.NET%20Framework.pdf">Download</a> PDF (40.3Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=AV#azk00">Back to index</a>] [<a href="/lib/azk00.html#disqus_thread">Comments</a>]<br/> <form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<address>
Zsombor Zsolt Kurdi<br/>
John von Neumann Faculty of Informatics, Budapest Tech<br/>
Bécsi út 96/B, H-1034 Budapest, Hungary<br/>
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="553e2027313c7b2f263a38373a27153b3c3e7b3738337b3d20">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>
</address>
<ul>
<li><a href="#c0">Abstract</a></li>
<li><a href="#c1">1 Introduction</a></li>
<li><a href="#c2">2 Viruses and Other Malicious Softwares</a></li>
<li><a href="#c3">3 The .NET Framework</a></li>
<li><a href="#c4">4 .NET Viruses</a></li>
<li><a href="#c5">Conclusions</a></li>
<li><a href="#c6">References</a></li>
</ul>
<h2><a name="c0"></a>Abstract</h2>
<p><em>In our age, programming languages and development tools advance to make programmers' work much easier. The tools can assemble programs written different programming languages, they can build executables can be run independently of the operating system. This simplification of software development causes the simplification of writing programs with the prepense of malice (e.g. viruses). So developers of these tools have to care about the security. Farther this virtual equivalency of computers – and the spreading of Internet – make easier to viruses infecting a computer.</em></p>
<p><strong>Keywords:</strong> .NET Framework, MSIL, Virus, Malware</p>
<h2><a name="c1"></a>1 Introduction</h2>
<p>Viruses are small softwares attach themselves to other files (infection) and cause damage to the computer (this is their main goal) when a user executes the infected file. The concrete steps of the infection procedure depend on a lot of properties of the local environment (e.g. operating system, ‘virus strain’, file's type would be infected etc.).</p>
<p>Penetration of .NET Framework (and other development tools for writing platform-independent programs) causes a great simplification in virus development too. For example the viruses have not care about the type of operating system during the infection – and damaging – which is a great advantage for them.</p>
<p>This article is organized as follows: Section 2 gives an outline about malicious softwares (short description, history, types etc.), Section 3 treats of the .NET framework, it's usability and its similarity to Java Virtual Machine. The main section (Section 4) covers an introduction and analysis of viruses based on the services of the .NET framework, which is followed by the conclusions (Section 5).</p>
 
<h2><a name="c2"></a>2 Viruses and Other Malicious Softwares</h2>
<p>A computer virus (or simply virus) is a self-replicating computer program that spreads by inserting copies of itself into other executable code or documents (definition from <em>wikipedia.org</em>). These small pieces of programs were named viruses because they behave very similar to biological viruses. The attaching procedure, when a virus copies itself to an executable is called ‘infection’, and the infected executable is the ‘host’.</p>
<p>The first computer virus was written in the early 1970s or even in the end of 1960s. But the term ‘computer virus’ was formally defined by Fred Cohen in 1983. Actually the number of malicious programs started increasing in this period. The most self-replicating programs were written with scientific view. Since that time this growing has accelerated and the goals of writing such a program has been changed ([1]).</p>
<p>Viruses are not the only malefic programs in the info-space, but they are the most well-known ones. There are a lot of other malicious softwares (malwares). The common property of these programs is to infiltrate or damage a computer system, without the owner’s consent. A malware can be</p>
<ul>
<li>a virus,</li>
<li>a worm,</li>
<li>a trojan horse,</li>
<li>a spyware,</li>
<li>an adware,</li>
<li>any other program written with the idea of causing damage.</li>
</ul>
<p>A worm is a special type of virus which travels over network (e.g. Internet) to find and infect files on other computers. Only viruses and worms are self-replicating programs from the enumeration above. The other malwares uses the credulousness of users to the reproduction (or the infection of the computer).</p>
<p>Spyware and adware programs are some special kinds of malware. They were created for commercial purposes. A spyware gathers information about computer users; an adware shows annoying advertisements to them. Since 2003 these are the most common types of malware.</p>
<p>Hereafter this article focuses on viruses (and partially on worms). Viruses can be sorted in many ways. There are viruses which uses existing executables (program virus) for running. Such a virus attaches itself to an executable file and it runs (infects and causes damage) when a user executes the host file. Other viruses overwrite the boot sector or the master boot sector of the disks (boot virus). These viruses are load into memory if the computer tries to read the disk while it is
 
booting. Some viruses combine boot and program viruses (multipartite virus) or tries to avoid virus-detection using certain techniques (polymorphic and stealth viruses). Finally a new type of viruses is macro viruses that infect the macros within a document or template.</p>
<p>This high number of viruses and virus types calls for solutions for defend computer from the infection of any virus. There are a lot of commercial softwares (anti-virus programs) more or less efficient tools against malwares. The contest between developers of viruses and anti-virus softwares is a never-ending war which can be won by nobody.</p>
<p>Because softwares are often designed with security features (e. g. operating system, browsers, e-mail softwares etc.), software design and development methods and strategies have to prevent as many security holes in the software as possible. Programs should have no vulnerabilities which can be used by viruses.</p>
<h2><a name="c3"></a>3 The .NET Framework</h2>
<p>Diversity is part of all segment of informatics. The hardware elements used for compiling computers can be very different and they can have unique characteristic depend on the manufacturer. One of the main goals of operating systems is to hide these dissimilarities and provide a uniform, hardware-independent interface for computer users (see Figure 1).</p>
<p>This virtual unification of the hardware-granted functions makes computer more usable, and software development will be much easier. Operating systems (their count is essentially less than the count of hardware elements) define virtual hardware units with generic properties and functions. They use the physical hardware or software emulation to grant these properties and functions. So people have to learn how they can avail themselves of the functions of the chosen operating system (they have not concern themselves about the functions of the hardware-layer).</p>
<p>Besides the operating systems, the most programming languages open the door to write so-called platform-independent programs (softwares uses resources available in every operating system). Up to now the programmers have had to write the program (source code) once and it has had to be compiled as many as the number of operating systems have the users (in each cases the result of this procedure is almost the same sequence of processor-instruments, but the executable file's format is different certainly).</p>
<p>For a long time past, programmers' wish is to make this procedure easier. They would like to write and compile the source code only once. This problem has been being solved far in the past. Interpreted programming languages are the solution.</p>
 
<p>In this case, the source code is the program which is executed by another program (interpreter). These codes can be executed with each operating system has the required interpreter.</p>
<p>But the interpreted programs have disadvantages: the executing procedure is too slow and the source code's syntax can not be checked fully. Sun Microsystems Inc. has given a solution for this. The programmers of Sun have created the Java programming language which integrate interpretation and compilation during software development and execution. After the Java source code has been written, it has to be compiled (the result is a sequence of <em>Java Byte Code</em>), so the syntax and semantics of the source code can be checked, and the code can be made more efficient. The Java Byte Code constitutes the instrument set of the <em>Java Virtual Machine</em> (JVM), so the result of compilation can be interpreted by a JVM. Because Sun has published JVMs for the most common operating systems, the once written and compiled program can be executed by all the computers run JVM.</p>
<p>Programmers of Microsoft solved the problem otherwise. They created the <em>Microsoft .NET Framework</em>. This solution is very similar to Java, JVM and Java Byte Code, but it is much more. It exploits the hidden power of JVM, and eliminates its weaknesses. The .NET Framework is development and execution environment for several programming languages (C\#, C++, Visual Basic etc.), so software component written in different programming languages can be assembled by .NET Framework. Moreover, the compiled source would not be interpreted; it will be compiled to native code before execution using the Just-In-Time (JIT) compiling strategy. The first compilation produces a code written using <em>Microsoft Intermediate Language</em> (MSIL).</p>
<p>The .NET Framework – as the Java environment – constitutes a new layer – over the operating system – which hides the dissimilarities of various operating systems (this architecture is shown on Figure 1).</p>
<div align="center">
<img src="img/azk00/fig1.gif" alt="Figure 1. Layered Architecture"/>
<p><strong>Figure 1. Layered Architecture</strong></p>
</div>
 
<h2><a name="c4"></a>4 .NET Viruses</h2>
<p>Executable files written for .NET Framework can be infected by viruses as other executables. In this case there are two ways for the infection: malicious code can be added to the file contains MSIL code-sequence or to the native code after the JIT compilation (see Figure 2).</p>
<div align="center">
<img src="img/azk00/fig2.gif" alt="Figure 2. Infection types"/>
<p><strong>Figure 2. Infection types</strong></p>
</div>
<p>If the virus infects an MSIL file, the infection will be platform independent too. The infected PE (portable executable) file can execute – without any changes – by other operating systems, so the infection can be spread very fast. While the infection of native code is ‘localized’ for the operating system using the same executable format.</p>
<p>Because lot of web services use the .NET architecture, they create new infection mechanisms unwittingly or almost unwittingly ([2]). Anti-virus professionals' opinion is the security model of .NET Framework can stop several attacks of viruses, but not all. There are other possible ways to take advantages of .NET services. Still the malwares and .NET Framework's ‘collaboration’ is an unanswered question.</p>
<p>There are several viruses using the .NET Framework in the info-space. The firs one was ‘Donut’ (also known as ‘dotNET’) which was exposed in 2002. It is a native executable targets PE files written for .NET Framework. It overwrites the initial jump to the <em>_CorExeMain()</em> function (located in <em>mscoree.dll</em>) with a jump to the end of the file where the malicious code is located. (This process is similar to the standard infection of native executables.) The virus also injects short MSIL code into the PE file for display a message that akes the fact of infection known to the user (source: virus description from <em>Symantec</em>).</p>
<p>The basic form of Donut is a native executable which is an e-mail irus (it uses the address book in Microsoft Outlook to spread via -mails sent without the user's will
 
([3]). If this file is executed on a local computer, it infects the executables in the same folder and up to 20 parent folder.</p>
<p>However Donut is defined as a low-risk virus, it is a good example, that the viral infection of .NET executables are possible indeed.</p>
<h2><a name="c5"></a>Conclusions</h2>
<p>The efforts make the program development easier faster and comfortable draw down the simply way to develop viruses and other malwares. So developers of programming frameworks (e.g. .NET) and creators of programming languages interpreted by virtual machines (e.g. Java) have to care the security leaks and features of these development tools through all ages.</p>
<p>The popularity of Internet and the new computing model – based on .NET Framework – used for web application creates fresh vulnerabilities can be exploit by virus (and malware) writers day-by-day. Donut is an example that good security conception (as the security of .NET Framework) can reduce this vulnerabilities, but they can be never completely removed.</p>
<h2><a name="c6"></a>References</h2>
<ol>
<li>B. Krebs: A Short History of Computer Viruses and Attacks, The Washington Post, 14th February 2003</li>
<li>J. Layden: .NET may Lead to Fewer Viruses, The Register, 28th September 2001</li>
<li>J. Layden: C\# Virus Pitched against .NET, The Register, 4th March 2002</li>
<li>Microsoft Knowledge Base: Information About the .NET W32.Donut Virus, Q316287, 8th July 2005</li>
</ol>
 
[<a style="" href="/lib/?lang=EN&amp;index=AV#azk00">Back to index</a>] [<a href="/lib/azk00.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=azk00">de</a><a href="/lib/index.php?lang=en&amp;id=azk00">en</a><a href="/lib/index.php?lang=es&amp;id=azk00">es</a><a href="/lib/index.php?lang=it&amp;id=azk00">it</a><a href="/lib/index.php?lang=fr&amp;id=azk00">fr</a><a href="/lib/index.php?lang=pl&amp;id=azk00">pl</a><a href="/lib/index.php?lang=ru&amp;id=azk00">ru</a><a href="/lib/index.php?lang=ua&amp;id=azk00">ua</a></div>
</body>
</html>
