<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Wallace Wang 'Stalking a Computer Virus' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Wallace Wang"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Wang, Wallace,Stalking a Computer Virus, anti, code, assembler, infected, computer, virus, victor, charlie, scanner, file, files, make, macro, boot, sector"/>
<meta name="Description" content="When most people find a computer virus lurking on their hard disk, the first reaction is to grab an anti-virus program such as The Norton AntiVirus or McAfee's VirusScan, and kill the virus as quickly as possible. The two common ways to kill a computer virus are to delete the infected file (which is like killing cancer by shooting the patient) or attempting a slightly riskier method of cleaning the infected file.Cleaning an infected file means the anti-virus program tries to remove the computer virus program code from a file without harming the infected file. In many cases, a computer virus attaches itself so firmly to a file that removing the computer virus irreparably damages the infected file as well. When this happens, you have no choice but to delete the infected file.But rather than delete an infected file or let an anti-virus program try to clean it, you might be interested in trying a third approach, if you like living dangerously - study the computer virus and dissect it.Such amateur virus sleuthing can be interesting but dangerous, much like trying to make pipe bombs from plans you find on the Internet. Before attempting to isolate and dissect a virus, make backups of all your important files. That way if the virus gets loose and wipes out your hard disk, you won't lose everything for good. (Better yet, practice looking for a virus on a computer that you don't care about, such as an old computer or a computer belonging to your boss or disliked co-worker. That way if a virus gets loose and wipes everything out, at least your computer data will still be safe.)"/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"d312e50788e2328671611cb3a9668fcf758051e6-1498757181-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/aww01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Stalking a Computer Virus</h1><p><a href="/lib/?lang=en&amp;author=Wang%2C%20Wallace">Wallace Wang</a><br/> <em>November 1996</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/aww01.html';</script><div class="ci"><a href="/lib/?ci=aww01">1</a></div>[<a style="" href="/lib/?lang=EN&amp;index=AV#aww01">Back to index</a>] [<a href="/lib/aww01.html#disqus_thread">Comments</a>]<br/> 
<ul>
<li><a href="#c1">Detecting A Virus</a></li>
<li><a href="#c2">Anti-Virus News and Hot Links</a></li>
<li><a href="#c3">Dissecting a Virus</a></li>
</ul>
<p>When most people find a computer virus lurking on their hard disk, the first reaction is to grab an anti-virus program such as The Norton AntiVirus or McAfee's VirusScan, and kill the virus as quickly as possible. The two common ways to kill a computer virus are to delete the infected file (which is like killing cancer by shooting the patient) or attempting a slightly riskier method of cleaning the infected file.</p>
<p>Cleaning an infected file means the anti-virus program tries to remove the computer virus program code from a file without harming the infected file. In many cases, a computer virus attaches itself so firmly to a file that removing the computer virus irreparably damages the infected file as well. When this happens, you have no choice but to delete the infected file.</p>
<p>But rather than delete an infected file or let an anti-virus program try to clean it, you might be interested in trying a third approach, if you like living dangerously - study the computer virus and dissect it.</p>
<p>Such amateur virus sleuthing can be interesting but dangerous, much like trying to make pipe bombs from plans you find on the Internet. Before attempting to isolate and dissect a virus, make backups of all your important files. That way if the virus gets loose and wipes out your hard disk, you won't lose everything for good. (Better yet, practice looking for a virus on a computer that you don't care about, such as an old computer or a computer belonging to your boss or disliked co-worker. That way if a virus gets loose and wipes everything out, at least your computer data will still be safe.)</p>
<h2><a name="c1"></a>Detecting A Virus</h2>
<p>Unless you have nothing better to do but look for all possible symptoms of a virus attacking your computer, your first line of defense should be an anti-virus program. Most anti-virus programs include a monitoring program that notifies you the moment a virus infects your computer. You can buy a commercial anti-virus program (such as The Norton AntiVirus), try a shareware version (such as McAfee's VirusScan), or use a free anti-virus program (such as F-Prot). To browse through links to the most popular anti-virus programs, visit the http://www.nha.com website.</p>
<h2><a name="c2"></a>Anti-Virus News and Hot Links</h2>
<p>Once you have a reliable anti-virus program that you trust, try capturing a virus using special virus bait files. Since computer viruses can only spread by infecting the boot sector of a hard disk, COM or EXE files, or any Microsoft Word documents on your computer, you can plant "dummy" EXE files on your hard disk. The moment a virus infects one of your "dummy" EXE files, you can safely start dissecting the virus. That way if you screw up completely and wreck the infected EXE file, you won't ruin any valuable programs in the process.</p>
<p>For a copy of a virus baiting program, download the <strong>VC50.ZIP</strong> file from ftp://boardwatch.com. This file contains an anti-virus program called <strong>Victor Charlie</strong>, which contains "dummy" COM and EXE files. Unlike more conventional anti-virus scanners that require constant updating to catch new viruses, Victor Charlie is a generic anti-virus program that never needs updating.</p>
<p>The main defense of an anti-virus program is its scanner. Most anti-virus scanners contain two parts: the actual scanner itself and a file containing virus "signatures," which are unique characteristics that identify specific viruses. Each time a new virus appears in the wilderness, the anti-virus company must create a new virus "signature" that tells the scanner how to recognize it. Because new viruses appear every month, anti-virus scanners will always risk missing a deadly new virus.</p>
<p>Victor Charlie is different though. Instead of scanning for viruses, Victor Charlie lets you plant its "dummy" COM and EXE files on your hard disk. The moment a virus infects one of these dummy files, Victor Charlie traps the virus's "signature" for future use. In this way, Victor Charlie constantly updates itself.</p>
<p>Victor Charlie does have two big flaws. A virus could attack and destroy important files before attacking one of Victor Charlie's "dummy" files. Until a virus infects a "dummy" file, Victor Charlie will never be able to detect that virus. Even worse, Victor Charlie can only bait viruses that attack COM or EXE files, not boot sector or macro viruses. Since the most common viruses are boot sector and macro viruses, don't rely on Victor Charlie alone to keep your hard disk virus-free.</p>
<h2><a name="c3"></a>Dissecting a Virus</h2>
<p>Once you've caught a virus, the next step is to dissect it using a hex editor such as the <strong>DISKEDIT.EXE</strong> program found in the Norton Utilities,the Hex Workshop program (which is available at http://ourworld.compuserve.com./homepages/breakpoint/hexhome.htm) or the EditPro program (available at http://www.winsite.com/info/pc/win3/util/editpro.zip).</p>
<p>A hex editor lets you examine the sectors of a floppy or hard disk so you can see the internal guts of a computer virus. By using a hex editor, you can often find hidden messages buried inside of a computer virus without actually setting off the virus.</p>
<p>Besides letting you view the contents of a file, a hex editor also lets you modify that file. In the right hands, a hex editor could patch a faulty program, erase somebody's name or registration number from a program, or let you add your own name or message to a program. Many software pirates use hex editors to crack copy-protected games or hide obscene messages in ordinary programs such as Microsoft Word or Lotus 1-2-3.</p>
<p>If you're skilled enough with a hex editor, you can separate a computer virus from an infected file, such as one caught by Victor Charlie's bait files. Once you've isolated a computer virus, you can go one step further and use a disassembler to convert the computer virus from working program to raw assembly language source code.</p>
<p>If you've trapped one of the increasing common Windows-based viruses, you can download the <b>W32DASM2.ZIP</b> file from the Boardwatch ftp site. This demo version can disassemble 32-bit Windows programs that are in the <em>Portable Executable Format (PE)</em>, so you can use it to examine other Windows programs besides viruses. Unfortunately, this Windows disassembler can't disassemble 16-bit programs and the demo version won't let you print or save any assembler source code.</p>
<p>In case you run across one of the more common DOS-based computer viruses, visit the http://rasi.lr.ttu.ee/teave/msdos/simtel/simtel_index_disasm.html site where you can download a variety of different disassembly programs.</p>
<p>A disassembler works by converting an EXE or COM file into assembly language source code so you can see how a program actually works. Unfortunately, disassemblers are never perfect, which means that the assembly language source code that a disassembler creates may require slight editing before you can assemble it using an assembler such as Borland's <em>Turbo Assembler</em> (the favorite assembler of virus programmers), Microsoft's Macro Assembler, or the shareware assembler <strong>A86.ZIP</strong> which you can download from http://lexitech.com/bobrich.</p>
<p>(Just in case you're wondering, disassemblers can only create assembly language source code. They can't convert an EXE or COM file into COBOL, C++, or Pascal source code. Since any program could have been written a million different ways using any programming language, a disassembler has no way of knowing which programming language someone may have used.)</p>
<p>After disassembling a computer virus and modifying the assembly source code, try assembling the virus back to its original form and run it to make sure it still works. (That way you can tell whether the disassembler worked correctly.)</p>
<p>By trapping, isolating, disassembling, and then assembling a computer virus, you can learn more about computer viruses than you could ever learn just by reading a book or using an anti-virus scanner. While virus hunting always runs the risk of letting a virus loose on your computer that wipes out your hard disk, it can be an amusing way to study a problem that will only continue growing as long as we rely on personal computers.</p>
<p>Since virus hunting is a skill that most computer science graduates never learn in college, any skills you pick up isolating real viruses could translate into a higher paying job, a new career working for an anti-virus company, or just plain fun, ripping apart computer viruses and witnessing the ongoing battle between virus writers and anti-virus programmers.</p>
<p>Then again, playing with live viruses could also translate into a wrecked hard disk or missing files so keep those anti-virus programs nearby in case a virus slips through your traps and starts shredding your data. Virus hunting isn't for everyone, but with the right tools, it can be another skill you can develop that can enhance your computer knowledge.</p>
[<a style="" href="/lib/?lang=EN&amp;index=AV#aww01">Back to index</a>] [<a href="/lib/aww01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=aww01">de</a><a href="/lib/index.php?lang=en&amp;id=aww01">en</a><a href="/lib/index.php?lang=es&amp;id=aww01">es</a><a href="/lib/index.php?lang=it&amp;id=aww01">it</a><a href="/lib/index.php?lang=fr&amp;id=aww01">fr</a><a href="/lib/index.php?lang=pl&amp;id=aww01">pl</a><a href="/lib/index.php?lang=ru&amp;id=aww01">ru</a><a href="/lib/index.php?lang=ua&amp;id=aww01">ua</a></div>
</body>
</html>
