<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title> freeon 'Remote Polymorphism and Customized Viruses' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="freeon"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, freeon,Remote Polymorphism and Customized Viruses, code, virus, emily, polymorphism, makes, worm, worms, tommy, computer, information, registry, program, skype, idea, viruses"/>
<meta name="Description" content="This article is a theoretical article more or less that is based on a set of concepts that are polymorphism and communication and combing these two concepts into a more advanced technique. The idea came to me when I was working on a new program, I was trying to understand the global workflow of a program from creation to use."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"4d288eff49a5309229d779180b4a9ed16e7a9c21-1498757059-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/vfr01.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Remote Polymorphism and Customized Viruses</h1><p><a href="/lib/?lang=en&amp;author=freeon"> freeon</a><br/> <em><a href="/vx.php?fid=1549#f1549">DoomRiderz #1</a></em><br/> <em>April 2007</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/vfr01.html';</script>[<a style="" href="/lib/?lang=EN&amp;index=VT#vfr01">Back to index</a>] [<a href="/lib/vfr01.html#disqus_thread">Comments</a>]<br/> 
<ol start="0">
<li><a href="#c0">Introduction</a></li>
<li><a href="#c1">Finding specific requirements and making correct assumptions.</a></li>
<li><a href="#c2">Using Communication and polymorphism.</a></li>
<li><a href="#c3">Conclusion</a></li>
</ol>
<h2><a name="c0"></a>0) Introduction</h2>
<p>This article is a theoretical article more or less that is based on a set of concepts that are polymorphism and communication and combing these two concepts into a more advanced technique. The idea came to me when I was working on a new program, I was trying to understand the global workflow of a program from creation to use.</p>
<p>Basic Steps:</p>
<ol>
<li>An idea is conceived with a purpose.</li>
<li>The idea is turned into a set of assumptions/requirements.</li>
<li>The developer creates the code based on the assumptions and requirements.</li>
<li>The program is finished and is implemented into a system and executed.</li>
</ol>
<p>For every virus and worm there is a purpose which the author wants it to serve. Since the virus/worm is bound to a set of requirements it's illogical to concieve that it will be able to be as effective as it could be. For example a skype worm assumes that the system has skype installed. A prepender virus assumes that it will be able to find executables with write permissions to infect. Now this is fine if you want your virus/worm to spread to only those mediums but if these assumptions are false the virus/worm doesn't stand a chance.</p>
<p>So now we have a couple different problems.</p>
<ol>
<li>How and where is the virus/worm supposed to get and know what the requirements are for each system</li>
<li>How is the virus/worm supposed to be able retrieve and communicate specific information based on the system in order to make a virus/worm won't fail.</li>
<li>How is the virus/worm supposed to be able to morph itself to something that is specific to the requirements.</li>
</ol>
<h2><a name="c1"></a>1) Finding specific requirements and making correct assumptions.</h2>
<dl>
<dt>Requirement:</dt><dd>A requirement is something wanted or needed in order for something to continue.</dd>
<dt>Assumption:</dt><dd>a fact or statement (as a proposition, axiom, postulate, or notion) taken for granted.</dd>
</dl>
<p>So we know what a requirement and an assumption are. The main goal though however is to make the correct requirements and assumptions for our virus/worm for a specific system.</p>
<p>Finding these are easy. Most of us have done them before in our viruses/worms. In most cases we do it by checking if something exists. For example we check directory paths,registry entries,chat clients. Below is a list of obvious requirements for most viruses/worms.</p>
<ul>
<li>email clients (outlook,thunderbird,evolution)</li>
<li>instant messaging (skype,irc,aim,msn,yahoo)</li>
<li>p2p (Ares,Kazza,limewire)</li>
<li>running services (http,ftp,ssh)</li>
<li>internet connection type (dial up, cable, vpn)</li>
<li>network shared folders (\\computer\$c)</li>
<li>computer paths and drives (C:\,hda)</li>
<li>usernames and user permissions</li>
<li>archiving programs (zip,rar)</li>
<li>system information (o.s. version, hard drive size, runtime env.)</li>
<li>antivirus information (norton,fpe etc..)</li>
<li>firewall information</li>
</ul>
<p>Now what we see now are virus/worms out there that cater to a hole bunch of different software. They try and pack network spreading, p2p, email spreading all into one program. This has several drawbacks for example to name a few</p>
<ol>
<li>file size increases</li>
<li>chance of error is increased.</li>
<li>more constants are used.</li>
<li>ability for antivirus to detect is much easier.</li>
</ol>
<p>The idea is to try and pack so much in it that won't fail. Now we are going to take the opposite approach we are going to make a customized virus/worm based off the system itself the idea of polymorphism with an interesting twist.</p>
<h2><a name="c2"></a>2) Using Communication and polymorphism..</h2>
<p>Now previously we talked about how information is gathered and can be used to make a customized virus. Now we can go more in depth more.</p>
<p>First we start with our virus/worm we will call it BOB. Consider BOB as the creator, GOD, whatever. BOB creates 2 programs we will call one Tommy and another called Emily. Each program is generated with random variable names, body moving, etc.. to keep being detected.</p>
<pre>
	---------	-------
	|	|=======|tommy|
	| BOB	|	-------
	|	|=======|emily|
	---------	-------
</pre>
<p>BOB's purpose:</p>
<ol>
<li>Create tommy and emily and make sure their code is different each time they are created.</li>
<li>Upon system start BOB will start tommy and emily to make sure they are running.</li>
<li>If tommy or emily is deleted he will create a new varient to replace the one that was lost.</li>
<li>Makes sure he's not deleted from autorun.</li>
<li>Based on system information program tommy to spread to other systems and collect information.</li>
</ol>
<p>Tommy's Purpose:</p>
<p>Tommy is the hunter and gatherer. His main purpose is to get off the system. and get onto another system. Once he's on another system and excuted he collects and gathers information on the new system and sends it to Emily.</p>
<ol>
<li>spread to other systems with specific options coded from BOB</li>
<li>once executed on another system.
<ol>
<li>check for another BOB, if another BOB varient is not found then
<ol>
<li>collect information on the system
<ul>
<li>communication mediums</li>
<li>system information</li>
</ul></li>
<li>send information to emily
<ul>
<li>if cant connect
<ul>
<li>try ip address of previous infected system</li>
<li>loop and keep trying</li>
<li>scan ip ranges for emily to find a infected system.</li>
</ul></li>
</ul></li>
<li>recieve code from emily</li>
<li>compile code, if code compiles correctly with no errors:
<ol>
<li>execute generated executable (BOB)
<ol>
<li>if launch is successful
<ol>
<li>terminate, goto BOB process and start over. else goto step 2) and try again</li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p>Emily's Purpose:</p>
<p>Emily is to remain on the system. She is going to act as the reciever and creator much like a female in real world :) . She basically will listen for information, decide based on that information what options to build code for and send the code back to tommy which is on the new system</p>
<ol>
<li>Listen for incoming connections, if connection is made
<ol>
<li>recieve information for new system</li>
<li>based on information build code to buid a new customized BOB.
<ul>
<li>change variable names</li>
<li>if av is on the system put in code to disable av at startup</li>
<li>body moving to make sure that code is executed in different places</li>
<li>logic changes</li>
<li>change loop types</li>
<li>include ip and information of the infected host it's running on</li>
<li>decide which startup method to do</li>
<li>autorun registry</li>
<li>installation path and registry name to check</li>
</ul></li>
<li>send code back to tommy on the new system.</li>
<li>end communication and resume listening.</li>
</ol></li>
</ol>
<p>Now you might be saying this is great but why do I need all these programs I can program all this in one program and Yes you could but the idea is that one program that acts as a poly engine which creates a specific virus (Emily) for the computer it's going to run on another advantage is that you keep everything small and portable. Tommy will be generated very small and has a higher probablity of <strong>not</strong> failing, and BOB has the ability to make sure that his children are working correctly which is good preventative measures.</p>
<h2><a name="c3"></a>3) Conclusion</h2>
<p>Although this concept may seem a little to abstract and far fetched it solves problems to bloated viruses, it makes our virus/worms more accurate in completing their purpose, it makes it harder for antivirus to detect all the varients that our poly engines can create, and it adds protection and prevenative measures. I hope this text makes some sense and you can take something from it and use it. Thanks for reading!</p>
[<a style="" href="/lib/?lang=EN&amp;index=VT#vfr01">Back to index</a>] [<a href="/lib/vfr01.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=vfr01">de</a><a href="/lib/index.php?lang=en&amp;id=vfr01">en</a><a href="/lib/index.php?lang=es&amp;id=vfr01">es</a><a href="/lib/index.php?lang=it&amp;id=vfr01">it</a><a href="/lib/index.php?lang=fr&amp;id=vfr01">fr</a><a href="/lib/index.php?lang=pl&amp;id=vfr01">pl</a><a href="/lib/index.php?lang=ru&amp;id=vfr01">ru</a><a href="/lib/index.php?lang=ua&amp;id=vfr01">ua</a></div>
</body>
</html>
