<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Diomidis Spinellis 'Reliable Identification of Bounded-length Viruses is NP-complete' (VX heaven)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Author" content="Diomidis Spinellis"/>
<meta name="KeyWords" lang="en" content="computer virus, virus, virii,vx, компьютерные вирусы, вирус, вири, Spinellis, Diomidis,Reliable Identification of Bounded-length Viruses is NP-complete, rightarrow, machine, computer, dots, viruses, wedge, code, integer, generation, satisfiability, sequence, forall, problem, software, files"/>
<meta name="Description" content="A virus is a program that replicates itself by copying its code into other files. A common virus protection mechanism involves scanning files to detect code patterns of known viruses. We prove that the problem of reliably identifying a bounded-length mutating virus is NP-complete by showing that a virus detector for a certain virus strain can be used to solve the satisfiability problem. The implication of this result is that virus identification methods will be facing increasing strain as virus mutation and hosting strategies mature, and that different protection methods should be developed and employed."/>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"047a5bcbf67431883fc9ed25fba33612",petok:"00bdb42e6eb3976fa92d99ec80ce3dc445bacf29-1498757057-1800",zone:"vxheaven.org",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=85b614c0f6/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script>
<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="/style.css"/><link rel="canonical" href="http://vxheaven.org/lib/ads03.html"/>
<script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
</head>
<body bgcolor="#dbc8a0" text="#302000" link="#225599" vlink="#113366">
<div class="s1">
<div style="float:right;"><a href="/lib/index.php?tbs=1"><img src="/img/max.gif" alt="Maximize"/></a></div> <form id="lf" style="margin: 0; float: right;" method="get" action="/index.php"><input type="hidden" name="action" value="set"/><select name="lang" onchange="javascript:document.getElementById('lf').submit();"><option value="ru">Русский</option><option selected="selected" value="en">English</option><option value="ua">Українська</option><option value="de">Deutsch</option><option value="es">Español</option><option value="fr">Fran&ccedil;ais</option><option value="it">Italiano</option><option value="pl">Polski</option></select></form>
<div style="float: right;"><div id="plusone"></div></div>
<script type="text/rocketscript">gapi.plusone.render("plusone", {"size":"small","count":"true"});</script>
<div style="float: right;" class="addthis_toolbox addthis_default_style">
<script type="text/rocketscript">var addthis_config = { ui_click: true }</script>
<a style="text-decoration: none; font-size: 10pt;" href="/?action=addthis" class="addthis_button_compact">Bookmark</a>
<script type="text/rocketscript" data-rocketsrc="http://s7.addthis.com/js/250/addthis_widget.js#username=herm1t"></script>
</div>
<div style="float: right;">
<script type="text/rocketscript" data-rocketsrc="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<form action="/search.php" id="cse-search-box">
<input type="hidden" name="cx" value="002577580816726040001:z9_irkorydo"/>
<input type="hidden" name="cof" value="FORID:10"/>
<input type="hidden" name="ie" value="UTF-8"/>
<input type="text" name="q" size="12" value=" "/>
<input type="submit" name="sa" value="Search"/>
</form>
</div><h1><a href="/" style="text-decoration: none; color: #000000;">VX Heaven</a></h1>
<span class="nav"><a href="/lib/">Library</a> <a href="/vl.php">Collection</a> <a href="/src.php">Sources</a> <a href="/vx.php?id=eidx">Engines</a> <a href="/vx.php?id=tidx">Constructors</a> <a href="/vx.php?id=sidx">Simulators</a> <a href="/vx.php?id=uidx">Utilities</a> <a href="/links.php">Links</a> <a href="/donate.php" style="color: #706020" id="donate">Donate</a> <a href="/forum" style="text-decoration: underline;">Forum</a> </span><br clear="all"/>
</div>
<div class="s2"><h1>Reliable Identification of Bounded-length Viruses is NP-complete</h1><p><a href="/lib/?lang=en&amp;author=Spinellis%2C%20Diomidis">Diomidis Spinellis</a><br/> <em>IEEE Transactions on Information Theory, 49(1), pp. 280-284, January 2003.</em><br/> <em>ISSN 0018-9448</em><br/> <em>January 2003</em></p><script type="text/rocketscript">var disqus_url = 'http://vxheaven.org/lib/ads03.html';</script><div class="ci"><a href="/lib/?ci=ads03">6</a></div><img src="/img/pdf.gif" alt="PDF"/><a href="/lib/pdf/Reliable%20Identification%20of%20Bounded-length%20Viruses%20is%20NP-complete.pdf">Download</a> PDF (69.54Kb) (You need to be registered on <a href="/forum">forum</a>)<br/>[<a style="" href="/lib/?lang=EN&amp;index=TH#ads03">Back to index</a>] [<a href="/lib/ads03.html#disqus_thread">Comments</a>]<br/> <form method="post" action="">
<img src="/img/cache/0b9fd596a90421f9f1f68a9760275737.gif" alt="\text{T_EX size}" valign="middle"/>
<select name="TeX_size"><option value="-2">-2</option><option value="-1">-1</option><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select>
<input type="submit" value="Scale"/>
</form><form method="post" action=""><input type="hidden" name="pages" value="1"/><input type="submit" value="Turn on page numbers"/></form>
<p><em>D. Spinellis is an Assistant Professor in the Department of Management Science and Technology at the Athens University of Economics and Business, Athens, Greece. E-mail: <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="fc98988fbc9d89999ed29b8ed2">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/rocketscript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></em></p>
<h2>Abstract</h2>
<p>A virus is a program that replicates itself by copying its code into other files. A common virus protection mechanism involves scanning files to detect code patterns of known viruses. We prove that the problem of reliably identifying a bounded-length mutating virus is NP-complete by showing that a virus detector for a certain virus strain can be used to solve the satisfiability problem. The implication of this result is that virus identification methods will be facing increasing strain as virus mutation and hosting strategies mature, and that different protection methods should be developed and employed.<sup><a href="#f1" name="b1">1</a></sup> <sup><a href="#f2" name="b2">2</a></sup></p>
<h2>I. Introduction</h2>
<p>One often-used defence against computer viruses is the execution of an <em>anti-virus</em> program that detects and cleans programs that appear to be infected. Virus writers respond to this defence by trying to thwart anti-virus software through targeted attacks, mutations, or social engineering. Mutating viruses are a particularly insidious threat, because detection algorithms need to be constantly updated and to spend increasing processing time to identify new mutation types. The question of whether complexity theory is on the side of virus writers or the protection vendors could have important practical implications. In this paper we will prove that there exist realistic viruses whose reliable detection is of NP-complete complexity [1] and that therefore the general problem of reliable bounded-length virus identification is NP-complete.</p>
<h2>II. Viral software</h2>
<p>Intentionally created malicious software [2] - often termed <em>malware</em> - is typically classified into Trojan horses, viruses, and worms [3]. A Trojan horse is a program that exploits the rights of its user to perform an action its user does not intend, a virus is a Trojan horse that replicates itself by copying its code into other program files [4], while a worm is an independently-running program that replicates through a network exploiting security weaknesses to invade other computers.</p>
<p>A number of virus prevention and detection methods have been proposed and are commonly implemented [5], [6]. Reference [7] contains an annotated bibliography of malware analysis and detection papers. Prevention methods involve limiting the flow of information between programs through the use of appropriate hardware and software protection domains, coupled with self-defence mechanisms, instrumentation, and fault-tolerance. Since the above methods will typically interfere with many legitimate operations (such as the installation of new software or the correction of an existing version) they need to be coordinated through carefully designed and executed security procedures. Unfortunately current practice in system administration often renders these methods useless. A large percentage of users typically administer their personal workstations on their own, in most cases exercising the full rights of the system administrator, without sufficient training and diligence.</p>
<p>Therefore, as a secondary line of defence, detection measures are often employed to locate virus instances and infections. Two often used detection measures involve either the comparison of the system's programs against known-good versions (typically condensed in the form of a checksum or a cryptographically secure signature [8]) or the comparison of files against patterns of known viruses. Since the first method depends on a known-clean system and can not be used to check software of unknown origin, the second, scanning, method is the one most commonly employed. A number of software vendors provide virus-scanning software that can search new and existing system files for patterns of all known viruses. The vendors regularly distribute updated versions of the virus patterns to keep the virus detection process up-to-date.</p>
<p>Virus writers however, have developed a series of countermeasures. Even early academic examples of viral code were cleverly engineered to hinder the detection of the virus [9]. Since the actual task of writing a virus is relatively simple [10], [11] modern virus code focuses on employing platform independence, stealth, effective replication, and detection countermeasures. Three pattern-matching detection countermeasures typically employed are the <em>encryption</em> of the virus body with a variable cryptographic key, the <em>polymorphic</em> generation of the decryption routine using equivalent code instructions, and, more recently, the <em>metamorphic</em> generation of the whole virus body through the addition, removal, permutation, and substitution of code sequences. Viruses that employ these techniques, such as W32/Simile [12] can be very difficult to identify. In the following section we establish that reliably detecting instances of such viruses is a problem of NP-complete complexity.</p>
 
<h2>III. Identification complexity</h2>
<p>A virus is formally defined [13] by reference to a Turing Machine [14]</p>
<div class="N5"><img src="/img/cache/36a17f0c81b1c088a6dad26e9c9ac7a4.gif" alt="
		M : (S_M, I_M, O_M, S_M \times I_M \to I_M, \\
		\hspace{50} N_M: S_M \times I_M \to S_M, D_M: S_M \times I_M \to d) \hspace{100}(1)
" valign="middle"/></div>
<p>with a given set of states <img src="/img/cache/ffe92837d7813e7e64a6dcd1b135375b.gif" alt="S_M" valign="middle"/>, set of input symbols <img src="/img/cache/5a402d80918bd7fa3b880ebc566ec17b.gif" alt="I_M" valign="middle"/>, and maps <img src="/img/cache/940d6852d9cfa44c9f3a8e03b29768d6.gif" alt="(O_M, N_M, D_M)" valign="middle"/> that, based on its current state <img src="/img/cache/a3a9df7b93158cd67d4d3949dc6ed0eb.gif" alt="s \in S_M" valign="middle"/> and input symbol <img src="/img/cache/2474e97512c4547f4b298e095fec5cdf.gif" alt="i \in I_M" valign="middle"/> coming from a semi-infinite tape, determine: the output symbol <img src="/img/cache/2d0756da0652bbc3e800526b27d49fd5.gif" alt="o \in I_M" valign="middle"/> to write on the tape, the machine's next state <img src="/img/cache/e1053a5ea0a487fa1679e6197300c2df.gif" alt="s' \in S_M" valign="middle"/>, and the tape's motion <img src="/img/cache/ec9b4de06345b26dc38773b5621482d1.gif" alt="d \in \{-1,0,1\}" valign="middle"/>.</p>
<p>Given the machine <img src="/img/cache/69691c7bdcc3ce6d5d8a1361f22d04ac.gif" alt="M" valign="middle"/>, a sequence of tape symbols <img src="/img/cache/0d7e6b8df7a7b76821ad9d76dea1674d.gif" alt="v : v_i \in I_M_" valign="middle"/> can be considered as a virus <em>for that machine</em> iff, processing the sequence <img src="/img/cache/9e3669d19b675bd57058fd4664205d2a.gif" alt="v" valign="middle"/> at time (sequence point) <img src="/img/cache/e358efa489f58062f10dd7316b65649e.gif" alt="t" valign="middle"/> implies that at a future time point <img src="/img/cache/3b11da5ab8568206a5e1184fbf7f2005.gif" alt="t'" valign="middle"/> a sequence <img src="/img/cache/b3afdc4dc7644ad636e084509b04ddab.gif" alt="v'" valign="middle"/> - not overlapping with <img src="/img/cache/9e3669d19b675bd57058fd4664205d2a.gif" alt="v" valign="middle"/> - will exist on the tape, and that the sequence <img src="/img/cache/b3afdc4dc7644ad636e084509b04ddab.gif" alt="v'" valign="middle"/> will have been written by <img src="/img/cache/69691c7bdcc3ce6d5d8a1361f22d04ac.gif" alt="M" valign="middle"/> at a point <img src="/img/cache/eff9ec111ac240c3184120138ebd2899.gif" alt="t''" valign="middle"/> lying between <img src="/img/cache/e358efa489f58062f10dd7316b65649e.gif" alt="t" valign="middle"/> and <img src="/img/cache/3b11da5ab8568206a5e1184fbf7f2005.gif" alt="t'" valign="middle"/>:</p>
<div class="N5"><img src="/img/cache/f0e830141e76d36d3b9c9b07d55f7b31.gif" alt="
	\forall\boxempty_M\forall{t}\forall{j}:\\
	\begin{align}
		&amp;\ &amp;S_M(t) = S_{M_0}							&amp;\wedge\\
		&amp;\ &amp;P_M(t) = j								&amp;\wedge\\
		&amp;\ &amp;\{\boxempty_M(t, j) \dots \boxempty_M(t, j + |v| - 1)\} = v		&amp;\Rightarrow\\
	\end{align}	\\
	\exists{v'}\exists{j'}\exists{t'}\exists{t''}:\\
	\begin{align}
		&amp;\ &amp;t &lt; t'' &lt; t'							&amp;\wedge\\
		&amp;\ &amp;\{j' \dots j' + |v'|\} \cap \{j \dots j + |v|\} = \emptyset		&amp;\wedge\\
		&amp;\ &amp;\{\boxempty_M(t', j') \dots \boxempty_M(t', j' + |v'| - 1)\} = v'	&amp;\wedge\\
		&amp;\ &amp;P_M(t'') \in \{j' \dots j' + |v'| - 1\}
	\end{align}	\hspace{100}(2)
	
" valign="middle"/></div>
<p>where</p>
<ul>
<li><img src="/img/cache/5ac21cd527a99bb6b43d84ab4ba1cf25.gif" alt="t \in \mathbb{N}" valign="middle"/> stands for the number of times the machine has performed its basic operation - "move"</li>
<li><img src="/img/cache/8a61a2cf9cb6cce6eb855a0b027cb53e.gif" alt="P_M \in \mathbb{N}" valign="middle"/> represents the machine's tape cell position number at time <img src="/img/cache/e358efa489f58062f10dd7316b65649e.gif" alt="t" valign="middle"/></li>
<li><img src="/img/cache/ba9fcb36ae28ca2b4c9f5245fee6f278.gif" alt="S_{M_0}" valign="middle"/> is the machine's initial state</li>
<li><img src="/img/cache/09bbc3d84f58c21d16c17e06907d0cc6.gif" alt="\boxempty_M(t, c) \in I_M" valign="middle"/> represents the content of cell <img src="/img/cache/4a8a08f09d37b73795649038408b5f33.gif" alt="c" valign="middle"/> at time <img src="/img/cache/e358efa489f58062f10dd7316b65649e.gif" alt="t" valign="middle"/></li>
</ul>
<p>Note that in the original seminal reference [13] the above virus definition appears in the context of a viral set <img src="/img/cache/0cca1c0fd8c584b009f0fc84be296a06.gif" alt="VS = (M, V)" valign="middle"/>: a tuple consisting of a Turing Machine <img src="/img/cache/69691c7bdcc3ce6d5d8a1361f22d04ac.gif" alt="M" valign="middle"/> and a set of symbol sequences <img src="/img/cache/a9507905169298b7e885b4c50f49b513.gif" alt="V : v, v' \in V" valign="middle"/>. From the virus definition it is clear that the notion of a virus is intimately associated with its interpretation in a given context - environment. It has been shown [13] that "any self-replicating tape symbol sequence is a one element <img src="/img/cache/2c54e23f4c5442c665a807ab19f61204.gif" alt="VS" valign="middle"/>, that there are countably infinit <img src="/img/cache/2c54e23f4c5442c665a807ab19f61204.gif" alt="VS" valign="middle"/>s and non <img src="/img/cache/2c54e23f4c5442c665a807ab19f61204.gif" alt="VS" valign="middle"/>s, that machines exist for which all tape sequences are viruses and for which no tape sequences are viruses, and that any finite sequence of tape symbols is a virus with respect to some machine." The same reference also proves that in the general case determining whether a given tuple <img src="/img/cache/6c16a5aed8392f7ee8e17ced73ad4f94.gif" alt="(M, X) : X_i \in I_M" valign="middle"/> is viral is an undecidable problem (i.e. that there is no algorithm that can reliably detect all viruses) through a reasoning similar to that employed to prove the undecidability of the Halting Problem [14]. Other researchers have shown that there are also virus types (viruses that evolve to contain an instance of the virus detection program) that can not be detected by any error-free algorithm [15].</p>
<p>As is often the case, current practice differs from theory. Typical pattern based virus detection software scans a (relatively) known environment (processor architecture and operating system) to locate one of several (thousands in practice) <em>a-priori</em> known viruses. In the following paragraphs we will therefore establish the complexity of the more restricted problem of locating an instance of a known finite length virus in a given execution environment. For instance, the virus programs we provide in the appendices are only viral in the context of compilation and execution following the rules of Haskell and ANSI C/POSIX, respectively.</p>
<p>The complexity of detecting a known fixed virus pattern of length <img src="/img/cache/69691c7bdcc3ce6d5d8a1361f22d04ac.gif" alt="M" valign="middle"/> in a program of length <img src="/img/cache/8d9c307cb7f3c4a32822a51922d1ceaa.gif" alt="N" valign="middle"/> is harnessed by the Boyer-Moore string-searching algorithm [16] which never uses more than <img src="/img/cache/e25bf8ecce30f447172878da45746d82.gif" alt="N + M" valign="middle"/> steps and under many circumstances (a small pattern and a large alphabet) can use about <img src="/img/cache/ffd9384adb4e096a61e9404abac5fd3d.gif" alt="N / M" valign="middle"/> steps. Unfortunately, as we saw in the previous section, virus writers are seldom thus accommodating; fixed search patterns are not any more a viable virus detection method. We will prove that the problem of reliably identifying a bounded-length mutating virus is NP-complete. Our proof is based on showing that a virus detector <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> for a certain virus strain <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> can be used to solve the satisfiability problem, which is known to be NP-complete [17]. (This approach works in the same way for any similar NP-complete problem; the satisfiability of the problem we are examining is not a special case.)</p>
<p>The virus <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/> is a mutating self-replicating program. We assume that the virus detector <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> can reliably determine in P-time whether a given candidate program <img src="/img/cache/0d61f8370cad1d412f80b84d143e1257.gif" alt="C" valign="middle"/> is a mutation of the virus <img src="/img/cache/5206560a306a2e085a437fd258eb57ce.gif" alt="V" valign="middle"/>. We will use the virus detector as an oracle for determining the satisfiability of an <img src="/img/cache/8d9c307cb7f3c4a32822a51922d1ceaa.gif" alt="N" valign="middle"/>-term boolean formula <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/> of the following type:</p>
<div class="N5"><img src="/img/cache/b731fef6703014968235764c963024c3.gif" alt="
	\begin{align}
	S = 	&amp;&amp; (x_{a_{1,1}} \vee x_{a_{1,2}} \vee \neg x_{a_{1,3}} \vee \dots)	&amp; \wedge \\
		&amp;&amp; (\neg x_{a_{2,1}} \vee x_{a_{2,2}} \vee \neg x_{a_{2,3}} \vee \dots)	&amp; \wedge \\
		&amp;&amp; (x_{a_{3,1}} \dots 							&amp; \\
		&amp;&amp; \vdots 								&amp; \hspace{100}(3) \\
		&amp;&amp; 0 \le a_{i,j} \lt N							&amp; \hspace{100}(4)
	\end{align}
" valign="middle"/></div>
<p>and thereby show that a P-time reliable virus detector is equivalent to a P-time solution to the satisfiability problem.</p>
<p>We will use the satisfiability formula <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/> to create a virus archetype <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/> and a possible instance of a virus phenotype <img src="/img/cache/44c29edb103a2872f519ad0c9a0fdaaa.gif" alt="P" valign="middle"/>.</p>
<p>The virus is a triple</p>
<div class="N5"><img src="/img/cache/c74ecfcde1d6f5c3b31c6119ef624b24.gif" alt="
	(f, s, c) \hspace{100}(5)
" valign="middle"/></div>
<p>where</p>
<ul>
<li><img src="/img/cache/8fa14cdd754f91cc6554c9e71929cce7.gif" alt="f" valign="middle"/> is the virus processing and replication function</li>
<li><img src="/img/cache/03c7c0ace395d80182db07ae2c30f034.gif" alt="s" valign="middle"/> is a boolean value indicating whether an instance of the virus has found a solution to <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/></li>
<li><img src="/img/cache/4a8a08f09d37b73795649038408b5f33.gif" alt="c" valign="middle"/> is an integer encoding the candidate values for <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/></li>
</ul>
<p>The function <img src="/img/cache/8fa14cdd754f91cc6554c9e71929cce7.gif" alt="f" valign="middle"/> maps a triple <img src="/img/cache/a52ffbaa1b7b15c7804506154dd9a2a7.gif" alt="(f, s, c)" valign="middle"/> into a new triple <img src="/img/cache/0157e1886e6ece32d5ba58313dabd1b6.gif" alt="(f, s', c')" valign="middle"/> and is defined as follows:</p>
<div class="N5"><img src="/img/cache/b9adc987ba58c234c45f60e9de3f41b6.gif" alt="
	\lambda (f, s, c).(f, s \vee S, \text{ if } c = 2^N \text{ then } c \text{ else } c + 1)
	\hspace{100}(6)
" valign="middle"/></div>
<p>Each <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/> term <img src="/img/cache/5bef92b1854f9c388d11bfbb1720c05d.gif" alt="x_n" valign="middle"/> is calculated from <img src="/img/cache/4a8a08f09d37b73795649038408b5f33.gif" alt="c" valign="middle"/> through the expression</p>
<div class="N5"><img src="/img/cache/9676bec9879d0c155960b1730634268c.gif" alt="
	\lfloor \frac{c}{2^n} \rfloor \text{ mod } 2 = 1
	\hspace{100}(7)
" valign="middle"/></div>
 
<p>A new generation of the virus is generated by applying <img src="/img/cache/8fa14cdd754f91cc6554c9e71929cce7.gif" alt="f" valign="middle"/> to the current generation.</p>
<p>Expressed in words, each new virus generation</p>
<ol>
<li>evaluates <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/> by extracting successive boolean value combinations from <img src="/img/cache/4a8a08f09d37b73795649038408b5f33.gif" alt="c" valign="middle"/></li>
<li>increments <img src="/img/cache/4a8a08f09d37b73795649038408b5f33.gif" alt="c" valign="middle"/> until it reaches <img src="/img/cache/f82f4b6656e1510bdce5c8a614763571.gif" alt="2^N" valign="middle"/></li>
<li>passes the result of the <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/> evaluation to the next generation</li>
</ol>
<p>We can now ask <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> whether the virus archetype <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/></p>
<div class="N5"><img src="/img/cache/72898fca402aa1ae99a633c218440a4a.gif" alt="
	(f, \text{False}, 0)
	\hspace{100}(8)
" valign="middle"/></div>
<p>will ever result in a virus mutation phenotype <img src="/img/cache/44c29edb103a2872f519ad0c9a0fdaaa.gif" alt="P" valign="middle"/></p>
<div class="N5"><img src="/img/cache/acb74e0a4bd735c1045720edf660ce8a.gif" alt="
	(f, \text{True}, 2^N)
	\hspace{100}(9)
" valign="middle"/></div>
<p>that is whether one of the virus mutations will satisfy <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/>.</p>
<p>We have thus proven that a reliable virus detector <img src="/img/cache/f623e75af30e62bbd73d6df5b50bb7b5.gif" alt="D" valign="middle"/> operating in P-time can be used as a P-time satisfiability oracle and that therefore reliable virus detection is NP-complete.</p>
<p>As an example for the operation of the virus consider the satisfiability of the formula <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/></p>
<div class="N5"><img src="/img/cache/7fca7ec94fc8bd109855884aee6c864d.gif" alt="
	(x_0 \vee x_1) \wedge \neg x_0
	\hspace{100}(10)
" valign="middle"/></div>
<p>The virus replication function <img src="/img/cache/8fa14cdd754f91cc6554c9e71929cce7.gif" alt="f" valign="middle"/> - after omitting for simplicity of expression the conditional, which only serves to limit the number of virus mutations - will be:</p>
<div class="N5"><img src="/img/cache/fd0af9b4cb532182623ea70fd791ca6a.gif" alt="
	\lambda(f, s, c).(f, s, \vee (x_0 \vee x_1) \wedge \neg x_0, c + 1)
	\hspace{100}(11)
" valign="middle"/></div>
<p>the corresponding archetype <img src="/img/cache/7fc56270e7a70fa81a5935b72eacbe29.gif" alt="A" valign="middle"/>:</p>
<div class="N5"><img src="/img/cache/c656b0e8f5c1f5326d79130589285a18.gif" alt="
	(\lambda(f, s, c).(f, s, \vee (x_0 \vee x_1) \wedge \neg x_0, c + 1), \text{F}, 0)
	\hspace{100}(12)
" valign="middle"/></div>
<p>and the phenotype <img src="/img/cache/44c29edb103a2872f519ad0c9a0fdaaa.gif" alt="P" valign="middle"/> indicating satisfiability:</p>
<div class="N5"><img src="/img/cache/1729eaa3adb633cddab66aaedb9395e6.gif" alt="
	(\lambda(f, s, c).(f, s, \vee (x_0 \vee x_1) \wedge \neg x_0, c + 1), \text{T}, 4)
	\hspace{100}(13)
" valign="middle"/></div>
<p>This particular virus will generate a mutation <img src="/img/cache/44c29edb103a2872f519ad0c9a0fdaaa.gif" alt="P" valign="middle"/> - and there by indicate that <img src="/img/cache/5dbc98dcc983a70728bd082d1a47546e.gif" alt="S" valign="middle"/> is satisfiable - in four generations through the following sequence:</p>
<div class="N5"><img src="/img/cache/9d20208b98f6863de0b3fcc82ad507e6.gif" alt="
	\begin{align}
		&amp;&amp; f f f f A 										&amp; \rightarrow	\\
		&amp;&amp; f f f \lambda (f, s, c).(f, s \vee (x_0 \vee x_1) \wedge \neg x_0, c + 1)		&amp;		\\
		&amp;&amp; (\lambda (f, s, c).(f, s \vee S, c + 1, F, 0)					&amp; \overset{\beta}{\rightarrow} \\
		&amp;&amp; f f f(\lambda (f, s, c).(f, s \vee S, c + 1), F \vee (F \vee F) \wedge \neg F, 0 + 1)&amp; \overset{\delta}{\rightarrow}\\
		&amp;&amp; f f f(\lambda (f, s, c).(f, s \vee S, c + 1), F, 1) 					&amp; \rightarrow \\
		&amp;&amp; f f \lambda (f, s, c).(f, s \vee (x_0 \vee x_1) \wedge \neg x_0, c + 1)		&amp; \\
		&amp;&amp; (\lambda (f, s, c).(f, s \vee S, c + 1), F, 1)					&amp; \overset{\beta}{\rightarrow}\\
		&amp;&amp; f f \lambda (f, s, c).(f, s \vee S, c + 1), F \vee (T \vee F) \wedge \neg T, 1 + 1)	&amp; \overset{\delta}{\rightarrow}\\
		&amp;&amp; f f \lambda (f, s, c).(f, s \vee S, c + 1), F, 2)					&amp; \rightarrow \\
		&amp;&amp; f \lambda (f, s, c).(f, s \vee (x_0 \vee x_1) \wedge \neg x_0, c + 1)		&amp; \\
		&amp;&amp; \lambda (f, s, c).(f, s \vee S, c + 1), F, 2)					&amp; \overset{\beta}{\rightarrow}\\
		&amp;&amp; f \lambda (f, s, c).(f, s \vee S, c + 1), F \vee (F \vee T) \wedge \neg F, 2 + 1)	&amp; \overset{\delta}{\rightarrow}\\
		&amp;&amp; f \lambda (f, s, c).(f, s \vee S, c + 1), T, 3)					&amp; \rightarrow \\
		&amp;&amp; \lambda (f, s, c).(f, s \vee (x_0 \vee x_1) \wedge \neg x_0, c + 1)			&amp; \\
		&amp;&amp; \lambda (f, s, c).(f, s \vee S, c + 1), T, 3)					&amp; \overset{\beta}{\rightarrow}\\
		&amp;&amp; (\lambda (f, s, c).(f, s \vee S, c + 1), T \vee (T \vee T) \wedge \neg T, 3 + 1)	&amp; \overset{\delta}{\rightarrow}\\
		&amp;&amp; (\lambda (f, s, c).(f, s \vee S, c + 1), T, 4) \equiv P
	\end{align}
	\hspace{100}(14)
" valign="middle"/></div>
<h2>IV. Implications</h2>
<p>The creation of metamorphic viruses is a relatively recent phenomenon that places a considerable threat on our information system infrastructures. From a theoretical point of view, the viruses bear remarkable similarities to the virus we have examined and the examples depicted in this paper's appendices. Virus detection programs however need not be 100% correct. Users can tolerate the (typically remote) possibility of some "noise" (false positives), because in practice it is quite rare for a non-viral program to match the detection pattern of a known virus. As an example, a virus detector that detected this paper's viruses and also detected as a virus all triplets of the form <img src="/img/cache/7ee2104fd2f3256cc769be685ec3221d.gif" alt="(f, s, n) : \forall s \forall n" valign="middle"/> (even cases where <img src="/img/cache/8fa14cdd754f91cc6554c9e71929cce7.gif" alt="f" valign="middle"/> is a non-satisfiable formula and <img src="/img/cache/03c7c0ace395d80182db07ae2c30f034.gif" alt="s" valign="middle"/> is true) would probably be tolerated as a functioning "good-enough" virus detector, although strictly speaking it detects some false positives. Such a virus detector can be implemented to terminate in linear time and is not NP-complete.</p>
<p>Thus, given the difference between the theoretically perfect detection (which is in the general case undecidable, and for known viruses, as we demonstrated, NP-complete) and the practically sufficient identification (which is the basis for a number of working virus scanner implementations) two questions arise.</p>
<ol>
<li>How can the notion of "sufficiently good detection" be formalized in information theory terms?</li>
<li>Can the increasing ability of metamorphic viruses to mutate move the identification threshold currently used by virus detection programs to the point where either numerous legitimate data sequences are falsely detected as viruses, or real viruses fail to be detected?</li>
</ol>
<p>An interesting phenomenon affecting the above topics concerns the currently permeable boundary between code and data. <em>Buffer overflow attacks</em> [18] are based on data that overwrites a carelessly written program's return stack address lying at the end of a data buffer to cause the program to execute part of that data. This renders all data files (documents, images, music, video - many of them highly compressed) stored on a computer potential carriers of viral code and dramatically increases the data a virus detector has to scan and discriminate. Few viruses currently propagate through buffer overflows; these weaknesses have traditionally been mainly exploited by worms and Trojan horses [19]. However, once such viruses are released, the current virus detection approach will come under increasing strain, faced with the short pattern vectors of mutating viruses and orders of magnitude more data to scan; as an example a 18GB disk filled with MP3 files is likely to contain any 4-byte (virus) pattern. In the medium and long term, hardening our security defences and developing software, procedures, and work practices that will stem the spread of malware seem to be the only reasonable alternatives.</p>
<h2>Appendix I. Virus code in Haskell</h2>
<p>The following code defines the virus replication function and the respective archetype and candidate phenotype, for determining the satisfiability of the expression</p>
<div class="N5"><img src="/img/cache/245ba337801d8de5b44fa5a6dde3dec2.gif" alt="
	(x_0 \vee x_3 \vee \neg x_4) \wedge (\neg x_1 \vee x_5) \wedge (x_2)
	\hspace{100}(15)
" valign="middle"/></div>
 
<p>The satisfiability function candidate values are encoded using Haskell's arbitrary precision integers.</p>
<div class="haskell" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #06c; font-weight: bold;">module</span> Virus <span style="color: #06c; font-weight: bold;">where</span><br/>
&nbsp; replicate <span style="color: #339933; font-weight: bold;">::</span> <span style="color: black;">&#40;</span>replicate<span style="color: #339933; font-weight: bold;">,</span> <a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Bool"><span style="color: #cccc00; font-weight: bold;">Bool</span></a><span style="color: #339933; font-weight: bold;">,</span> <a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Integer"><span style="color: #cccc00; font-weight: bold;">Integer</span></a><span style="color: black;">&#41;</span><span style="color: #339933; font-weight: bold;">-&gt;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#40;</span>replicate<span style="color: #339933; font-weight: bold;">,</span> <a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Bool"><span style="color: #cccc00; font-weight: bold;">Bool</span></a><span style="color: #339933; font-weight: bold;">,</span> <a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Integer"><span style="color: #cccc00; font-weight: bold;">Integer</span></a><span style="color: black;">&#41;</span><br/>
&nbsp; replicate <span style="color: black;">&#40;</span>v<span style="color: #339933; font-weight: bold;">,</span> b<span style="color: #339933; font-weight: bold;">,</span> i<span style="color: black;">&#41;</span> <span style="color: #339933; font-weight: bold;">=</span> <span style="color: black;">&#40;</span>v<span style="color: #339933; font-weight: bold;">,</span> b <span style="color: #339933; font-weight: bold;">||</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span>bit <span style="color: red;">0</span> i<span style="color: black;">&#41;</span> <span style="color: #339933; font-weight: bold;">||</span> <span style="color: black;">&#40;</span>bit <span style="color: red;">3</span> i<span style="color: black;">&#41;</span> <span style="color: #339933; font-weight: bold;">||</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:not"><span style="font-weight: bold;">not</span></a> <span style="color: black;">&#40;</span>bit <span style="color: red;">4</span> i<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #339933; font-weight: bold;">&amp;&amp;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#40;</span><a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:not"><span style="font-weight: bold;">not</span></a> <span style="color: black;">&#40;</span>bit <span style="color: red;">1</span> i<span style="color: black;">&#41;</span> <span style="color: #339933; font-weight: bold;">||</span> <span style="color: black;">&#40;</span>bit <span style="color: red;">5</span> i<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #339933; font-weight: bold;">&amp;&amp;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: black;">&#40;</span><span style="color: black;">&#40;</span>bit <span style="color: red;">2</span> i<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #339933; font-weight: bold;">,</span> <span style="color: #06c; font-weight: bold;">if</span> i <span style="color: #339933; font-weight: bold;">==</span> <span style="color: red;">64</span> <span style="color: #06c; font-weight: bold;">then</span> i <span style="color: #06c; font-weight: bold;">else</span> i <span style="color: #339933; font-weight: bold;">+</span> <span style="color: red;">1</span><span style="color: black;">&#41;</span><br/>
<br/>
&nbsp; <span style="color: black; font-style: italic;">-- Extract bit b out of the Integer n</span><br/>
&nbsp; bit <span style="color: #339933; font-weight: bold;">::</span> <a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Integer"><span style="color: #cccc00; font-weight: bold;">Integer</span></a> <span style="color: #339933; font-weight: bold;">-&gt;</span> <a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Integer"><span style="color: #cccc00; font-weight: bold;">Integer</span></a> <span style="color: #339933; font-weight: bold;">-&gt;</span> <a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Bool"><span style="color: #cccc00; font-weight: bold;">Bool</span></a><br/>
&nbsp; bit b n <span style="color: #339933; font-weight: bold;">=</span> n `<a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:div"><span style="font-weight: bold;">div</span></a>` <span style="color: black;">&#40;</span><span style="color: red;">2</span> <span style="color: #339933; font-weight: bold;">^</span> b<span style="color: black;">&#41;</span> `<a style="color: #000060;" href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:rem"><span style="font-weight: bold;">rem</span></a>` <span style="color: red;">2</span> <span style="color: #339933; font-weight: bold;">==</span> <span style="color: red;">1</span><br/>
<br/>
&nbsp; virus<span style="color: #339933; font-weight: bold;">_</span>archetype <span style="color: #339933; font-weight: bold;">=</span> <span style="color: black;">&#40;</span>replicate<span style="color: #339933; font-weight: bold;">,</span> False<span style="color: #339933; font-weight: bold;">,</span> <span style="color: red;">0</span><span style="color: black;">&#41;</span><br/>
&nbsp; virus<span style="color: #339933; font-weight: bold;">_</span>phenotype <span style="color: #339933; font-weight: bold;">=</span> <span style="color: black;">&#40;</span>replicate<span style="color: #339933; font-weight: bold;">,</span> True<span style="color: #339933; font-weight: bold;">,</span> <span style="color: red;">64</span><span style="color: black;">&#41;</span><br/>
&nbsp;</div>
<h2>Appendix II. Virus code in C</h2>
<p>The following code is the virus archetype, again for determining the satisfiability of the expression (15). The satisfiability function candidate values are encoded as elements of the array x.</p>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #339933;">#include &lt;stdio.h&gt;</span><br/>
<span style="color: #339933;">#include &lt;ctype.h&gt;</span><br/>
<br/>
<span style="color: #808080; font-style: italic;">/* Number of variables to satisfy */</span><br/>
<span style="color: #339933;">#define N 6</span><br/>
<span style="color: #993333;">int</span> x<span style="color: black;">&#91;</span>N<span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: black;">&#123;</span><br/>
<span style="color: #0000dd;">0</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">,</span><br/>
<span style="color: black;">&#125;</span><span style="color: #339933;">;</span><br/>
<span style="color: #993333;">void</span><br/>
advance<span style="color: black;">&#40;</span><span style="color: #993333;">void</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #993333;">int</span> i<span style="color: #339933;">,</span> j<span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span>i <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> N<span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span>x<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span> <span style="color: #339933;">==</span> <span style="color: #0000dd;">0</span><span style="color: black;">&#41;</span> <span style="color: black;">&#123;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span>j <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span> j <span style="color: #339933;">&lt;</span> i<span style="color: #339933;">;</span> j<span style="color: #339933;">++</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; &nbsp; x<span style="color: black;">&#91;</span>j<span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; x<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: black;">&#125;</span><br/>
<span style="color: black;">&#125;</span><br/>
<span style="color: #993333;">void</span><br/>
print_vector<span style="color: black;">&#40;</span>FILE <span style="color: #339933;">*</span>f<span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #993333;">int</span> i<span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #b1b100;">for</span> <span style="color: black;">&#40;</span>i <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> N<span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fprintf.html"><span style="color: #000066;">fprintf</span></a><span style="color: black;">&#40;</span>f<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;%c, &quot;</span><span style="color: #339933;">,</span> x<span style="color: black;">&#91;</span>i<span style="color: black;">&#93;</span> <span style="color: #339933;">?</span> <span style="color: #ff0000;">'1'</span> <span style="color: #339933;">:</span> <span style="color: #ff0000;">'0'</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fputc.html"><span style="color: #000066;">fputc</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #339933;">,</span> f<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
main<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br/>
<span style="color: black;">&#123;</span><br/>
&nbsp; <span style="color: #993333;">char</span> buff<span style="color: black;">&#91;</span><span style="color: #0000dd;">1024</span><span style="color: black;">&#93;</span><span style="color: #339933;">;</span><br/>
&nbsp; FILE <span style="color: #339933;">*</span>fi <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fopen.html"><span style="color: #000066;">fopen</span></a><span style="color: black;">&#40;</span>__FILE__<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;r&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; FILE <span style="color: #339933;">*</span>fo <span style="color: #339933;">=</span> <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fopen.html"><span style="color: #000066;">fopen</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;new&quot;</span> __FILE__<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;w&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
<br/>
&nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: black;">&#93;</span> <span style="color: #339933;">||</span> x<span style="color: black;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: black;">&#93;</span> <span style="color: #339933;">||</span> <span style="color: #339933;">!</span>x<span style="color: black;">&#91;</span><span style="color: #0000dd;">4</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span><br/>
&nbsp; &nbsp; &nbsp; <span style="color: black;">&#40;</span><span style="color: #339933;">!</span>x<span style="color: black;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: black;">&#93;</span> <span style="color: #339933;">||</span> x<span style="color: black;">&#91;</span><span style="color: #0000dd;">5</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: black;">&#40;</span>x<span style="color: black;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fprintf.html"><span style="color: #000066;">fprintf</span></a><span style="color: black;">&#40;</span>fo<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;/* Satisfied */<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; advance<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #b1b100;">while</span> <span style="color: black;">&#40;</span><a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fgets.html"><span style="color: #000066;">fgets</span></a><span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> <span style="color: #993333;">sizeof</span><span style="color: black;">&#40;</span>buff<span style="color: black;">&#41;</span><span style="color: #339933;">,</span> fi<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: black;">&#40;</span><a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/isdigit.html"><span style="color: #000066;">isdigit</span></a><span style="color: black;">&#40;</span>buff<span style="color: black;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br/>
&nbsp; &nbsp; &nbsp; print_vector<span style="color: black;">&#40;</span>fo<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; &nbsp; <span style="color: #b1b100;">else</span><br/>
&nbsp; &nbsp; &nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fputs.html"><span style="color: #000066;">fputs</span></a><span style="color: black;">&#40;</span>buff<span style="color: #339933;">,</span> fo<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fclose.html"><span style="color: #000066;">fclose</span></a><span style="color: black;">&#40;</span>fi<span style="color: black;">&#41;</span><span style="color: #339933;">;</span> <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/fclose.html"><span style="color: #000066;">fclose</span></a><span style="color: black;">&#40;</span>fo<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <a style="color: #000060;" href="http://www.opengroup.org/onlinepubs/009695399/functions/system.html"><span style="color: #000066;">system</span></a><span style="color: black;">&#40;</span><span style="color: #ff0000;">&quot;cc new&quot;</span> __FILE__<span style="color: black;">&#41;</span><span style="color: #339933;">;</span><br/>
&nbsp; <span style="color: #b1b100;">return</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">;</span><br/>
<span style="color: black;">&#125;</span><br/>
&nbsp;</div>
<p>The candidate virus phenotype begins as follows:</p>
<div class="c" style="font-family:monospace;color: #000066;  border: solid thin #c2c1b1; background: #d6d5c5;"><span style="color: #808080; font-style: italic;">/* Satisfied */</span><br/>
<span style="color: black;">&#91;</span>...<span style="color: black;">&#93;</span><br/>
<span style="color: #993333;">int</span> x<span style="color: black;">&#91;</span>N<span style="color: black;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: black;">&#123;</span><br/>
<span style="color: #0000dd;">1</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">1</span><span style="color: #339933;">,</span><br/>
<span style="color: black;">&#125;</span><span style="color: #339933;">;</span><br/>
&nbsp;</div>
<h2>Acknowledgments</h2>
<p>The author acknowledges the valuable suggestions of the anonymous referees on an earlier version of this paper. The publication of this work was supported by the IST project mEXPRESS (IST-2001-33432), which is funded in part by the European Commission.</p>
<h2>References</h2>
<ol>
<li>M. R. Garey and D. S. Johnson, <em>Computers and Intractability: A Guide to the Theory of NP-Completeness</em>, W. H. Freeman and Company, 1979.</li>
<li>Carl E. Landwehr, Alan R. Bull, John P. McDermott, and William S. Choi, "A taxonomy of computer program security flaws," <em>ACM Computing Surveys</em>, vol. 26, no. 3, pp. 211-254, Sept. 1994.</li>
<li>Peter J. Denning, "Computer viruses," <em>American Scientist</em>, pp. 236-238, May-June 1988.</li>
<li>Fred Cohen, "<a href="/lib/afc01.html">Computer viruses: Theory and experiments</a>," <em>Computers &amp; Security</em>, vol. 6, no. 1, pp. 22-35, Feb. 1987.</li>
<li>Eugene H. Spafford, Kathleen A. Heaphy, and David J. Ferbrache, "A computer virus primer," in <em><a href="/lib/apd01.html">Computers Under Attack: Intruders, Worms, and Viruses</a></em>, Peter J. Denning, Ed., chapter 20, pp. 316-355. Addison-Wesley, 1990.</li>
<li>Vassilis Prevelakis and Diomidis Spinellis, "Sandboxing applications," in <em>USENIX 2001 Technical Conference Proceedings: FreeNIX Track</em>. Usenix Association, June 2001.</li>
<li>Prabhat K. Singh and Arun Lakhotia, "Analysis and detection of computer viruses and worms: An annotated bibliography," <em>ACM SIGPLAN Notices</em>, vol. 37, no. 2, pp. 29-35, Feb. 2002.</li>
<li>R. Rivest, "RFC 1321: The MD5 message-digest algorithm," Apr. 1992, Status: INFORMATIONAL.</li>
<li>Ken L. Thompson, "<a href="/lib/mkt00.html">Reflections on trusting trust</a>," <em>Communications of the ACM</em>, vol. 27, no. 8, pp. 761-763, Aug. 1984.</li>
<li>Tom Duff, "Experience with viruses on UNIX systems," <em>Computing Systems</em>, vol. 2, no. 2, pp. 155-171, Spring 1989.</li>
<li>M. Douglas McIlroy, "<a href="/lib/vmm00.html">Virology 101</a>," <em>Computing Systems</em>, vol. 2, no. 2, pp. 173-184, Spring 1989.</li>
<li>Fr&egrave;d&egrave;ric Perriot, Peter Ferrie, and P&egrave;ter Sz&ouml;r,"W32/Simile," Online http://www.virusbtn.com/resources/viruses/indepth/simile.xml. Current June 2002, 2002.</li>
<li>Fred Cohen, "<a href="/lib/afc10.html">Computational aspects of computer viruses</a>," <em>Computers &amp; Security</em>, vol. 8, no. 4, pp. 325-344, June 1989.</li>
<li>Alan M. Turing, "On computable numbers, with an application to the Entscheidungs Problem," <em>Proceedings of the London Mathematical Society</em>, vol. 2, no. 42, pp. 230-265, 1936, Corrections in 2(43):544-546.</li>
 
<li>David M. Chess and Steve R. White, <a href="/lib/adc06.html">"An undetectable computer virus,"</a> in <em>Virus Bulletin Conference</em>, Sept. 2000, Online http://www.research.ibm.com/antivirus/SciPapers/VB2000DC.pdf. Current June 2002.</li>
<li>R. S. Boyer and J. S. Moore, "A fast string searching algorithm," <em>Communications of the ACM</em>, vol. 20, no. 10, pp. 262-272, Oct. 1977.</li>
<li>S. A. Cook, "The complexity of theorem prooving procedures," in <em>Proceeding of the 3rd ACM Symposium on Theory of Computing</em>. 1971, pp. 151-158, ACM.</li>
<li>Crispan Cowan, Perry Wagle, Calton Pu, Steve Beattie, and Jonathan Walpole, "Buffer overflows: Attacks and defenses for the vulnerability of the decade," in <em>Proceedings of the DARPA Information Survivability Conference and Exposition</em>, Hilton Head, SC, USA, Jan. 2000, DARPA, pp. 119-129.</li>
<li>Mark W. Eichlin and Jon A. Rochlis, "<a href="/lib/aem02.html">With microscope and tweezers: An analysis of the internet virus of November 1988</a>," in <em>IEEE Symposium on Research in Security and Privacy</em>, Oakland, CA, May 1989, pp. 326-345.</li>
</ol>
<div>
<div style="float:left; border: solid thin black; width: 4em; text-align: center; margin-right: .5em;"><p>PLACE PHOTO HERE</p></div>
<p><small>Diomidis Spinellis holds an MEng in Software Engineering and a PhD in Computer Science both from Imperial College (University of London, UK). Currently he is an Assistant Professor at the Department of Management Science and Technology at the Athens University of Economics and Business, Greece. He is the author of the book "Code Reading: The Open Source Perspective" (Addison Wesley, 2003) and more than 60 journal papers and conference presentations. He has contributed software to the BSD Unix distribution, the X-Windows system, and is the author of a number of open-source software packages, libraries, and tools. His research interests include Information Security, Software Engineering, and Ubiquitous Computing.<br/>
Dr. Spinellis is a member of the ACM, the IEEE Computer Society, the Greek Computer Society, the Technical Chamber of Greece, and a founding member of the Greek Internet User's Society. He is a co-recipient of the Usenix Association 1993 Lifetime Achievement Award.</small></p>
</div>
<hr/>
<p><a name="f1" href="#b1">1</a> IEEE Transactions on Information Theory, 49(1):280-284, January 2003.</p>
<p><a name="f2" href="#b2">2</a> This is a machine-readable rendering of a working paper draft that led to a publication. The publication should always be cited in preference to this draft using the reference in the previous footnote. This material is presented to ensure timely dissemination of scholarly and technical work. Copyright and all rights therein are retained by authors or by other copyright holders. All persons copying this information are expected to adhere to the terms and constraints invoked by each author's copyright. In most cases, these works may not be reposted without the explicit permission of the copyright holder.</p>
[<a style="" href="/lib/?lang=EN&amp;index=TH#ads03">Back to index</a>] [<a href="/lib/ads03.html#disqus_thread">Comments</a>]<br/> <div id="disqus_thread"></div>
<script type="text/rocketscript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'vxheaven'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<div><small>By accessing, viewing, downloading or otherwise using this content you agree to be bound by the <a href="/agreement.php">Terms of Use</a>!</small> <small>vxheaven.org aka vx.netlux.org</small></div>
<div style="margin-top: 2px; float: left;" class="adsapeu">
<script type="text/rocketscript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
</div>
<script data-rocketsrc="http://www.google-analytics.com/urchin.js" type="text/rocketscript"></script><script type="text/rocketscript">try { _uacct = "UA-590608-1"; urchinTracker(); } catch(err) {}</script>
<div style="display: none;"><a href="/lib/index.php?lang=de&amp;id=ads03">de</a><a href="/lib/index.php?lang=en&amp;id=ads03">en</a><a href="/lib/index.php?lang=es&amp;id=ads03">es</a><a href="/lib/index.php?lang=it&amp;id=ads03">it</a><a href="/lib/index.php?lang=fr&amp;id=ads03">fr</a><a href="/lib/index.php?lang=pl&amp;id=ads03">pl</a><a href="/lib/index.php?lang=ru&amp;id=ads03">ru</a><a href="/lib/index.php?lang=ua&amp;id=ads03">ua</a></div>
</body>
</html>
